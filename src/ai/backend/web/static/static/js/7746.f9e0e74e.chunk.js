"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[7746],{94777:(e,t,s)=>{s.d(t,{A:()=>F});var i=s(58452),n=s(90840),l=s(59571),r=s(3730),a=s(79151),o=s(34132),c=s(88961),u=s(29107),d=s(27484),g=s.n(d),p=s(1426),h=s(42906);const m=(0,u.rU)((e=>{let{css:t}=e;return{baiSettingItemCheckbox:t`
    .ant-checkbox {
      align-self: flex-start;
      margin-top: 0.2rem;
    }
  `}})),x=e=>{let{type:t,title:s,description:i,children:u,defaultValue:d,value:p,selectProps:x,onChange:y,disabled:v}=e;const{token:b}=l.A.useToken(),{styles:j}=m();return(0,h.jsxs)(n.A,{direction:"column",align:"start",gap:"xxs",children:[(0,h.jsxs)(n.A,{direction:"row",gap:"xxs",children:[(0,h.jsx)(r.A.Text,{strong:!0,style:{fontSize:b.fontSize},children:s}),!v&&void 0!==p&&null!==p&&d!==p&&(0,h.jsx)(a.A,{dot:!0,status:"warning"})]}),"custom"===t&&(0,h.jsxs)(h.Fragment,{children:[i,(0,h.jsx)("div",{style:{marginTop:b.marginXS},children:u})]}),"checkbox"===t&&(0,h.jsx)(o.A,{checked:p,onChange:y,disabled:v,className:j.baiSettingItemCheckbox,children:(0,h.jsx)(r.A.Text,{type:v?"secondary":void 0,children:i})}),"select"===t&&(0,h.jsxs)(h.Fragment,{children:[i,(0,h.jsx)(c.A,{value:p,popupMatchSelectWidth:!1,onChange:y,disabled:v,style:{marginTop:b.marginXS,...null===x||void 0===x?void 0:x.style},...g().omit(x,["style"])})]})]})};var y=s(80310),v=s(80707),b=s(67884),j=s(67933),_=s(86187),f=s(64181),k=s(79810),A=s(28134),S=s(4800),w=s(9976);const C=(0,u.rU)((e=>{let{css:t,token:s}=e;return{TabStyles:t`
    .ant-tabs-tab-active {
      font-weight: var(--token-fontWeightSuperStrong, 700);
    }
    .ant-typography-secondary {
      font-weight: normal !important;
    }
  `}})),P=e=>{let{title:t,count:s}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.A.Text,{children:t}),(0,h.jsx)(r.A.Text,{type:"secondary",children:` (${s})`})]})},T=e=>{let{group:t,hideEmpty:s}=e;const{token:i}=l.A.useToken();return(!s||0!==t.settingItems.length)&&(0,h.jsxs)(n.A,{direction:"column",align:"stretch",style:{marginBottom:i.marginMD},children:[(0,h.jsxs)(n.A,{direction:"column",align:"stretch",style:{zIndex:1,marginBottom:i.marginMD,background:i.colorBgContainer},children:[(0,h.jsx)(r.A.Title,{level:5,style:{marginTop:0},children:t.title}),(0,h.jsx)(j.A,{style:{marginTop:0,marginBottom:0}}),t.description&&(0,h.jsx)(r.A.Text,{type:"secondary",style:{marginTop:i.marginSM},children:t.description})]}),(0,h.jsx)(n.A,{direction:"column",align:"start",gap:"lg",children:t.settingItems.map(((e,t)=>(0,h.jsx)(x,{...e},e.title+t)))})]})},F=e=>{let{settingGroups:t,tabDirection:s="left",showChangedOptionFilter:r,showResetButton:a,showSearchBar:c}=e;const{t:u}=(0,w.Bd)(),{token:d}=l.A.useToken(),{styles:m}=C(),[x,j]=(0,p.useState)(""),[F,I]=(0,p.useState)(!1),[R,{toggle:U}]=(0,b.A)(!1),[D,V]=(0,p.useState)("all"),O=g().map(t,(e=>({...e,settingItems:g().filter(e.settingItems,(e=>(!F||(e=>null!==e.value&&void 0!==e.value&&!e.disabled&&e.value!==e.defaultValue)(e))&&(e=>e.title.toLowerCase().includes(x.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(x.toLowerCase()))(e)))})));return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(n.A,{direction:"column",gap:"md",align:"stretch",style:{padding:d.paddingContentHorizontal,maxWidth:d.screenLG},children:[(0,h.jsxs)(n.A,{justify:"start",gap:"xs",children:[!!c&&(0,h.jsx)(_.A,{prefix:(0,h.jsx)(y.A,{}),placeholder:u("settings.SearchPlaceholder"),onChange:e=>j(e.target.value),value:x}),!!r&&(0,h.jsx)(o.A,{onChange:e=>I(e.target.checked),style:{whiteSpace:"nowrap"},children:u("settings.ShowOnlyChanged")}),!!a&&(0,h.jsx)(f.Ay,{icon:(0,h.jsx)(v.A,{}),onClick:()=>U(),children:u("button.Reset")})]}),(0,h.jsx)(k.A,{activeKey:D,onChange:V,className:m.TabStyles,tabPosition:s?"left":"top",tabBarStyle:{minWidth:200},items:[{key:"all",label:(0,h.jsx)(P,{title:u("general.All"),count:g().sumBy(O,(e=>e.settingItems.length))}),children:(0,h.jsx)(n.A,{direction:"column",align:"stretch",gap:"xl",children:g().sumBy(O,(e=>e.settingItems.length))>0?g().map(O,(e=>(0,h.jsx)(T,{group:e,hideEmpty:!0},e.title))):(0,h.jsx)(A.A,{image:A.A.PRESENTED_IMAGE_SIMPLE,description:u("settings.NoChangesToDisplay")})})},...g().map(O,((e,t)=>({key:`index${t}`,label:(0,h.jsx)(P,{title:e.title,count:e.settingItems.length}),children:e.settingItems.length>0?(0,h.jsx)(T,{group:e,hideEmpty:!0}):(0,h.jsx)(A.A,{image:A.A.PRESENTED_IMAGE_SIMPLE,description:u("settings.NoChangesToDisplay")})})))]})]}),(0,h.jsx)(i.A,{open:R,title:u("dialog.ask.DoYouWantToResetChanges"),okText:u("button.Reset"),okButtonProps:{danger:!0},onOk:()=>{g().flatMap(t,(e=>e.settingItems)).forEach((e=>{!e.disabled&&(null===e||void 0===e?void 0:e.setValue)&&e.setValue(e.defaultValue)})),U()},cancelText:u("button.Cancel"),onCancel:()=>U(),children:(0,h.jsx)(S.A,{showIcon:!0,message:u("dialog.warning.CannotBeUndone"),type:"warning"})})]})}},97746:(e,t,s)=>{s.r(t),s.d(t,{default:()=>R});var i=s(32967),n=s(88616),l=s(58452),r=s(90840),a=s(40361),o=s(73552),c=s(91564),u=s(44389),d=s(34132),g=s(1426),p=s(9976),h=s(42906);const m=e=>{let{onRequestClose:t,open:s}=e;const{t:m}=(0,p.Bd)(),{message:x}=o.A.useApp(),y=(0,g.useRef)(null),[v,b]=(0,g.useState)(!1),j=(0,i.CX)(),{isFetching:_}=(0,n.nN)({queryKey:["mtu"],queryFn:async()=>{var e;const{result:t}=await j.setting.get("network/overlay/mtu");return null===(e=y.current)||void 0===e||e.setFieldsValue({mtu:t,mtu_checkbox:null===t||void 0===t||""===t}),t},enabled:s});return(0,h.jsx)(l.A,{open:s,title:(0,h.jsxs)(r.A,{gap:"xxs",children:[m("settings.OverlayNetworkSettings"),(0,h.jsx)(a.A,{title:m("settings.OverlayNetworkSettingsDescription")})]}),onCancel:t,confirmLoading:v,centered:!0,width:"auto",okText:m("button.Save"),onOk:()=>{y.current&&y.current.validateFields().then((async e=>{try{if(e.mtu_checkbox){b(!0);const{result:e}=await j.setting.delete("network/overlay/mtu",!0);if("ok"!==e)throw new Error;x.success(m("notification.SuccessfullyUpdated")),t()}else{b(!0);const{result:s}=await j.setting.set("network/overlay/mtu",e.mtu);if("ok"!==s)throw new Error;x.success(m("notification.SuccessfullyUpdated")),t()}}catch(i){var s;x.error(null!==(s=null===i||void 0===i?void 0:i.message)&&void 0!==s?s:m("settings.FailedToSaveSettings"))}finally{b(!1)}})).catch((()=>{}))},cancelText:m("button.Cancel"),destroyOnClose:!0,children:(0,h.jsx)(c.A,{ref:y,layout:"vertical",children:(0,h.jsx)(c.A.Item,{label:"MTU",tooltip:m("settings.MTUDescription"),required:!0,children:(0,h.jsxs)(r.A,{gap:"sm",align:"center",children:[(0,h.jsx)(c.A.Item,{noStyle:!0,dependencies:["mtu_checkbox"],children:()=>{var e;return(0,h.jsx)(c.A.Item,{noStyle:!0,name:"mtu",rules:[{validator:(e,t)=>{var s;return!0===(null===(s=y.current)||void 0===s?void 0:s.getFieldValue("mtu_checkbox"))?Promise.resolve():void 0===t||null===t?Promise.reject(m("data.explorer.ValueRequired")):Promise.resolve()}}],children:(0,h.jsx)(u.A,{style:{flex:1},min:0,max:15e3,disabled:!0===(null===(e=y.current)||void 0===e?void 0:e.getFieldValue("mtu_checkbox"))||_})})}}),(0,h.jsx)(c.A.Item,{noStyle:!0,name:"mtu_checkbox",valuePropName:"checked",children:(0,h.jsx)(d.A,{disabled:_,onChange:e=>{var t;e.target.checked&&(null===(t=y.current)||void 0===t||t.setFieldsValue({mtu:null}))},children:m("settings.Unset")})})]})})})})};var x=s(59571),y=s(3730),v=s(88961),b=s(35040);const j=e=>{let{onRequestClose:t,open:s}=e;const{t:n}=(0,p.Bd)(),[d,m]=(0,g.useState)(!1),[j,_]=(0,g.useState)(!1),f=(0,g.useRef)(null),{token:k}=x.A.useToken(),A=(0,i.CX)(),{message:S}=o.A.useApp();return(0,h.jsx)(l.A,{title:(0,h.jsxs)(r.A,{align:"center",gap:"xxs",children:[n("settings.ConfigPerJobSchduler"),(0,h.jsx)(a.A,{title:n("settings.ConfigPerJobSchdulerDescription")})]}),confirmLoading:d,open:s,centered:!0,width:"auto",onCancel:t,onOk:()=>{f.current&&f.current.validateFields().then((async e=>{const s=e.schedulerType,i=e.num_retries_to_skip;try{if(e.num_retries_to_skip_checkbox){m(!0);const{result:e}=await A.setting.delete(`plugins/scheduler/${s}/num_retries_to_skip`,!0);if("ok"!==e)throw new Error;S.success(n("notification.SuccessfullyUpdated")),t()}else{if("fifo"!==s&&"0"!==i)throw new Error(n("settings.FifoOnly"));m(!0);const{result:e}=await A.setting.set(`plugins/scheduler/${s}/num_retries_to_skip`,i);if("ok"!==e)throw new Error;S.success(n("notification.SuccessfullyUpdated")),t()}}catch(r){var l;S.error(null!==(l=null===r||void 0===r?void 0:r.message)&&void 0!==l?l:n("settings.FailedToSaveSettings"))}finally{m(!1)}})).catch((()=>{}))},cancelText:n("button.Cancel"),okText:n("button.Save"),okButtonProps:{type:"primary"},destroyOnClose:!0,children:(0,h.jsxs)(c.A,{ref:f,layout:"vertical",children:[(0,h.jsx)(c.A.Item,{label:n("settings.Scheduler"),name:"schedulerType",required:!0,rules:[{required:!0,message:n("settings.SchedulerRequired")}],extra:(0,h.jsx)(y.A.Text,{type:"secondary",style:{fontSize:k.fontSizeSM},children:n("settings.SchedulerSelectComment")}),children:(0,h.jsx)(v.A,{loading:j,popupMatchSelectWidth:!1,onChange:e=>{null!==e&&(_(!0),A.setting.get(`plugins/scheduler/${e}/num_retries_to_skip`).then((e=>{var t;null===(t=f.current)||void 0===t||t.setFieldsValue({num_retries_to_skip:e.result,num_retries_to_skip_checkbox:null===e.result})})).finally((()=>{_(!1)})))},options:[{label:"FIFO",value:"fifo"},{label:"LIFO",value:"lifo"},{label:"DRF",value:"drf"}]})}),(0,h.jsxs)(r.A,{direction:"column",align:"start",style:{width:"100%"},children:[(0,h.jsx)(y.A.Text,{strong:!0,children:n("settings.SchedulerOptions")}),(0,h.jsx)(c.A.Item,{label:n("settings.SessionCreationRetries"),required:!0,style:{width:"100%"},children:(0,h.jsxs)(r.A,{gap:"sm",align:"center",style:{width:"100%"},children:[(0,h.jsx)(c.A.Item,{noStyle:!0,dependencies:["schedulerType","num_retries_to_skip_checkbox"],style:{width:"100%"},children:()=>{var e,t;return(0,h.jsx)(c.A.Item,{noStyle:!0,name:"num_retries_to_skip",rules:[{validator:(e,t)=>{var s;return!0===(null===(s=f.current)||void 0===s?void 0:s.getFieldValue("num_retries_to_skip_checkbox"))?Promise.resolve():void 0===t||null===t?Promise.reject(n("data.explorer.ValueRequired")):Promise.resolve()}}],children:(0,h.jsx)(u.A,{min:0,max:1e3,disabled:!0===(null===(e=f.current)||void 0===e?void 0:e.getFieldValue("num_retries_to_skip_checkbox"))||void 0===(null===(t=f.current)||void 0===t?void 0:t.getFieldValue("schedulerType"))||j,style:{flex:1}})})}}),(0,h.jsx)(c.A.Item,{noStyle:!0,dependencies:["schedulerType"],children:()=>{var e;return(0,h.jsx)(c.A.Item,{noStyle:!0,name:"num_retries_to_skip_checkbox",valuePropName:"checked",children:(0,h.jsx)(b.A,{disabled:void 0===(null===(e=f.current)||void 0===e?void 0:e.getFieldValue("schedulerType"))||j,onChange:e=>{var t;e.target.checked&&(null===(t=f.current)||void 0===t||t.setFieldsValue({num_retries_to_skip:null}))},children:n("settings.Unset")})})}})]})})]})]})})};var _=s(94777),f=s(59706),k=s(67884),A=s(64181),S=s(4800);const w={image_pulling_behavior:"digest",cuda_gpu:!1,cuda_fgpu:!1,rocm_gpu:!1,tpu:!1,ipu:!1,atom:!1,atom_plus:!1,gaudi2:!1,warboy:!1,rngd:!1,hyperaccel_lpu:!1,schedulerType:"fifo",scheduler:{num_retries_to_skip:"0"},network:{mtu:""}},C={"cuda.device":"cuda_gpu","cuda.shares":"cuda_fgpu","rocm.device":"rocm_gpu","tpu.device":"tpu","ipu.device":"ipu","atom.device":"atom","atom-plus.device":"atom_plus","warboy.device":"warboy","rngd.device":"rngd","hyperaccel-lpu.device":"hyperaccel_lpu"},P=()=>{const{t:e}=(0,p.Bd)(),[t,{toggle:s}]=(0,k.A)(!1),[n,{toggle:l}]=(0,k.A)(!1),[r,a]=(0,g.useState)({...w}),c=(0,i.CX)(),{message:u}=o.A.useApp(),d=async()=>{const{result:e}=await c.setting.get("docker/image/auto_pull");a(null===e||"digest"===e?e=>({...e,image_pulling_behavior:"digest"}):"tag"===e?e=>({...e,image_pulling_behavior:"tag"}):e=>({...e,image_pulling_behavior:"none"}))},x=async t=>{if(t!==r.image_pulling_behavior)try{const{result:s}=await c.setting.set("docker/image/auto_pull",t);"ok"===s?(d(),u.success(e("notification.SuccessfullyUpdated"))):u.error(e("settings.FailedToSaveSettings"))}catch(s){u.error(e("settings.FailedToSaveSettings"))}};(0,g.useEffect)((()=>{Promise.all([d(),c.get_resource_slots().then((e=>{a((t=>({...t,...Object.fromEntries(Object.keys(C).map((t=>[C[t],t in e])))})))}))])}),[]);const y=[{title:e("settings.General"),settingItems:[{type:"select",title:e("settings.ImagePullBehavior"),description:e("settings.DescImagePullBehavior"),selectProps:{options:[{label:e("settings.image.Digest"),value:"digest"},{label:e("settings.image.Tag"),value:"tag"},{label:e("settings.image.None"),value:"none"}]},setValue:e=>x(e),defaultValue:w.image_pulling_behavior,value:r.image_pulling_behavior,onChange:e=>x(e)},{type:"custom",title:e("settings.OverlayNetwork"),description:e("settings.OverlayNetworkConfiguration"),children:(0,h.jsx)(A.Ay,{icon:(0,h.jsx)(f.A,{}),onClick:s,children:e("settings.Config")})},{type:"custom",title:e("settings.Scheduler"),description:e("settings.SchedulerConfiguration"),children:(0,h.jsx)(A.Ay,{icon:(0,h.jsx)(f.A,{}),onClick:l,children:e("settings.Config")})}]},{title:e("settings.Plugins"),description:(0,h.jsx)(S.A,{message:e("settings.NoteAboutFixedSetup"),type:"info",showIcon:!0}),settingItems:[{type:"checkbox",title:e("settings.OpenSourceCudaGPUSupport"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescCudaGPUSupport")," ",r.cuda_fgpu&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("br",{}),e("settings.CUDAGPUdisabledByFGPUsupport")]})]}),value:r.cuda_gpu,defaultValue:w.cuda_gpu,disabled:!0},{type:"checkbox",title:e("settings.ROCMGPUSupport"),description:e("settings.DescRocmGPUSupport"),value:r.rocm_gpu,defaultValue:w.rocm_gpu,disabled:!0}]},{title:e("settings.EnterpriseFeatures"),description:(0,h.jsx)(S.A,{message:e("settings.NoteAboutFixedSetup"),type:"info",showIcon:!0}),settingItems:[{type:"checkbox",title:e("settings.FractionalGPU"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescFractionalGPU"),(0,h.jsx)("br",{}),e("settings.RequireFGPUPlugin")]}),value:r.cuda_fgpu,defaultValue:w.cuda_fgpu,disabled:!0},{type:"checkbox",title:e("settings.TPU"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescTPU"),(0,h.jsx)("br",{}),e("settings.RequireTPUPlugin")]}),value:r.tpu,defaultValue:w.tpu,disabled:!0},{type:"checkbox",title:e("settings.IPUSupport"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescIPUSupport"),(0,h.jsx)("br",{}),e("settings.RequireTPUPlugin")]}),value:r.ipu,defaultValue:w.ipu,disabled:!0},{type:"checkbox",title:e("settings.ATOMSupport"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescATOMSupport"),(0,h.jsx)("br",{}),e("settings.RequireATOMPlugin")]}),value:r.atom,defaultValue:w.atom,disabled:!0},{type:"checkbox",title:e("settings.ATOMPlusSupport"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescATOMPlusSupport"),(0,h.jsx)("br",{}),e("settings.RequireATOMPlusPlugin")]}),value:r.atom_plus,defaultValue:w.atom_plus,disabled:!0},{type:"checkbox",title:e("settings.Gaudi2Support"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescGaudi2Support"),(0,h.jsx)("br",{}),e("settings.RequireGaudi2Plugin")]}),value:r.gaudi2,defaultValue:w.gaudi2,disabled:!0},{type:"checkbox",title:e("settings.WarboySupport"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescWarboySupport"),(0,h.jsx)("br",{}),e("settings.RequireWarboyPlugin")]}),value:r.warboy,defaultValue:w.warboy,disabled:!0},{type:"checkbox",title:e("settings.RNGDSupport"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescRNGDSupport"),(0,h.jsx)("br",{}),e("settings.RequireRNGDPlugin")]}),value:r.rngd,defaultValue:w.rngd,disabled:!0},{type:"checkbox",title:e("settings.HyperaccelLPUSupport"),description:(0,h.jsxs)(h.Fragment,{children:[e("settings.DescHyperaccelLPUSupport"),(0,h.jsx)("br",{}),e("settings.RequireHyperaccelLPUPlugin")]}),value:r.hyperaccel_lpu,defaultValue:w.hyperaccel_lpu,disabled:!0}]}];return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(_.A,{settingGroups:y,showSearchBar:!0,showChangedOptionFilter:!0,showResetButton:!0}),(0,h.jsx)(m,{onRequestClose:s,open:t}),(0,h.jsx)(j,{onRequestClose:l,open:n})]})};var T=s(14287),F=s(86289);const I=(0,F.withDefault)(F.StringParam,"configurations"),R=()=>{const{t:e}=(0,p.Bd)(),[t,s]=(0,F.useQueryParam)("tab",I);return(0,h.jsx)(T.A,{activeTabKey:"configurations",onTabChange:e=>s(e),tabList:[{key:"configurations",tab:e("webui.menu.Configurations")}],styles:{body:{padding:0}},children:"configurations"===t&&(0,h.jsx)(P,{})})}}}]);
//# sourceMappingURL=7746.f9e0e74e.chunk.js.map