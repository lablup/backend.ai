"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[216],{43306:function(e,n,l){var a=l(1413),t=l(44925),i=l(77758),r=l(7517),o=l(44036),s=l(57054),u=l(38818),d=l(14634),c=l(32048),m=l.n(c),g=l(4519),p=l(81748),f=l(2556),y=["open","onRequestClose","columns","displayedColumnKeys"];n.Z=function(e){var n=e.open,l=e.onRequestClose,c=e.columns,v=e.displayedColumnKeys,k=(0,t.Z)(e,y),S=(0,g.useRef)(null),_=(0,p.$G)().t,h=o.Z.useToken().token,F=c.map((function(e){return"string"===typeof e.title?{label:e.title,value:m().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(n=e.title,g.Children.map(n.props.children,(function(e){if("string"===typeof e)return e}))),value:m().toString(e.key)}:{label:void 0,value:m().toString(e.key)};var n}));return(0,f.jsx)(i.Z,(0,a.Z)((0,a.Z)({title:_("table.SettingTable"),open:n,destroyOnClose:!0,centered:!0,onOk:function(){var e;null===(e=S.current)||void 0===e||e.validateFields().then((function(e){l(e)})).catch((function(){}))},onCancel:function(){l()}},k),{},{children:(0,f.jsxs)(s.Z,{ref:S,preserve:!1,initialValues:{selectedColumnKeys:v||F.map((function(e){return e.value}))},layout:"vertical",children:[(0,f.jsx)(s.Z.Item,{name:"searchInput",label:_("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,f.jsx)(u.Z,{prefix:(0,f.jsx)(r.Z,{}),style:{marginBottom:h.marginSM},placeholder:_("table.SearchTableColumn")})}),(0,f.jsx)(s.Z.Item,{noStyle:!0,shouldUpdate:function(e,n){return e.searchInput!==n.searchInput},children:function(e){var n=e.getFieldValue,l=n("searchInput")?m().toLower(n("searchInput")):void 0,t=F.map((function(e){return m().toLower(m().toString(e.label)).includes(l||"")?e:(0,a.Z)((0,a.Z)({},e),{},{style:{display:"none"}})}));return(0,f.jsx)(s.Z.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},children:(0,f.jsx)(d.Z.Group,{options:t,style:{flexDirection:"column"}})})}})]})}))}},98216:function(e,n,l){l.r(n),l.d(n,{default:function(){return q}});var a=l(93433),t=l(29439),i=l(77758),r=l(88630),o=l(96451),s=l(99277),u=l(38252),d=l(43306),c=l(43255),m=l(40406),g=l(50164),p=l(43596),f=l(28501),y=l(83861),v=l(31662),k=l(4519),S=l(46951),_=l(69537);var h=function(e){if(e.id,"undefined"===typeof cancelAnimationFrame)return clearInterval(e.id);cancelAnimationFrame(e.id)};var F,x=function(e,n,l){var a=null===l||void 0===l?void 0:l.immediate,t=(0,S.Z)(e),i=(0,k.useRef)();return(0,k.useEffect)((function(){if((0,_.hj)(n)&&!(n<0))return a&&t.current(),i.current=function(e,n){if(void 0===n&&(n=0),"undefined"===typeof requestAnimationFrame)return{id:setInterval(e,n)};var l=(new Date).getTime(),a={id:0};return a.id=requestAnimationFrame((function t(){(new Date).getTime()-l>=n&&(e(),l=(new Date).getTime()),a.id=requestAnimationFrame(t)})),a}((function(){t.current()}),n),function(){i.current&&h(i.current)}}),[n]),(0,k.useCallback)((function(){i.current&&h(i.current)}),[])},K=l(67873),Z=l(44036),b=l(70389),j=l(38812),L=l(86199),C=l(3597),T=l(88464),I=l(99517),w=l.n(I),E=l(32048),D=l.n(E),P=l(81748),A=l(16980),z=l(51843),R=l(2556),q=function(e){e.children;var n=(0,P.$G)().t,S=(0,m.Dj)(),_=Z.Z.useToken().token,h=(0,m.qh)(),I=(0,k.useState)(!1),E=(0,t.Z)(I,2),q=E[0],O=E[1],V=(0,k.useState)(!1),N=(0,t.Z)(V,2),$=N[0],B=N[1],H=(0,k.useState)(null),M=(0,t.Z)(H,2),Q=M[0],Y=M[1],U=(0,k.useState)(null),G=(0,t.Z)(U,2),W=G[0],X=G[1],J=(0,k.useState)({current:1,pageSize:100}),ee=(0,t.Z)(J,1)[0],ne=(0,k.useTransition)(),le=(0,t.Z)(ne,2),ae=le[0],te=le[1],ie=(0,k.useState)(!1),re=(0,t.Z)(ie,2),oe=re[0],se=re[1],ue=(0,m.Kr)("initial-fetch"),de=(0,t.Z)(ue,2),ce=de[0],me=de[1],ge=(0,k.useState)("services"),pe=(0,t.Z)(ge,1)[0],fe=[{title:n("modelService.EndpointName"),dataIndex:"endpoint_id",key:"endpointName",fixed:"left",render:function(e,n){return(0,R.jsx)(z.rU,{to:"/serving/"+e,children:n.name})}},{title:n("modelService.EndpointId"),dataIndex:"endpoint_id",key:"endpoint_id",width:310,render:function(e){return(0,R.jsx)(b.Z.Text,{code:!0,children:e})}},{title:n("modelService.ServiceEndpoint"),dataIndex:"endpoint_id",key:"url",render:function(e,n){return n.url?(0,R.jsx)(b.Z.Link,{copyable:!0,href:n.url,target:"_blank",children:n.url}):"-"}},{title:n("modelService.Controls"),dataIndex:"controls",key:"controls",render:function(e,n){var l,a,t,i;return(0,R.jsxs)(s.Z,{direction:"row",align:"stretch",children:[(0,R.jsx)(j.ZP,{type:"text",icon:(0,R.jsx)(p.Z,{}),style:n.desired_session_count<0||"destroying"===(null===(l=n.status)||void 0===l?void 0:l.toLowerCase())?void 0:{color:_.colorInfo},disabled:n.desired_session_count<0||"destroying"===(null===(a=n.status)||void 0===a?void 0:a.toLowerCase()),onClick:function(){O(!q),Y(n)}}),(0,R.jsx)(j.ZP,{type:"text",icon:(0,R.jsx)(f.Z,{style:n.desired_session_count<0||"destroying"===(null===(t=n.status)||void 0===t?void 0:t.toLowerCase())?void 0:{color:_.colorError}}),disabled:n.desired_session_count<0||"destroying"===(null===(i=n.status)||void 0===i?void 0:i.toLowerCase()),onClick:function(){se(!0),X(n)}})]})}},{title:n("modelService.Status"),key:"status",render:function(e,n){return(0,R.jsx)(o.Z,{endpointFrgmt:n})}}].concat((0,a.Z)(S.is_admin?[{title:n("modelService.Owner"),dataIndex:"created_user_email",key:"session_owner",render:function(e,n){return(0,R.jsx)(r.Z,{endpointFrgmt:n})}}]:[]),[{title:n("modelService.CreatedAt"),dataIndex:"created_at",key:"createdAt",render:function(e){return w()(e).format("ll LT")},defaultSortOrder:"descend",sortDirections:["descend","ascend","descend"],sorter:function(e,n){var l=w()(e.created_at),a=w()(n.created_at);return l.diff(a)}},{title:n("modelService.DesiredSessionCount"),dataIndex:"desired_session_count",key:"desiredSessionCount",render:function(e){return e<0?"-":e}},{title:(0,R.jsxs)(s.Z,{direction:"column",align:"start",children:[n("modelService.RoutingsCount"),(0,R.jsx)("br",{}),(0,R.jsxs)(b.Z.Text,{type:"secondary",style:{fontWeight:"normal"},children:["(",n("modelService.Active/Total"),")"]})]}),key:"routingCount",render:function(e,n){var l;return D().filter(n.routings,(function(e){return"HEALTHY"===(null===e||void 0===e?void 0:e.status)})).length+" / "+(null===(l=n.routings)||void 0===l?void 0:l.length)}},{title:n("modelService.Public"),key:"public",render:function(e,n){return n.open_to_public?(0,R.jsx)(y.Z,{style:{color:_.colorSuccess}}):(0,R.jsx)(v.Z,{style:{color:_.colorTextSecondary}})}}]),ye=(0,K.Z)("backendaiwebui.ServingListPage.displayedColumnKeys",{defaultValue:fe.map((function(e){return D().toString(e.key)}))}),ve=(0,t.Z)(ye,2),ke=ve[0],Se=ve[1];x((function(){(0,k.startTransition)((function(){me()}))}),7e3);var _e=(0,A.useLazyLoadQuery)(void 0!==F?F:F=l(16142),{offset:(ee.current-1)*ee.pageSize,limit:ee.pageSize,projectID:h.id},{fetchPolicy:"initial-fetch"===ce?"store-and-network":"network-only",fetchKey:ce}).endpoint_list,he=D().sortBy(null===_e||void 0===_e?void 0:_e.items,"name"),Fe=(0,g.Y)({mutationFn:function(e){return(0,c.Lc)({method:"DELETE",url:"/services/"+e,client:S})}});return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(s.Z,{direction:"column",align:"stretch",gap:"xs",children:(0,R.jsx)(s.Z,{direction:"column",align:"stretch",children:(0,R.jsx)(L.Z,{tabList:[{key:"services",label:n("modelService.Services")}],activeTabKey:pe,tabBarExtraContent:(0,R.jsx)(j.ZP,{type:"primary",onClick:function(){O(!0)},children:n("modelService.StartService")}),bodyStyle:{padding:0,paddingTop:1},children:(0,R.jsxs)(k.Suspense,{fallback:(0,R.jsx)("div",{children:"loading.."}),children:[(0,R.jsx)(C.Z,{loading:ae,scroll:{x:"max-content"},rowKey:"endpoint_id",dataSource:he||[],columns:fe.filter((function(e){return null===ke||void 0===ke?void 0:ke.includes(D().toString(e.key))}))}),(0,R.jsx)(s.Z,{justify:"end",style:{padding:_.paddingXXS},children:(0,R.jsx)(j.ZP,{type:"text",icon:(0,R.jsx)(p.Z,{}),onClick:function(){B(!0)}})})]})})})}),(0,R.jsx)(i.Z,{open:oe,title:n("dialog.title.LetsDouble-Check"),okButtonProps:{loading:Fe.isLoading},onOk:function(){Fe.mutate((null===W||void 0===W?void 0:W.endpoint_id)||"",{onSuccess:function(e){te((function(){me()})),se(!oe),T.ZP.success(n("modelService.ServiceTerminated",{name:null===W||void 0===W?void 0:W.name}))},onError:function(e){console.log(e),T.ZP.error(n("modelService.FailedToTerminateService"))}})},onCancel:function(){se(!oe)},children:(0,R.jsxs)(s.Z,{direction:"column",align:"stretch",justify:"center",children:[(0,R.jsx)("p",{children:n("modelService.YouAreAboutToTerminate")+((null===W||void 0===W?void 0:W.name)||"")+"."}),(0,R.jsx)("p",{children:n("dialog.ask.DoYouWantToProceed")})]})}),(0,R.jsx)(u.Z,{open:q,endpointFrgmt:Q||null,onCancel:function(){Y(null),O(!q)},onRequestClose:function(e){O(!q),e&&te((function(){me()}))}}),(0,R.jsx)(d.Z,{open:$,onRequestClose:function(e){(null===e||void 0===e?void 0:e.selectedColumnKeys)&&Se(null===e||void 0===e?void 0:e.selectedColumnKeys),B(!$)},columns:fe,displayedColumnKeys:ke||[]})]})}},16142:function(e,n,l){l.r(n);var a=function(){var e={defaultValue:null,kind:"LocalArgument",name:"limit"},n={defaultValue:null,kind:"LocalArgument",name:"offset"},l={defaultValue:null,kind:"LocalArgument",name:"projectID"},a=[{kind:"Literal",name:"filter",value:"name != 'koalpaca-test'"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"project",variableName:"projectID"}],t={alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"endpoint_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"project",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"resource_group",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"resource_slots",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"open_to_public",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"desired_session_count",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"routing_id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"endpoint",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"session",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"traffic_ratio",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null};return{fragment:{argumentDefinitions:[e,n,l],kind:"Fragment",metadata:null,name:"ServingListPageQuery",selections:[{alias:null,args:a,concreteType:"EndpointList",kind:"LinkedField",name:"endpoint_list",plural:!1,selections:[t,{alias:null,args:null,concreteType:"Endpoint",kind:"LinkedField",name:"items",plural:!0,selections:[i,r,o,s,u,d,c,m,g,p,f,{kind:"RequiredField",field:y,action:"NONE",path:"endpoint_list.items.desired_session_count"},{alias:null,args:null,concreteType:"Routing",kind:"LinkedField",name:"routings",plural:!0,selections:[v,k,S,_,u],storageKey:null},{args:null,kind:"FragmentSpread",name:"ServiceLauncherModalFragment"},{args:null,kind:"FragmentSpread",name:"EndpointOwnerInfoFragment"},{args:null,kind:"FragmentSpread",name:"EndpointStatusTagFragment"}],storageKey:null}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,e,l],kind:"Operation",name:"ServingListPageQuery",selections:[{alias:null,args:a,concreteType:"EndpointList",kind:"LinkedField",name:"endpoint_list",plural:!1,selections:[t,{alias:null,args:null,concreteType:"Endpoint",kind:"LinkedField",name:"items",plural:!0,selections:[i,r,o,s,u,d,c,m,g,p,f,y,{alias:null,args:null,concreteType:"Routing",kind:"LinkedField",name:"routings",plural:!0,selections:[v,k,S,_,u,h],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_opts",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cluster_mode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cluster_size",storageKey:null},{alias:null,args:null,concreteType:"ImageNode",kind:"LinkedField",name:"image_object",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"humanized_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_local",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"digest",storageKey:null},{alias:null,args:null,concreteType:"ResourceLimit",kind:"LinkedField",name:"resource_limits",plural:!0,selections:[F,{alias:null,args:null,kind:"ScalarField",name:"min",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:[F,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"size_bytes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supported_accelerators",storageKey:null},h],storageKey:null},h,{alias:null,args:null,kind:"ScalarField",name:"created_user_email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"session_owner_email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"4a9c7014b8f455afbfa5b84f50f86818",id:null,metadata:{},name:"ServingListPageQuery",operationKind:"query",text:'query ServingListPageQuery(\n  $offset: Int!\n  $limit: Int!\n  $projectID: UUID\n) {\n  endpoint_list(offset: $offset, limit: $limit, project: $projectID, filter: "name != \'koalpaca-test\'") {\n    total_count\n    items {\n      name\n      endpoint_id\n      model\n      domain\n      status\n      project\n      resource_group\n      resource_slots\n      url\n      open_to_public\n      created_at @since(version: "23.09.0")\n      desired_session_count\n      routings {\n        routing_id\n        endpoint\n        session\n        traffic_ratio\n        status\n        id\n      }\n      ...ServiceLauncherModalFragment\n      ...EndpointOwnerInfoFragment\n      ...EndpointStatusTagFragment\n      id\n    }\n  }\n}\n\nfragment EndpointOwnerInfoFragment on Endpoint {\n  id\n  created_user_email @since(version: "23.09.8")\n  session_owner_email @since(version: "23.09.8")\n}\n\nfragment EndpointStatusTagFragment on Endpoint {\n  id\n  status\n}\n\nfragment ServiceLauncherModalFragment on Endpoint {\n  endpoint_id\n  desired_session_count\n  resource_group\n  resource_slots\n  resource_opts\n  cluster_mode\n  cluster_size\n  open_to_public\n  image_object @since(version: "23.09.9") {\n    name\n    humanized_name\n    tag\n    registry\n    architecture\n    is_local\n    digest\n    resource_limits {\n      key\n      min\n      max\n    }\n    labels {\n      key\n      value\n    }\n    size_bytes\n    supported_accelerators\n    id\n  }\n  name\n}\n'}}}();a.hash="99a738a4bb1e6636dd1f5f78e9828377",n.default=a},28501:function(e,n,l){l.d(n,{Z:function(){return s}});var a=l(87462),t=l(4519),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},r=l(9491),o=function(e,n){return t.createElement(r.Z,(0,a.Z)({},e,{ref:n,icon:i}))};var s=t.forwardRef(o)}}]);
//# sourceMappingURL=216.e6abebad.chunk.js.map