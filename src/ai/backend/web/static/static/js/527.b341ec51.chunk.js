"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[527,7569],{68314:(e,l,a)=>{a.d(l,{A:()=>o});var n=a(89214),r=(a(66610),a(66906));const o=e=>{let{type:l,style:a,monospace:o,children:i,...s}=e;return o?(0,r.jsx)(n.A.Text,{type:l,...s,style:{fontFamily:"monospace",...a},children:i}):(0,r.jsx)(n.A.Text,{type:l,style:a,...s,children:i})}},27569:(e,l,a)=>{a.r(l),a.d(l,{default:()=>x,useFileUploadManager:()=>S});const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"vfolderGlobalId"}],l=[{kind:"Variable",name:"id",variableName:"vfolderGlobalId"}],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"FileUploadManagerQuery",selections:[{alias:null,args:l,concreteType:"VirtualFolderNode",kind:"LinkedField",name:"vfolder_node",plural:!1,selections:[{kind:"RequiredField",field:a,action:"THROW"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"FileUploadManagerQuery",selections:[{alias:null,args:l,concreteType:"VirtualFolderNode",kind:"LinkedField",name:"vfolder_node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"da162cec4ce77cdb6fcdd31a87d2f135",id:null,metadata:{},name:"FileUploadManagerQuery",operationKind:"query",text:"query FileUploadManagerQuery(\n  $vfolderGlobalId: String!\n) {\n  vfolder_node(id: $vfolderGlobalId) {\n    name\n    id\n  }\n}\n"}}}();n.hash="1f3a6bd97dae542b3c85605ab9a61d03";const r=n;var o=a(82860),i=a(63872),s=a(64949),d=a(81501),t=a(17315),u=a(8348),c=a.n(u),m=a(97190),g=a(66610),p=a(54070),F=a(89737),y=a(19885),f=a(29951);const k=(0,s.eU)([]),h=(0,s.eU)({}),v=(0,t.Iz)((e=>(0,s.eU)((l=>l(h)[e]),((l,a,n)=>{const r=l(h);a(h,{...r,[e]:n})})))),x=()=>{const{t:e}=(0,p.Bd)(),{upsertNotification:l}=(0,o.js)(),a=(0,y.CX)(),[n,r]=(0,d.fp)(k),[i,s]=(0,d.fp)(h),t=new m.A({concurrency:1});return(0,g.useEffect)((()=>{0!==n.length&&a&&(n.forEach((a=>{const{vFolderId:n,vFolderName:r,uploadFilesNames:o,startFunctions:i}=a;s((e=>{var l;return{...e,[n]:{vFolderName:r,pending:[...(null===(l=e[n])||void 0===l?void 0:l.pending)||[],...o],completed:[],failed:[]}}})),l({key:"upload:"+n,open:!0,message:e("explorer.UploadToFolder",{folderName:r}),backgroundTask:{status:"pending",percent:0,onChange:{pending:e("explorer.ProcessingUpload")}},duration:0}),i.forEach((a=>{t.add((async()=>{await a({onProgress:(a,o,i)=>{s((s=>{var d;const t=(null===(d=s[n])||void 0===d?void 0:d.pending)||[];return l({key:"upload:"+n,message:`${e("explorer.UploadToFolder",{folderName:r})}${t.length>1?` (${t.length})`:""}`,backgroundTask:{status:"pending",percent:Math.round(a/o*100)-1,onChange:{pending:e("explorer.FileInProgress",{fileName:i})}}}),s}))}}).then((e=>{s((l=>({...l,[n]:{...l[n],pending:l[n].pending.filter((l=>l!==e)),completed:[...l[n].completed,e]}})))})).catch((e=>{s((l=>({...l,[n]:{...l[n],pending:l[n].pending.filter((l=>l!==e)),failed:[...l[n].failed,e]}})))}))}))}))})),r([]))}),[n]),(0,g.useEffect)((()=>{Object.entries(i).forEach((a=>{let[n,r]=a;c().isEmpty(null===r||void 0===r?void 0:r.pending)&&(c().isEmpty(null===r||void 0===r?void 0:r.failed)?c().isEmpty(null===r||void 0===r?void 0:r.completed)||(l({key:"upload:"+n,open:!0,message:e("explorer.SuccessfullyUploadedToFolder",{folderName:null===r||void 0===r?void 0:r.vFolderName}),backgroundTask:{status:"resolved",percent:100,onChange:{resolved:" "}},duration:3}),s((e=>({...e,[n]:{...e[n],completed:[]}})))):l({key:"upload:"+n,open:!0,message:e("explorer.UploadFailed",{folderName:null===r||void 0===r?void 0:r.vFolderName}),backgroundTask:{status:"rejected",percent:0,onChange:{rejected:e("explorer.FileUploadFailed",{folderName:null===r||void 0===r?void 0:r.vFolderName})}},extraDescription:c().join(null===r||void 0===r?void 0:r.failed,", ")}))}))}),[i]),null},S=e=>{const l=(0,i.kq)(),{t:a}=(0,p.Bd)(),{upsertNotification:n}=(0,o.js)(),[s,t]=(e=>(0,d.fp)(v(e)))(e),u=(0,d.Xr)(k),{vfolder_node:m}=(0,F.useLazyLoadQuery)(r,{vfolderGlobalId:(0,i.wc)("VirtualFolderNode",e)},{fetchPolicy:e?"network-only":"store-only"});return{uploadStatus:s,setUploadStatus:t,uploadFiles:async(e,r,o)=>{var i;if(!((e,r)=>{const o=l._config.maxFileUploadSize,i=c().map(e,(e=>e.size)).reduce(((e,l)=>Math.max(e,l)),0);var s;return!(o>0&&i>o)||(n({open:!0,key:"upload:"+r,message:a("explorer.UploadFailed",{folderName:null!==(s=null===m||void 0===m?void 0:m.name)&&void 0!==s?s:""}),description:a("data.explorer.FileUploadSizeLimit"),duration:3,toText:a("data.folders.OpenAFolder"),to:{search:new URLSearchParams({folder:r}).toString()}}),!1)})(e,r))return;let s=[];const d=c().map(e,(e=>(s.push(e.webkitRelativePath||e.name),async a=>{const n=[o,e.webkitRelativePath||e.name].filter(Boolean).join("/"),i=await l.vfolder.create_upload_session(n,e,r);return new Promise(((l,n)=>{new f._O(e,{endpoint:i,uploadUrl:i,retryDelays:[0,3e3,5e3,1e4,2e4],chunkSize:_(e.size),storeFingerprintForResuming:!1,metadata:{filename:e.name,filetype:e.type},onProgress:(l,n)=>{var r;null===a||void 0===a||null===(r=a.onProgress)||void 0===r||r.call(a,l,n,e.name)},onSuccess:()=>{l(e.webkitRelativePath||e.name)},onError:()=>{n(e.webkitRelativePath||e.name)}}).start()}))}))),t={vFolderId:r,vFolderName:null!==(i=null===m||void 0===m?void 0:m.name)&&void 0!==i?i:"",uploadFilesNames:s,startFunctions:d};u((e=>[...e,t]))}}},_=e=>{const l=1048576;return e>=5120*l?200*l:e>=1024*l?100*l:e>=100*l?50*l:15*l}},70527:(e,l,a)=>{a.r(l),a.d(l,{default:()=>J});const n=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"vfolderGlobalId"}],l=[{kind:"Variable",name:"id",variableName:"vfolderGlobalId"}],a={alias:null,args:null,kind:"ScalarField",name:"group",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"unmanaged_path",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"permissions",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"FolderExplorerQuery",selections:[{alias:null,args:l,concreteType:"VirtualFolderNode",kind:"LinkedField",name:"vfolder_node",plural:!1,selections:[a,n,{args:null,kind:"FragmentSpread",name:"FolderExplorerHeaderFragment"},{args:null,kind:"FragmentSpread",name:"VFolderNodeDescriptionFragment"},{args:null,kind:"FragmentSpread",name:"VFolderNameTitleNodeFragment"},{args:null,kind:"FragmentSpread",name:"BAIFileExplorerFragment"},{args:null,kind:"FragmentSpread",name:"FileItemControlsFragment"},{args:null,kind:"FragmentSpread",name:"ExplorerActionControlsFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"FolderExplorerQuery",selections:[{alias:null,args:l,concreteType:"VirtualFolderNode",kind:"LinkedField",name:"vfolder_node",plural:!1,selections:[a,n,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permission",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"host",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"quota_scope_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user_email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"group_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creator",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usage_mode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ownership_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_files",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_used",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"num_files",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cur_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cloneable",storageKey:null},r,r],storageKey:null}]},params:{cacheID:"74771cddce526f1356f6ecb08c6d4db0",id:null,metadata:{},name:"FolderExplorerQuery",operationKind:"query",text:'query FolderExplorerQuery(\n  $vfolderGlobalId: String!\n) {\n  vfolder_node(id: $vfolderGlobalId) {\n    group\n    unmanaged_path @since(version: "25.04.0")\n    ...FolderExplorerHeaderFragment\n    ...VFolderNodeDescriptionFragment\n    ...VFolderNameTitleNodeFragment\n    ...BAIFileExplorerFragment\n    ...FileItemControlsFragment\n    ...ExplorerActionControlsFragment\n    id\n  }\n}\n\nfragment BAIFileExplorerFragment on VirtualFolderNode {\n  permissions\n  ...FileItemControlsFragment\n  ...ExplorerActionControlsFragment\n  ...EditableFileNameFragment\n}\n\nfragment EditableFileNameFragment on VirtualFolderNode {\n  permissions\n}\n\nfragment EditableVFolderNameFragment on VirtualFolderNode {\n  id\n  name\n  user\n  group\n  status\n}\n\nfragment ExplorerActionControlsFragment on VirtualFolderNode {\n  permissions\n}\n\nfragment FileItemControlsFragment on VirtualFolderNode {\n  permissions\n  host\n}\n\nfragment FolderExplorerHeaderFragment on VirtualFolderNode {\n  id\n  user\n  permission\n  unmanaged_path @since(version: "25.04.0")\n  ...VFolderNameTitleNodeFragment\n  ...VFolderNodeIdenticonFragment\n  ...EditableVFolderNameFragment\n}\n\nfragment VFolderNameTitleNodeFragment on VirtualFolderNode {\n  name\n}\n\nfragment VFolderNodeDescriptionFragment on VirtualFolderNode {\n  id\n  host\n  quota_scope_id\n  user\n  user_email\n  group\n  group_name\n  creator\n  usage_mode\n  permission\n  ownership_type\n  max_files\n  max_size\n  created_at\n  last_used\n  num_files\n  cur_size\n  cloneable\n  status\n  permissions @since(version: "24.09.0")\n  unmanaged_path @since(version: "25.04.0")\n  ...VFolderPermissionCellFragment\n  ...useVirtualFolderNodePathFragment\n}\n\nfragment VFolderNodeIdenticonFragment on VirtualFolderNode {\n  id\n}\n\nfragment VFolderPermissionCellFragment on VirtualFolderNode {\n  permissions\n}\n\nfragment useVirtualFolderNodePathFragment on VirtualFolderNode {\n  id\n  host\n  quota_scope_id\n  user\n  user_email\n  group\n  group_name\n  creator\n  usage_mode\n  permission\n  ownership_type\n  max_files\n  max_size\n  created_at\n  last_used\n  num_files\n  cur_size\n  cloneable\n  status\n  permissions @since(version: "24.09.0")\n}\n'}}}();n.hash="ba239e9907a8626dbf9641396e031ead";const r=n;var o=a(27569);const i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"FolderExplorerHeaderFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permission",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"unmanaged_path",storageKey:null},{args:null,kind:"FragmentSpread",name:"VFolderNameTitleNodeFragment"},{args:null,kind:"FragmentSpread",name:"VFolderNodeIdenticonFragment"},{args:null,kind:"FragmentSpread",name:"EditableVFolderNameFragment"}],type:"VirtualFolderNode",abstractKey:null,hash:"b034e00d5b8454a58e6ebb66a4d821a1"},s=i;var d=a(56457),t=a(99453),u=a(44163),c=a(75706),m=a(89214),g=a(56761),p=a(33403),F=a(75220),y=a(63872),f=a(66610),k=a(54070),h=a(89737),v=a(66906);const x=e=>{let{vfolderNodeFrgmt:l,folderExplorerRef:a,titleStyle:n}=e;const{t:r}=(0,k.Bd)(),{token:o}=u.A.useToken(),{lg:i}=c.Ay.useBreakpoint(),f=(0,h.useFragment)(s,l);return(0,v.jsxs)(y.OO,{"data-testid":"folder-explorer-header",justify:"between",gap:o.marginMD,style:{width:"100%"},children:[(0,v.jsxs)(y.OO,{"data-testid":"folder-explorer-title",gap:"xs",style:{flex:1,...n},children:[f?(0,v.jsx)(t.A,{vfolderNodeIdenticonFrgmt:f,style:{fontSize:o.fontSizeHeading4}}):(0,v.jsx)(y.OO,{style:{borderColor:o.colorBorderSecondary,borderWidth:1,borderStyle:"solid",width:o.fontSizeHeading3,height:o.fontSizeHeading3,borderRadius:o.borderRadius}}),f&&(0,v.jsx)(d.A,{vfolderFrgmt:f,enableLink:!1,component:m.A.Title,level:3,style:{margin:0,width:"100%"},ellipsis:!0,editable:{triggerType:["icon","text"]},inputProps:{size:"large"}})]}),(0,v.jsx)(y.OO,{"data-testid":"folder-explorer-actions",justify:"end",gap:o.marginSM,children:null!==f&&void 0!==f&&f.unmanaged_path?null:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.A,{title:!i&&r("data.explorer.ExecuteFileBrowser"),children:(0,v.jsx)(p.Ay,{icon:(0,v.jsx)(F.A,{width:"18px",src:"/resources/icons/filebrowser.svg",alt:"File Browser",preview:!1}),onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e._executeFileBrowser()},children:i&&r("data.explorer.ExecuteFileBrowser")})}),(0,v.jsx)(g.A,{title:!i&&r("data.explorer.RunSSH/SFTPserver"),children:(0,v.jsx)(p.Ay,{icon:(0,v.jsx)(F.A,{width:"18px",src:"/resources/icons/sftp.png",alt:"SSH / SFTP",preview:!1}),onClick:()=>{var e;null===(e=a.current)||void 0===e||e._executeSSHProxyAgent()},children:i&&r("data.explorer.RunSSH/SFTPserver")})})]})})]})},S=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],l=[{kind:"Variable",name:"id",variableName:"id"}],a={alias:null,args:null,kind:"ScalarField",name:"permission",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"permissions",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VFolderNodeDescriptionPermissionRefreshQuery",selections:[{alias:null,args:l,concreteType:"VirtualFolderNode",kind:"LinkedField",name:"vfolder_node",plural:!1,selections:[a,n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VFolderNodeDescriptionPermissionRefreshQuery",selections:[{alias:null,args:l,concreteType:"VirtualFolderNode",kind:"LinkedField",name:"vfolder_node",plural:!1,selections:[a,n,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"3aee063a4b508648c2365ba6c7f0f44a",id:null,metadata:{},name:"VFolderNodeDescriptionPermissionRefreshQuery",operationKind:"query",text:"query VFolderNodeDescriptionPermissionRefreshQuery(\n  $id: String!\n) {\n  vfolder_node(id: $id) {\n    permission\n    permissions\n    id\n  }\n}\n"}}}();S.hash="36063c8300310d9ef6c369b49127a2a2";const _=S,b={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VFolderNodeDescriptionFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"host",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"quota_scope_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user_email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"group",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"group_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creator",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usage_mode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permission",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ownership_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_files",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_used",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"num_files",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cur_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cloneable",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permissions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"unmanaged_path",storageKey:null},{args:null,kind:"FragmentSpread",name:"VFolderPermissionCellFragment"},{args:null,kind:"FragmentSpread",name:"useVirtualFolderNodePathFragment"}],type:"VirtualFolderNode",abstractKey:null,hash:"f4ca4470ea635f85c8c346eed0a5fe8c"},K=b;var N=a(2156),j=a(19885),A=a(37615),V=a(17457),w=a(71526);const I={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useVirtualFolderNodePathFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"host",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"quota_scope_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user_email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"group",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"group_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"creator",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usage_mode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permission",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ownership_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_files",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_used",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"num_files",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cur_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cloneable",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"permissions",storageKey:null}],type:"VirtualFolderNode",abstractKey:null,hash:"439221036e87c57ca3ec1ce737e0cdf7"},z=I;var P=a(8348),T=a.n(P);const E=e=>{const l=(0,h.useFragment)(z,e),[a,n]=T().split(null===l||void 0===l?void 0:l.quota_scope_id,":"),r=(0,y.om)(null===l||void 0===l?void 0:l.id),o=r.slice(0,2),i=r.slice(2,4),s=r.slice(4),d=`${n.replaceAll("-","")}/${o}/${i}/${s.replaceAll("-","")}`;return{quotaScopeType:a,quotaScopeIdWithoutType:n,vfolderId:r,vfolderIdPrefix1:o,vfolderIdPrefix2:i,vfolderIdRest:s,vfolderPath:d}};var O=a(61659),R=a(14659),C=a(67097),U=a(68314);const D=e=>{let{vfolderNodeFrgmt:l}=e;const{quotaScopeType:a,quotaScopeIdWithoutType:n,vfolderId:r,vfolderIdPrefix1:o,vfolderIdPrefix2:i,vfolderIdRest:s}=E(l),{token:d}=u.A.useToken();return(0,v.jsxs)(y.OO,{direction:"row",align:"start",justify:"start",wrap:"wrap",gap:3,children:[(0,v.jsx)(U.A,{monospace:!0,type:"secondary",style:{fontSize:"0.9em"},children:"(root)"}),(0,v.jsx)(U.A,{monospace:!0,type:"secondary",style:{fontSize:"0.9em"},children:"/"}),(0,v.jsxs)(y.OO,{direction:"column",align:"start",justify:"start",children:[(0,v.jsx)(U.A,{monospace:!0,copyable:{text:n},style:{fontSize:"0.9em"},children:T().truncate(n.replaceAll("-",""),{length:15})}),(0,v.jsxs)(U.A,{type:"secondary",style:{fontSize:d.fontSizeSM},children:["Quota Scope ID (",T().upperFirst(a),")"]})]}),(0,v.jsx)(U.A,{monospace:!0,type:"secondary",style:{fontSize:"0.9em"},children:"/"}),(0,v.jsxs)(y.OO,{direction:"column",align:"start",justify:"start",children:[(0,v.jsxs)(y.OO,{gap:3,children:[(0,v.jsx)(U.A,{monospace:!0,style:{fontSize:"0.9em"},children:o}),(0,v.jsx)(U.A,{monospace:!0,type:"secondary",style:{fontSize:"0.9em"},children:"/"}),(0,v.jsx)(U.A,{monospace:!0,style:{fontSize:"0.9em"},children:i}),(0,v.jsx)(U.A,{monospace:!0,type:"secondary",style:{fontSize:"0.9em"},children:"/"}),(0,v.jsx)(U.A,{monospace:!0,copyable:{text:r},style:{fontSize:"0.9em"},children:T().truncate(s.replaceAll("-",""),{length:7})})]}),(0,v.jsx)(U.A,{type:"secondary",style:{fontSize:d.fontSizeSM},children:"VFolder ID"})]})]})};var q=a(99139),B=a(95676),M=a(18682),Q=a(80503),L=a(4994),H=a.n(L);const G=e=>{var l;let{vfolderNodeFrgmt:a,onRequestRefresh:n,...r}=e;const{t:o}=(0,k.Bd)(),{token:i}=u.A.useToken(),{message:s}=M.A.useApp(),{getErrorMessage:d}=(0,y.B7)(),t=(0,h.useRelayEnvironment)(),c=(0,w.hd)(),g=(0,j.CX)(),[p]=(0,A.U6)(),F=(0,V.ET)({mutationFn:e=>{let{permission:l,id:a}=e;return g.vfolder.update_folder({permission:l},a)}}),f=(0,h.useFragment)(K,a),{vfolderPath:x}=E(f),S=(0,y.om)(f.id),b=(0,y.YM)([!(null!==f&&void 0!==f&&f.unmanaged_path)&&{key:"path",label:(0,v.jsx)(m.A.Text,{copyable:{text:x},style:{color:i.colorTextLabel},children:o("data.folders.Path")}),children:(0,v.jsx)(D,{vfolderNodeFrgmt:f})},{key:"status",label:o("data.folders.Status"),children:(0,v.jsx)(R.A,{color:f.status?C.C[f.status]:void 0,children:T().toUpper(f.status||"")})},{key:"host",label:o("data.Host"),children:f.host},{key:"ownership_type",label:o("data.folders.Ownership"),children:"user"===(null===f||void 0===f?void 0:f.ownership_type)?(0,v.jsxs)(y.OO,{gap:"xs",children:[(0,v.jsx)(m.A.Text,{children:o("data.User")}),(0,v.jsx)(q.A,{style:{color:i.colorTextTertiary}})]}):(0,v.jsxs)(y.OO,{gap:"xs",children:[(0,v.jsx)(m.A.Text,{children:o("data.Project")}),(0,v.jsx)(y.Ob,{style:{color:i.colorTextTertiary}})]})},((null===f||void 0===f?void 0:f.user)===p.uuid||g.is_admin&&(null===f||void 0===f?void 0:f.group)===(null===c||void 0===c?void 0:c.id))&&{key:"permission",label:o("data.folders.MountPermission"),children:(0,v.jsx)(O.A,{defaultValue:"wd"===f.permission?"rw":f.permission,options:[{value:"ro",label:o("data.ReadOnly")},{value:"rw",label:o("data.ReadWrite")}],onChange:e=>{F.mutate({permission:e,id:S},{onSuccess:()=>{s.success(o("data.permission.PermissionModified")),document.dispatchEvent(new CustomEvent("backend-ai-folder-updated")),(0,h.fetchQuery)(t,_,{id:f.id}).toPromise(),null===n||void 0===n||n()},onError:e=>{s.error(d(e))}})},popupMatchSelectWidth:!1})},{key:"owner",label:o("data.folders.Owner"),children:(null===f||void 0===f?void 0:f.user)===(null===p||void 0===p?void 0:p.uuid)||g.is_admin&&(null===f||void 0===f?void 0:f.group)===(null===c||void 0===c?void 0:c.id)?(0,v.jsx)(y.OO,{justify:"start",children:(0,v.jsx)(B.A,{})}):null},null!==f.user_email&&{key:"user_email",label:o("data.User"),children:(0,v.jsx)(m.A.Text,{copyable:!0,children:f.user_email})},null!==f.group_name&&{key:"group_name",label:o("data.Project"),children:f.group_name},{key:"cloneable",label:o("data.folders.Cloneable"),children:f.cloneable?(0,v.jsx)(y.OO,{justify:"start",children:(0,v.jsx)(B.A,{})}):null},{key:"max_size",label:o("data.folders.MaxSize"),children:f.max_size?null===(l=(0,N.Gh)(f.max_size,"g",2))||void 0===l?void 0:l.displayValue:"\u221e"},{key:"usage",label:o("data.UsageMode"),children:f.usage_mode},{key:"created_at",label:o("data.folders.CreatedAt"),children:H()(f.created_at).format("lll")}]);return(0,v.jsx)(Q.A,{bordered:!0,column:1,size:"small",items:b,styles:{content:{wordBreak:"break-word",overflowWrap:"break-word"}},...r})};var $=a(12991),W=a(77828),X=a(90077);const Y=(0,a(17505).rU)((e=>{let{css:l}=e;return{baiModalHeader:l`
    .ant-modal-title {
      width: 100%;
    }
  `}})),J=e=>{let{vfolderID:l,onRequestClose:a,...n}=e;const{t:i}=(0,k.Bd)(),{token:s}=u.A.useToken(),{xl:d}=c.Ay.useBreakpoint(),{styles:t}=Y(),m=(0,f.useRef)(null),{uploadStatus:g,uploadFiles:p}=(0,o.useFileUploadManager)(l),[F,S]=(0,j.zu)(),_=(0,w.hd)(),b=(0,f.useRef)(null);(0,f.useEffect)((()=>{g&&T().isEmpty(g.pending)&&S()}),[g,S]);const{vfolder_node:K}=(0,h.useLazyLoadQuery)(r,{vfolderGlobalId:(0,y.wc)("VirtualFolderNode",l)},{fetchPolicy:n.open?"network-only":"store-only"}),N=null!==K&&void 0!==K&&K.unmanaged_path?(0,v.jsx)($.A,{message:i("explorer.NoExplorerSupportForUnmanagedFolder"),showIcon:!0}):(0,v.jsx)(y.Gt,{vfolderNodeFrgmt:K,targetVFolderId:l,fetchKey:F,onUpload:(e,a)=>{p(e,l,a)},tableProps:{scroll:d?{x:"max-content"}:{x:"max-content",y:"calc(100vh - 400px)"}},style:{paddingBottom:d?s.paddingLG:0},fileDropContainerRef:b}),A=K?(0,v.jsx)(G,{vfolderNodeFrgmt:K,onRequestRefresh:()=>{var e;null===(e=m.current)||void 0===e||e._fetchVFolder()}}):null;return(0,v.jsx)(y.Ib,{className:t.baiModalHeader,width:"90%",centered:!0,destroyOnClose:!0,footer:null,title:K?(0,v.jsx)(x,{titleStyle:{zIndex:s.zIndexPopupBase+2},vfolderNodeFrgmt:K,folderExplorerRef:m}):null,bodyProps:{ref:b},onCancel:()=>{a()},...n,children:(0,v.jsxs)(y.OO,{direction:"column",gap:"lg",align:"stretch",children:[K?(null===_||void 0===_?void 0:_.id)!==(null===K||void 0===K?void 0:K.group)&&null!==K&&void 0!==K&&K.group?(0,v.jsx)($.A,{message:i("data.NotInProject"),type:"warning",showIcon:!0}):null:(0,v.jsx)($.A,{message:i("explorer.FolderNotFoundOrNoAccess"),type:"error",showIcon:!0}),d?(0,v.jsxs)(W.A,{style:{gap:s.size},layout:d?"horizontal":"vertical",children:[(0,v.jsx)(W.A.Panel,{resizable:!1,children:N}),(0,v.jsx)(W.A.Panel,{defaultSize:500,children:A})]},d?"large":"small"):(0,v.jsxs)(y.OO,{direction:"column",align:"stretch",children:[N,(0,v.jsx)(X.A,{style:{borderColor:s.colorBorderSecondary}}),A]}),(0,v.jsx)("div",{style:{display:"none"},children:(0,v.jsx)("backend-ai-folder-explorer",{ref:m,active:!0,vfolderID:l})})]})})}}}]);
//# sourceMappingURL=527.b341ec51.chunk.js.map