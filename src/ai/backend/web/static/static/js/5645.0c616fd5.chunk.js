"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[5645],{3106:(e,t,n)=>{n.d(t,{A:()=>M});var a,s=n(56276),i=n(11863),c=n(7871),l=n(3076),o=n(62581),r=n(349),d=n(6888),g=n(33401),m=n(34326),u=n(74350),h=n(38442),p=n(31511),x=n.n(p),j=n(57506),y=n(57578);const b=(0,u.rU)((e=>{let{css:t}=e;return{baiSettingItemCheckbox:t(a||(a=(0,c.A)(["\n    .ant-checkbox {\n      align-self: flex-start;\n      margin-top: 0.2rem;\n    }\n  "])))}})),A=e=>{let{"data-testid":t,type:n,title:a,description:i,children:c,defaultValue:l,value:u,selectProps:p,onChange:j,disabled:A}=e;const{token:f}=o.A.useToken(),{styles:v}=b();return(0,y.jsxs)(h.OO,{"data-testid":t,direction:"column",align:"start",gap:"xxs",children:[(0,y.jsxs)(h.OO,{direction:"row",gap:"xxs",children:[(0,y.jsx)(r.A.Text,{strong:!0,style:{fontSize:f.fontSize},children:a}),!A&&void 0!==u&&null!==u&&l!==u&&(0,y.jsx)(d.A,{dot:!0,status:"warning"})]}),"custom"===n&&(0,y.jsxs)(h.OO,{direction:"column",gap:"xs",align:"start",style:{width:"100%"},children:[i,c]}),"checkbox"===n&&(0,y.jsx)(g.A,{checked:u,onChange:j,disabled:A,className:v.baiSettingItemCheckbox,children:(0,y.jsx)(r.A.Text,{type:A?"secondary":void 0,children:i})}),"select"===n&&(0,y.jsxs)(y.Fragment,{children:[i,(0,y.jsx)(m.A,(0,s.A)({value:u,popupMatchSelectWidth:!1,onChange:j,disabled:A,style:(0,s.A)({marginTop:f.marginXS},null===p||void 0===p?void 0:p.style)},x().omit(p,["style"])))]})]})};var f=n(12349),v=n(39999),k=n(60747),C=n(71922),S=n(32103),w=n(29326),I=n(67552),T=n(88264),O=n(14262);const R=["group","hideEmpty"];var E;const _=(0,u.rU)((e=>{let{css:t}=e;return{TabStyles:t(E||(E=(0,c.A)(["\n    .ant-tabs-tab-active {\n      font-weight: var(--token-fontWeightSuperStrong, 700);\n    }\n    .ant-typography-secondary {\n      font-weight: normal !important;\n    }\n  "])))}})),B=e=>{let{title:t,count:n}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(r.A.Text,{children:t}),(0,y.jsx)(r.A.Text,{type:"secondary",children:" (".concat(n,")")})]})},D=e=>{let{group:t,hideEmpty:n=!0}=e,a=(0,i.A)(e,R);const{token:c}=o.A.useToken();return(!n||0!==t.settingItems.length)&&(0,y.jsxs)(h.OO,(0,s.A)((0,s.A)({direction:"column",align:"stretch",style:{marginBottom:c.marginMD}},a),{},{children:[(0,y.jsxs)(h.OO,{direction:"column",align:"stretch",style:{zIndex:1,marginBottom:c.marginMD,background:c.colorBgContainer},children:[(0,y.jsx)(h.OO,{align:"start",justify:"between",children:(0,y.jsxs)(h.OO,{gap:"sm",align:"start",children:[(0,y.jsx)(r.A.Title,{level:5,style:{marginTop:0},children:t.title}),t.titleExtra&&(0,y.jsx)("div",{children:t.titleExtra})]})}),(0,y.jsx)(C.A,{style:{marginTop:0,marginBottom:0}}),t.description&&(0,y.jsx)(r.A.Text,{type:"secondary",style:{marginTop:c.marginSM},children:t.description})]}),(0,y.jsxs)(h.OO,{direction:"column",align:"stretch",gap:"lg",children:[t.alert,t.settingItems.map(((e,t)=>(0,y.jsx)(A,(0,s.A)({},e),e.title+t)))]})]}))},M=e=>{const t=(0,l.c)(96),{settingGroups:n,tabDirection:a,showChangedOptionFilter:i,showResetButton:c,showSearchBar:o,primaryButton:r,extraButton:d}=e,m=void 0===a?"left":a,{t:u}=(0,O.Bd)(),{styles:p}=_(),[b,A]=(0,j.useState)(""),[C,R]=(0,j.useState)(!1),[E,M]=(0,k.A)(!1),{toggle:U}=M,[V,z]=(0,j.useState)("all");let G;t[0]!==b?(G=e=>e.title.toLowerCase().includes(b.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(b.toLowerCase()),t[0]=b,t[1]=G):G=t[1];const W=G,K=L;let X,Q,Y,Z,q,H,J,$,ee,te,ne,ae,se,ie,ce,le,oe,re,de,ge,me,ue,he,pe;if(t[2]!==V||t[3]!==C||t[4]!==d||t[5]!==r||t[6]!==b||t[7]!==W||t[8]!==U||t[9]!==n||t[10]!==i||t[11]!==c||t[12]!==o||t[13]!==p.TabStyles||t[14]!==u||t[15]!==m){let e;t[28]!==C||t[29]!==W?(e=e=>(0,s.A)((0,s.A)({},e),{},{settingItems:x().filter(e.settingItems,(e=>(!C||K(e))&&W(e)))}),t[28]=C,t[29]=W,t[30]=e):e=t[30];const a=x().map(n,e);let l,j,k,T,O;Q=h.OO,Y="column",Z="md",q="stretch",t[31]!==b||t[32]!==o||t[33]!==u?(l=!!o&&(0,y.jsx)(S.A,{prefix:(0,y.jsx)(f.A,{}),placeholder:u("settings.SearchPlaceholder"),onChange:e=>A(e.target.value),value:b}),t[31]=b,t[32]=o,t[33]=u,t[34]=l):l=t[34],t[35]!==i||t[36]!==u?(j=!!i&&(0,y.jsx)(g.A,{onChange:e=>R(e.target.checked),style:{whiteSpace:"nowrap"},children:u("settings.ShowOnlyChanged")}),t[35]=i,t[36]=u,t[37]=j):j=t[37],t[38]!==U||t[39]!==c||t[40]!==u?(k=!!c&&(0,y.jsx)(h.Fv,{icon:(0,y.jsx)(v.A,{}),onClick:()=>U(),children:u("button.Reset")}),t[38]=U,t[39]=c,t[40]=u,t[41]=k):k=t[41],t[42]!==d||t[43]!==r||t[44]!==l||t[45]!==j||t[46]!==k?(H=(0,y.jsxs)(h.OO,{justify:"start",gap:"xs",children:[l,j,d,k,r]}),t[42]=d,t[43]=r,t[44]=l,t[45]=j,t[46]=k,t[47]=H):H=t[47],X=w.A,J=V,$=z,ee=p.TabStyles,te=m?"left":"top",t[48]===Symbol.for("react.memo_cache_sentinel")?(ne={minWidth:200},t[48]=ne):ne=t[48],t[49]!==u?(T=u("general.All"),t[49]=u,t[50]=T):T=t[50],t[51]!==U||t[52]!==u?(O=(e,t)=>({key:"index".concat(t),label:(0,y.jsx)(B,{title:e.title,count:e.settingItems.length}),children:(0,y.jsx)(h.OO,{direction:"column",align:"stretch",gap:"xl",children:e.settingItems.length>0?(0,y.jsx)(D,{group:e,hideEmpty:!0,onReset:()=>{U()}}):(0,y.jsx)(I.A,{image:I.A.PRESENTED_IMAGE_SIMPLE,description:u("settings.NoChangesToDisplay")})})}),t[51]=U,t[52]=u,t[53]=O):O=t[53],ae=[{key:"all",label:(0,y.jsx)(B,{title:T,count:x().sumBy(a,P)}),children:(0,y.jsx)(h.OO,{direction:"column",align:"stretch",gap:"xl",children:x().sumBy(a,N)>0?x().map(a,(e=>(0,y.jsx)(D,{"data-testid":null===e||void 0===e?void 0:e["data-testid"],group:e,hideEmpty:!0,onReset:()=>{U()}},e.title))):(0,y.jsx)(I.A,{image:I.A.PRESENTED_IMAGE_SIMPLE,description:u("settings.NoChangesToDisplay")})})},...x().map(a,O)],t[2]=V,t[3]=C,t[4]=d,t[5]=r,t[6]=b,t[7]=W,t[8]=U,t[9]=n,t[10]=i,t[11]=c,t[12]=o,t[13]=p.TabStyles,t[14]=u,t[15]=m,t[16]=X,t[17]=Q,t[18]=Y,t[19]=Z,t[20]=q,t[21]=H,t[22]=J,t[23]=$,t[24]=ee,t[25]=te,t[26]=ne,t[27]=ae}else X=t[16],Q=t[17],Y=t[18],Z=t[19],q=t[20],H=t[21],J=t[22],$=t[23],ee=t[24],te=t[25],ne=t[26],ae=t[27];return t[54]!==X||t[55]!==J||t[56]!==$||t[57]!==ee||t[58]!==te||t[59]!==ne||t[60]!==ae?(se=(0,y.jsx)(X,{activeKey:J,onChange:$,className:ee,tabPosition:te,tabBarStyle:ne,items:ae}),t[54]=X,t[55]=J,t[56]=$,t[57]=ee,t[58]=te,t[59]=ne,t[60]=ae,t[61]=se):se=t[61],t[62]!==Q||t[63]!==Y||t[64]!==Z||t[65]!==q||t[66]!==H||t[67]!==se?(ie=(0,y.jsxs)(Q,{direction:Y,gap:Z,align:q,children:[H,se]}),t[62]=Q,t[63]=Y,t[64]=Z,t[65]=q,t[66]=H,t[67]=se,t[68]=ie):ie=t[68],t[69]!==u?(ce=u("dialog.ask.DoYouWantToResetChanges"),t[69]=u,t[70]=ce):ce=t[70],t[71]!==u?(le=u("button.Reset"),t[71]=u,t[72]=le):le=t[72],t[73]===Symbol.for("react.memo_cache_sentinel")?(oe={danger:!0},t[73]=oe):oe=t[73],t[74]!==U||t[75]!==n?(re=()=>{F(n),U()},t[74]=U,t[75]=n,t[76]=re):re=t[76],t[77]!==u?(de=u("button.Cancel"),t[77]=u,t[78]=de):de=t[78],t[79]!==U?(ge=()=>U(),t[79]=U,t[80]=ge):ge=t[80],t[81]!==u?(me=u("dialog.warning.CannotBeUndone"),t[81]=u,t[82]=me):me=t[82],t[83]!==me?(ue=(0,y.jsx)(T.A,{showIcon:!0,message:me,type:"warning"}),t[83]=me,t[84]=ue):ue=t[84],t[85]!==E||t[86]!==ce||t[87]!==le||t[88]!==re||t[89]!==de||t[90]!==ge||t[91]!==ue?(he=(0,y.jsx)(h.Ib,{open:E,title:ce,okText:le,okButtonProps:oe,onOk:re,cancelText:de,onCancel:ge,children:ue}),t[85]=E,t[86]=ce,t[87]=le,t[88]=re,t[89]=de,t[90]=ge,t[91]=ue,t[92]=he):he=t[92],t[93]!==ie||t[94]!==he?(pe=(0,y.jsxs)(y.Fragment,{children:[ie,he]}),t[93]=ie,t[94]=he,t[95]=pe):pe=t[95],pe},F=e=>{x().flatMap(e,(e=>e.settingItems)).forEach((e=>{!e.disabled&&(null===e||void 0===e?void 0:e.setValue)&&e.setValue(e.defaultValue)}))};function L(e){return null!==e.value&&void 0!==e.value&&!e.disabled&&e.value!==e.defaultValue}function P(e){return e.settingItems.length}function N(e){return e.settingItems.length}},5645:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var a=n(66448),s=n(69679),i=n(3106),c=n(39999),l=n(86062),o=n(57506),r=n(14262),d=n(57578);const g=()=>{const[e,t]=(0,o.useState)(!1),[n,g]=(0,o.useState)(!1),{t:m}=(0,r.Bd)(),{upsertNotification:u}=(0,s.js)(),h=(0,a.CX)(),p=[{"data-testid":"maintenance-fix",title:m("maintenance.Fix"),settingItems:[{type:"custom",title:m("maintenance.MatchDatabase"),description:m("maintenance.DescMatchDatabase"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{t(!0),u({message:m("maintenance.RecalculateUsage"),description:m("maintenance.Recalculating"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.recalculate_usage().finally((()=>t(!1))),onChange:{pending:m("maintenance.Recalculating"),resolved:m("maintenance.RecalculationFinished"),rejected:m("maintenance.RecalculationFailed")}}})},loading:e,children:m(e?"maintenance.Recalculating":"maintenance.RecalculateUsage")})}]},{"data-testid":"maintenance-images",title:m("maintenance.ImagesEnvironment"),settingItems:[{type:"custom",title:m("maintenance.RescanImageList"),description:m("maintenance.DescRescanImageList"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{g(!0),u({message:m("maintenance.RescanImages"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.rescan_images(),onChange:{pending:m("maintenance.RescanImageScanning"),resolved:e=>{const t=e;if(t.rescan_images.ok)return{backgroundTask:{status:"pending",taskId:t.rescan_images.task_id,promise:null,percent:0,onChange:{resolved:(e,t)=>(g(!1),m("maintenance.RescanImageFinished"))}},duration:0};throw new Error(m("maintenance.RescanFailed"))},rejected:(e,t)=>{const n=e;return g(!1),(null===n||void 0===n?void 0:n.message)||m("maintenance.RescanFailed")}}}})},loading:n,children:m(n?"maintenance.RescanImageScanning":"maintenance.RescanImages")})}]}];return(0,d.jsx)(i.A,{settingGroups:p,showSearchBar:!0})};var m=n(73297),u=n(38442),h=n(57179),p=n(74483);const x=(0,p.withDefault)(p.StringParam,"maintenance"),j=()=>{const{t:e}=(0,r.Bd)(),[t,n]=(0,p.useQueryParam)("tab",x);return(0,d.jsx)(u.Zu,{activeTabKey:t,onTabChange:e=>n(e),tabList:[{key:"maintenance",tab:e("webui.menu.Maintenance")}],children:(0,d.jsx)(o.Suspense,{fallback:(0,d.jsx)(m.A,{active:!0}),children:"maintenance"===t&&(0,d.jsx)(h.A,{children:(0,d.jsx)(g,{})})})})}},39999:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(1139),s=n(57506);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};var c=n(92726),l=function(e,t){return s.createElement(c.A,(0,a.A)({},e,{ref:t,icon:i}))};const o=s.forwardRef(l)}}]);
//# sourceMappingURL=5645.0c616fd5.chunk.js.map