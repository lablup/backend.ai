"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1147],{50514:(e,n,t)=>{t.d(n,{A:()=>R});var a=t(88543),s=t(72338),i=t(66596),c=t(12221),o=t(29759),l=t(88221),r=t(47543),d=t(77946),g=t(55093),u=t(79569);const m=(0,d.rU)((e=>{let{css:n}=e;return{baiSettingItemCheckbox:n`
    .ant-checkbox {
      align-self: flex-start;
      margin-top: 0.2rem;
    }
  `}})),h=e=>{let{type:n,title:t,description:a,children:d,defaultValue:g,value:h,selectProps:p,onChange:x}=e;const{token:k}=i.A.useToken(),{styles:b}=m();return(0,u.jsxs)(s.A,{direction:"column",align:"start",gap:"xxs",children:[(0,u.jsxs)(s.A,{direction:"row",gap:"xxs",children:[(0,u.jsx)(c.A.Text,{strong:!0,style:{fontSize:k.fontSize},children:t}),void 0!==h&&null!==h&&g!==h&&(0,u.jsx)(o.A,{dot:!0,status:"warning"})]}),"custom"===n&&(0,u.jsxs)(u.Fragment,{children:[a,d]}),"checkbox"===n&&(0,u.jsx)(l.A,{checked:h,onChange:x,className:b.baiSettingItemCheckbox,children:a}),"select"===n&&(0,u.jsxs)(u.Fragment,{children:[a,(0,u.jsx)(r.A,{value:h,popupMatchSelectWidth:!1,onChange:x,...p})]})]})};var p=t(76975),x=t(30344),k=t(11956),b=t(1364),j=t(99142),f=t(11824),y=t(38398),A=t(46976),w=t.n(A),C=t(33364);const v=(0,d.rU)((e=>{let{css:n}=e;return{TabStyles:n`
    .ant-tabs-tab-active {
      font-weight: var(--token-fontWeightSuperStrong, 700);
    }
    .ant-typography-secondary {
      font-weight: normal !important;
    }
  `}})),R=e=>{let{settingGroup:n,tabDirection:t="left",showChangedOptionFilter:o,showResetButton:r,showSearchBar:d}=e;const{t:m}=(0,C.Bd)(),{token:A}=i.A.useToken(),{styles:R}=v(),[S,I]=(0,g.useState)(""),[T,F]=(0,g.useState)(!1),[B,{toggle:D}]=(0,k.A)(!1),_=(0,g.useMemo)((()=>[{title:m("general.All"),settingItems:w().flatMap(n,(e=>e.settingItems))},...n]),[n]);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)(s.A,{direction:"column",gap:"md",align:"stretch",style:{padding:A.paddingContentHorizontal,maxWidth:A.screenLG},children:[(0,u.jsxs)(s.A,{justify:"start",gap:"xs",children:[!!d&&(0,u.jsx)(b.A,{prefix:(0,u.jsx)(p.A,{}),placeholder:m("settings.SearchPlaceholder"),onChange:e=>I(e.target.value),value:S}),!!o&&(0,u.jsx)(l.A,{onChange:e=>F(e.target.checked),style:{whiteSpace:"nowrap"},children:m("settings.ShowOnlyChanged")}),!!r&&(0,u.jsx)(j.Ay,{icon:(0,u.jsx)(x.A,{}),onClick:()=>D(),children:m("button.Reset")})]}),(0,u.jsx)(f.A,{className:R.TabStyles,tabPosition:t?"left":"top",tabBarStyle:{minWidth:200},items:w().map(_,(e=>{const n=e.settingItems.filter((e=>(!T||(e=>null!==e.value&&void 0!==e.value&&e.value!==e.defaultValue)(e))&&(e=>e.title.toLowerCase().includes(S.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(S.toLowerCase()))(e)));return{key:e.title,label:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.A.Text,{children:e.title}),(0,u.jsx)(c.A.Text,{type:"secondary",children:` (${n.length})`})]}),children:(0,u.jsx)(s.A,{direction:"column",gap:"lg",align:"start",children:n.map((e=>(0,u.jsx)(h,{...e})))})}}))})]}),(0,u.jsx)(a.A,{open:B,title:m("dialog.ask.DoYouWantToResetChanges"),okText:m("button.Reset"),okButtonProps:{danger:!0},onOk:()=>{w().flatMap(n,(e=>e.settingItems)).forEach((e=>{(null===e||void 0===e?void 0:e.setValue)&&e.setValue(e.defaultValue)})),D()},cancelText:m("button.Cancel"),onCancel:()=>D(),children:(0,u.jsx)(y.A,{showIcon:!0,message:m("dialog.warning.CannotBeUndone"),type:"warning"})})]})}},51147:(e,n,t)=>{t.r(n),t.d(n,{default:()=>p});var a=t(23441),s=t(25905),i=t(50514),c=t(30344),o=t(99142),l=t(55093),r=t(33364),d=t(79569);const g=()=>{const[e,n]=(0,l.useState)(!1),[t,g]=(0,l.useState)(!1),{t:u}=(0,r.Bd)(),{upsertNotification:m}=(0,s.js)(),h=(0,a.CX)(),p=[{title:u("maintenance.Fix"),settingItems:[{type:"custom",title:u("maintenance.MatchDatabase"),description:u("maintenance.DescMatchDatabase"),children:(0,d.jsx)(o.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{n(!0),m({message:u("maintenance.RecalculateUsage"),description:u("maintenance.Recalculating"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.recalculate_usage().finally((()=>n(!1))),statusDescriptions:{pending:u("maintenance.Recalculating"),resolved:u("maintenance.RecalculationFinished"),rejected:u("maintenance.RecalculationFailed")}}})},loading:e,children:u(e?"maintenance.Recalculating":"maintenance.RecalculateUsage")})}]},{title:u("maintenance.ImagesEnvironment"),settingItems:[{type:"custom",title:u("maintenance.RescanImageList"),description:u("maintenance.DescRescanImageList"),children:(0,d.jsx)(o.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{g(!0);const e=m({message:u("maintenance.RescanImages"),description:u("maintenance.RescanImageScanning"),open:!0,backgroundTask:{status:"pending"}});h.maintenance.rescan_images().then((n=>{let{rescan_images:t}=n;if(!t.ok)throw new Error(u("maintenance.RescanFailed"));m({key:e,backgroundTask:{status:"pending",percent:0,taskId:t.task_id,statusDescriptions:{pending:u("maintenance.RescanImageScanning"),resolved:u("maintenance.RescanImageFinished"),rejected:u("maintenance.RescanFailed")}},duration:0})})).catch((n=>{m({key:e,backgroundTask:{status:"rejected",statusDescriptions:{rejected:(null===n||void 0===n?void 0:n.message)||u("maintenance.RescanFailed")}},open:!0,duration:s.Zq})})).finally((()=>{g(!1)}))},loading:t,children:u(t?"maintenance.RescanImageScanning":"maintenance.RescanImages")})}]}];return(0,d.jsx)(i.A,{settingGroup:p,showSearchBar:!0})};var u=t(80963),m=t(2647);const h=(0,m.withDefault)(m.StringParam,"maintenance"),p=()=>{const{t:e}=(0,r.Bd)(),[n,t]=(0,m.useQueryParam)("tab",h);return(0,d.jsx)(u.A,{activeTabKey:"maintenance",onTabChange:e=>t(e),tabList:[{key:"maintenance",tab:e("webui.menu.Maintenance")}],styles:{body:{padding:0}},children:"maintenance"===n&&(0,d.jsx)(g,{})})}},30344:(e,n,t)=>{t.d(n,{A:()=>l});var a=t(40991),s=t(55093);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};var c=t(36462),o=function(e,n){return s.createElement(c.A,(0,a.A)({},e,{ref:n,icon:i}))};const l=s.forwardRef(o)}}]);
//# sourceMappingURL=1147.f102ec84.chunk.js.map