"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1584],{68314:(e,n,i)=>{i.d(n,{A:()=>l});var a=i(89214),t=(i(66610),i(66906));const l=e=>{let{type:n,style:i,monospace:l,children:r,...s}=e;return l?(0,t.jsx)(a.A.Text,{type:n,...s,style:{fontFamily:"monospace",...i},children:r}):(0,t.jsx)(a.A.Text,{type:n,style:i,...s,children:r})}},1584:(e,n,i)=>{i.r(n),i.d(n,{default:()=>E});const a=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},n={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:null,kind:"LocalArgument",name:"limit"},a={defaultValue:null,kind:"LocalArgument",name:"offset"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o=[r,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],d={alias:null,args:null,concreteType:"SourceInfo",kind:"LinkedField",name:"registry",plural:!1,selections:o,storageKey:null},c={alias:null,args:null,concreteType:"SourceInfo",kind:"LinkedField",name:"source",plural:!1,selections:o,storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},g={kind:"Literal",name:"orderBy",value:{direction:"DESC",field:"VERSION"}},f=[{kind:"Literal",name:"filter",value:{status:{equals:"PULLING"}}},g],m={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},A={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},y={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},k={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]},F=[{kind:"Literal",name:"first",value:1},g],R={alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null},L={args:null,kind:"FragmentSpread",name:"BAIImportArtifactModalArtifactRevisionFragment"},S=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},g];return{fragment:{argumentDefinitions:[e,n,i,a],kind:"Fragment",metadata:null,name:"ReservoirArtifactDetailPageQuery",selections:[{alias:null,args:t,concreteType:"Artifact",kind:"LinkedField",name:"artifact",plural:!1,selections:[l,r,{args:null,kind:"FragmentSpread",name:"BAIArtifactTypeTagFragment"},s,d,c,u,{alias:"pullingArtifactRevisions",args:f,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"__ReservoirArtifactDetailPage_pullingArtifactRevisions_connection",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,A,{args:null,kind:"FragmentSpread",name:"BAIPullingArtifactRevisionAlertFragment"},v],storageKey:null},p],storageKey:null},y,k],storageKey:'__ReservoirArtifactDetailPage_pullingArtifactRevisions_connection(filter:{"status":{"equals":"PULLING"}},orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:"latestVersion",args:F,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,R,I,A,L,{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionTableLatestRevisionFragment"}],storageKey:null}],storageKey:null}],storageKey:'revisions(first:1,orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:null,args:S,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,A,{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionTableArtifactRevisionFragment"},L,{args:null,kind:"FragmentSpread",name:"BAIDeleteArtifactRevisionsModalArtifactRevisionFragment"},{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionDeleteButtonFragment"},{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionDownloadButtonFragment"}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"BAIImportArtifactModalArtifactFragment"},{args:null,kind:"FragmentSpread",name:"BAIDeleteArtifactRevisionsModalArtifactFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,i,e],kind:"Operation",name:"ReservoirArtifactDetailPageQuery",selections:[{alias:null,args:t,concreteType:"Artifact",kind:"LinkedField",name:"artifact",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},s,d,c,u,{alias:"pullingArtifactRevisions",args:f,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,A,I,v],storageKey:null},p],storageKey:null},y,k],storageKey:'revisions(filter:{"status":{"equals":"PULLING"}},orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:"pullingArtifactRevisions",args:f,filters:["filter","orderBy"],handle:"connection",key:"ReservoirArtifactDetailPage_pullingArtifactRevisions",kind:"LinkedHandle",name:"revisions"},{alias:"latestVersion",args:F,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,R,I,A],storageKey:null}],storageKey:null}],storageKey:'revisions(first:1,orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:null,args:S,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,A,I,R,u],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"0d1cbe108f844759d49f2a65d38b28c4",id:null,metadata:{connection:[{count:null,cursor:null,direction:"bidirectional",path:["artifact","pullingArtifactRevisions"]}]},name:"ReservoirArtifactDetailPageQuery",operationKind:"query",text:"query ReservoirArtifactDetailPageQuery(\n  $id: ID!\n  $offset: Int!\n  $limit: Int!\n  $filter: ArtifactRevisionFilter!\n) {\n  artifact(id: $id) {\n    id\n    name\n    ...BAIArtifactTypeTagFragment\n    description\n    registry {\n      name\n      url\n    }\n    source {\n      name\n      url\n    }\n    updatedAt\n    pullingArtifactRevisions: revisions(filter: {status: {equals: PULLING}}, orderBy: {field: VERSION, direction: DESC}) {\n      count\n      edges {\n        node {\n          id\n          status\n          ...BAIPullingArtifactRevisionAlertFragment\n          __typename\n        }\n        cursor\n      }\n      pageInfo {\n        endCursor\n        hasNextPage\n        hasPreviousPage\n        startCursor\n      }\n    }\n    latestVersion: revisions(first: 1, orderBy: {field: VERSION, direction: DESC}) {\n      edges {\n        node {\n          id\n          size\n          version\n          status\n          ...BAIImportArtifactModalArtifactRevisionFragment\n          ...BAIArtifactRevisionTableLatestRevisionFragment\n        }\n      }\n    }\n    revisions(offset: $offset, limit: $limit, orderBy: {field: VERSION, direction: DESC}, filter: $filter) {\n      count\n      edges {\n        node {\n          id\n          status\n          ...BAIArtifactRevisionTableArtifactRevisionFragment\n          ...BAIImportArtifactModalArtifactRevisionFragment\n          ...BAIDeleteArtifactRevisionsModalArtifactRevisionFragment\n          ...BAIArtifactRevisionDeleteButtonFragment\n          ...BAIArtifactRevisionDownloadButtonFragment\n        }\n      }\n    }\n    ...BAIImportArtifactModalArtifactFragment\n    ...BAIDeleteArtifactRevisionsModalArtifactFragment\n  }\n}\n\nfragment BAIArtifactDescriptionsFragment on Artifact {\n  name\n  description\n  source {\n    name\n    url\n  }\n  ...BAIArtifactTypeTagFragment\n}\n\nfragment BAIArtifactRevisionDeleteButtonFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactRevisionDownloadButtonFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactRevisionTableArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n  updatedAt\n  ...BAIArtifactStatusTagFragment\n  ...BAIArtifactRevisionDownloadButtonFragment\n  ...BAIArtifactRevisionDeleteButtonFragment\n}\n\nfragment BAIArtifactRevisionTableLatestRevisionFragment on ArtifactRevision {\n  id\n}\n\nfragment BAIArtifactStatusTagFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactTypeTagFragment on Artifact {\n  type\n}\n\nfragment BAIDeleteArtifactRevisionsModalArtifactFragment on Artifact {\n  id\n  ...BAIArtifactDescriptionsFragment\n}\n\nfragment BAIDeleteArtifactRevisionsModalArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n}\n\nfragment BAIImportArtifactModalArtifactFragment on Artifact {\n  id\n  name\n  ...BAIArtifactDescriptionsFragment\n}\n\nfragment BAIImportArtifactModalArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n}\n\nfragment BAIPullingArtifactRevisionAlertFragment on ArtifactRevision {\n  id\n  status\n  version\n}\n"}}}();a.hash="84c2e87c5b490db6c7abb4854da057af";const t=a;var l=i(89214),r=i(44163),s=i(33403),o=i(80503),d=i(56761),c=i(63872),u=i(4994),g=i.n(u),f=i(65288),m=i.n(f),A=i(8348),v=i.n(A),p=i(5343),y=i(66610),k=i(54070),F=i(89737),R=i(19022),I=i(84970),L=i(68314),S=i(19885),h=i(61774),B=i(82860),b=i(83203),P=i(66906);g().extend(m());const{Title:D,Text:x,Paragraph:T}=l.A,E=()=>{var e,n,i,a;const{token:u}=r.A.useToken(),{t:f}=(0,k.Bd)(),{upsertNotification:m}=(0,B.js)(),{artifactId:A}=(0,R.g)(),[E,K]=(0,S.Tw)(S.eI),[N,j]=(0,y.useState)([]),[C,V]=(0,y.useState)([]),[O,_]=(0,y.useState)([]),[M,w]=(0,b.useQueryParams)({filter:(0,b.withDefault)(b.JsonParam,{})}),$=JSON.stringify(M.filter),{baiPaginationOption:z,tablePaginationOption:G,setTablePaginationOption:U}=(0,h.aW)({current:1,pageSize:10}),q=(0,y.useMemo)((()=>({id:null!==A&&void 0!==A?A:"",offset:z.offset,limit:z.limit,filter:JSON.parse($||"{}")})),[A,z.limit,z.offset,$]),Q=(0,y.useDeferredValue)(q),J=(0,y.useDeferredValue)(E),{artifact:Y}=(0,F.useLazyLoadQuery)(t,Q,{fetchKey:J===S.eI?void 0:J,fetchPolicy:J===S.eI?"store-and-network":"network-only"}),Z=null===Y||void 0===Y||null===(e=Y.latestVersion.edges[0])||void 0===e?void 0:e.node,H=(0,c.f)(null===Y||void 0===Y?void 0:Y.pullingArtifactRevisions.edges.map((e=>null===e||void 0===e?void 0:e.node)));return(0,P.jsxs)("div",{children:[(0,P.jsxs)(c.OO,{align:"center",style:{marginBottom:u.marginLG},justify:"between",children:[(0,P.jsxs)(c.OO,{align:"center",gap:"xs",children:[(0,P.jsx)(D,{level:3,style:{margin:0},children:null===Y||void 0===Y?void 0:Y.name}),Y&&(0,P.jsx)(c.bk,{artifactTypeFrgmt:Y})]}),(0,P.jsx)(I.A,{value:E,autoUpdateDelay:1e4,loading:J!==E,onChange:()=>{K()}})]}),H.length>0&&(0,P.jsx)(c.OO,{direction:"column",gap:"sm",align:"stretch",style:{marginBottom:u.marginMD},children:H.map((e=>(0,P.jsx)(c.vy,{pullingArtifactRevisionFrgmt:e,onOk:()=>{K()}},e.id)))}),(0,P.jsx)(c.Zu,{title:f("reservoirPage.BasicInformation"),showDivider:!0,extra:(0,P.jsx)(s.Ay,{type:"primary",icon:(0,P.jsx)(p.A,{size:16}),onClick:()=>{Z&&_([Z])},disabled:!Z||"SCANNED"!==Z.status,children:Z?f("reservoirPage.PullLatestVersion",{version:Z.version}):"N/A"}),style:{marginBottom:u.marginMD},children:(0,P.jsxs)(o.A,{column:2,bordered:!0,children:[(0,P.jsx)(o.A.Item,{label:f("reservoirPage.Name"),children:null===Y||void 0===Y?void 0:Y.name}),(0,P.jsx)(o.A.Item,{label:f("reservoirPage.Type"),children:Y&&(0,P.jsx)(c.bk,{artifactTypeFrgmt:Y})}),(0,P.jsx)(o.A.Item,{label:f("reservoirPage.Size"),children:(0,P.jsx)(L.A,{monospace:!0,children:null!==Z&&void 0!==Z&&Z.size?null===(n=(0,c.Gh)(Z.size,"auto"))||void 0===n?void 0:n.displayValue:"N/A"})}),(0,P.jsx)(o.A.Item,{label:f("reservoirPage.Source"),children:null!==Y&&void 0!==Y&&Y.source?(0,P.jsx)(l.A.Link,{href:null!==(i=Y.source.url)&&void 0!==i?i:"",target:"_blank",rel:"noopener noreferrer",children:Y.source.name||"N/A"}):"N/A"}),(0,P.jsx)(o.A.Item,{label:f("reservoirPage.Registry"),children:(0,P.jsx)(l.A,{children:null!==Y&&void 0!==Y&&Y.registry?`${Y.registry.name}(${Y.registry.url})`:"N/A"})}),(0,P.jsx)(o.A.Item,{label:f("reservoirPage.LastUpdated"),span:2,children:null!==Y&&void 0!==Y&&Y.updatedAt?g()(null===Y||void 0===Y?void 0:Y.updatedAt).format("lll"):"N/A"}),(0,P.jsx)(o.A.Item,{label:f("reservoirPage.Description"),span:2,children:null!==Y&&void 0!==Y&&Y.description?(0,P.jsx)(T,{children:Y.description}):"N/A"})]})}),(0,P.jsx)(c.Zu,{title:f("reservoirPage.VersionList"),showDivider:!0,style:{marginBottom:u.marginMD},styles:{body:{padding:`${u.paddingSM}px ${u.paddingLG}px ${u.paddingLG}px ${u.paddingLG}px`}},children:(0,P.jsxs)(c.OO,{direction:"column",gap:"sm",align:"stretch",children:[(0,P.jsxs)(c.OO,{align:"stretch",justify:"between",children:[(0,P.jsx)(c.tX,{combinationMode:"AND",onChange:e=>{w({filter:null!==e&&void 0!==e?e:{}},"replaceIn")},filterProperties:[{fixedOperator:"equals",propertyLabel:f("reservoirPage.Status"),key:"status",type:"enum",options:[{label:"SCANNED",value:"SCANNED"},{label:"PULLING",value:"PULLING"},{label:"PULLED",value:"PULLED"},{label:"VERIFYING",value:"VERIFYING"},{label:"NEEDS_APPROVAL",value:"NEEDS_APPROVAL"},{label:"FAILED",value:"FAILED"},{label:"AVAILABLE",value:"AVAILABLE"},{label:"REJECTED",value:"REJECTED"}]},{fixedOperator:"contains",propertyLabel:f("reservoirPage.Version"),key:"version",type:"string"},{propertyLabel:f("reservoirPage.ArtifactID"),key:"artifactId",valueMode:"scalar",type:"string"}]}),N.length>0?(0,P.jsxs)(c.OO,{gap:"xs",children:[(0,P.jsxs)(x,{children:[N.length," selected"]}),(0,P.jsx)(d.A,{title:f("reservoirPage.PullSelectedVersions"),children:(0,P.jsx)(c.eM,{revisionsFrgmt:N.flatMap((e=>e.data)),onClick:()=>{Y&&_(N.flatMap((e=>e.data)))}})}),(0,P.jsx)(d.A,{title:f("reservoirPage.RemoveSelectedVersions"),children:(0,P.jsx)(c.Ty,{revisionsFrgmt:N.flatMap((e=>e.data)),style:{borderColor:u.colorBorder,backgroundColor:u.colorBgContainer},onClick:()=>{Y&&V(N.flatMap((e=>e.data)))}})})]}):null]}),(0,P.jsx)(c.eU,{artifactRevisionFrgmt:(0,c.f)(null===Y||void 0===Y?void 0:Y.revisions.edges.map((e=>e.node))),latestRevisionFrgmt:null===Y||void 0===Y?void 0:Y.latestVersion.edges[0].node,loading:Q!==q,onClickDownload:e=>{null===Y||void 0===Y||Y.revisions.edges.forEach((n=>{if(n.node.id===e)return _([n.node])}))},onClickDelete:e=>{null===Y||void 0===Y||Y.revisions.edges.forEach((n=>{if(n.node.id===e)return V([n.node])}))},pagination:{current:G.current,pageSize:G.pageSize,total:null!==(a=null===Y||void 0===Y?void 0:Y.revisions.count)&&void 0!==a?a:0,onChange:(e,n)=>{v().isNumber(e)&&v().isNumber(n)&&U({current:e,pageSize:n})}},onRow:e=>({onClick:n=>{var i;n.stopPropagation();const a=n.target;if(a.closest("button")||a.closest("a"))return;if(!Y)return;const t=null===(i=Y.revisions.edges.find((n=>n.node.id===e.id)))||void 0===i?void 0:i.node;t&&j((n=>{const i=n.filter((n=>n.id!==e.id));return i.length===n.length?[...n,{id:e.id,data:t}]:i}))}}),rowSelection:{type:"checkbox",onChange:e=>{if(!Y)return;const n=Y.revisions,i=n.edges.map((e=>e.node.id));j((a=>{const t=a.filter((e=>!i.includes(e.id))),l=n.edges.filter((n=>e.includes(n.node.id))).map((e=>({id:e.node.id,data:e.node})));return t.concat(l)}))},selectedRowKeys:N.map((e=>e.id))}})]})}),(0,P.jsx)(c.VC,{selectedArtifactFrgmt:null!==Y&&void 0!==Y?Y:null,selectedArtifactRevisionFrgmt:O,open:!!Y&&!v().isEmpty(O),connectionIds:Y?[Y.pullingArtifactRevisions.__id]:void 0,onOk:(e,n)=>{_([]),n.forEach((e=>{m({message:f("reservoirPage.PullingArtifact",{name:e.artifact.name,version:e.version}),type:"info",open:!0,duration:0,backgroundTask:{status:"pending",taskId:e.taskId,promise:null,percent:0,onChange:{resolved:(n,i)=>({type:"success",message:f("reservoirPage.SuccessFullyPulledArtifact",{name:e.artifact.name,version:e.version}),showIcon:!0,toText:f("reservoirPage.GoToArtifact"),to:`/reservoir/${e.artifact.id}`}),rejected:(n,i)=>f("reservoirPage.FailedToPullArtifact",{name:e.artifact.name,version:e.version})}}})}))},onCancel:()=>{_([])}}),(0,P.jsx)(c.L$,{selectedArtifactFrgmt:null!==Y&&void 0!==Y?Y:null,selectedArtifactRevisionFrgmt:C,onOk:()=>{V([])},onCancel:()=>{V([])},open:!!Y&&!v().isEmpty(C)})]})}}}]);
//# sourceMappingURL=1584.a11710a0.chunk.js.map