"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[5276],{95597:(e,t,l)=>{l.d(t,{A:()=>p});var n=l(2425),a=l(66397),r=l(62081),i=l(93184),s=l(49561),o=l(15269),u=l(19784),d=l.n(u),c=l(35422),m=l(94408),g=l(27966);const p=e=>{var t;let{open:l,onRequestClose:u,columns:p,hiddenColumnKeys:y,...f}=e;const h=(0,c.useRef)(null),{t:b}=(0,m.Bd)(),{token:v}=r.A.useToken(),x=d().map(p,(e=>{return"string"===typeof e.title?{label:e.title,value:d().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(t=e.title,c.Children.map(t.props.children,(e=>{if("string"===typeof e)return e}))),value:d().toString(e.key)}:{label:void 0,value:d().toString(e.key)};var t}));return(0,g.jsx)(n.A,{title:b("table.SettingTable"),open:l,destroyOnClose:!0,centered:!0,onOk:()=>{var e;null===(e=h.current)||void 0===e||e.validateFields().then((e=>{u(e)})).catch((()=>{}))},onCancel:()=>{u()},...f,children:(0,g.jsxs)(i.A,{ref:h,preserve:!1,initialValues:{selectedColumnKeys:null===(t=d().map(x,"value"))||void 0===t?void 0:t.filter((e=>!d().includes(y,e)))},layout:"vertical",children:[(0,g.jsx)(i.A.Item,{name:"searchInput",label:b("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,g.jsx)(s.A,{prefix:(0,g.jsx)(a.A,{}),style:{marginBottom:v.marginSM},placeholder:b("table.SearchTableColumn")})}),(0,g.jsx)(i.A.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.searchInput!==t.searchInput,children:e=>{let{getFieldValue:t}=e;const l=t("searchInput")?d().toLower(t("searchInput")):void 0,n=d().map(x,(e=>d().toLower(d().toString(e.label)).includes(l||"")?e:{...e,style:{display:"none"}}));return(0,g.jsx)(i.A.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},rules:[{required:!0,message:b("general.validation.PleaseSelectOptions")}],children:(0,g.jsx)(o.A.Group,{options:n,style:{flexDirection:"column"}})})}})]})})}},98332:(e,t,l)=>{l.d(t,{a:()=>a});var n=l(93264);const a=e=>{const[t,l]=(0,n.q)(`hiddenColumnKeys.${e}`);return[t,l]}},95276:(e,t,l)=>{l.r(t),l.d(t,{default:()=>V});const n=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},t={defaultValue:null,kind:"LocalArgument",name:"limit"},l={defaultValue:null,kind:"LocalArgument",name:"offset"},n={defaultValue:null,kind:"LocalArgument",name:"order"},a={defaultValue:null,kind:"LocalArgument",name:"status"},r=[{alias:null,args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"order",variableName:"order"},{kind:"Variable",name:"status",variableName:"status"}],concreteType:"AgentSummaryList",kind:"LinkedField",name:"agent_summary_list",plural:!1,selections:[{alias:null,args:null,concreteType:"AgentSummary",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"available_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"occupied_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"scaling_group",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"schedulable",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t,l,n,a],kind:"Fragment",metadata:null,name:"AgentSummaryListQuery",selections:r,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,l,e,a,n],kind:"Operation",name:"AgentSummaryListQuery",selections:r},params:{cacheID:"caaf8909248bac69bce5c748e6d28032",id:null,metadata:{},name:"AgentSummaryListQuery",operationKind:"query",text:"query AgentSummaryListQuery(\n  $limit: Int!\n  $offset: Int!\n  $filter: String\n  $status: String\n  $order: String\n) {\n  agent_summary_list(limit: $limit, offset: $offset, filter: $filter, status: $status, order: $order) {\n    items {\n      id\n      status\n      architecture\n      available_slots\n      occupied_slots\n      scaling_group\n      schedulable\n    }\n    total_count\n  }\n}\n"}}}();n.hash="dab7ef4f1205af54a6f80ce0d28098c7";const a=n;var r=l(80472),i=l(37769),s=l(54043),o=l(56746),u=l(94514),d=l(98332),c=l(47274),m=l(62453),g=l(17987),p=l(95597),y=l(36963),f=l(4828),h=l(98910),b=l(21176),v=l(62081),x=l(54553),S=l(26020),k=l(44163),j=l(55004),A=l(19784),O=l.n(A),_=l(35422),C=l(94408),L=l(67717),w=l(93264),T=l(78251),I=l(15397),K=l(27966);const F=e=>{var t;let{containerStyle:l,tableProps:n}=e;const{t:A}=(0,C.Bd)(),{token:F}=v.A.useToken(),{mergedResourceSlots:z}=(0,s.Hv)(),[N,{toggle:V}]=(0,b.A)(),[D,$]=(0,_.useTransition)(),{baiPaginationOption:P,tablePaginationOption:R,setTablePaginationOption:q}=(0,o.aW)({current:1,pageSize:20}),[E,Z]=(0,T.R)({order:(0,I.withDefault)(I.StringParam,void 0),filter:(0,I.withDefault)(I.StringParam,void 0),status:(0,I.withDefault)(I.StringParam,"ALIVE")}),[B,Q]=(0,i.Tw)("first"),[G]=(0,_.useState)("network-only"),{sftpResourceGroups:X}=(0,u.Bk)(),W=X&&X.length>0?`!(scaling_group in [${X.map((e=>`"${e}"`)).join(", ")}])`:void 0,M=(0,_.useMemo)((()=>({limit:P.limit,offset:P.offset,filter:(0,j.r2)([E.filter,W]),order:E.order,status:E.status})),[P.limit,P.offset,E.filter,E.order,E.status,W]),J=(0,_.useDeferredValue)(M),[H,U]=(0,w.q)("table_column_overrides.AgentSummaryList"),{agent_summary_list:Y}=(0,L.useLazyLoadQuery)(a,J,{fetchKey:B,fetchPolicy:G}),ee=[{title:(0,K.jsx)(K.Fragment,{children:"ID"}),key:"id",dataIndex:"id",fixed:"left",render:(e,t)=>(0,K.jsx)(j.OO,{direction:"column",align:"start",children:(0,K.jsx)(x.A.Text,{children:e})}),sorter:!0},{title:A("agent.Architecture"),key:"architecture",dataIndex:"architecture"},{title:A("agent.Allocation"),key:"allocation",render:(e,t)=>{const l=JSON.parse((null===t||void 0===t?void 0:t.occupied_slots)||"{}"),n=JSON.parse((null===t||void 0===t?void 0:t.available_slots)||"{}");return(0,K.jsx)(j.OO,{direction:"column",gap:"xxs",children:O().map(n,((e,t)=>{if("cpu"===t){var a;const e=O().toFinite(O().toNumber(l.cpu)/O().toNumber(n.cpu)*100);return(0,K.jsxs)(j.OO,{justify:"between",style:{minWidth:220},children:[(0,K.jsxs)(j.OO,{gap:"xxs",children:[(0,K.jsx)(g.s,{type:t},t),(0,K.jsxs)(x.A.Text,{children:[(0,r.Z1)(l.cpu||0,0),"/",(0,r.Z1)(n.cpu||0,0)]}),(0,K.jsx)(x.A.Text,{type:"secondary",style:{fontSize:F.sizeXS},children:null===z||void 0===z||null===(a=z.cpu)||void 0===a?void 0:a.display_unit})]}),(0,K.jsx)(c.A,{percent:e,strokeColor:e>80?F.colorError:F.colorSuccess,width:120,valueLabel:(0,r.Z1)(e,1)+" %"})]},t)}if("mem"===t){var i,s,o,u;const e=O().toFinite(O().toNumber(l.mem)/O().toNumber(n.mem)*100);return(0,K.jsxs)(j.OO,{justify:"between",style:{minWidth:220},children:[(0,K.jsxs)(j.OO,{gap:"xxs",children:[(0,K.jsx)(g.s,{type:"mem"}),(0,K.jsxs)(x.A.Text,{children:[null!==(i=null===(s=(0,r.mv)(l.mem,"g",0))||void 0===s?void 0:s.numberFixed)&&void 0!==i?i:0,"/",null!==(o=null===(u=(0,r.mv)(n.mem,"g",0))||void 0===u?void 0:u.numberFixed)&&void 0!==o?o:0]}),(0,K.jsx)(x.A.Text,{type:"secondary",style:{fontSize:F.sizeXS},children:"GiB"})]}),(0,K.jsx)(c.A,{percent:e,strokeColor:e>80?F.colorError:F.colorSuccess,width:120,valueLabel:(0,r.Z1)(e,1)+" %"})]},"mem")}if(n[t]){var d;const e=O().toFinite(O().toNumber(l[t])/O().toNumber(n[t])*100);return(0,K.jsxs)(j.OO,{justify:"between",style:{minWidth:220},gap:"xxs",children:[(0,K.jsxs)(j.OO,{gap:"xxs",children:[(0,K.jsx)(g.s,{type:t},t),(0,K.jsxs)(x.A.Text,{children:[(0,r.Z1)(l[t]||0,2),"/",(0,r.Z1)(n[t],2)]}),(0,K.jsx)(x.A.Text,{type:"secondary",style:{fontSize:F.sizeXS},children:null===z||void 0===z||null===(d=z[t])||void 0===d?void 0:d.display_unit})]}),(0,K.jsx)(c.A,{percent:e,strokeColor:e>80?F.colorError:F.colorSuccess,width:120,valueLabel:(0,r.Z1)(e,1)+" %"})]},t)}}))})}},{title:A("general.ResourceGroup"),key:"scaling_group",dataIndex:"scaling_group",sorter:!0},{title:A("agent.Schedulable"),key:"schedulable",dataIndex:"schedulable",render:e=>(0,K.jsx)(j.OO,{justify:"center",children:!0===e?(0,K.jsx)(y.A,{style:{color:F.colorSuccess,fontSize:F.fontSizeXL}}):(0,K.jsx)(f.A,{style:{color:F.colorTextDisabled,fontSize:F.fontSizeXL}})}),sorter:!0}],[te,le]=(0,d.a)("AgentSummaryList");return(0,K.jsxs)(j.OO,{direction:"column",align:"stretch",style:l,gap:"sm",children:[(0,K.jsxs)(j.OO,{justify:"between",align:"start",gap:"xs",wrap:"wrap",children:[(0,K.jsxs)(j.OO,{direction:"row",gap:"sm",align:"start",style:{flex:1},wrap:"wrap",children:[(0,K.jsx)(m.A,{options:[{label:A("agent.Connected"),value:"ALIVE"},{label:A("agent.Terminated"),value:"TERMINATED"}],value:E.status,onChange:e=>{const t=e.target.value;Z({status:t},"replaceIn")}}),(0,K.jsx)(j.Af,{filterProperties:[{key:"id",propertyLabel:"ID",type:"string"},{key:"schedulable",propertyLabel:A("agent.Schedulable"),type:"boolean",options:[{label:A("general.Enabled"),value:"true"},{label:A("general.Disabled"),value:"false"}]}],value:E.filter,onChange:e=>{Z({filter:e},"replaceIn"),q({current:1})}})]}),(0,K.jsx)(j.OO,{gap:"xs",children:(0,K.jsx)(S.A,{title:A("button.Refresh"),children:(0,K.jsx)(k.Ay,{loading:D,onClick:()=>$((()=>{Q()})),icon:(0,K.jsx)(h.A,{})})})})]}),(0,K.jsx)(j.zx,{bordered:!0,scroll:{x:"max-content"},rowKey:"id",dataSource:(0,j.f)(null===Y||void 0===Y?void 0:Y.items),showSorterTooltip:!1,columns:O().filter(ee,(e=>!O().includes(te,O().toString(null===e||void 0===e?void 0:e.key)))),pagination:{pageSize:R.pageSize,current:R.current,total:null!==(t=null===Y||void 0===Y?void 0:Y.total_count)&&void 0!==t?t:0,onChange(e,t){O().isNumber(e)&&O().isNumber(t)&&q({current:e,pageSize:t})}},onChangeOrder:e=>{Z({order:e},"replaceIn")},tableSettings:{columnOverrides:H,onColumnOverridesChange:U},loading:J!==M,...n}),(0,K.jsx)(p.A,{open:N,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&le(O().difference(ee.map((e=>O().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),V()},columns:ee,hiddenColumnKeys:te})]})};var z=l(26845);const N=(0,I.withDefault)(I.StringParam,"agent-summary"),V=e=>{const{t:t}=(0,C.Bd)(),[l,n]=(0,I.useQueryParam)("tab",N,{updateType:"replace"}),{token:a}=v.A.useToken();return(0,K.jsx)(j.Zu,{activeTabKey:l,onTabChange:e=>n(e),tabList:[{key:"agent-summary",tab:t("webui.menu.AgentSummary")}],children:"agent-summary"===l?(0,K.jsx)(_.Suspense,{fallback:(0,K.jsx)(z.A,{active:!0,style:{padding:a.paddingContentVerticalLG}}),children:(0,K.jsx)(F,{})}):null})}}}]);
//# sourceMappingURL=5276.72cc5523.chunk.js.map