"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[6863],{81838:(e,a,n)=>{n.d(a,{A:()=>p});var t=n(56276),l=n(11863);const i=function(){var e=[{alias:null,args:[{kind:"Literal",name:"is_active",value:!0}],concreteType:"Domain",kind:"LinkedField",name:"domains",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:"domains(is_active:true)"}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DomainSelectorQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DomainSelectorQuery",selections:e},params:{cacheID:"9df762094b74dc3eb8079edfcc73765f",id:null,metadata:{},name:"DomainSelectorQuery",operationKind:"query",text:"query DomainSelectorQuery {\n  domains(is_active: true) {\n    name\n  }\n}\n"}}}();i.hash="c14d362fa40cf9a3cef5d1d71202cc5f";const o=i;var s=n(30782),r=n(47699),u=n.n(r),d=(n(17534),n(62962)),c=n(46336),g=n(89374);const m=["onSelectDomain"],p=e=>{let{onSelectDomain:a}=e,n=(0,l.A)(e,m);const{t:i}=(0,d.Bd)(),{domains:r}=(0,c.useLazyLoadQuery)(o,{},{fetchPolicy:"store-and-network"});return(0,g.jsxs)(s.A,(0,t.A)((0,t.A)({onChange:(e,n)=>{null===a||void 0===a||a(n)},placeholder:i("storageHost.quotaSettings.SelectDomain")},n),{},{children:[u().map(r,(e=>(0,g.jsx)(s.A.Option,{domainName:null===e||void 0===e?void 0:e.name,children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e.name))),";"]}))}},96863:(e,a,n)=>{n.r(a),n.d(a,{default:()=>pe});const t=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"capabilities",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"StorageHostSettingPageQuery",selections:[{alias:null,args:a,concreteType:"StorageVolume",kind:"LinkedField",name:"storage_volume",plural:!1,selections:[n,t,{args:null,kind:"FragmentSpread",name:"StorageHostResourcePanelFragment"},{args:null,kind:"FragmentSpread",name:"StorageHostSettingsPanel_storageVolumeFrgmt"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"StorageHostSettingPageQuery",selections:[{alias:null,args:a,concreteType:"StorageVolume",kind:"LinkedField",name:"storage_volume",plural:!1,selections:[n,t,{alias:null,args:null,kind:"ScalarField",name:"backend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"path",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usage",storageKey:null}],storageKey:null}]},params:{cacheID:"821175f86743d9d81be2a55aca371919",id:null,metadata:{},name:"StorageHostSettingPageQuery",operationKind:"query",text:"query StorageHostSettingPageQuery(\n  $id: String\n) {\n  storage_volume(id: $id) {\n    id\n    capabilities\n    ...StorageHostResourcePanelFragment\n    ...StorageHostSettingsPanel_storageVolumeFrgmt\n  }\n}\n\nfragment StorageHostResourcePanelFragment on StorageVolume {\n  id\n  backend\n  capabilities\n  path\n  usage\n}\n\nfragment StorageHostSettingsPanel_storageVolumeFrgmt on StorageVolume {\n  id\n  capabilities\n}\n"}}}();t.hash="f6e77057e83b0449ef99e8918e794b24";const l=t,i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StorageHostResourcePanelFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backend",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"capabilities",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"path",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usage",storageKey:null}],type:"StorageVolume",abstractKey:null,hash:"30a1b4101eeb2fae45385780dbc0ddcc"},o=i;var s=n(48880),r=n(94824),u=n(25292),d=n(96223),c=n(42338),g=n(47699),m=n.n(g),p=n(62962),_=n(46336),y=n(89374);const S=e=>{var a,n;let{storageVolumeFrgmt:t}=e;const{t:l}=(0,p.Bd)(),i=(0,_.useFragment)(o,t),g=JSON.parse((null===i||void 0===i?void 0:i.usage)||"{}"),S=null===g||void 0===g?void 0:g.used_bytes,k=null===g||void 0===g?void 0:g.capacity_bytes,h={used_bytes:S,capacity_bytes:k,percent:Number((100*(k>0?S/k:0)).toFixed(1))};return(0,y.jsxs)(r.A,{size:"small",bordered:!0,column:3,children:[(0,y.jsxs)(r.A.Item,{label:l("storageHost.Usage"),span:3,children:[(null===h||void 0===h?void 0:h.percent)<100?(0,y.jsx)(u.A,{size:[200,15],percent:null===h||void 0===h?void 0:h.percent,strokeColor:(0,s.yc)(null===h||void 0===h?void 0:h.percent)}):(0,y.jsx)(u.A,{size:[200,15],percent:null===h||void 0===h?void 0:h.percent,status:"exception"}),(0,y.jsxs)(d.A.Text,{type:"secondary",children:[l("storageHost.Used"),":"," "]}),null===(a=(0,s.Gh)(null===h||void 0===h?void 0:h.used_bytes,"auto"))||void 0===a?void 0:a.displayValue,(0,y.jsx)(d.A.Text,{type:"secondary",children:" / "}),(0,y.jsxs)(d.A.Text,{type:"secondary",children:[l("storageHost.Total"),":"," "]}),null===(n=(0,s.Gh)(null===h||void 0===h?void 0:h.capacity_bytes,"auto"))||void 0===n?void 0:n.displayValue]}),(0,y.jsx)(r.A.Item,{label:l("agent.Endpoint"),children:null===i||void 0===i?void 0:i.path}),(0,y.jsx)(r.A.Item,{label:l("agent.BackendType"),children:null===i||void 0===i?void 0:i.backend}),(0,y.jsx)(r.A.Item,{label:l("agent.Capabilities"),children:m().map(null===i||void 0===i?void 0:i.capabilities,(e=>(0,y.jsx)(c.A,{children:e},e)))})]})},k=function(){var e={defaultValue:null,kind:"LocalArgument",name:"quota_scope_id"},a={defaultValue:null,kind:"LocalArgument",name:"skipQuotaScope"},n={defaultValue:null,kind:"LocalArgument",name:"storage_host_name"},t=[{kind:"Variable",name:"quota_scope_id",variableName:"quota_scope_id"},{kind:"Variable",name:"storage_host_name",variableName:"storage_host_name"}];return{fragment:{argumentDefinitions:[e,a,n],kind:"Fragment",metadata:null,name:"StorageHostSettingsPanelQuery",selections:[{condition:"skipQuotaScope",kind:"Condition",passingValue:!1,selections:[{alias:null,args:t,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"QuotaSettingModalFragment"},{args:null,kind:"FragmentSpread",name:"QuotaScopeCardFragment"}],storageKey:null}]}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,n,a],kind:"Operation",name:"StorageHostSettingsPanelQuery",selections:[{condition:"skipQuotaScope",kind:"Condition",passingValue:!1,selections:[{alias:null,args:t,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"quota_scope_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storage_host_name",storageKey:null},{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usage_bytes",storageKey:null}],storageKey:null}],storageKey:null}]}]},params:{cacheID:"378699d92e64ba9559bfbe8e533d6c6a",id:null,metadata:{},name:"StorageHostSettingsPanelQuery",operationKind:"query",text:"query StorageHostSettingsPanelQuery(\n  $quota_scope_id: String!\n  $storage_host_name: String!\n  $skipQuotaScope: Boolean!\n) {\n  quota_scope(storage_host_name: $storage_host_name, quota_scope_id: $quota_scope_id) @skip(if: $skipQuotaScope) {\n    ...QuotaSettingModalFragment\n    ...QuotaScopeCardFragment\n    id\n  }\n}\n\nfragment QuotaScopeCardFragment on QuotaScope {\n  id\n  quota_scope_id\n  storage_host_name\n  details {\n    hard_limit_bytes\n    usage_bytes\n  }\n  ...QuotaSettingModalFragment\n}\n\nfragment QuotaSettingModalFragment on QuotaScope {\n  id\n  quota_scope_id\n  storage_host_name\n  details {\n    hard_limit_bytes\n  }\n}\n"}}}();k.hash="ef16372a7f5bf0c1844a65d4b63fe4d9";const h=k,v={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StorageHostSettingsPanel_storageVolumeFrgmt",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"capabilities",storageKey:null}],type:"StorageVolume",abstractKey:null,hash:"2f9e5e6060806e6f9265e5cbbd325afe"},b=v;var f=n(40690),F=n(81838),A=n(56276),q=n(59991),x=n(76132),K=n(17534);const Q=e=>{let a=Object.assign({},((0,q.A)(e),e));return(0,y.jsx)(x.A,(0,A.A)((0,A.A)({},a),{},{disableDefaultFilter:!0}))},j=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"quota_scope_id"},{defaultValue:null,kind:"LocalArgument",name:"storage_host_name"}],a=[{alias:null,args:[{kind:"Variable",name:"quota_scope_id",variableName:"quota_scope_id"},{kind:"Variable",name:"storage_host_name",variableName:"storage_host_name"}],concreteType:"UnsetQuotaScope",kind:"LinkedField",name:"unset_quota_scope",plural:!1,selections:[{alias:null,args:null,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"quota_scope_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storage_host_name",storageKey:null},{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"QuotaScopeCardUnsetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"QuotaScopeCardUnsetMutation",selections:a},params:{cacheID:"338836966362b14e823520f40fa56a73",id:null,metadata:{},name:"QuotaScopeCardUnsetMutation",operationKind:"mutation",text:"mutation QuotaScopeCardUnsetMutation(\n  $quota_scope_id: String!\n  $storage_host_name: String!\n) {\n  unset_quota_scope(quota_scope_id: $quota_scope_id, storage_host_name: $storage_host_name) {\n    quota_scope {\n      id\n      quota_scope_id\n      storage_host_name\n      details {\n        hard_limit_bytes\n      }\n    }\n  }\n}\n"}}}();j.hash="272001cc642518fb66015dcc367b9f65";const L=j,D={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"QuotaScopeCardFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"quota_scope_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storage_host_name",storageKey:null},{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usage_bytes",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"QuotaSettingModalFragment"}],type:"QuotaScope",abstractKey:null,hash:"78fe420c92ce5b9c8d5c133d1f9c389f"},H=D;var V=n(57586),C=n(1139);const T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"};var w=n(5436),M=function(e,a){return K.createElement(w.A,(0,C.A)({},e,{ref:a,icon:T}))};const I=K.forwardRef(M);var P=n(89866),E=n(76591),U=n(73635),$=n(8343),O=n(8034),B=n(69062),N=n(77402),R=n(67631);const z=e=>{let{quotaScopeFrgmt:a,showAddButtonWhenEmpty:n,onClickEdit:t}=e;const{t:l}=(0,p.Bd)(),{token:i}=E.A.useToken(),o=(0,_.useFragment)(H,a),[r,u]=(0,_.useMutation)(L),d=(0,y.jsx)(U.A,{style:{width:"100%"},image:U.A.PRESENTED_IMAGE_SIMPLE,description:(0,y.jsx)("div",{children:l("storageHost.quotaSettings.SelectFirst")})}),c=(0,y.jsx)(U.A,{style:{width:"100%"},image:U.A.PRESENTED_IMAGE_SIMPLE,description:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:{margin:10},children:l("storageHost.quotaSettings.ClickSettingButton")}),(0,y.jsx)($.Ay,{icon:(0,y.jsx)(V.A,{}),onClick:()=>t&&t(),children:l("storageHost.quotaSettings.AddQuotaConfigs")})]})});return(0,y.jsx)(O.A,{bordered:!0,rowKey:"id",columns:[{title:l("storageHost.quotaSettings.QuotaScopeId"),dataIndex:"quota_scope_id",key:"quota_scope_id",render:e=>(0,y.jsx)("code",{children:e})},{title:l("storageHost.HardLimit")+" (GB)",dataIndex:["details","hard_limit_bytes"],key:"hard_limit_bytes",render:e=>(0,y.jsx)(y.Fragment,{children:(0,s.wb)(e)})},{title:l("storageHost.Usage")+" (GB)",dataIndex:["details","usage_bytes"],key:"usage_bytes",render:e=>(0,y.jsx)(y.Fragment,{children:(0,s.wb)(e)})},{title:l("general.Control"),key:"control",render:()=>(0,y.jsxs)(R.OO,{gap:i.marginSM,children:[(0,y.jsx)($.Ay,{icon:(0,y.jsx)(I,{}),onClick:()=>t&&t(),children:l("button.Edit")}),(0,y.jsx)(B.A,{title:l("storageHost.quotaSettings.UnsetCustomSettings"),description:l("storageHost.quotaSettings.ConfirmUnsetCustomQuota"),placement:"bottom",onConfirm:()=>{o&&r({variables:{quota_scope_id:o.quota_scope_id,storage_host_name:o.storage_host_name},onCompleted(){N.Ay.success(l("storageHost.quotaSettings.QuotaScopeSuccessfullyUpdated"))},onError(e){N.Ay.error(null===e||void 0===e?void 0:e.message)}})},children:(0,y.jsx)($.Ay,{loading:u,danger:!0,icon:(0,y.jsx)(P.A,{}),children:l("button.Unset")})})]})}],dataSource:o?[o]:[],locale:{emptyText:n?c:d},pagination:!1})};var G=n(11863);const W=function(){var e={defaultValue:null,kind:"LocalArgument",name:"props"},a={defaultValue:null,kind:"LocalArgument",name:"quota_scope_id"},n={defaultValue:null,kind:"LocalArgument",name:"storage_host_name"},t=[{alias:null,args:[{kind:"Variable",name:"props",variableName:"props"},{kind:"Variable",name:"quota_scope_id",variableName:"quota_scope_id"},{kind:"Variable",name:"storage_host_name",variableName:"storage_host_name"}],concreteType:"SetQuotaScope",kind:"LinkedField",name:"set_quota_scope",plural:!1,selections:[{alias:null,args:null,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"quota_scope_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storage_host_name",storageKey:null},{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,a,n],kind:"Fragment",metadata:null,name:"QuotaSettingModalSetMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,e],kind:"Operation",name:"QuotaSettingModalSetMutation",selections:t},params:{cacheID:"d337cab9be9523bfde2bfb7d6bed595b",id:null,metadata:{},name:"QuotaSettingModalSetMutation",operationKind:"mutation",text:"mutation QuotaSettingModalSetMutation(\n  $quota_scope_id: String!\n  $storage_host_name: String!\n  $props: QuotaScopeInput!\n) {\n  set_quota_scope(quota_scope_id: $quota_scope_id, storage_host_name: $storage_host_name, props: $props) {\n    quota_scope {\n      id\n      quota_scope_id\n      storage_host_name\n      details {\n        hard_limit_bytes\n      }\n    }\n  }\n}\n"}}}();W.hash="0e8509b3174920c1dd917ece91d41161";const Z=W,J={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"QuotaSettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"quota_scope_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storage_host_name",storageKey:null},{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null}],storageKey:null}],type:"QuotaScope",abstractKey:null,hash:"1c5ad8315a2d78cb376e7436dc6a8627"},X=J;var Y=n(94010),ee=n(90711);const ae=["quotaScopeFrgmt","onRequestClose"],ne=e=>{var a;let{quotaScopeFrgmt:n=null,onRequestClose:t}=e,l=(0,G.A)(e,ae);const{logger:i}=(0,R.Q7)(),{t:o}=(0,p.Bd)(),r=(0,K.useRef)(null),u=(0,_.useFragment)(X,n),[d,c]=(0,_.useMutation)(Z);return(0,y.jsx)(R.Ib,(0,A.A)((0,A.A)({},l),{},{destroyOnHidden:!0,onOk:()=>{var e;null===(e=r.current)||void 0===e||e.validateFields().then((e=>{d({variables:{quota_scope_id:(null===u||void 0===u?void 0:u.quota_scope_id)||"",storage_host_name:(null===u||void 0===u?void 0:u.storage_host_name)||"",props:{hard_limit_bytes:(0,s._S)(null===e||void 0===e?void 0:e.hard_limit_bytes)}},onCompleted(e){var a,n;null!==e&&void 0!==e&&null!==(a=e.set_quota_scope)&&void 0!==a&&null!==(n=a.quota_scope)&&void 0!==n&&n.id?N.Ay.success(o("storageHost.quotaSettings.QuotaScopeSuccessfullyUpdated")):N.Ay.error(o("dialog.ErrorOccurred")),t()},onError(e){i.error(e),N.Ay.error(null===e||void 0===e?void 0:e.message)}})}))},confirmLoading:c,onCancel:t,title:o("storageHost.quotaSettings.QuotaSettings"),children:(0,y.jsx)(Y.A,{ref:r,preserve:!1,labelCol:{span:6},wrapperCol:{span:20},validateTrigger:["onChange","onBlur"],style:{marginBottom:40,marginTop:20},children:(0,y.jsx)(Y.A.Item,{name:"hard_limit_bytes",label:o("storageHost.HardLimit"),initialValue:(0,s.wb)(null===u||void 0===u||null===(a=u.details)||void 0===a?void 0:a.hard_limit_bytes),rules:[{pattern:/^\d+(\.\d+)?$/,message:o("storageHost.quotaSettings.AllowNumberAndDot")||"Allows numbers and .(dot) only"}],children:(0,y.jsx)(ee.A,{addonAfter:"GB",type:"number",step:.25,style:{width:"70%"}})})})}))},te=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},a={defaultValue:null,kind:"LocalArgument",name:"limit"},n={defaultValue:null,kind:"LocalArgument",name:"offset"},t=[{alias:null,args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Literal",name:"is_active",value:!0},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"}],concreteType:"UserList",kind:"LinkedField",name:"user_list",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_active",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,a,n],kind:"Fragment",metadata:null,name:"UserSelectorQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,e],kind:"Operation",name:"UserSelectorQuery",selections:t},params:{cacheID:"f552e13a727e58f49a7a7e49a466d4d2",id:null,metadata:{},name:"UserSelectorQuery",operationKind:"query",text:"query UserSelectorQuery(\n  $limit: Int!\n  $offset: Int!\n  $filter: String\n) {\n  user_list(limit: $limit, offset: $offset, filter: $filter, is_active: true) {\n    items {\n      id\n      is_active\n      email\n      resource_policy\n    }\n  }\n}\n"}}}();te.hash="323d93fb2d8eb4ee2d1d3677121f9ad2";const le=te;var ie=n(30782);const oe=["onSelectUser"],se=e=>{let{onSelectUser:a}=e,n=(0,G.A)(e,oe);const{t:t}=(0,p.Bd)(),[l,i]=(0,K.useState)(""),o=(0,K.useDeferredValue)(l),{user_list:s}=(0,_.useLazyLoadQuery)(le,{limit:150,offset:0,filter:0===(null===o||void 0===o?void 0:o.length)?null:'email ilike "%'+o+'%"'},{fetchPolicy:"store-and-network"});return(0,y.jsx)(ie.A,(0,A.A)({filterOption:!1,searchValue:l,loading:o!==l,onSearch:e=>{i(e)},onChange:e=>{a(m().find(null===s||void 0===s?void 0:s.items,(a=>(null===a||void 0===a?void 0:a.email)===e)))},showSearch:!0,placeholder:t("storageHost.quotaSettings.SelectUser"),options:m().map(null===s||void 0===s?void 0:s.items,(e=>({value:null===e||void 0===e?void 0:e.email,label:null===e||void 0===e?void 0:e.email}))).sort(((e,a)=>e.value&&a.value&&e.value>a.value?1:-1))},n))};var re=n(84423),ue=n(99901),de=n(16952);const ce=e=>{let{storageVolumeFrgmt:a}=e;const{t:n}=(0,p.Bd)(),t=(0,_.useFragment)(b,a),[l,i]=(0,K.useTransition)(),o=(0,f.eZ)(),[r,u]=(0,K.useState)("user"),[d,c]=(0,K.useState)(o),[g,m]=(0,K.useState)();(0,K.useState)();const[S,k]=(0,K.useState)(),[v,A]=(0,K.useState)();(0,K.useState)();const q=(0,s.sZ)(r,("project"===r?g:S)||""),[x,{toggle:j}]=(0,re.A)(!1),[L]=(0,f.Tw)("default"),{quota_scope:D}=(0,_.useLazyLoadQuery)(h,{quota_scope_id:q,skipQuotaScope:void 0===q||""===q,storage_host_name:(null===t||void 0===t?void 0:t.id)||""},{fetchPolicy:"network-only",fetchKey:L});return(0,y.jsx)(R.OO,{direction:"column",align:"stretch",children:(0,y.jsxs)(ue.A,{title:n("storageHost.QuotaSettings"),tabList:[{key:"user",tab:n("storageHost.ForUser")},{key:"project",tab:n("storageHost.ForProject")}],activeTabKey:r,onTabChange:e=>{i((()=>{u(e)}))},children:[(0,y.jsx)(R.OO,{justify:"between",children:"project"===r?(0,y.jsx)(R.OO,{style:{marginBottom:10},children:(0,y.jsxs)(Y.A,{layout:"inline",children:[(0,y.jsx)(Y.A.Item,{label:n("resourceGroup.Domain"),children:(0,y.jsx)(F.A,{style:{width:"20vw",marginRight:10},value:d,onSelectDomain:e=>{i((()=>{c(null===e||void 0===e?void 0:e.domainName),m(void 0)}))}})}),(0,y.jsx)(Y.A.Item,{label:n("webui.menu.Project"),children:(0,y.jsx)(Q,{value:g,disabled:!d,domain:d||"",onSelectProject:e=>{i((()=>{m(null===e||void 0===e?void 0:e.projectId)}))}})})]})}):(0,y.jsx)(Y.A,{layout:"inline",children:(0,y.jsx)(Y.A.Item,{label:n("data.User"),children:(0,y.jsx)(se,{style:{width:"30vw",marginBottom:10},value:v,onSelectUser:e=>{A(null===e||void 0===e?void 0:e.email),i((()=>{k(null===e||void 0===e?void 0:e.id)}))}})})})}),(0,y.jsx)(de.A,{spinning:l,children:(0,y.jsx)(z,{quotaScopeFrgmt:D||null,onClickEdit:()=>{j()},showAddButtonWhenEmpty:"project"===r&&!!g||"user"===r&&!!S})}),(0,y.jsx)(ne,{open:x,quotaScopeFrgmt:D||null,onRequestClose:()=>{j()}})]})})};var ge=n(41732),me=n(40720);const pe=()=>{var e,a;const{hostname:n}=(0,me.g)(),t=(0,f.f0)(),{t:i}=(0,p.Bd)(),{storage_volume:o}=(0,_.useLazyLoadQuery)(l,{id:n||""}),s=null!==(e=null===o||void 0===o||null===(a=o.capabilities)||void 0===a?void 0:a.includes("quota"))&&void 0!==e&&e;return(0,y.jsxs)(R.OO,{direction:"column",align:"stretch",gap:"sm",children:[(0,y.jsx)(ge.A,{items:[{title:i("webui.menu.Resources"),onClick:e=>{e.preventDefault(),t("/agent")},href:"/agent"},{title:i("storageHost.StorageSetting")}]}),(0,y.jsx)(d.A.Title,{level:3,style:{margin:0},children:n||""}),(0,y.jsx)(S,{storageVolumeFrgmt:o||null}),s?(0,y.jsx)(K.Suspense,{fallback:(0,y.jsx)("div",{children:"loading..."}),children:(0,y.jsx)(ce,{storageVolumeFrgmt:o||null})}):(0,y.jsx)(ue.A,{title:i("storageHost.QuotaSettings"),children:(0,y.jsx)(U.A,{image:U.A.PRESENTED_IMAGE_SIMPLE,description:i("storageHost.QuotaDoesNotSupported")})})]})}}}]);
//# sourceMappingURL=6863.1bda8abe.chunk.js.map