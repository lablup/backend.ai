"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[2842],{23623:(e,l,n)=>{n.d(l,{A:()=>a});var t=n(76998);const i=(e,l,n)=>{const[i,a]=(0,t.useState)(e());return(0,t.useEffect)((()=>{n&&a(e())}),[n]),function(e,l){const n=(0,t.useRef)();(0,t.useEffect)((()=>{n.current=e})),(0,t.useEffect)((()=>{if(null!==l){let e=setInterval((function(){var e;null===(e=n.current)||void 0===e||e.call(n)}),l);return()=>clearInterval(e)}}),[l])}((()=>{const l=e();l!==i&&a(l)}),l),i},a=e=>{let{callback:l,delay:n,triggerKey:t}=e;return i(l,n,t)}},7075:(e,l,n)=>{n.d(l,{A:()=>d});var t=n(29871),i=n(50840),a=n(97080),o=n(45901),r=n.n(o),s=(n(76998),n(23446));const d=e=>{let{title:l,valueLabel:n,percent:o=0,width:d,strokeColor:u,labelStyle:c,size:g="small"}=e;const{token:v}=i.A.useToken(),p="small"===g?v.fontSizeSM:"middle"===g?v.fontSize:v.fontSizeLG;return(0,s.jsxs)(t.A,{style:{padding:1,border:"1px solid ".concat(v.colorBorder),borderRadius:3,backgroundColor:v.colorBgContainerDisabled,...r().isNumber(d)||r().isString(d)?{width:d}:{flex:1}},direction:"column",align:"stretch",children:[(0,s.jsx)(t.A,{style:{height:"100%",width:"".concat(o,"%"),position:"absolute",left:0,top:0,backgroundColor:null!==u&&void 0!==u?u:v.colorSuccess,opacity:.7,zIndex:0,overflow:"hidden"}}),(0,s.jsxs)(t.A,{direction:"row",justify:"between",children:[(0,s.jsx)(a.A.Text,{style:{fontSize:p,...c},children:l}),(0,s.jsx)(a.A.Text,{style:{fontSize:p,...c},children:n})]})]})}},5621:(e,l,n)=>{n.d(l,{A:()=>d});var t=n(29871),i=n(48713),a=n(45901),o=n.n(a),r=n(76998),s=n(23446);const d=e=>{let l,{values:n=[]}=e;return 0===n.length?null:(l=n[0]&&("string"===typeof n[0]||r.isValidElement(n[0]))?n.map((e=>({label:e,color:"blue"}))):n,(0,s.jsx)(t.A,{direction:"row",children:o().map(l,((e,n)=>(0,s.jsx)(i.A,{style:o().last(l)===e?void 0:{margin:0,marginRight:-1},color:e.color,children:e.label},n)))}))}},8469:(e,l,n)=>{n.d(l,{Ay:()=>m,s5:()=>p,uJ:()=>g});var t=n(30032),i=n(16162),a=n(96495),o=n(29871),r=n(50840),s=n(97080),d=n(20307),u=(n(76998),n(77678)),c=n(23446);const g={"cuda.device":"GPU","cuda.shares":"FGPU","rocm.device":"GPU","tpu.device":"TPU","ipu.device":"IPU","atom.device":"ATOM","atom-plus.device":"ATOM+","warboy.device":"Warboy","hyperaccel-lpu.device":"Hyperaccel LPU"},v=e=>{let{size:l=16,children:n}=e;return(0,c.jsx)("mwc-icon",{style:{"--mdc-icon-size":"".concat(l+2,"px"),width:l,height:l},children:n})},p=e=>{var l,n,t;let{type:i,size:a=16,showIcon:r=!0,showUnit:s=!0,showTooltip:g=!0,...p}=e;const{t:m}=(0,u.Bd)(),y={cpu:[(0,c.jsx)(v,{size:a,children:"developer_board"}),m("session.core")],mem:[(0,c.jsx)(v,{size:a,children:"memory"}),"GiB"],"cuda.device":["/resources/icons/file_type_cuda.svg","GPU"],"cuda.shares":["/resources/icons/file_type_cuda.svg","FGPU"],"rocm.device":["/resources/icons/rocm.svg","GPU"],"tpu.device":[(0,c.jsx)(v,{size:a,children:"view_module"}),"TPU"],"ipu.device":[(0,c.jsx)(v,{size:a,children:"view_module"}),"IPU"],"atom.device":["/resources/icons/rebel.svg","ATOM"],"atom-plus.device":["/resources/icons/rebel.svg","ATOM"],"warboy.device":["/resources/icons/furiosa.svg","Warboy"],"hyperaccel-lpu.device":["/resources/icons/npu_generic.svg","Hyperaccel LPU"]},x="string"===typeof(null===(l=y[i])||void 0===l?void 0:l[0])?(0,c.jsx)("img",{...p,style:{height:a,alignSelf:"center",...p.style||{}},src:(null===(n=y[i])||void 0===n?void 0:n[0])||"",alt:i}):(0,c.jsx)(o.A,{style:{width:16,height:16},children:(null===(t=y[i])||void 0===t?void 0:t[0])||i});return g?(0,c.jsx)(d.A,{title:i,children:x}):(0,c.jsx)(o.A,{style:{pointerEvents:"none"},children:x})},m=e=>{var l,n,d,u,g;let{type:v,value:m,extra:y,opts:x,hideTooltip:h=!1}=e;const{token:A}=r.A.useToken(),b=(0,a.Nw)(),[f]=(0,i.Hv)(b||void 0);return(0,c.jsxs)(o.A,{direction:"row",gap:"xxs",children:[null!==f&&void 0!==f&&f[v]?(0,c.jsx)(p,{type:v,showTooltip:!h}):v,(0,c.jsx)(s.A.Text,{children:null!==f&&void 0!==f&&null!==(l=f[v])&&void 0!==l&&l.number_format.binary?Number(null===(n=(0,t.Js)(m,"g",3,!0))||void 0===n?void 0:n.numberFixed).toString():((null===f||void 0===f||null===(d=f[v])||void 0===d?void 0:d.number_format.round_length)||0)>0?parseFloat(m).toFixed(2):m}),(0,c.jsx)(s.A.Text,{type:"secondary",children:(null===f||void 0===f||null===(u=f[v])||void 0===u?void 0:u.display_unit)||""}),"mem"===v&&null!==x&&void 0!==x&&x.shmem&&(null===x||void 0===x?void 0:x.shmem)>0?(0,c.jsxs)(s.A.Text,{type:"secondary",style:{fontSize:A.fontSizeSM},children:["(SHM: ",null===(g=(0,t.Js)(x.shmem+"b","g",2,!0))||void 0===g?void 0:g.numberFixed,"GiB)"]}):null,y]})}},34680:(e,l,n)=>{n.d(l,{A:()=>p});var t=n(34103),i=n(83786),a=n(50840),o=n(7121),r=n(63284),s=n(87627),d=n(45901),u=n.n(d),c=n(76998),g=n(77678),v=n(23446);const p=e=>{let{open:l,onRequestClose:n,columns:d,displayedColumnKeys:p,...m}=e;const y=(0,c.useRef)(null),{t:x}=(0,g.Bd)(),{token:h}=a.A.useToken(),A=d.map((e=>{return"string"===typeof e.title?{label:e.title,value:u().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(l=e.title,c.Children.map(l.props.children,(e=>{if("string"===typeof e)return e}))),value:u().toString(e.key)}:{label:void 0,value:u().toString(e.key)};var l}));return(0,v.jsx)(t.A,{title:x("table.SettingTable"),open:l,destroyOnClose:!0,centered:!0,onOk:()=>{var e;null===(e=y.current)||void 0===e||e.validateFields().then((e=>{n(e)})).catch((()=>{}))},onCancel:()=>{n()},...m,children:(0,v.jsxs)(o.A,{ref:y,preserve:!1,initialValues:{selectedColumnKeys:p||A.map((e=>e.value))},layout:"vertical",children:[(0,v.jsx)(o.A.Item,{name:"searchInput",label:x("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,v.jsx)(r.A,{prefix:(0,v.jsx)(i.A,{}),style:{marginBottom:h.marginSM},placeholder:x("table.SearchTableColumn")})}),(0,v.jsx)(o.A.Item,{noStyle:!0,shouldUpdate:(e,l)=>e.searchInput!==l.searchInput,children:e=>{let{getFieldValue:l}=e;const n=l("searchInput")?u().toLower(l("searchInput")):void 0,t=A.map((e=>u().toLower(u().toString(e.label)).includes(n||"")?e:{...e,style:{display:"none"}}));return(0,v.jsx)(o.A.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},children:(0,v.jsx)(s.A.Group,{options:t,style:{flexDirection:"column"}})})}})]})})}},53234:(e,l,n)=>{n.r(l),n.d(l,{default:()=>i});const t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AgentDetailModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"live_stat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"available_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"occupied_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cpu_cur_pct",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mem_cur_bytes",storageKey:null}],type:"Agent",abstractKey:null,hash:"cb343a0290034803cca4c2b82a1c1b68"},i=t},80508:(e,l,n)=>{n.r(l),n.d(l,{default:()=>i});const t=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},l={defaultValue:null,kind:"LocalArgument",name:"limit"},n={defaultValue:null,kind:"LocalArgument",name:"offset"},t={defaultValue:null,kind:"LocalArgument",name:"order"},i={defaultValue:null,kind:"LocalArgument",name:"status"},a=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"order",variableName:"order"},{kind:"Variable",name:"status",variableName:"status"}],o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"addr",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"region",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"compute_plugins",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"first_contact",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"lost_at",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"status_changed",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"live_stat",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"cpu_cur_pct",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"mem_cur_bytes",storageKey:null},A={alias:null,args:null,kind:"ScalarField",name:"available_slots",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"occupied_slots",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"scaling_group",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"schedulable",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null};return{fragment:{argumentDefinitions:[e,l,n,t,i],kind:"Fragment",metadata:null,name:"AgentListQuery",selections:[{alias:null,args:a,concreteType:"AgentList",kind:"LinkedField",name:"agent_list",plural:!1,selections:[{alias:null,args:null,concreteType:"Agent",kind:"LinkedField",name:"items",plural:!0,selections:[o,r,s,d,u,c,g,v,p,m,y,x,h,A,b,f,j,{args:null,kind:"FragmentSpread",name:"AgentDetailModalFragment"},{args:null,kind:"FragmentSpread",name:"AgentSettingModalFragment"}],storageKey:null},_],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,n,e,i,t],kind:"Operation",name:"AgentListQuery",selections:[{alias:null,args:a,concreteType:"AgentList",kind:"LinkedField",name:"agent_list",plural:!1,selections:[{alias:null,args:null,concreteType:"Agent",kind:"LinkedField",name:"items",plural:!0,selections:[o,r,s,d,u,c,g,v,p,m,y,x,h,A,b,f,j],storageKey:null},_],storageKey:null}]},params:{cacheID:"e1a551c0261ce59a4b187a3bbb29b86b",id:null,metadata:{},name:"AgentListQuery",operationKind:"query",text:"query AgentListQuery(\n  $limit: Int!\n  $offset: Int!\n  $filter: String\n  $status: String\n  $order: String\n) {\n  agent_list(limit: $limit, offset: $offset, filter: $filter, status: $status, order: $order) {\n    items {\n      id\n      status\n      version\n      addr\n      architecture\n      region\n      compute_plugins\n      first_contact\n      lost_at\n      status_changed\n      live_stat\n      cpu_cur_pct\n      mem_cur_bytes\n      available_slots\n      occupied_slots\n      scaling_group\n      schedulable\n      ...AgentDetailModalFragment\n      ...AgentSettingModalFragment\n    }\n    total_count\n  }\n}\n\nfragment AgentDetailModalFragment on Agent {\n  id\n  live_stat\n  available_slots\n  occupied_slots\n  cpu_cur_pct\n  mem_cur_bytes\n}\n\nfragment AgentSettingModalFragment on Agent {\n  id\n  schedulable\n}\n"}}}();t.hash="1d6c6a390aad71e4b7815a623ca61d86";const i=t},81157:(e,l,n)=>{n.r(l),n.d(l,{default:()=>i});const t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AgentSettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"schedulable",storageKey:null}],type:"Agent",abstractKey:null,hash:"303f8ee06508c3b28511ab1a24a305d5"},i=t},69130:(e,l,n)=>{n.r(l),n.d(l,{default:()=>i});const t=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"props"}],l=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"id"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyAgent",kind:"LinkedField",name:"modify_agent",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"AgentSettingModalMutation",selections:l,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"AgentSettingModalMutation",selections:l},params:{cacheID:"1a9e43d4bc6e78f3949d1a2a397ff00e",id:null,metadata:{},name:"AgentSettingModalMutation",operationKind:"mutation",text:"mutation AgentSettingModalMutation(\n  $id: String!\n  $props: ModifyAgentInput!\n) {\n  modify_agent(id: $id, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();t.hash="13b2a6a91c7f08bbced5fde155ded60e";const i=t},52842:(e,l,n)=>{n.r(l),n.d(l,{default:()=>te});var t=n(30032),i=n(83468),a=n(16162),o=n(45901),r=n.n(o),s=n(76998),d=n(3606),u=n(58346);var c,g=n(90660),v=n(34103),p=n(7075),m=n(29871),y=n(50840),x=n(7518),h=n(9788),A=n(97080),b=n(77678),f=n(23446);const j=e=>{var l,i,o,s,u,g,j,_,S,k,F,T,w,L,C,K,z;let{agentDetailModalFrgmt:I=null,onRequestClose:M,...P}=e;const{t:D}=(0,b.Bd)(),{token:O}=y.A.useToken(),[N]=(0,a.Hv)(),U=(0,d.useFragment)(void 0!==c?c:c=n(53234),I),V=JSON.parse((null===U||void 0===U?void 0:U.live_stat)||"{}"),B=JSON.parse((null===U||void 0===U?void 0:U.available_slots)||"{}");return(0,f.jsx)(v.A,{...P,styles:{body:{padding:0}},centered:!0,title:"".concat(D("agent.DetailedInformation"),": ").concat(null===U||void 0===U?void 0:U.id),onCancel:M,destroyOnClose:!0,footer:null,children:(0,f.jsxs)(m.A,{direction:"column",align:"stretch",gap:"md",children:[(0,f.jsxs)(x.A,{gutter:[24,24],children:[(0,f.jsx)(h.A,{xs:24,sm:12,children:null!==V&&void 0!==V&&null!==(l=V.devices)&&void 0!==l&&l.cpu_util?(0,f.jsxs)(m.A,{direction:"column",gap:"xxs",align:"stretch",children:[(0,f.jsx)(A.A.Title,{level:5,style:{marginTop:0},children:null===N||void 0===N||null===(i=N.cpu)||void 0===i?void 0:i.human_readable_name}),r().map(null===V||void 0===V||null===(o=V.devices)||void 0===o?void 0:o.cpu_util,((e,l)=>{var n;return(0,f.jsxs)(m.A,{justify:"between",children:[(0,f.jsxs)(A.A.Text,{type:"secondary",style:{flex:.5},children:[null===N||void 0===N||null===(n=N.cpu)||void 0===n?void 0:n.human_readable_name,l]},l),(0,f.jsx)(p.A,{percent:null===e||void 0===e?void 0:e.pct,valueLabel:(null===e||void 0===e?void 0:e.pct)+"%"})]})}))]}):null}),(0,f.jsxs)(h.A,{xs:24,sm:12,children:[null!==B&&void 0!==B&&B.mem?(0,f.jsxs)(m.A,{direction:"column",gap:"xxs",align:"stretch",children:[(0,f.jsx)(A.A.Title,{level:5,style:{marginTop:0},children:null===N||void 0===N||null===(s=N.mem)||void 0===s?void 0:s.human_readable_name}),(0,f.jsx)(p.A,{percent:null!==(u=(null!==(g=null===(j=(0,t.Js)(r().toString(null===U||void 0===U?void 0:U.mem_cur_bytes),"g"))||void 0===j?void 0:j.number)&&void 0!==g?g:0)/(null!==(_=null===(S=(0,t.Js)(null===B||void 0===B?void 0:B.mem,"g"))||void 0===S?void 0:S.number)&&void 0!==_?_:0)*100)&&void 0!==u?u:0,valueLabel:"".concat(null===(k=(0,t.Js)(r().toString(null===U||void 0===U?void 0:U.mem_cur_bytes),"g"))||void 0===k?void 0:k.numberUnit,"iB / ").concat(null===(F=(0,t.Js)(null===B||void 0===B?void 0:B.mem,"g"))||void 0===F?void 0:F.numberUnit,"iB")})]}):null,null!==V&&void 0!==V&&V.node?(0,f.jsxs)(m.A,{direction:"column",gap:"xxs",align:"start",children:[(0,f.jsx)(A.A.Title,{level:5,style:{marginTop:0},children:D("session.launcher.Network")}),(0,f.jsxs)(m.A,{gap:"xl",children:[(0,f.jsx)(A.A.Text,{children:"TX:"}),(0,f.jsxs)(A.A.Text,{children:[null===(T=(0,t.Js)(null===V||void 0===V||null===(w=V.node)||void 0===w||null===(L=w.net_tx)||void 0===L?void 0:L.current,"m",1))||void 0===T?void 0:T.numberUnit,"iB"]})]}),(0,f.jsxs)(m.A,{gap:"xl",children:[(0,f.jsx)(A.A.Text,{children:"RX:"}),(0,f.jsxs)(A.A.Text,{children:[null===(C=(0,t.Js)(null===V||void 0===V||null===(K=V.node)||void 0===K||null===(z=K.net_rx)||void 0===z?void 0:z.current,"m",1))||void 0===C?void 0:C.numberUnit,"iB"]})]})]}):null]})]}),(0,f.jsx)(x.A,{gutter:[24,24],style:{marginBottom:O.marginSM},children:r().map(r().keys(null===V||void 0===V?void 0:V.devices),(e=>{if(["cpu_util","mem","disk","net_rx","net_tx"].includes(e))return null;if(r().includes(e,"_util")){var l;const n=r().split(e,"_")[0]+".device";return(0,f.jsx)(h.A,{xs:24,sm:12,children:(0,f.jsxs)(m.A,{direction:"column",gap:"xxs",align:"stretch",children:[(0,f.jsxs)(A.A.Title,{level:5,style:{marginTop:0},children:[null===N||void 0===N||null===(l=N[n])||void 0===l?void 0:l.human_readable_name," ",D("session.Utilization")]}),r().map(r().toPairs(null===V||void 0===V?void 0:V.devices[e]),((e,l)=>{var t,i,a;return(0,f.jsxs)(m.A,{justify:"between",children:[(0,f.jsxs)(A.A.Text,{type:"secondary",style:{flex:.5},children:[null===N||void 0===N||null===(t=N[n])||void 0===t?void 0:t.human_readable_name,l]},l),(0,f.jsx)(p.A,{percent:r().toFinite(null===e||void 0===e||null===(i=e[1])||void 0===i?void 0:i.pct),valueLabel:(null===e||void 0===e||null===(a=e[1])||void 0===a?void 0:a.pct)+"%"})]})}))]})})}if(r().includes(e,"_mem")){var n;const l=r().split(e,"_")[0]+".device";return(0,f.jsx)(h.A,{xs:24,sm:12,children:(0,f.jsxs)(m.A,{direction:"column",gap:"xxs",align:"stretch",children:[(0,f.jsxs)(A.A.Title,{level:5,style:{marginTop:0},children:[null===N||void 0===N||null===(n=N[l])||void 0===n?void 0:n.human_readable_name," ",D("session.launcher.Memory")]}),r().map(r().toPairs(null===V||void 0===V?void 0:V.devices[e]),((e,n)=>{var t,i,a;return(0,f.jsxs)(m.A,{justify:"between",children:[(0,f.jsxs)(A.A.Text,{type:"secondary",style:{flex:.5},children:[null===N||void 0===N||null===(t=N[l])||void 0===t?void 0:t.human_readable_name,n]},n),(0,f.jsx)(p.A,{percent:r().toFinite(null===e||void 0===e||null===(i=e[1])||void 0===i?void 0:i.pct),valueLabel:(null===e||void 0===e||null===(a=e[1])||void 0===a?void 0:a.pct)+"%"})]})}))]})})}}))})]})})};var _,S,k=n(78969),F=n(7121),T=n(82745);const w=e=>{let{agentSettingModalFrgmt:l=null,onRequestClose:t,...i}=e;const{t:a}=(0,b.Bd)(),{message:o}=k.A.useApp(),r=(0,s.useRef)(null),u=(0,d.useFragment)(void 0!==_?_:_=n(81157),l),[c,g]=(0,d.useMutation)(void 0!==S?S:S=n(69130));return(0,f.jsx)(v.A,{...i,title:"".concat(a("agent.AgentSetting"),": ").concat(null===u||void 0===u?void 0:u.id),onCancel:()=>t(),destroyOnClose:!0,width:300,confirmLoading:g,onOk:()=>{var e;null===(e=r.current)||void 0===e||e.validateFields().then((e=>{c({variables:{id:(null===u||void 0===u?void 0:u.id)||"",props:{schedulable:e.schedulable}},onCompleted(e,l){var n,i;null===e||void 0===e||null===(n=e.modify_agent)||void 0===n||!n.ok||l?(o.error(null===e||void 0===e||null===(i=e.modify_agent)||void 0===i?void 0:i.msg),t()):(o.success(a("agent.AgentSettingUpdated")),t(!0))},onError(e){o.error(null===e||void 0===e?void 0:e.message)}})})).catch((()=>{}))},children:(0,f.jsx)(F.A,{ref:r,preserve:!1,initialValues:{...u},children:(0,f.jsx)(F.A.Item,{name:"schedulable",label:a("agent.Schedulable"),valuePropName:"checked",children:(0,f.jsx)(T.A,{})})})})};var L=n(23623),C=n(91353),K=n(66464),z=n(10840),I=n(63284),M=n(78074),P=n(48713),D=n(20307),O=n(6932);const N=e=>{let{filterProperties:l,value:n,onChange:t,defaultValue:i,...a}=e;const[o,d]=(0,K.A)({}),[u,c]=(0,K.A)({value:n,defaultValue:i,onChange:t}),g=(0,s.useMemo)((()=>{if(void 0===u)return[];return u.split("&").map((e=>e.trim())).map((e=>{var n;const{property:t,operator:i,value:a}=function(e){const[l,...n]=e.split(/\s+(?=(?:(?:[^"]*"){2})*[^"]*$)/),[t,...i]=n.join(" ").split(/\s+(?=(?:(?:[^"]*"){2})*[^"]*$)/);return{property:l,operator:t,value:i.join(" ").replace(/^"|"$/g,"")}}(e);return{property:t,operator:i,value:a,propertyLabel:(null===(n=r().find(l,(e=>e.key===t)))||void 0===n?void 0:n.propertyLabel)||t}}))}),[u,l]),{t:v}=(0,b.Bd)(),p=r().map(l,(e=>({label:e.propertyLabel,value:e.key,filter:e}))),[x,h]=(0,s.useState)(p[0].filter),{list:A,remove:j,push:_,resetList:S,getKey:k}=(0,z.A)(g),{token:F}=y.A.useToken();return(0,s.useEffect)((()=>{0===A.length?c(void 0):c(r().map(A,(e=>"".concat(e.property," ").concat(e.operator,' "').concat(e.value,'"'))).join(" & "))}),[A,c]),(0,f.jsxs)(m.A,{direction:"column",gap:"xs",style:{flex:1},align:"start",children:[(0,f.jsx)(m.A,{children:(0,f.jsx)(I.A.Search,{addonBefore:(0,f.jsx)(M.A,{popupMatchSelectWidth:!1,options:p,value:x.key,onChange:(e,l)=>{h(r().castArray(l)[0].filter)}}),style:{minWidth:250},onSearch:e=>{if(r().isEmpty(e))return;d("");const l=x.defaultOperator||"ilike",n="ilike"===l||"like"===l?"%".concat(e,"%"):"".concat(e);_({property:x.key,propertyLabel:x.propertyLabel,operator:l,value:n})},allowClear:!0,placeholder:v("propertyFilter.placeHolder"),value:o,onChange:e=>d(e.target.value),...a})}),A.length>0&&(0,f.jsxs)(m.A,{direction:"row",gap:"xs",wrap:"wrap",style:{alignSelf:"stretch"},children:[r().map(A,((e,l)=>{return(0,f.jsxs)(P.A,{closable:!0,onClose:()=>{j(l)},style:{margin:0},children:[e.propertyLabel,": ",(n=e.value,n.replace(/^%|%$/g,""))]},k(l));var n})),A.length>1&&(0,f.jsx)(D.A,{title:v("propertyFilter.ResetFilter"),children:(0,f.jsx)(O.Ay,{size:"small",icon:(0,f.jsx)(C.A,{style:{color:F.colorTextSecondary}}),type:"text",onClick:()=>{S([])}})})]})]})};var U,V=n(5621),B=n(8469),E=n(34680),R=n(8461),J=n(94080),G=n(2292),$=n(63718),W=n(94519),X=n(43336),q=n(44355),H=n(99641),Q=n(94120),Y=n(14455),Z=n.n(Y);const ee=e=>{let{containerStyle:l,tableProps:o}=e;const{t:u}=(0,b.Bd)(),{token:c}=y.A.useToken(),{isDarkMode:v}=(0,g.e)(),[x]=(0,a.Hv)(),[h,_]=(0,s.useState)(),[S,k]=(0,s.useState)(),[F,T]=(0,s.useState)(!1),C=(0,i.CX)(),[K,z]=(0,s.useTransition)(),[I,M]=(0,s.useTransition)(),[Y,ee]=(0,s.useTransition)(),[le,ne]=(0,s.useState)("ALIVE"),[te,ie]=(0,s.useState)(le),[ae,oe]=(0,s.useTransition)(),[re,se]=(0,s.useState)(),{baiPaginationOption:de,tablePaginationOption:ue,setTablePaginationOption:ce}=(e=>{const[l,n]=(0,s.useState)(e);return{baiPaginationOption:{limit:l.pageSize,offset:l.current>1?(l.current-1)*l.pageSize:0},tablePaginationOption:{pageSize:l.pageSize,current:l.current},setTablePaginationOption:e=>{n((l=>({...l,...e})))}}})({current:1,pageSize:20}),[ge,ve]=(0,s.useState)(),[pe,me]=(0,i.Tw)("first"),[ye]=(0,s.useState)("network-only"),xe=()=>M((()=>{me()})),{agent_list:he}=(0,d.useLazyLoadQuery)(void 0!==U?U:U=n(80508),{limit:de.limit,offset:de.offset,filter:re,order:ge,status:le},{fetchKey:pe,fetchPolicy:ye}),Ae=[{title:"#",fixed:"left",render:(e,l,n)=>n+1+(ue.current-1)*ue.pageSize,showSorterTooltip:!1,rowScope:"row"},{title:"ID / ".concat(u("agent.Endpoint")),key:"id",dataIndex:"id",fixed:"left",render:(e,l)=>(0,f.jsxs)(m.A,{direction:"column",align:"start",children:[(0,f.jsx)(A.A.Text,{children:e}),(0,f.jsx)(A.A.Text,{type:"secondary",children:null===l||void 0===l?void 0:l.addr})]}),sorter:!0},{title:u("agent.Region"),key:"region",dataIndex:"region",render:e=>{const l=r().split(e,"/"),n=null===l||void 0===l?void 0:l[0],t=(null===l||void 0===l?void 0:l.length)>1?l[1]:"",{color:i,icon:a}={aws:{color:"orange",icon:"aws"},amazon:{color:"orange",icon:"aws"},azure:{color:"blue",icon:"azure"},gcp:{color:"lightblue",icon:"gcp"},google:{color:"lightblue",icon:"gcp"},nbp:{color:"green",icon:"nbp"},naver:{color:"green",icon:"nbp"},openstack:{color:"red",icon:"openstack"},dgx:{color:"green",icon:"local"},local:{color:"yellow",icon:"local"}}[n]||{color:"yellow",icon:"local"};return(0,f.jsxs)(m.A,{gap:"xxs",children:[(0,f.jsx)("img",{alt:e,src:"/resources/icons/".concat(a,".png"),style:{width:"32px",height:"32px",filter:v&&"local"===a?"invert(1)":""}}),""!==t?(0,f.jsx)(V.A,{values:[{label:t,color:i},{label:n,color:i}]}):(0,f.jsx)(P.A,{color:i,children:n})]})}},{title:u("agent.Architecture"),key:"architecture",dataIndex:"architecture"},{title:u("agent.Starts"),key:"first_contact",dataIndex:"first_contact",render:e=>(0,f.jsxs)(m.A,{direction:"column",children:[(0,f.jsx)(A.A.Text,{children:Z()(e).format("ll LTS")}),(0,f.jsx)(V.A,{values:[u("agent.Running"),(0,f.jsx)(L.A,{callback:()=>C.utils.elapsedTime(e,Date.now()),delay:1e3})]})]}),sorter:!0},{title:u("agent.Allocation"),key:"allocation",render:(e,l)=>{const n=JSON.parse((null===l||void 0===l?void 0:l.occupied_slots)||"{}"),i=JSON.parse((null===l||void 0===l?void 0:l.available_slots)||"{}");return(0,f.jsx)(m.A,{direction:"column",gap:"xxs",children:r().map(r().keys(i),(e=>{var l,a,o,s,d,u,g,v,y,h;return"cpu"===e?(0,f.jsxs)(m.A,{justify:"between",style:{minWidth:220},children:[(0,f.jsxs)(m.A,{gap:"xxs",children:[(0,f.jsx)(B.s5,{type:e},e),(0,f.jsxs)(A.A.Text,{children:[null!==(l=n[e])&&void 0!==l?l:0,"/",null!==(a=i[e])&&void 0!==a?a:0]}),(0,f.jsx)(A.A.Text,{type:"secondary",style:{fontSize:c.sizeXS},children:null===x||void 0===x||null===(o=x.cpu)||void 0===o?void 0:o.display_unit})]}),(0,f.jsx)(p.A,{percent:n[e]/i[e]*100,strokeColor:n[e]/i[e]*100>80?c.colorError:c.colorSuccess,width:120,valueLabel:r().toFinite(n[e]/i[e]*100).toFixed(2)+" %"})]},e):"mem"===e?(0,f.jsxs)(m.A,{justify:"between",style:{minWidth:220},children:[(0,f.jsxs)(m.A,{gap:"xxs",children:[(0,f.jsx)(B.s5,{type:e},e),(0,f.jsxs)(A.A.Text,{children:[null!==(s=null===(d=(0,t.Js)(n[e],"g",0))||void 0===d?void 0:d.numberFixed)&&void 0!==s?s:0,"/",null!==(u=null===(g=(0,t.Js)(i[e],"g",0))||void 0===g?void 0:g.numberFixed)&&void 0!==u?u:0]}),(0,f.jsx)(A.A.Text,{type:"secondary",style:{fontSize:c.sizeXS},children:"GiB"})]}),(0,f.jsx)(p.A,{percent:n[e]/i[e]*100,strokeColor:n[e]/i[e]*100>80?c.colorError:c.colorSuccess,width:120,valueLabel:r().toFinite(n[e]/i[e]*100).toFixed(2)+" %"})]},e):n[e]&&i[e]?(0,f.jsxs)(m.A,{justify:"between",style:{minWidth:220},children:[(0,f.jsxs)(m.A,{gap:"xxs",children:[(0,f.jsx)(B.s5,{type:e},e),(0,f.jsxs)(A.A.Text,{children:[null!==(v=n[e])&&void 0!==v?v:0,"/",null!==(y=i[e])&&void 0!==y?y:0]}),(0,f.jsx)(A.A.Text,{type:"secondary",style:{fontSize:c.sizeXS},children:null===x||void 0===x||null===(h=x[e])||void 0===h?void 0:h.display_unit})]}),(0,f.jsx)(p.A,{percent:n[e]/i[e]*100,strokeColor:n[e]/i[e]*100>80?c.colorError:c.colorSuccess,width:120,valueLabel:r().toFinite(n[e]/i[e]*100).toFixed(2)+" %"})]},e):void 0}))})}},{title:u("agent.Utilization"),key:"live_stat",dataIndex:"live_stat",render:(e,l)=>{const n=JSON.parse(e||"{}");if("ALIVE"===(null===l||void 0===l?void 0:l.status)){var i,a,o,s;const e={cpu_util:{capacity:0,current:0,ratio:0},mem_util:{capacity:0,current:0,ratio:0}};if(n&&n.node&&n.devices){const l=r().keys(n.devices.cpu_util).length;e.cpu_util.capacity=r().toFinite(n.node.cpu_util.capacity),e.cpu_util.current=r().toFinite(n.node.cpu_util.current),e.cpu_util.ratio=e.cpu_util.current/e.cpu_util.capacity/l*100||0,e.mem_util.capacity=r().toInteger(n.node.mem.capacity),e.mem_util.current=r().toInteger(n.node.mem.current),e.mem_util.ratio=e.mem_util.current/e.mem_util.capacity*100||0}return r().forEach(r().keys(null===n||void 0===n?void 0:n.node),(l=>{["cpu_util","mem","disk","net_rx","net_tx"].includes(l)||(r().includes(l,"_util")?e[l]={capacity:"cuda_util"===l?r().toFinite(n.node[l]["stats.max"]):r().toFinite(n.node[l].capacity),current:r().toFinite(n.node[l].current),ratio:r().toFinite(n.node[l].current)/100||0}:l.includes("_mem")&&(e[l]={capacity:r().toFinite(n.node[l].capacity),current:r().toFinite(n.node[l].current),ratio:r().toFinite(n.node[l].pct)/100||0}))})),(0,f.jsxs)(m.A,{direction:"column",gap:"xxs",children:[(0,f.jsxs)(m.A,{justify:"between",style:{minWidth:200},children:[(0,f.jsx)(A.A.Text,{children:null===x||void 0===x||null===(i=x.cpu)||void 0===i?void 0:i.human_readable_name}),(0,f.jsx)(p.A,{percent:e.cpu_util.ratio,width:120,valueLabel:r().toFinite(e.cpu_util.ratio.toFixed(1))+" %"})]}),(0,f.jsxs)(m.A,{justify:"between",style:{minWidth:200},children:[(0,f.jsx)(A.A.Text,{children:null===x||void 0===x||null===(a=x.mem)||void 0===a?void 0:a.human_readable_name}),(0,f.jsx)(p.A,{percent:e.mem_util.ratio,width:120,valueLabel:(null===(o=(0,t.Js)(r().toString(e.mem_util.current),"g"))||void 0===o?void 0:o.numberFixed)+"/"+(null===(s=(0,t.Js)(r().toString(e.mem_util.capacity),"g"))||void 0===s?void 0:s.numberFixed)+" GiB"})]}),r().map(r().keys(null===n||void 0===n?void 0:n.node),(l=>{if(!["cpu_util","mem"].includes(l)){if(r().includes(l,"_util")){var n;const t=r().split(l,"_")[0]+".device";return(0,f.jsxs)(m.A,{justify:"between",style:{minWidth:200,width:"min-content"},gap:"xxs",children:[(0,f.jsxs)(A.A.Text,{children:[null===x||void 0===x||null===(n=x[t])||void 0===n?void 0:n.human_readable_name,"(util)"]}),(0,f.jsx)(p.A,{width:120,percent:e[l].ratio,valueLabel:r().toFinite(e[l].ratio.toFixed(1))+" %"})]})}if(r().includes(l,"_mem")){var i,a,o;const n=r().split(l,"_")[0]+".device";return(0,f.jsxs)(m.A,{justify:"between",style:{minWidth:200,width:"min-content"},gap:"xxs",children:[(0,f.jsxs)(A.A.Text,{children:[null===x||void 0===x||null===(i=x[n])||void 0===i?void 0:i.human_readable_name,"(mem)"]}),(0,f.jsx)(p.A,{width:120,percent:e[l].ratio,valueLabel:(null===(a=(0,t.Js)(r().toString(e[l].current),"g"))||void 0===a?void 0:a.numberFixed)+"/"+(null===(o=(0,t.Js)(r().toString(e[l].capacity),"g"))||void 0===o?void 0:o.numberFixed)+" GiB"})]})}}}))]})}return u("agent.NoAvailableLiveStat")}},{title:u("agent.DiskPerc"),key:"disk_perc",render:(e,l)=>{var n,i,a;const o=null!==(n=null===(i=JSON.parse((null===l||void 0===l?void 0:l.live_stat)||"{}"))||void 0===i||null===(a=i.node)||void 0===a?void 0:a.disk)&&void 0!==n?n:{},r=parseFloat(o.pct)||0,s=parseFloat(r.toFixed(1)),d=s>80?c.colorError:c.colorSuccess;return(0,f.jsxs)(m.A,{direction:"column",children:[(0,f.jsx)(p.A,{valueLabel:s+" %",percent:s,strokeColor:d,width:120}),(0,f.jsxs)(A.A.Text,{style:{fontSize:c.fontSizeSM},children:[(0,t.wb)(null===o||void 0===o?void 0:o.current),"GB /"," ",(0,t.wb)(null===o||void 0===o?void 0:o.capacity),"GB"]})]})}},{title:u("general.ResourceGroup"),key:"resource_group",dataIndex:"scaling_group",sorter:!0},{title:u("agent.Status"),key:"status",dataIndex:"status",render:(e,l)=>{var n,t,i;const a=JSON.parse((null===l||void 0===l?void 0:l.compute_plugins)||"{}"),o=JSON.parse((null===l||void 0===l?void 0:l.available_slots)||"{}");return(0,f.jsxs)(m.A,{direction:"column",gap:"xxs",align:"start",children:[(0,f.jsx)(V.A,{values:[{label:"Agent"},{label:null===l||void 0===l?void 0:l.version,color:"ALIVE"===e?"green":"TERMINATED"===e?"red":"blue"}]}),null!==a&&void 0!==a&&a.cuda?(0,f.jsxs)(f.Fragment,{children:[null!==a&&void 0!==a&&null!==(n=a.cuda)&&void 0!==n&&n.cuda_version?(0,f.jsx)(V.A,{values:[{label:"CUDA"},{label:null===a||void 0===a||null===(t=a.cuda)||void 0===t?void 0:t.cuda_version,color:"green"}]}):(0,f.jsx)(P.A,{color:"green",children:"CUDA Disabled"}),(0,f.jsx)(V.A,{values:[{label:"CUDA Plugin"},{label:null===a||void 0===a||null===(i=a.cuda)||void 0===i?void 0:i.version,color:"blue"}]}),r().includes(r().keys(o),"cuda.shares")?(0,f.jsx)(P.A,{color:"blue",children:"Fractional GPU\u2122"}):null]}):null]})}},{title:u("agent.Schedulable"),key:"schedulable",dataIndex:"schedulable",render:e=>(0,f.jsx)(m.A,{justify:"center",children:!0===e?(0,f.jsx)(R.A,{style:{color:c.colorPrimary,fontSize:c.fontSizeXL}}):(0,f.jsx)(J.A,{style:{color:c.colorError,fontSize:c.fontSizeXL}})}),sorter:!0},{title:u("general.Control"),key:"control",fixed:"right",render:(e,l)=>(0,f.jsxs)(m.A,{children:[(0,f.jsx)(O.Ay,{size:"large",style:{color:c.colorSuccess},type:"text",icon:(0,f.jsx)(G.A,{}),onClick:()=>_(l)}),(0,f.jsx)(O.Ay,{size:"large",style:{color:c.colorInfo},type:"text",icon:(0,f.jsx)($.A,{}),onClick:()=>k(l)})]})}],[be,fe]=(0,q.A)("backendaiwebui.AgentList.displayedColumnKeys",{defaultValue:Ae.map((e=>r().toString(e.key)))});return(0,f.jsxs)(m.A,{direction:"column",align:"stretch",style:l,children:[(0,f.jsxs)(m.A,{justify:"between",align:"start",gap:"xs",style:{padding:c.paddingXS},wrap:"wrap",children:[(0,f.jsxs)(m.A,{direction:"row",gap:"sm",align:"start",style:{flex:1},wrap:"wrap",children:[(0,f.jsx)(H.A,{options:[{label:u("agent.Connected"),value:"ALIVE"},{label:u("agent.Terminated"),value:"TERMINATED"}],value:K?te:le,onChange:e=>{ie(e),z((()=>{ne(e)}))}}),(0,f.jsx)(N,{filterProperties:[{key:"id",propertyLabel:"ID"},{key:"addr",propertyLabel:u("agent.Endpoint")}],value:re,onChange:e=>{oe((()=>{se(e)}))}})]}),(0,f.jsx)(m.A,{gap:"xs",children:(0,f.jsx)(D.A,{title:u("button.Refresh"),children:(0,f.jsx)(O.Ay,{loading:I,onClick:()=>xe(),icon:(0,f.jsx)(W.A,{})})})})]}),(0,f.jsx)(Q.A,{bordered:!0,scroll:{x:"max-content"},rowKey:"id",dataSource:null===he||void 0===he?void 0:he.items,showSorterTooltip:!1,columns:r().filter(Ae,(e=>null===be||void 0===be?void 0:be.includes(r().toString(e.key)))),pagination:{pageSize:ue.pageSize,showSizeChanger:!0,total:null===he||void 0===he?void 0:he.total_count,current:ue.current,showTotal:(e,l)=>"".concat(l[0],"-").concat(l[1]," of ").concat(e," items"),pageSizeOptions:["10","20","50"],style:{marginRight:c.marginXS}},onChange:(e,l,n)=>{let{pageSize:i,current:a}=e;ee((()=>{r().isNumber(a)&&r().isNumber(i)&&i!==ue.pageSize&&a!==ue.current&&ce({current:a,pageSize:i}),ve((0,t.Wh)(n))}))},loading:{spinning:Y||K||ae,indicator:(0,f.jsx)(X.A,{})},...o}),(0,f.jsx)(m.A,{justify:"end",style:{padding:c.paddingXXS},children:(0,f.jsx)(O.Ay,{type:"text",icon:(0,f.jsx)($.A,{}),onClick:()=>{T(!0)}})}),(0,f.jsx)(j,{agentDetailModalFrgmt:h,open:!!h,onRequestClose:()=>_(null)}),(0,f.jsx)(w,{agentSettingModalFrgmt:S,open:!!S,onRequestClose:e=>{e&&xe(),k(null)}}),(0,f.jsx)(E.A,{open:F,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&fe(null===e||void 0===e?void 0:e.selectedColumnKeys),T(!1)},columns:Ae,displayedColumnKeys:be||[]})]})};var le=n(29475);const ne=(0,u.withDefault)(u.StringParam,"agents"),te=e=>{const{t:l}=(0,b.Bd)(),[n,t]=(0,u.useQueryParam)("tab",ne,{updateType:"replace"});return(0,f.jsxs)(le.A,{activeTabKey:n,onTabChange:e=>t(e),tabList:[{key:"agents",tab:l("agent.Agent")},{key:"storages",tab:l("general.StorageProxies")},{key:"resourceGroup",tab:l("general.ResourceGroup")}],styles:{body:{padding:0,paddingTop:1,overflow:"hidden"}},children:["agents"===n?(0,f.jsx)(ee,{containerStyle:{marginLeft:-1,marginRight:-1}}):null,"storages"===n?(0,f.jsx)("backend-ai-storage-proxy-list",{active:!0}):null,"resourceGroup"===n?(0,f.jsx)("backend-ai-resource-group-list",{active:!0}):null]})}}}]);
//# sourceMappingURL=2842.84fa186d.chunk.js.map