"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1822],{94777:(e,n,t)=>{t.d(n,{A:()=>T});var a=t(27340),s=t(90840),i=t(1869),c=t(75864),l=t(73857),o=t(60476),r=t(18695),d=t(76832),g=t(1426),m=t(42906);const u=(0,d.rU)((e=>{let{css:n}=e;return{baiSettingItemCheckbox:n`
    .ant-checkbox {
      align-self: flex-start;
      margin-top: 0.2rem;
    }
  `}})),h=e=>{let{type:n,title:t,description:a,children:d,defaultValue:g,value:h,selectProps:p,onChange:x}=e;const{token:j}=i.A.useToken(),{styles:y}=u();return(0,m.jsxs)(s.A,{direction:"column",align:"start",gap:"xxs",children:[(0,m.jsxs)(s.A,{direction:"row",gap:"xxs",children:[(0,m.jsx)(c.A.Text,{strong:!0,style:{fontSize:j.fontSize},children:t}),void 0!==h&&null!==h&&g!==h&&(0,m.jsx)(l.A,{dot:!0,status:"warning"})]}),"custom"===n&&(0,m.jsxs)(m.Fragment,{children:[a,d]}),"checkbox"===n&&(0,m.jsx)(o.A,{checked:h,onChange:x,className:y.baiSettingItemCheckbox,children:a}),"select"===n&&(0,m.jsxs)(m.Fragment,{children:[a,(0,m.jsx)(r.A,{value:h,popupMatchSelectWidth:!1,onChange:x,...p})]})]})};var p=t(89664),x=t(96099),j=t(67884),y=t(30871),A=t(81021),k=t(76415),b=t(16736),C=t(37565),f=t(27484),v=t.n(f),w=t(48602);const S=(0,d.rU)((e=>{let{css:n,token:t}=e;return{TabStyles:n`
    .ant-tabs-tab-active {
      font-weight: var(--token-fontWeightSuperStrong, 700);
    }
    .ant-typography-secondary {
      font-weight: normal !important;
    }
  `}})),I=e=>{let{title:n,count:t}=e;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.A.Text,{children:n}),(0,m.jsx)(c.A.Text,{type:"secondary",children:` (${t})`})]})},R=e=>{let{group:n,hideEmpty:t}=e;const{token:a}=i.A.useToken();return(!t||0!==n.settingItems.length)&&(0,m.jsxs)(s.A,{direction:"column",align:"stretch",style:{marginBottom:a.marginMD},children:[(0,m.jsxs)(s.A,{direction:"column",align:"stretch",style:{zIndex:1,marginBottom:a.marginMD,background:a.colorBgContainer},children:[(0,m.jsx)(c.A.Title,{level:5,style:{marginTop:0},children:n.title}),(0,m.jsx)(y.A,{style:{marginTop:0,marginBottom:0}}),n.description&&(0,m.jsx)(c.A.Text,{type:"secondary",style:{marginTop:a.marginSM},children:n.description})]}),(0,m.jsx)(s.A,{direction:"column",align:"start",gap:"lg",children:n.settingItems.map(((e,n)=>(0,m.jsx)(h,{...e},e.title+n)))})]})},T=e=>{let{settingGroups:n,tabDirection:t="left",showChangedOptionFilter:c,showResetButton:l,showSearchBar:r}=e;const{t:d}=(0,w.Bd)(),{token:u}=i.A.useToken(),{styles:h}=S(),[y,f]=(0,g.useState)(""),[T,B]=(0,g.useState)(!1),[F,{toggle:_}]=(0,j.A)(!1),[D,L]=(0,g.useState)("all"),M=v().map(n,(e=>({...e,settingItems:v().filter(e.settingItems,(e=>(!T||(e=>null!==e.value&&void 0!==e.value&&e.value!==e.defaultValue)(e))&&(e=>e.title.toLowerCase().includes(y.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(y.toLowerCase()))(e)))})));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(s.A,{direction:"column",gap:"md",align:"stretch",style:{padding:u.paddingContentHorizontal,maxWidth:u.screenLG},children:[(0,m.jsxs)(s.A,{justify:"start",gap:"xs",children:[!!r&&(0,m.jsx)(A.A,{prefix:(0,m.jsx)(p.A,{}),placeholder:d("settings.SearchPlaceholder"),onChange:e=>f(e.target.value),value:y}),!!c&&(0,m.jsx)(o.A,{onChange:e=>B(e.target.checked),style:{whiteSpace:"nowrap"},children:d("settings.ShowOnlyChanged")}),!!l&&(0,m.jsx)(k.Ay,{icon:(0,m.jsx)(x.A,{}),onClick:()=>_(),children:d("button.Reset")})]}),(0,m.jsx)(b.A,{activeKey:D,onChange:L,className:h.TabStyles,tabPosition:t?"left":"top",tabBarStyle:{minWidth:200},items:[{key:"all",label:(0,m.jsx)(I,{title:d("general.All"),count:v().sumBy(M,(e=>e.settingItems.length))}),children:(0,m.jsx)(s.A,{direction:"column",align:"stretch",gap:"xl",children:v().map(M,(e=>(0,m.jsx)(R,{group:e,hideEmpty:!0},e.title)))})},...v().map(M,((e,n)=>({key:`index${n}`,label:(0,m.jsx)(I,{title:e.title,count:e.settingItems.length}),children:(0,m.jsx)(R,{group:M[n],hideEmpty:!0})})))]})]}),(0,m.jsx)(a.A,{open:F,title:d("dialog.ask.DoYouWantToResetChanges"),okText:d("button.Reset"),okButtonProps:{danger:!0},onOk:()=>{v().flatMap(n,(e=>e.settingItems)).forEach((e=>{(null===e||void 0===e?void 0:e.setValue)&&e.setValue(e.defaultValue)})),_()},cancelText:d("button.Cancel"),onCancel:()=>_(),children:(0,m.jsx)(C.A,{showIcon:!0,message:d("dialog.warning.CannotBeUndone"),type:"warning"})})]})}},41822:(e,n,t)=>{t.r(n),t.d(n,{default:()=>p});var a=t(32967),s=t(17353),i=t(94777),c=t(96099),l=t(76415),o=t(1426),r=t(48602),d=t(42906);const g=()=>{const[e,n]=(0,o.useState)(!1),[t,g]=(0,o.useState)(!1),{t:m}=(0,r.Bd)(),{upsertNotification:u}=(0,s.js)(),h=(0,a.CX)(),p=[{title:m("maintenance.Fix"),settingItems:[{type:"custom",title:m("maintenance.MatchDatabase"),description:m("maintenance.DescMatchDatabase"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{n(!0),u({message:m("maintenance.RecalculateUsage"),description:m("maintenance.Recalculating"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.recalculate_usage().finally((()=>n(!1))),onChange:{pending:m("maintenance.Recalculating"),resolved:m("maintenance.RecalculationFinished"),rejected:m("maintenance.RecalculationFailed")}}})},loading:e,children:m(e?"maintenance.Recalculating":"maintenance.RecalculateUsage")})}]},{title:m("maintenance.ImagesEnvironment"),settingItems:[{type:"custom",title:m("maintenance.RescanImageList"),description:m("maintenance.DescRescanImageList"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{g(!0),u({message:m("maintenance.RescanImages"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.rescan_images(),onChange:{pending:m("maintenance.RescanImageScanning"),resolved:e=>{const n=e;if(n.rescan_images.ok)return{backgroundTask:{status:"pending",taskId:n.rescan_images.task_id,promise:null,percent:0,onChange:{resolved:(e,n)=>(g(!1),m("maintenance.RescanImageFinished"))}},duration:0};throw new Error(m("maintenance.RescanFailed"))},rejected:(e,n)=>{const t=e;return g(!1),(null===t||void 0===t?void 0:t.message)||m("maintenance.RescanFailed")}}}})},loading:t,children:m(t?"maintenance.RescanImageScanning":"maintenance.RescanImages")})}]}];return(0,d.jsx)(i.A,{settingGroups:p,showSearchBar:!0})};var m=t(94281),u=t(93409);const h=(0,u.withDefault)(u.StringParam,"maintenance"),p=()=>{const{t:e}=(0,r.Bd)(),[n,t]=(0,u.useQueryParam)("tab",h);return(0,d.jsx)(m.A,{activeTabKey:"maintenance",onTabChange:e=>t(e),tabList:[{key:"maintenance",tab:e("webui.menu.Maintenance")}],styles:{body:{padding:0}},children:"maintenance"===n&&(0,d.jsx)(g,{})})}},96099:(e,n,t)=>{t.d(n,{A:()=>o});var a=t(61293),s=t(1426),i=t(53886),c=t(3181),l=function(e,n){return s.createElement(c.A,(0,a.A)({},e,{ref:n,icon:i.A}))};const o=s.forwardRef(l)}}]);
//# sourceMappingURL=1822.c4d4db18.chunk.js.map