"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1147],{50514:(e,n,t)=>{t.d(n,{A:()=>T});var a=t(9189),s=t(72338),i=t(9571),c=t(50128),l=t(9712),o=t(92280),r=t(1581),g=t(43403),d=t(53350),m=t(60598);const u=(0,g.rU)((e=>{let{css:n}=e;return{baiSettingItemCheckbox:n`
    .ant-checkbox {
      align-self: flex-start;
      margin-top: 0.2rem;
    }
  `}})),h=e=>{let{type:n,title:t,description:a,children:g,defaultValue:d,value:h,selectProps:p,onChange:x}=e;const{token:j}=i.A.useToken(),{styles:k}=u();return(0,m.jsxs)(s.A,{direction:"column",align:"start",gap:"xxs",children:[(0,m.jsxs)(s.A,{direction:"row",gap:"xxs",children:[(0,m.jsx)(c.A.Text,{strong:!0,style:{fontSize:j.fontSize},children:t}),void 0!==h&&null!==h&&d!==h&&(0,m.jsx)(l.A,{dot:!0,status:"warning"})]}),"custom"===n&&(0,m.jsxs)(m.Fragment,{children:[a,g]}),"checkbox"===n&&(0,m.jsx)(o.A,{checked:h,onChange:x,className:k.baiSettingItemCheckbox,children:a}),"select"===n&&(0,m.jsxs)(m.Fragment,{children:[a,(0,m.jsx)(r.A,{value:h,popupMatchSelectWidth:!1,onChange:x,...p})]})]})};var p=t(28567),x=t(30775),j=t(40915),k=t(40056),y=t(83978),A=t(52335),b=t(81529),C=t(58325),f=t(46976),v=t.n(f),w=t(91788);const S=(0,g.rU)((e=>{let{css:n,token:t}=e;return{TabStyles:n`
    .ant-tabs-tab-active {
      font-weight: var(--token-fontWeightSuperStrong, 700);
    }
    .ant-typography-secondary {
      font-weight: normal !important;
    }
  `}})),I=e=>{let{title:n,count:t}=e;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(c.A.Text,{children:n}),(0,m.jsx)(c.A.Text,{type:"secondary",children:` (${t})`})]})},R=e=>{let{group:n,hideEmpty:t}=e;const{token:a}=i.A.useToken();return(!t||0!==n.settingItems.length)&&(0,m.jsxs)(s.A,{direction:"column",align:"stretch",style:{marginBottom:a.marginMD},children:[(0,m.jsxs)(s.A,{direction:"column",align:"stretch",style:{zIndex:1,marginBottom:a.marginMD,background:a.colorBgContainer},children:[(0,m.jsx)(c.A.Title,{level:5,style:{marginTop:0},children:n.title}),(0,m.jsx)(k.A,{style:{marginTop:0,marginBottom:0}})]}),(0,m.jsx)(s.A,{direction:"column",align:"start",gap:"lg",children:n.settingItems.map((e=>(0,m.jsx)(h,{...e})))})]})},T=e=>{let{settingGroups:n,tabDirection:t="left",showChangedOptionFilter:c,showResetButton:l,showSearchBar:r}=e;const{t:g}=(0,w.Bd)(),{token:u}=i.A.useToken(),{styles:h}=S(),[k,f]=(0,d.useState)(""),[T,B]=(0,d.useState)(!1),[F,{toggle:_}]=(0,j.A)(!1),[D,L]=(0,d.useState)("all"),E=v().map(n,(e=>({...e,settingItems:v().filter(e.settingItems,(e=>(!T||(e=>null!==e.value&&void 0!==e.value&&e.value!==e.defaultValue)(e))&&(e=>e.title.toLowerCase().includes(k.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(k.toLowerCase()))(e)))})));return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(s.A,{direction:"column",gap:"md",align:"stretch",style:{padding:u.paddingContentHorizontal,maxWidth:u.screenLG},children:[(0,m.jsxs)(s.A,{justify:"start",gap:"xs",children:[!!r&&(0,m.jsx)(y.A,{prefix:(0,m.jsx)(p.A,{}),placeholder:g("settings.SearchPlaceholder"),onChange:e=>f(e.target.value),value:k}),!!c&&(0,m.jsx)(o.A,{onChange:e=>B(e.target.checked),style:{whiteSpace:"nowrap"},children:g("settings.ShowOnlyChanged")}),!!l&&(0,m.jsx)(A.Ay,{icon:(0,m.jsx)(x.A,{}),onClick:()=>_(),children:g("button.Reset")})]}),(0,m.jsx)(b.A,{activeKey:D,onChange:L,className:h.TabStyles,tabPosition:t?"left":"top",tabBarStyle:{minWidth:200},items:[{key:"all",label:(0,m.jsx)(I,{title:g("general.All"),count:v().sumBy(E,(e=>e.settingItems.length))}),children:(0,m.jsx)(s.A,{direction:"column",align:"stretch",gap:"xl",children:v().map(E,(e=>(0,m.jsx)(R,{group:e,hideEmpty:!0})))})},...v().map(E,((e,n)=>({key:`index${n}`,label:(0,m.jsx)(I,{title:e.title,count:e.settingItems.length}),children:(0,m.jsx)(R,{group:E[n],hideEmpty:!0})})))]})]}),(0,m.jsx)(a.A,{open:F,title:g("dialog.ask.DoYouWantToResetChanges"),okText:g("button.Reset"),okButtonProps:{danger:!0},onOk:()=>{v().flatMap(n,(e=>e.settingItems)).forEach((e=>{(null===e||void 0===e?void 0:e.setValue)&&e.setValue(e.defaultValue)})),_()},cancelText:g("button.Cancel"),onCancel:()=>_(),children:(0,m.jsx)(C.A,{showIcon:!0,message:g("dialog.warning.CannotBeUndone"),type:"warning"})})]})}},51147:(e,n,t)=>{t.r(n),t.d(n,{default:()=>p});var a=t(23441),s=t(25905),i=t(50514),c=t(30775),l=t(52335),o=t(53350),r=t(91788),g=t(60598);const d=()=>{const[e,n]=(0,o.useState)(!1),[t,d]=(0,o.useState)(!1),{t:m}=(0,r.Bd)(),{upsertNotification:u}=(0,s.js)(),h=(0,a.CX)(),p=[{title:m("maintenance.Fix"),settingItems:[{type:"custom",title:m("maintenance.MatchDatabase"),description:m("maintenance.DescMatchDatabase"),children:(0,g.jsx)(l.Ay,{icon:(0,g.jsx)(c.A,{}),onClick:()=>{n(!0),u({message:m("maintenance.RecalculateUsage"),description:m("maintenance.Recalculating"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.recalculate_usage().finally((()=>n(!1))),onChange:{pending:m("maintenance.Recalculating"),resolved:m("maintenance.RecalculationFinished"),rejected:m("maintenance.RecalculationFailed")}}})},loading:e,children:m(e?"maintenance.Recalculating":"maintenance.RecalculateUsage")})}]},{title:m("maintenance.ImagesEnvironment"),settingItems:[{type:"custom",title:m("maintenance.RescanImageList"),description:m("maintenance.DescRescanImageList"),children:(0,g.jsx)(l.Ay,{icon:(0,g.jsx)(c.A,{}),onClick:()=>{d(!0),u({message:m("maintenance.RescanImages"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.rescan_images(),onChange:{pending:m("maintenance.RescanImageScanning"),resolved:e=>{const n=e;if(n.rescan_images.ok)return{backgroundTask:{status:"pending",taskId:n.rescan_images.task_id,promise:null,percent:0,onChange:{resolved:(e,n)=>(d(!1),m("maintenance.RescanImageFinished"))}},duration:0};throw new Error(m("maintenance.RescanFailed"))},rejected:(e,n)=>{const t=e;return d(!1),(null===t||void 0===t?void 0:t.message)||m("maintenance.RescanFailed")}}}})},loading:t,children:m(t?"maintenance.RescanImageScanning":"maintenance.RescanImages")})}]}];return(0,g.jsx)(i.A,{settingGroups:p,showSearchBar:!0})};var m=t(20418),u=t(32043);const h=(0,u.withDefault)(u.StringParam,"maintenance"),p=()=>{const{t:e}=(0,r.Bd)(),[n,t]=(0,u.useQueryParam)("tab",h);return(0,g.jsx)(m.A,{activeTabKey:"maintenance",onTabChange:e=>t(e),tabList:[{key:"maintenance",tab:e("webui.menu.Maintenance")}],styles:{body:{padding:0}},children:"maintenance"===n&&(0,g.jsx)(d,{})})}},30775:(e,n,t)=>{t.d(n,{A:()=>o});var a=t(40991),s=t(53350),i=t(30138),c=t(90055),l=function(e,n){return s.createElement(c.A,(0,a.A)({},e,{ref:n,icon:i.A}))};const o=s.forwardRef(l)}}]);
//# sourceMappingURL=1147.0fdfab4a.chunk.js.map