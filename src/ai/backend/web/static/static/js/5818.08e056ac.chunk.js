"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[5818,8463],{32461:(e,n,a)=>{a.d(n,{Ay:()=>h,z7:()=>p});var l=a(89130),i=a(67318),r=a(4342),t=a(23702),o=a(67378),s=a(60822),d=a(89608),u=a.n(d),m=a(43373),c=a(56762),v=a(73689);const g=[/AUTH/i,/ACCESS/i,/SECRET/i,/_KEY/i,/PASSWORD/i,/PASSWD/i,/PWD/i,/TOKEN/i,/PRIVATE/i,/CREDENTIAL/i,/JWT/i,/KEYPAIR/i,/CERTIFICATE/i,/SSH/i,/ENCRYPT/i,/SIGNATURE/i,/SALT/i,/PIN/i,/PASSPHRASE/i,/OAUTH/i];function p(e){return e.map((e=>{return e&&(n=e.variable,g.some((e=>e.test(n))))?{...e,value:""}:e;var n}))}const h=e=>{let{formItemProps:n,...a}=e;const d=(0,m.useRef)(null),{t:g}=(0,c.Bd)(),p=t.A.useFormInstance();return(0,v.jsx)(t.A.List,{...a,children:(e,m)=>{let{add:c,remove:h}=m;return(0,v.jsxs)(l.A,{direction:"column",gap:"xs",align:"stretch",children:[e.map(((r,s)=>{let{key:m,name:c,...y}=r;return(0,v.jsxs)(l.A,{direction:"row",align:"baseline",gap:"xs",children:[(0,v.jsx)(t.A.Item,{...y,style:{marginBottom:0,flex:1},name:[c,"variable"],rules:[{required:!0,message:g("session.launcher.EnterEnvironmentVariable")},{pattern:/^[a-zA-Z_][a-zA-Z0-9_]*$/,message:g("session.launcher.EnvironmentVariableNamePatternError")},e=>{let{getFieldValue:n}=e;return{validator(e,l){const i=u().map(n(a.name),(e=>null===e||void 0===e?void 0:e.variable));return!u().isEmpty(l)&&i.length>0&&u().filter(i,(e=>e===l)).length>1?Promise.reject(g("session.launcher.EnvironmentVariableDuplicateName")):Promise.resolve()}}}],...n,children:(0,v.jsx)(o.A,{ref:s===e.length-1?d:null,placeholder:"Variable",onChange:()=>{const n=e.map(((e,n)=>[a.name,n,"variable"]));p.validateFields(n)}})}),(0,v.jsx)(t.A.Item,{...y,name:[c,"value"],style:{marginBottom:0,flex:1},rules:[{required:!0,message:g("session.launcher.EnvironmentVariableValueRequired")}],validateTrigger:["onChange","onBlur"],children:(0,v.jsx)(o.A,{placeholder:"Value"})}),(0,v.jsx)(i.A,{onClick:()=>h(c)})]},m)})),(0,v.jsx)(t.A.Item,{noStyle:!0,children:(0,v.jsx)(s.Ay,{type:"dashed",onClick:()=>{c(),setTimeout((()=>{d.current&&d.current.focus()}),0)},icon:(0,v.jsx)(r.A,{}),block:!0,children:g("session.launcher.AddEnvironmentVariable")})})]})}})}},18463:(e,n,a)=>{a.r(n),a.d(n,{default:()=>s,useFolderExplorerOpener:()=>d});var l=a(43373),i=a(18150),r=a(12121),t=a(73689);const o=l.lazy((()=>Promise.all([a.e(2963),a.e(4639)]).then(a.bind(a,44639)))),s=()=>{const[e,n]=(0,r.useQueryParam)("folder",r.StringParam),a=null===e||void 0===e?void 0:e.replaceAll("-","");return(0,t.jsx)(o,{vfolderID:a||"",open:!!a,onRequestClose:()=>{n(null,"replaceIn")},destroyOnClose:!0})},d=()=>{const[,e]=(0,r.useQueryParam)("folder",r.StringParam),n=(0,i.zy)();return{open:n=>{e(n)},generateFolderPath:e=>{const a=new URLSearchParams(n.search);return a.set("folder",e),{pathname:n.pathname,search:a.toString()}}}}},98957:(e,n,a)=>{a.d(n,{A:()=>F});var l=a(58879),i=a(51593),r=a(84553),t=a(98401),o=a(89130);var s,d=a(16272),u=a(6597),m=a(23702),c=a(50868),v=a(85690),g=a(69056),p=a(15934),h=a(96799),y=a(67378),f=a(89608),A=a.n(f),x=a(43373),_=a(56762),j=a(88522),k=a(73689);const F=e=>{var n;let{filter:f,showPrivate:F}=e;const w=m.A.useFormInstance(),b=m.A.useWatch("environments",{form:w,preserve:!0}),S=(0,i.CX)(),[V,I]=(0,x.useState)(""),[C,N]=(0,x.useState)(""),{t:P}=(0,_.Bd)(),[E,{getImageMeta:K}]=(0,i.Gj)(),{token:T}=c.A.useToken(),{isDarkMode:R}=(0,r.e)(),M=(0,x.useRef)(null),L=(0,x.useRef)(null),O=null!==S&&void 0!==S&&null!==(n=S._config)&&void 0!==n&&n.showNonInstalledImages?{}:{installed:!0},{images:z}=(0,j.useLazyLoadQuery)(void 0!==s?s:s=a(38044),O,{fetchPolicy:"store-and-network"});(0,x.useEffect)((()=>{var e,n,a;if(!A().isEmpty(null===b||void 0===b?void 0:b.manual))return void((b.environment||b.version)&&w.setFieldsValue({environments:{environment:void 0,version:void 0,image:void 0}}));let i,r,t,o,s=null===(e=w.getFieldValue("environments"))||void 0===e?void 0:e.version;var d,u;(s&&s.indexOf("@")<0&&(s+="@x86_64"),s&&A().find(q,(e=>(i=A().find(e.environmentGroups,(e=>(r=A().find(e.images,(e=>(0,l.A_)(e)===s)),!!r))),!!i))),i?(t=i,o=r):w.getFieldValue(["environments","environment"])&&A().find(q,(e=>{var n;return t=A().find(e.environmentGroups,(e=>e.environmentName===w.getFieldValue(["environments","environment"]))),o=null===(n=t)||void 0===n?void 0:n.images[0],!!t})),t&&o)||(t=null===(d=q[0])||void 0===d?void 0:d.environmentGroups[0],o=null===(u=t)||void 0===u?void 0:u.images[0]);const m=null===(n=A().find(null===(a=o)||void 0===a?void 0:a.labels,(e=>null!==e&&"ai.backend.customized-image.name"===(null===e||void 0===e?void 0:e.key))))||void 0===n?void 0:n.value;o?!i&&S._config.allow_manual_image_name_for_session&&s?w.setFieldsValue({environments:{environment:void 0,version:void 0,image:void 0,manual:s,customizedTag:null!==m&&void 0!==m?m:void 0}}):w.setFieldsValue({environments:{environment:t.environmentName,version:(0,l.A_)(o),image:o,customizedTag:null!==m&&void 0!==m?m:void 0}}):S._config.allow_manual_image_name_for_session&&w.setFieldValue(["environments","manual"],s)}),[null===b||void 0===b?void 0:b.version,null===b||void 0===b?void 0:b.manual]);const q=(0,x.useMemo)((()=>A().chain(z).filter((e=>(!!F||!(e=>A().some(null===e||void 0===e?void 0:e.labels,(e=>{var n;return"ai.backend.features"===(null===e||void 0===e?void 0:e.key)&&(null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.split(" ").includes("private"))})))(e))&&(!f||f(e)))).groupBy((e=>{var n;return(null===E||void 0===E||null===(n=E.imageInfo[K((0,l.A_)(e)||"").key])||void 0===n?void 0:n.group)||"Custom Environments"})).map(((e,n)=>({groupName:n,environmentGroups:A().chain(e).groupBy((e=>(null===e||void 0===e?void 0:e.registry)+"/"+(null===e||void 0===e?void 0:e.name))).map(((e,n)=>{var a,i;const r=null===(a=n.split("/"))||void 0===a?void 0:a[2];return{environmentName:n,displayName:r&&(null===E||void 0===E||null===(i=E.imageInfo[r])||void 0===i?void 0:i.name)||A().last(n.split("/")),prefix:A().chain(n).split("/").drop(1).dropRight(1).join("/").value(),images:e.sort(((e,n)=>{var a,i,r,t,o,s;return function(e,n){const a=e.split(".").map(Number),l=n.split(".").map(Number);for(let i=0;i<Math.max(a.length,l.length);i++){const e=a[i]||0,n=l[i]||0;if(e>n)return 1;if(e<n)return-1}return 0}(null!==(a=null===n||void 0===n||null===(i=n.tag)||void 0===i||null===(r=i.split("-"))||void 0===r?void 0:r[0])&&void 0!==a?a:"",null!==(t=null===e||void 0===e||null===(o=e.tag)||void 0===o||null===(s=o.split("-"))||void 0===s?void 0:s[0])&&void 0!==t?t:"")||(0,l._f)(null===e||void 0===e?void 0:e.architecture,null===n||void 0===n?void 0:n.architecture)}))}})).sortBy((e=>e.displayName)).value()}))).sortBy((e=>e.groupName)).value()),[z,E,f,F]),{fullNameMatchedImage:B}=(0,x.useMemo)((()=>{let e,n;return V.length&&A().chain(q.flatMap((e=>e.environmentGroups)).find((a=>(n=a,e=A().find(a.images,(e=>(0,l.A_)(e)===V)),!!e)))).value(),{fullNameMatchedImage:e,fullNameMatchedImageGroup:n}}),[V,q]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("style",{children:"/* Change the image and tags of the select option when the selection is opened  */\ndiv.image-environment-select-form-item\n  div.ant-select-open\n  span.ant-select-selection-item\n  div\n  img,\ndiv.image-environment-select-form-item\n  div.ant-select-open\n  span.ant-select-selection-item\n  div\n  span.ant-tag {\n  opacity: 0.5;\n}\n\ndiv.image-environment-select-form-item\n  div.ant-select-item-option-content\n  div.tag-wrap-light {\n  /* flex: 1 !important; */\n  flex-wrap: wrap !important;\n}\n\ndiv.image-environment-select-form-item\n  div.ant-select-item-option-content\n  div.tag-wrap-dark {\n  /* flex: 1 !important; */\n  flex-wrap: wrap !important;\n}\n\ndiv.image-environment-select-form-item\n  span.ant-select-selection-item\n  div.tag-wrap-light {\n  overflow: hidden;\n}\n\ndiv.image-environment-select-form-item\n  span.ant-select-selection-item\n  div.tag-wrap-dark {\n  overflow: hidden;\n}\n\ndiv.image-environment-select-form-item\n  span.ant-select-selection-item\n  div.tag-wrap-light::after {\n  content: '';\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 10px; /* Width of the transparent gradient area */\n  background: linear-gradient(\n    to right,\n    rgba(255, 255, 255, 0),\n    rgba(255, 255, 255, 1)\n  );\n}\n\ndiv.image-environment-select-form-item\n  span.ant-select-selection-item\n  div.tag-wrap-dark::after {\n  content: '';\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 10px;\n  background: linear-gradient(\n    to right,\n    rgba(20, 20, 20, 0),\n    rgba(20, 20, 20, 1)\n  );\n}\n"}),(0,k.jsx)(m.A.Item,{className:"image-environment-select-form-item",name:["environments","environment"],label:(0,k.jsxs)(v.A.Text,{copyable:{text:(0,l.A_)(w.getFieldValue(["environments","image"]))},children:[P("session.launcher.Environments")," /"," ",P("session.launcher.Version")]}),rules:[{required:A().isEmpty(null===b||void 0===b?void 0:b.manual)}],style:{marginBottom:10},children:(0,k.jsx)(g.A,{ref:M,showSearch:!0,searchValue:V,onSearch:I,defaultActiveFirstOption:!0,optionFilterProp:"filterValue",onChange:e=>{if(B)w.setFieldsValue({environments:{environment:(null===B||void 0===B?void 0:B.name)||"",version:(0,l.A_)(B),image:B}});else{const n=q.flatMap((e=>e.environmentGroups)).filter((n=>n.environmentName===e))[0].images[0];w.setFieldsValue({environments:{environment:(null===n||void 0===n?void 0:n.name)||"",version:(0,l.A_)(n),image:n}})}},disabled:S._config.allow_manual_image_name_for_session&&!A().isEmpty(null===b||void 0===b?void 0:b.manual),children:B?(0,k.jsx)(g.A.Option,{value:null===B||void 0===B?void 0:B.name,filterValue:(0,l.A_)(B),children:(0,k.jsxs)(o.A,{direction:"row",align:"center",gap:"xs",style:{display:"inline-flex"},children:[(0,k.jsx)(d.A,{image:(0,l.A_)(B)||"",style:{width:15,height:15}}),(0,l.A_)(B)]})}):A().map(q,(e=>(0,k.jsx)(g.A.OptGroup,{label:e.groupName,children:A().map(e.environmentGroups,(e=>{var n;const a=e.images[0],i=null===E||void 0===E?void 0:E.imageInfo[null===(n=e.environmentName.split("/"))||void 0===n?void 0:n[2]],r=[];let t=null;e.prefix&&!["lablup","cloud","stable"].includes(e.prefix)&&(r.push(e.prefix),t=(0,k.jsx)(p.A,{color:"purple",children:(0,k.jsx)(u.A,{keyword:V,children:e.prefix})}));const s=A().map(null===i||void 0===i?void 0:i.label,(e=>A().isUndefined(e.category)&&e.tag&&e.color?(r.push(e.tag),(0,k.jsx)(p.A,{color:e.color,children:(0,k.jsx)(u.A,{keyword:V,children:e.tag},e.tag)},e.tag)):null));return(0,k.jsx)(g.A.Option,{value:e.environmentName,filterValue:e.displayName+"\t"+r.join("\t"),children:(0,k.jsxs)(o.A,{direction:"row",justify:"between",children:[(0,k.jsxs)(o.A,{direction:"row",align:"center",gap:"xs",children:[(0,k.jsx)(d.A,{image:(0,l.A_)(a)||"",style:{width:15,height:15}}),(0,k.jsx)(u.A,{keyword:V,children:e.displayName})]}),(0,k.jsxs)(o.A,{direction:"row",className:R?"tag-wrap-dark":"tag-wrap-light",style:{marginLeft:T.marginXS,flexShrink:1},children:[t,s]})]})},e.environmentName)}))},e.groupName)))})}),(0,k.jsx)(m.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>{var a,l;return(null===(a=e.environments)||void 0===a?void 0:a.environment)!==(null===(l=n.environments)||void 0===l?void 0:l.environment)},children:e=>{var n;let a,{getFieldValue:i}=e;return A().find(q,(e=>A().find(e.environmentGroups,(e=>{var n;return e.environmentName===(null===(n=i("environments"))||void 0===n?void 0:n.environment)&&(a=e,!0)})))),(0,k.jsx)(m.A.Item,{className:"image-environment-select-form-item",name:["environments","version"],rules:[{required:A().isEmpty(null===b||void 0===b?void 0:b.manual)}],children:(0,k.jsx)(g.A,{ref:L,onChange:e=>{const n=A().find(z,(n=>(0,l.A_)(n)===e));w.setFieldValue(["environments","image"],n)},showSearch:!0,searchValue:C,onSearch:N,optionFilterProp:"filterValue",dropdownRender:e=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(o.A,{style:{fontWeight:T.fontWeightStrong,paddingLeft:T.paddingSM},children:[P("session.launcher.Version"),(0,k.jsx)(h.A,{type:"vertical"}),P("session.launcher.Base"),(0,k.jsx)(h.A,{type:"vertical"}),P("session.launcher.Architecture"),(0,k.jsx)(h.A,{type:"vertical"}),P("session.launcher.Requirements")]}),(0,k.jsx)(h.A,{style:{margin:"8px 0"}}),e]}),disabled:S._config.allow_manual_image_name_for_session&&!A().isEmpty(null===b||void 0===b?void 0:b.manual),children:A().map(A().uniqBy(null===(n=a)||void 0===n?void 0:n.images,"id"),(e=>{var n;const[a,i,...r]=(null===e||void 0===e||null===(n=e.tag)||void 0===n?void 0:n.split("-"))||["","",""];let s=null===E||void 0===E?void 0:E.tagAlias[i];if(!s){for(const[e,n]of Object.entries((null===E||void 0===E?void 0:E.tagReplace)||{})){const a=new RegExp(e);a.test(i)&&(s=null===i||void 0===i?void 0:i.replace(a,n))}s||(s=i)}const d=[],m=A().chain(r).filter((e=>!e.startsWith("customized_"))).map(((e,n)=>(0,k.jsx)(t.A,{values:A().split((null===E||void 0===E?void 0:E.tagAlias[e])||e,":").map((e=>(d.push(e),(0,k.jsx)(u.A,{keyword:C,children:e},e))))},n))).value(),c=null===e||void 0===e?void 0:e.labels;if(c){const e=A().findIndex(c,(e=>null!==e&&"ai.backend.customized-image.name"===(null===e||void 0===e?void 0:e.key)));if(e&&c[e]){var v;const n=(null===(v=c[e])||void 0===v?void 0:v.value)||"";d.push("Customized"),d.push(n),m.push((0,k.jsx)(t.A,{values:[{label:(0,k.jsx)(u.A,{keyword:C,children:"Customized"},"Customized"),color:"cyan"},{label:(0,k.jsx)(u.A,{keyword:C,children:n},n),color:"cyan"}]},m.length+1))}}return(0,k.jsx)(g.A.Option,{value:(0,l.A_)(e),filterValue:[a,s,null===e||void 0===e?void 0:e.architecture,...d].join("\t"),children:(0,k.jsxs)(o.A,{direction:"row",justify:"between",children:[(0,k.jsxs)(o.A,{direction:"row",children:[(0,k.jsx)(u.A,{keyword:C,children:a}),(0,k.jsx)(h.A,{type:"vertical"}),(0,k.jsx)(u.A,{keyword:C,children:s}),(0,k.jsx)(h.A,{type:"vertical"}),(0,k.jsx)(u.A,{keyword:C,children:null===e||void 0===e?void 0:e.architecture})]}),(0,k.jsx)(o.A,{direction:"row",className:R?"tag-wrap-dark":"tag-wrap-light",style:{marginLeft:T.marginXS,flexShrink:1},children:m||"-"})]})},null===e||void 0===e?void 0:e.id)}))})})}}),(0,k.jsx)(m.A.Item,{label:P("session.launcher.ManualImageName"),name:["environments","manual"],style:{display:S._config.allow_manual_image_name_for_session?"block":"none"},children:(0,k.jsx)(y.A,{allowClear:!0,onChange:e=>{A().isEmpty(e)||w.setFieldsValue({environments:{environment:void 0,version:void 0,image:void 0}})}})}),(0,k.jsx)(m.A.Item,{noStyle:!0,hidden:!0,name:["environments","image"],children:(0,k.jsx)(y.A,{})})]})}},81514:(e,n,a)=>{a.d(n,{A:()=>G});var l=a(58879),i=a(51593),r=a(68190),t=a(60881),o=a(7194),s=a(15634),d=a(60266),u=a(59286),m=a(43373),c=a(97734),v=a(73689);const g=(0,u.rU)((e=>{let{css:n,token:a}=e;return{hover:n`
    text-decoration: none;
    color: inherit;

    &:hover {
      color: ${a.colorLinkHover};
      text-decoration: underline;
    }
  `}})),p=e=>{let{type:n,...a}=e;const{styles:l}=g();return(0,v.jsx)(c.N_,{className:"hover"===n?l.hover:void 0,...a})};var h,y=a(45719),f=a(89130),A=a(92920),x=a(18463),_=a(6597),j=a(98401),k=a(89608),F=a.n(k),w=a(88522);const b=e=>{let{vFolderFrgmt:n=null,permission:l}=e;const i=(0,w.useFragment)(void 0!==h?h:h=a(34790),n),r=F().chain({r:"green",w:"blue",d:"red"}).map(((e,n)=>{if(((e,n)=>!(null===e||void 0===e||!e.includes(n))||!(null===e||void 0===e||!e.includes("w")||"r"!==n))((null===i||void 0===i?void 0:i.permission)||l,n))return{label:n.toUpperCase(),color:e}})).compact().value();return(0,v.jsx)(j.A,{values:r})};var S,V=a(65666),I=a(58457),C=a(40567),N=a(23702),P=a(85690),E=a(33789),K=a(67378),T=a(60822),R=a(77731),M=a(45679),L=a(15934),O=a(12731),z=a.n(O),q=a(93056),B=a(56762);const D=/^[a-zA-Z0-9_/.-]*$/,$="/home/work/",Q=e=>{let{filter:n,showAliasInput:u=!1,selectedRowKeys:c=[],onChangeSelectedRowKeys:g,aliasBasePath:h=$,aliasMap:j,onChangeAliasMap:k,rowKey:O="name",onChangeAutoMountedFolders:Q,showAutoMountedFoldersSection:G,...U}=e;const{generateFolderPath:W}=(0,x.useFolderExplorerOpener)(),H=m.useMemo((()=>e=>e&&e[O]),[O]),[J,X]=(0,m.useState)(!1),[Y,Z]=(0,o.A)({value:c,onChange:g},{defaultValue:[]}),[ee,ne]=(0,o.A)({value:j,onChange:k},{defaultValue:{}}),ae=(0,i.CX)(),[le]=(0,r.x)(null===ae||void 0===ae?void 0:ae._config.accessKey),[ie]=N.A.useForm();(0,m.useEffect)((()=>{ee&&(ie.setFieldsValue(F().mapValues(ee,(e=>e.startsWith(h)?e.slice(h.length):e))),ie.validateFields())}),[ee,ie,h]);const{t:re}=(0,B.Bd)(),te=(0,l.QE)(),oe=(0,s.hd)(),[se,de]=(0,i.Tw)("first"),[ue,me]=(0,m.useTransition)(),{data:ce}=(0,t.nj)({queryKey:["VFolderSelectQuery",se,oe.id],queryFn:()=>{const e=new URLSearchParams;return e.set("group_id",oe.id),te({method:"GET",url:`/folders?${e.toString()}`})},staleTime:1e3}),{domain:ve,group:ge,keypair_resource_policy:pe}=(0,w.useLazyLoadQuery)(void 0!==S?S:S=a(46385),{domain_name:ae._config.domainName,group_id:oe.id,keypair_resource_policy_name:(null===le||void 0===le?void 0:le.resource_policy)||""},{fetchPolicy:"store-and-network",fetchKey:se}),he=(0,m.useMemo)((()=>{const e=JSON.parse((null===ve||void 0===ve?void 0:ve.allowed_vfolder_hosts)||"{}"),n=JSON.parse((null===ge||void 0===ge?void 0:ge.allowed_vfolder_hosts)||"{}"),a=JSON.parse((null===pe||void 0===pe?void 0:pe.allowed_vfolder_hosts)||"{}"),l=F().merge({},e,n,a),i=Object.keys(l).filter((e=>l[e].includes("mount-in-session")));return null===ce||void 0===ce?void 0:ce.filter((e=>i.includes(e.host)))}),[ve,ge,pe,ce]),ye=(0,m.useMemo)((()=>F().chain(he).filter((e=>{var n;return"ready"===e.status&&(null===(n=e.name)||void 0===n?void 0:n.startsWith("."))})).map((e=>e.name)).value()),[he]);(0,m.useEffect)((()=>{F().isFunction(Q)&&Q(ye)}),[ye]);const[fe,Ae]=(0,m.useState)(""),xe=F().chain(he).filter((e=>!n||n(e))).filter((e=>!!Y.includes(H(e))||(!fe||e.name.includes(fe)))).value(),_e=(0,m.useCallback)(((e,n)=>void 0===n||""===n?`${h}${e}`:n.startsWith("/")?n:`${h}${n}`),[h]),je=(0,d.E)((()=>{ne(F().mapValues(F().pickBy(ie.getFieldsValue({strict:!1}),(e=>!!e)),((e,n)=>_e(n,e)))),ie.validateFields().catch((()=>{}))}));(0,m.useEffect)((()=>{je()}),[JSON.stringify(Y),je]);const ke=(0,y.useShadowRoot)(),Fe=[{title:(0,v.jsxs)(f.A,{direction:"row",gap:"xxs",children:[(0,v.jsx)(P.A.Text,{children:re("data.folders.Name")}),u&&(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(P.A.Text,{type:"secondary",style:{fontWeight:"normal"},children:["(",re("session.launcher.FolderAlias")," ",(0,v.jsx)(E.A,{title:(0,v.jsx)(B.x6,{i18nKey:"session.launcher.DescFolderAlias"}),getPopupContainer:()=>ke,children:(0,v.jsx)(V.A,{})}),")"]})})]}),dataIndex:"name",sorter:(e,n)=>e.name.localeCompare(n.name),render:(e,n)=>{const a=Y.includes(H(n));return(0,v.jsxs)(f.A,{direction:"column",align:"start",gap:"xxs",style:u&&a?{display:"inline-flex",height:70,width:"100%"}:{maxWidth:200},children:[(0,v.jsx)(p,{type:"hover",to:W(n.id),children:(0,v.jsx)(_.A,{keyword:fe,children:e})}),u&&a&&(0,v.jsx)(N.A.Item,{noStyle:!0,shouldUpdate:(e,a)=>e[H(n)]!==a[H(n)],children:()=>{const e=F()(Y).reduce(((e,n)=>(e[n]=(null===ee||void 0===ee?void 0:ee[n])||_e(n,void 0),e)),{});return(0,v.jsx)(N.A.Item,{name:H(n),rules:[{type:"string",pattern:D,message:re("session.launcher.FolderAliasInvalid")},{type:"string",validator:async(a,l)=>l&&F().some(e,((e,a)=>a!==H(n)&&e===_e(H(n),l)))?Promise.reject(re("session.launcher.FolderAliasOverlapping")):Promise.resolve()},{type:"string",validator:async(e,a)=>{const l=_e(H(n),a);return a&&F().map(ye,(e=>_e("",e))).includes(l)?Promise.reject(re("session.launcher.FolderAliasOverlappingToAutoMount")):Promise.resolve()}}],extra:_e(n.name,ie.getFieldValue(H(n))),children:(0,v.jsx)(K.A,{onClick:e=>{e.stopPropagation()},placeholder:re("session.launcher.FolderAlias"),allowClear:!0,onChange:()=>{je()}})})}})]})}},{title:re("data.UsageMode"),dataIndex:"usage_mode",sorter:(e,n)=>e.usage_mode.localeCompare(n.usage_mode)},{title:re("data.Host"),dataIndex:"host"},{title:re("data.Type"),dataIndex:"type",sorter:(e,n)=>e.type.localeCompare(n.type),render:(e,n)=>(0,v.jsxs)(f.A,{direction:"column",children:["user"===n.type?(0,v.jsx)(I.A,{title:"User"}):(0,v.jsx)("div",{children:"Group"}),"group"===n.type&&`(${n.group_name})`]})},{title:re("data.Permission"),dataIndex:"permission",sorter:(e,n)=>e.permission.localeCompare(n.permission),render:(e,n)=>(0,v.jsx)(b,{permission:n.permission})},{title:re("data.Created"),dataIndex:"created_at",sorter:(e,n)=>e.created_at.localeCompare(n.created_at),render:(e,n)=>z()(e).format("L"),defaultSortOrder:"descend"}];return(0,v.jsxs)(f.A,{direction:"column",align:"stretch",gap:"xs",children:[(0,v.jsxs)(f.A,{direction:"row",gap:"xs",justify:"between",children:[(0,v.jsx)(K.A,{value:fe,onChange:e=>Ae(e.target.value),allowClear:!0,placeholder:re("data.SearchByName")}),(0,v.jsx)(E.A,{title:re("button.Refresh"),children:(0,v.jsx)(T.Ay,{loading:ue,icon:(0,v.jsx)(C.A,{}),onClick:()=>{me((()=>{de()}))}})}),(0,v.jsx)(E.A,{title:re("data.CreateANewStorageFolder"),children:(0,v.jsx)(T.Ay,{icon:(0,v.jsx)(q.A,{}),type:"primary",ghost:!0,onClick:()=>{X(!0)}})})]}),(0,v.jsx)(N.A,{form:ie,component:!1,preserve:!1,children:(0,v.jsx)(R.A,{scroll:{x:"max-content"},rowKey:H,rowSelection:{selectedRowKeys:Y,onChange:e=>{Z(e),je()}},showSorterTooltip:!1,columns:Fe,dataSource:xe,onRow:(e,n)=>({onClick:n=>{var a;const l=n.target;null!==l&&void 0!==l&&null!==(a=l.classList)&&void 0!==a&&a.contains("ant-table-selection-column")&&(n.stopPropagation(),Y.includes(H(e))?Z(Y.filter((n=>n!==H(e)))):Z([...Y,H(e)]))}}),sortDirections:["ascend","descend"],...U})}),G&&ye.length>0?(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(M.A,{size:"small",children:(0,v.jsx)(M.A.Item,{label:re("data.AutomountFolders"),children:F().map(ye,(e=>(0,v.jsx)(L.A,{children:e},e)))})})}):null,(0,v.jsx)(A.A,{open:J,onRequestClose:e=>{X(!1),e&&me((()=>{de(),Z((n=>[...n,e[O]]))}))}})]})},G=e=>{let{filter:n,rowKey:a="name",tableProps:l,...i}=e;const r=N.A.useFormInstance(),{t:t}=(0,B.Bd)();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(N.A.Item,{hidden:!0,name:"vfoldersAliasMap",rules:[{validator(e,n){const a=F().chain(r.getFieldValue("mounts")).reduce(((e,a)=>(e[a]=n[a]||"/home/work/"+a,e)),{}).values().value();return F().uniq(a).length!==a.length?Promise.reject(t("session.launcher.FolderAliasOverlapping")):F().some(a,(e=>!D.test(e)))?Promise.reject(t("session.launcher.FolderAliasInvalid")):F().some(r.getFieldValue("autoMountedFolderNames"),(e=>a.includes($+e)))?Promise.reject(t("session.launcher.FolderAliasOverlappingToAutoMount")):Promise.resolve()}}],children:(0,v.jsx)(K.A,{})}),(0,v.jsx)(N.A.Item,{hidden:!0,name:"autoMountedFolderNames"}),(0,v.jsx)(N.A.Item,{name:"mounts",...i,valuePropName:"selectedRowKeys",trigger:"onChangeSelectedRowKeys",children:(0,v.jsx)(Q,{rowKey:a,showAliasInput:!0,aliasMap:r.getFieldValue("vfoldersAliasMap"),onChangeAliasMap:e=>{r.setFieldValue("vfoldersAliasMap",e),r.validateFields(["vfoldersAliasMap"])},pagination:!1,filter:n,showAutoMountedFoldersSection:!0,onChangeAutoMountedFolders:e=>{r.setFieldValue("autoMountedFolderNames",e)},...l})})]})}},38044:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"installed"}],n={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},a=[{alias:null,args:[{kind:"Variable",name:"is_installed",variableName:"installed"}],concreteType:"Image",kind:"LinkedField",name:"images",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"humanized_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"digest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"installed",storageKey:null},{alias:null,args:null,concreteType:"ResourceLimit",kind:"LinkedField",name:"resource_limits",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"min",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ImageEnvironmentSelectFormItemsQuery",selections:a,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ImageEnvironmentSelectFormItemsQuery",selections:a},params:{cacheID:"3922d893a3df3d3d88a36cb49448a95e",id:null,metadata:{},name:"ImageEnvironmentSelectFormItemsQuery",operationKind:"query",text:"query ImageEnvironmentSelectFormItemsQuery(\n  $installed: Boolean\n) {\n  images(is_installed: $installed) {\n    id\n    name\n    humanized_name\n    tag\n    registry\n    architecture\n    digest\n    installed\n    resource_limits {\n      key\n      min\n      max\n    }\n    labels {\n      key\n      value\n    }\n  }\n}\n"}}}();l.hash="499347d0f0cdbbc4ca61a92a5ecf98d3";const i=l},34790:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VFolderPermissionTag_VFolder",selections:[{alias:null,args:null,kind:"ScalarField",name:"permission",storageKey:null}],type:"VirtualFolder",abstractKey:null,hash:"d3b0f85629ac8c6f45ef363938f66067"},i=l},46385:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"domain_name"},{defaultValue:null,kind:"LocalArgument",name:"group_id"},{defaultValue:null,kind:"LocalArgument",name:"keypair_resource_policy_name"}],n=[{alias:null,args:null,kind:"ScalarField",name:"allowed_vfolder_hosts",storageKey:null}],a=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"domain_name"}],concreteType:"Domain",kind:"LinkedField",name:"domain",plural:!1,selections:n,storageKey:null},{alias:null,args:[{kind:"Variable",name:"domain_name",variableName:"domain_name"},{kind:"Variable",name:"id",variableName:"group_id"}],concreteType:"Group",kind:"LinkedField",name:"group",plural:!1,selections:n,storageKey:null},{alias:null,args:[{kind:"Variable",name:"name",variableName:"keypair_resource_policy_name"}],concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policy",plural:!1,selections:n,storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VFolderTableProjectQuery",selections:a,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VFolderTableProjectQuery",selections:a},params:{cacheID:"2c2ce905afd89e93c6d761f22ed59f3d",id:null,metadata:{},name:"VFolderTableProjectQuery",operationKind:"query",text:"query VFolderTableProjectQuery(\n  $domain_name: String!\n  $group_id: UUID!\n  $keypair_resource_policy_name: String!\n) {\n  domain(name: $domain_name) {\n    allowed_vfolder_hosts\n  }\n  group(id: $group_id, domain_name: $domain_name) {\n    allowed_vfolder_hosts\n  }\n  keypair_resource_policy(name: $keypair_resource_policy_name) {\n    allowed_vfolder_hosts\n  }\n}\n"}}}();l.hash="ccdbaa52a63c2ea005423e7c541eff80";const i=l}}]);
//# sourceMappingURL=5818.08e056ac.chunk.js.map