"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[503],{37007:function(e,n,a){var t=a(99277),l=a(82548),i=a(32048),s=a.n(i),r=a(4519),o=a(2556);n.Z=function(e){var n,a=e.values,i=void 0===a?[]:a;return 0===i.length?null:(n=i[0]&&("string"===typeof i[0]||r.isValidElement(i[0]))?i.map((function(e){return{label:e,color:"blue"}})):i,(0,o.jsx)(t.Z,{direction:"row",children:s().map(n,(function(e,a){return(0,o.jsx)(l.Z,{style:s().last(n)===e?void 0:{margin:0,marginRight:-1},color:e.color,children:e.label},a)}))}))}},14001:function(e,n,a){var t=a(1413),l=a(29439),i=a(40406),s=a(4519),r=a(2556),o=function(e,n){var a=e.image,s=e.style,o=void 0===s?{}:s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",c=(0,i.X6)(),d=(0,l.Z)(c,2)[1].getImageIcon;return(0,r.jsx)("img",{src:d(a),style:(0,t.Z)({width:"1em",height:"1em"},o),alt:u})};n.Z=s.memo(o)},3173:function(e,n,a){a.r(n);var t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SessionInfoCellFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"session_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user_email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"image",storageKey:null}],type:"ComputeSession",abstractKey:null,hash:"93f8cd0d4b47d24ea281955be0ad792b"};n.default=t},72428:function(e,n,a){a.r(n);var t=function(){var e={defaultValue:null,kind:"LocalArgument",name:"ak"},n={defaultValue:null,kind:"LocalArgument",name:"group_id"},a={defaultValue:null,kind:"LocalArgument",name:"limit"},t={defaultValue:null,kind:"LocalArgument",name:"offset"},l={defaultValue:null,kind:"LocalArgument",name:"skipClusterSize"},i={defaultValue:null,kind:"LocalArgument",name:"status"},s=[{kind:"Variable",name:"access_key",variableName:"ak"},{kind:"Variable",name:"group_id",variableName:"group_id"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"status",variableName:"status"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"session_id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"image",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"terminated_at",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"status_info",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"service_ports",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"mounts",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"occupied_slots",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"resource_opts",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"starts_at",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"scaling_group",storageKey:null},Z={alias:null,args:null,kind:"ScalarField",name:"agents",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"cluster_size",storageKey:null};return{fragment:{argumentDefinitions:[e,n,a,t,l,i],kind:"Fragment",metadata:null,name:"SessionListQuery",selections:[{alias:null,args:s,concreteType:"ComputeSessionList",kind:"LinkedField",name:"compute_session_list",plural:!1,selections:[{alias:null,args:null,concreteType:"ComputeSession",kind:"LinkedField",name:"items",plural:!0,selections:[r,o,u,c,d,m,g,f,p,h,x,y,v,k,S,j,_,Z,b,{args:null,kind:"FragmentSpread",name:"SessionInfoCellFragment"}],storageKey:null}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,e,n,i,l],kind:"Operation",name:"SessionListQuery",selections:[{alias:null,args:s,concreteType:"ComputeSessionList",kind:"LinkedField",name:"compute_session_list",plural:!1,selections:[{alias:null,args:null,concreteType:"ComputeSession",kind:"LinkedField",name:"items",plural:!0,selections:[r,o,u,c,d,m,g,f,p,h,x,y,v,k,S,j,_,Z,b,{alias:null,args:null,kind:"ScalarField",name:"user_email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"83e3fabcd47538a643850d50617579a5",id:null,metadata:{},name:"SessionListQuery",operationKind:"query",text:"query SessionListQuery(\n  $limit: Int!\n  $offset: Int!\n  $ak: String\n  $group_id: String\n  $status: String\n  $skipClusterSize: Boolean!\n) {\n  compute_session_list(limit: $limit, offset: $offset, access_key: $ak, group_id: $group_id, status: $status) {\n    items {\n      id\n      type\n      session_id\n      name\n      image\n      architecture\n      created_at\n      terminated_at\n      status\n      status_info\n      service_ports\n      mounts\n      occupied_slots\n      resource_opts\n      access_key\n      starts_at\n      scaling_group\n      agents\n      cluster_size @skipOnClient(if: $skipClusterSize)\n      ...SessionInfoCellFragment\n    }\n  }\n}\n\nfragment SessionInfoCellFragment on ComputeSession {\n  id\n  session_id\n  name\n  status\n  user_email\n  image\n}\n"}}}();t.hash="b0859dbf2946abcb56ec83ac42d76781",n.default=t},11503:function(e,n,a){a.r(n),a.d(n,{default:function(){return X}});var t,l=a(93433),i=a(29439),s=a(99277),r=a(1413),o=a(44925),u=a(40406),c=a(37007),d=a(14001),m=a(96732),g=a(50164),f=a(61749),p=a(44036),h=a(57054),x=a(38818),y=a(70389),v=a(38812),k=a(4519),S=a(81748),j=a(16980),_=a(2556),Z=function(e){var n=e.sessionFrgmt,l=e.sessionNameList,r=e.onRename,o=(0,u.Dj)(),c=p.Z.useToken().token,d=(0,j.useFragment)(void 0!==t?t:t=a(3173),n),m=(0,g.Y)({mutationFn:function(e){var n=o.APIMajorVersion<5?d.name:d.session_id;return o.rename(n,e)}}),Z=(0,k.useRef)(null),b=(0,S.$G)().t,I=(0,k.useState)(!1),F=(0,i.Z)(I,2),N=F[0],E=F[1],L=(0,k.useState)(d.name),R=(0,i.Z)(L,2),T=R[0],C=R[1],K=function(){return["RUNNING","RESTARTING","TERMINATING","PENDING","SCHEDULED","PREPARING","PULLING"].includes(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}(d.status||void 0)&&!function(){return["RESTARTING","PREPARING","PULLING"].includes(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}(d.status||void 0)&&o.email===d.user_email,A=m.isLoading||T!==d.name;return(0,_.jsx)(h.Z,{ref:Z,children:N?(0,_.jsx)(h.Z.Item,{style:{margin:0},name:"name",rules:[{required:!0},{max:64},{pattern:/^(?:[a-zA-Z0-9][-a-zA-Z0-9._]{2,}[a-zA-Z0-9])?$/,message:b("session.Validation.EnterValidSessionName")},function(){return{validator:function(e,n){return l.includes(String(n))?Promise.reject(new Error(b("session.Validation.SessionNameAlreadyExist"))):Promise.resolve()}}}],children:(0,_.jsx)(x.Z,{autoFocus:!0,onPressEnter:function(){return function(){var e;null===(e=Z.current)||void 0===e||e.validateFields().then((function(e){var n=e.name;E(!1),C(n),m.mutate(n,{onSuccess:function(e){r&&r()},onError:function(e){C(d.name)}})})).catch((function(){}))}()},onKeyUp:function(e){"Escape"===e.key&&E(!1)}})}):(0,_.jsxs)(s.Z,{style:{maxWidth:250},children:[(0,_.jsx)(y.Z.Text,{ellipsis:{tooltip:{overlayInnerStyle:{width:"max-content"}}},style:{opacity:A?.5:1},children:T}),K&&(0,_.jsx)(v.ZP,{loading:A,type:"text",icon:(0,_.jsx)(f.Z,{}),style:{color:c.colorLink},onClick:function(){var e;null===(e=Z.current)||void 0===e||e.setFieldsValue({name:d.name}),E(!0)}})]})})},b=a(14644),I=a(87462),F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M912 820.1V203.9c28-9.9 48-36.6 48-67.9 0-39.8-32.2-72-72-72-31.3 0-58 20-67.9 48H203.9C194 84 167.3 64 136 64c-39.8 0-72 32.2-72 72 0 31.3 20 58 48 67.9v616.2C84 830 64 856.7 64 888c0 39.8 32.2 72 72 72 31.3 0 58-20 67.9-48h616.2c9.9 28 36.6 48 67.9 48 39.8 0 72-32.2 72-72 0-31.3-20-58-48-67.9zM888 112c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zM136 912c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-752c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm704 680H184V184h656v656zm48 72c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"}},{tag:"path",attrs:{d:"M288 474h448c8.8 0 16-7.2 16-16V282c0-8.8-7.2-16-16-16H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16zm56-136h336v64H344v-64zm-56 420h448c8.8 0 16-7.2 16-16V566c0-8.8-7.2-16-16-16H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16zm56-136h336v64H344v-64z"}}]},name:"group",theme:"outlined"},N=a(9491),E=function(e,n){return k.createElement(N.Z,(0,I.Z)({},e,{ref:n,icon:F}))};var L,R=k.forwardRef(E),T=a(3597),C=a(82548),K=a(32048),A=a.n(K),w=["status","limit","currentPage","pageSize","projectId","filter","extraFetchKey"],D=function(e){var n,t=e.status,g=void 0===t?[]:t,f=(e.limit,e.currentPage),h=void 0===f?1:f,x=e.pageSize,v=void 0===x?50:x,I=e.projectId,F=e.filter,N=e.extraFetchKey,E=void 0===N?"":N,K=(0,o.Z)(e,w),D=(0,u.Dj)(),z=(0,u.Kr)("initial-fetch"),P=(0,i.Z)(z,2),V=P[0],G=P[1],H=(0,k.useDeferredValue)(V+E),M=(0,S.$G)().t,$=p.Z.useToken().token,U=(0,u.X6)(),B=(0,i.Z)(U,2)[1],O=B.getImageAliasName,q=B.getBaseVersion,Q=B.getBaseImage;!D.supports("avoid-hol-blocking")&&g.includes("SCHEDULED")&&(g=g.filter((function(e){return"SCHEDULED"!==e})));var X=(0,j.useLazyLoadQuery)(void 0!==L?L:L=a(72428),{limit:v,offset:(h-1)*v,status:null===(n=g)||void 0===n?void 0:n.join(","),group_id:I,skipClusterSize:!D.supports("multi-container")},{fetchKey:H,fetchPolicy:"network-only"}).compute_session_list,J={RESTARTING:"blue",PREPARING:"blue",PULLING:"blue",RUNNING:"green",PENDING:"green",SCHEDULED:"green",ERROR:"red"},W={"idle-timeout":"green","user-requested":"green",scheduled:"green","self-terminated":"green","no-available-instances":"red","failed-to-start":"red","creation-failed":"red"},Y={INTERACTIVE:"green",BATCH:"darkgreen",INFERENCE:"blue"};return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(T.Z,(0,r.Z)({scroll:{x:"max-content"},columns:[{title:M("session.SessionInfo"),render:function(e,n,a){return(0,_.jsx)(Z,{sessionFrgmt:n,sessionNameList:A().map(((null===X||void 0===X?void 0:X.items)||[]).filter(F)||[],"name"),onRename:function(){G(n.session_id+(new Date).toISOString())}},n.session_id)},fixed:"left"},{title:M("session.Status"),dataIndex:"status",render:function(e,n){return(0,_.jsx)(_.Fragment,{children:""!==n.status_info?(0,_.jsx)(c.Z,{values:[{label:e,color:A().get(J,e)},{label:n.status_info,color:A().get(W,n.status_info)}]}):(0,_.jsx)(C.Z,{color:A().get(J,e),children:e})})}},{title:M("general.Control")},{title:M("session.Configuration"),dataIndex:"mounts",render:function(e,n){return(0,_.jsxs)(_.Fragment,{children:[e.length>0?(0,_.jsxs)(s.Z,{gap:"xxs",style:{width:200},children:[(0,_.jsx)(b.Z,{}),(0,_.jsx)(y.Z.Text,{ellipsis:{tooltip:{overlayInnerStyle:{width:"max-content"},title:A().map(e,(function(e){return(0,_.jsx)("div",{children:e})}))}},children:e.join(", ")})]}):(0,_.jsxs)(s.Z,{gap:"xxs",style:{color:$.colorTextDisabled},children:[(0,_.jsx)(b.Z,{}),"No mount"]}),(0,_.jsxs)(s.Z,{gap:"xxs",children:[(0,_.jsx)(R,{}),n.scaling_group]}),(0,_.jsx)(s.Z,{gap:"xxs",children:n.occupied_slots&&A().map(JSON.parse(n.occupied_slots),(function(e,a){return(0,_.jsx)(m.ZP,{type:a,value:A().toString(e),opts:{shmem:A().sum(A().map(JSON.parse(n.resource_opts),(function(e){return e.shmem})))}},a)}))})]})}},{title:M("session.Usage")},{title:M("session.Reservation"),dataIndex:"created_at",render:function(e,n){var a=new Date(e).toLocaleString(),t=D.utils.elapsedTime(e,n.terminated_at);return(0,_.jsxs)(s.Z,{direction:"column",gap:"xs",children:[a,(0,_.jsx)(c.Z,{values:[M("session.ElapsedTime"),t]})]})}},{title:M("session.EnvironmentInfo"),render:function(e){return(0,_.jsx)(C.Z,{color:"gold",children:(0,_.jsxs)(s.Z,{direction:"column",children:[(0,_.jsxs)(s.Z,{gap:"xxs",children:[(0,_.jsx)(d.Z,{image:e.image}),(0,_.jsx)("div",{children:O(e.image)}),q(e.image)]}),(0,_.jsxs)(s.Z,{gap:"xxs",children:[(0,_.jsx)("div",{children:Q(e.image)}),e.architecture]})]})})}},{title:M("session.SessionType"),dataIndex:"type",render:function(e){return(0,_.jsx)(C.Z,{color:A().get(Y,e),children:e})}}].concat((0,l.Z)(D.is_admin||D._config.hideAgents?[{title:M("session.Agent"),dataIndex:"agents",render:function(e){return A().map(e,(function(e){return e}))}}]:[])),dataSource:((null===X||void 0===X?void 0:X.items)||[]).filter(F)},K))})},z={icon:function(e,n){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M695.4 164.1H470.8L281.2 491.5h157.4l-60.3 241 319.8-305.1h-211z",fill:n}},{tag:"path",attrs:{d:"M848.1 359.3H627.8L825.9 109c4.1-5.3.4-13-6.3-13H436.1c-2.8 0-5.5 1.5-6.9 4L170.1 547.5c-3.1 5.3.7 12 6.9 12h174.4L262 917.1c-1.9 7.8 7.5 13.3 13.3 7.7L853.6 373c5.2-4.9 1.7-13.7-5.5-13.7zM378.3 732.5l60.3-241H281.2l189.6-327.4h224.6L487.1 427.4h211L378.3 732.5z",fill:e}}]}},name:"thunderbolt",theme:"twotone"},P=function(e,n){return k.createElement(N.Z,(0,I.Z)({},e,{ref:n,icon:z}))};var V=k.forwardRef(P),G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M705.6 124.9a8 8 0 00-11.6 7.2v64.2c0 5.5 2.9 10.6 7.5 13.6a352.2 352.2 0 0162.2 49.8c32.7 32.8 58.4 70.9 76.3 113.3a355 355 0 0127.9 138.7c0 48.1-9.4 94.8-27.9 138.7a355.92 355.92 0 01-76.3 113.3 353.06 353.06 0 01-113.2 76.4c-43.8 18.6-90.5 28-138.5 28s-94.7-9.4-138.5-28a353.06 353.06 0 01-113.2-76.4A355.92 355.92 0 01184 650.4a355 355 0 01-27.9-138.7c0-48.1 9.4-94.8 27.9-138.7 17.9-42.4 43.6-80.5 76.3-113.3 19-19 39.8-35.6 62.2-49.8 4.7-2.9 7.5-8.1 7.5-13.6V132c0-6-6.3-9.8-11.6-7.2C178.5 195.2 82 339.3 80 506.3 77.2 745.1 272.5 943.5 511.2 944c239 .5 432.8-193.3 432.8-432.4 0-169.2-97-315.7-238.4-386.7zM480 560h64c4.4 0 8-3.6 8-8V88c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v464c0 4.4 3.6 8 8 8z"}}]},name:"poweroff",theme:"outlined"},H=function(e,n){return k.createElement(N.Z,(0,I.Z)({},e,{ref:n,icon:G}))};var M=k.forwardRef(H),$=a(52176),U=a(15850),B=a(45110),O=a(12674),q=["RUNNING","RESTARTING","TERMINATING","PENDING","SCHEDULED","PREPARING","PULLING"],Q={running:q,interactive:q,batch:q,inference:q,finished:["TERMINATED","CANCELLED"],others:["TERMINATING","ERROR"],default:q},X=function(e){var n=e.children,a=(0,S.$G)().t,t=(0,u.Dj)(),r=p.Z.useToken().token,o=(0,u.qh)(),c=(0,O.s0)(),d=(0,k.useState)("running"),m=(0,i.Z)(d,2),g=m[0],f=m[1],h=(0,k.useState)("next"),x=(0,i.Z)(h,2),j=x[0],Z=x[1];return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)($.Z,{message:(0,_.jsxs)(s.Z,{gap:"md",children:[(0,_.jsxs)(y.Z.Text,{children:["This is"," ","current"===j?"current version":"NEXT generation"," ","of session list. you can switch anytime."]}),(0,_.jsx)(U.Z,{options:[{label:"Current",value:"current"},{label:(0,_.jsx)(y.Z.Text,{style:{color:"next"===j?r.colorPrimary:void 0},children:"Next"}),value:"next",icon:(0,_.jsx)(V,{twoToneColor:r.colorWarning})}],value:j,onChange:function(e){return Z(e)}})]}),type:"warning",banner:!0,style:{marginTop:-14,marginLeft:-14,marginRight:-14}}),"next"===j?(0,_.jsxs)(s.Z,{direction:"column",align:"stretch",style:{padding:r.padding,gap:r.margin},children:[n,(0,_.jsxs)(s.Z,{direction:"column",align:"stretch",children:[(0,_.jsx)(s.Z,{style:{flex:1},children:(0,_.jsx)(B.Z,{activeKey:g,onChange:function(e){return f(e)},tabBarStyle:{marginBottom:0},style:{width:"100%",paddingLeft:r.paddingMD,paddingRight:r.paddingMD,borderTopLeftRadius:r.borderRadius,borderTopRightRadius:r.borderRadius},items:[{key:"running",label:a("session.Running")},{key:"interactive",label:a("session.Interactive")},{key:"batch",label:a("session.Batch")}].concat((0,l.Z)(t.supports("inference-workload")?[{key:"inference",label:a("session.Inference")}]:[]),[{key:"finished",label:a("session.Finished")},{key:"others",label:a("session.Others")}]),tabBarExtraContent:{right:(0,_.jsx)(s.Z,{direction:"row",gap:"sm",children:(0,_.jsx)(v.ZP,{type:"primary",icon:(0,_.jsx)(M,{}),onClick:function(){c("/session/start")},children:"START"})})}})}),(0,_.jsx)(k.Suspense,{fallback:(0,_.jsx)("div",{children:"loading.."}),children:(0,_.jsx)(D,{projectId:o.id,status:Q[g]||Q.default,filter:function(e){var n;return!["interactive","batch","inference"].includes(g)||(null===e||void 0===e||null===(n=e.type)||void 0===n?void 0:n.toLowerCase())===g},extraFetchKey:g})})]})]}):(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("backend-ai-session-view",{class:"page",name:"job",active:!0})})]})}}}]);
//# sourceMappingURL=503.5a7d5c64.chunk.js.map