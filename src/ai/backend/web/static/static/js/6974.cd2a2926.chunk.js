/*! For license information please see 6974.cd2a2926.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[6974],{14781:(e,a,n)=>{n.d(a,{A:()=>l});const l=(0,n(24604).A)("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},16974:(e,a,n)=>{n.r(a),n.d(a,{default:()=>ca});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"access_key"}],a=[{alias:null,args:[{kind:"Variable",name:"access_key",variableName:"access_key"}],concreteType:"DeleteKeyPair",kind:"LinkedField",name:"delete_keypair",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserCredentialListDeleteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserCredentialListDeleteMutation",selections:a},params:{cacheID:"00d579de4db39e2f3e48067fb19aaf72",id:null,metadata:{},name:"UserCredentialListDeleteMutation",operationKind:"mutation",text:"mutation UserCredentialListDeleteMutation(\n  $access_key: String!\n) {\n  delete_keypair(access_key: $access_key) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="b955bc28ed14b19b153f202b0f1e6e22";const i=l,r=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"access_key"},{defaultValue:null,kind:"LocalArgument",name:"props"}],a=[{alias:null,args:[{kind:"Variable",name:"access_key",variableName:"access_key"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyKeyPair",kind:"LinkedField",name:"modify_keypair",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserCredentialListModifyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserCredentialListModifyMutation",selections:a},params:{cacheID:"49292a75a914ad1eeb6f8e2667974b95",id:null,metadata:{},name:"UserCredentialListModifyMutation",operationKind:"mutation",text:"mutation UserCredentialListModifyMutation(\n  $access_key: String!\n  $props: ModifyKeyPairInput!\n) {\n  modify_keypair(access_key: $access_key, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();r.hash="b3504d39bac9dd8ac749460ba5e510c0";const t=r,s=function(){var e={defaultValue:null,kind:"LocalArgument",name:"domain_name"},a={defaultValue:null,kind:"LocalArgument",name:"email"},n={defaultValue:null,kind:"LocalArgument",name:"filter"},l={defaultValue:null,kind:"LocalArgument",name:"is_active"},i={defaultValue:null,kind:"LocalArgument",name:"limit"},r={defaultValue:null,kind:"LocalArgument",name:"offset"},t={defaultValue:null,kind:"LocalArgument",name:"order"},s=[{kind:"Variable",name:"domain_name",variableName:"domain_name"},{kind:"Variable",name:"email",variableName:"email"},{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"is_active",variableName:"is_active"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"order",variableName:"order"}],o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"user_id",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"is_admin",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"rate_limit",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"num_queries",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"concurrency_used",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null};return{fragment:{argumentDefinitions:[e,a,n,l,i,r,t],kind:"Fragment",metadata:null,name:"UserCredentialListQuery",selections:[{alias:null,args:s,concreteType:"KeyPairList",kind:"LinkedField",name:"keypair_list",plural:!1,selections:[{alias:null,args:null,concreteType:"KeyPair",kind:"LinkedField",name:"items",plural:!0,selections:[o,d,u,c,m,g,y,p,k,{args:null,kind:"FragmentSpread",name:"KeypairSettingModalFragment"},{args:null,kind:"FragmentSpread",name:"KeypairInfoModalFragment"}],storageKey:null},_],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[i,r,n,t,e,a,l],kind:"Operation",name:"UserCredentialListQuery",selections:[{alias:null,args:s,concreteType:"KeyPairList",kind:"LinkedField",name:"keypair_list",plural:!1,selections:[{alias:null,args:null,concreteType:"KeyPair",kind:"LinkedField",name:"items",plural:!0,selections:[o,d,u,c,m,g,y,p,k,{alias:null,args:null,kind:"ScalarField",name:"secret_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_used",storageKey:null}],storageKey:null},_],storageKey:null}]},params:{cacheID:"3318983898774e0fa0110bbe3a8f1ad5",id:null,metadata:{},name:"UserCredentialListQuery",operationKind:"query",text:'query UserCredentialListQuery(\n  $limit: Int!\n  $offset: Int!\n  $filter: String\n  $order: String\n  $domain_name: String\n  $email: String\n  $is_active: Boolean\n) {\n  keypair_list(limit: $limit, offset: $offset, filter: $filter, order: $order, domain_name: $domain_name, email: $email, is_active: $is_active) {\n    items {\n      id\n      user_id\n      access_key\n      is_admin\n      resource_policy\n      created_at\n      rate_limit\n      num_queries\n      concurrency_used @since(version: "24.09.0")\n      ...KeypairSettingModalFragment\n      ...KeypairInfoModalFragment\n    }\n    total_count\n  }\n}\n\nfragment KeypairInfoModalFragment on KeyPair {\n  user_id\n  access_key\n  secret_key\n  is_admin\n  created_at\n  last_used\n  resource_policy\n  num_queries\n  rate_limit\n  concurrency_used @since(version: "24.09.0")\n}\n\nfragment KeypairSettingModalFragment on KeyPair {\n  rate_limit\n  access_key\n  resource_policy\n}\n'}}}();s.hash="591117e6f6a9853325076522a5e68177";const o=s;var d=n(40690),u=n(91225),c=n(72792),m=n(56276),g=n(11863);const y=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"domain_name"},{defaultValue:null,kind:"LocalArgument",name:"email"}],a=[{kind:"Variable",name:"domain_name",variableName:"domain_name"},{kind:"Variable",name:"email",variableName:"email"}],n={alias:null,args:null,kind:"ScalarField",name:"main_access_key",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairInfoModalQuery",selections:[{alias:null,args:a,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairInfoModalQuery",selections:[{alias:null,args:a,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"ae75c283d1803be0e160390a438f1ef0",id:null,metadata:{},name:"KeypairInfoModalQuery",operationKind:"query",text:'query KeypairInfoModalQuery(\n  $domain_name: String\n  $email: String\n) {\n  user(domain_name: $domain_name, email: $email) {\n    main_access_key @since(version: "24.03.0")\n    id\n  }\n}\n'}}}();y.hash="4e1858d8f369f238aa329976b4678e7b";const p=y,k={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"KeypairInfoModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"user_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"secret_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_admin",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"last_used",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"num_queries",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rate_limit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"concurrency_used",storageKey:null}],type:"KeyPair",abstractKey:null,hash:"11d6baebc6283f59151dab410a2a80d2"},_=k;var v=n(20353),f=n(7957),S=n(30621),b=n(64754),K=n(67631),h=n(8905),x=n.n(h),A=n(84765),F=n(46336),j=n(89374);const M=["keypairInfoModalFrgmt","onRequestClose"],T=e=>{var a;let{keypairInfoModalFrgmt:n=null,onRequestClose:l}=e,i=(0,g.A)(e,M);const{token:r}=v.A.useToken(),t=(0,F.useFragment)(_,n),{user:s}=(0,F.useLazyLoadQuery)(p,{email:null===t||void 0===t?void 0:t.user_id},{fetchPolicy:i.open&&null!==t&&void 0!==t&&t.user_id?"network-only":"store-only"});return(0,j.jsxs)(K.Ib,(0,m.A)((0,m.A)({title:(0,j.jsxs)(K.OO,{gap:"xs",children:[(0,j.jsx)(f.A.Text,{style:{fontSize:r.fontSizeHeading5},children:(0,A.t)("credential.KeypairDetail")}),(null===s||void 0===s?void 0:s.main_access_key)===(null===t||void 0===t?void 0:t.access_key)&&(0,j.jsx)(S.A,{color:"red",children:(0,A.t)("credential.MainAccessKey")})]}),onCancel:()=>l(),footer:null},i),{},{children:[(0,j.jsxs)(b.A,{title:(0,A.t)("credential.Information"),size:"small",column:1,labelStyle:{width:"40%"},children:[(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.UserID"),children:null===t||void 0===t?void 0:t.user_id}),(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.AccessKey"),children:null===t||void 0===t?void 0:t.access_key}),(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.SecretKey"),children:(0,j.jsx)(f.A.Text,{copyable:{text:null!==(a=null===t||void 0===t?void 0:t.secret_key)&&void 0!==a?a:""},children:null!==t&&void 0!==t&&t.secret_key?"********":""})}),(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.Permission"),children:null!==t&&void 0!==t&&t.is_admin?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(S.A,{color:"red",children:"admin"}),(0,j.jsx)(S.A,{color:"green",children:"user"})]}):(0,j.jsx)(S.A,{color:"green",children:"user"})}),(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.CreatedAt"),children:x()(null===t||void 0===t?void 0:t.created_at).format("lll")}),(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.LastUsed"),children:null!==t&&void 0!==t&&t.last_used?x()(null===t||void 0===t?void 0:t.last_used).format("lll"):"-"})]}),(0,j.jsx)("br",{}),(0,j.jsxs)(b.A,{title:(0,A.t)("credential.Allocation"),size:"small",column:1,labelStyle:{width:"40%"},children:[(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.ResourcePolicy"),children:null===t||void 0===t?void 0:t.resource_policy}),(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.NumberOfQueries"),children:null===t||void 0===t?void 0:t.num_queries}),(0,j.jsx)(b.A.Item,{label:(0,A.t)("credential.ConcurrentSessions"),children:null===t||void 0===t?void 0:t.concurrency_used}),(0,j.jsx)(b.A.Item,{label:"".concat((0,A.t)("credential.RateLimit")," ").concat((0,A.t)("credential.For900Seconds")),children:null===t||void 0===t?void 0:t.rate_limit})]})]}))},I=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"access_key"},{defaultValue:null,kind:"LocalArgument",name:"props"}],a=[{alias:null,args:[{kind:"Variable",name:"access_key",variableName:"access_key"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyKeyPair",kind:"LinkedField",name:"modify_keypair",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairSettingModalModifyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairSettingModalModifyMutation",selections:a},params:{cacheID:"0bf2a12bbaaabcbf7577479149266c0b",id:null,metadata:{},name:"KeypairSettingModalModifyMutation",operationKind:"mutation",text:"mutation KeypairSettingModalModifyMutation(\n  $access_key: String!\n  $props: ModifyKeyPairInput!\n) {\n  modify_keypair(access_key: $access_key, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();I.hash="59732bd851a981ce0e4bd3bda1b4c602";const L=I,P=function(){var e={defaultValue:null,kind:"LocalArgument",name:"props"},a={defaultValue:null,kind:"LocalArgument",name:"user_id"},n=[{alias:null,args:[{kind:"Variable",name:"props",variableName:"props"},{kind:"Variable",name:"user_id",variableName:"user_id"}],concreteType:"CreateKeyPair",kind:"LinkedField",name:"create_keypair",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,a],kind:"Fragment",metadata:null,name:"KeypairSettingModalCreateMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,e],kind:"Operation",name:"KeypairSettingModalCreateMutation",selections:n},params:{cacheID:"2911946ae5cad21bdff21cc88cf64c74",id:null,metadata:{},name:"KeypairSettingModalCreateMutation",operationKind:"mutation",text:"mutation KeypairSettingModalCreateMutation(\n  $user_id: String!\n  $props: KeyPairInput!\n) {\n  create_keypair(user_id: $user_id, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();P.hash="a81bb2d7d4e5a095deaf58a442f4211d";const C=P,U={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"KeypairSettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"rate_limit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null}],type:"KeyPair",abstractKey:null,hash:"a453330249f3d6cb4a241e19f2314614"},w=U;var D=n(59991);const O=function(){var e=[{alias:null,args:null,concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"KeypairResourcePolicySelectorQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"KeypairResourcePolicySelectorQuery",selections:e},params:{cacheID:"98cc9e7ac02916e772401f1672dc324f",id:null,metadata:{},name:"KeypairResourcePolicySelectorQuery",operationKind:"query",text:"query KeypairResourcePolicySelectorQuery {\n  keypair_resource_policies {\n    name\n  }\n}\n"}}}();O.hash="3052deb294da5fb0ec7a981d8fade18f";const N=O;var V=n(48880),q=n(66673),R=n(67692),$=n(47699),Q=n.n($),E=n(62962);const z=e=>{let a=Object.assign({},((0,D.A)(e),e));const{t:n}=(0,E.Bd)(),[l,i]=(0,q.A)({value:a.value,onChange:a.onChange}),{keypair_resource_policies:r}=(0,F.useLazyLoadQuery)(N,{},{fetchPolicy:"store-and-network"});return(0,j.jsx)(R.A,(0,m.A)((0,m.A)({showSearch:!0,placeholder:n("credential.SelectPolicy"),options:Q().map(r,(e=>({value:null===e||void 0===e?void 0:e.name,label:null===e||void 0===e?void 0:e.name}))).sort(((e,a)=>(0,V._f)(null===e||void 0===e?void 0:e.label,null===a||void 0===a?void 0:a.label)))},a),{},{value:l,onChange:(e,a)=>{i(e,a)}}))};var B=n(74031),G=n(284),X=n(87621),Y=n(86671),H=n(30369),W=n(83499),Z=n(17534);const J=["keypairSettingModalFrgmt","onRequestClose"],ee=e=>{let{keypairSettingModalFrgmt:a=null,onRequestClose:n}=e,l=(0,g.A)(e,J);const{t:i}=(0,E.Bd)(),{message:r}=B.A.useApp(),t=(0,Z.useRef)(null),s=(0,F.useFragment)(w,a),[o,d]=(0,F.useMutation)(C),[u,c]=(0,F.useMutation)(L);return(0,j.jsx)(K.Ib,(0,m.A)((0,m.A)({title:i(s?"credential.ModifyKeypairResourcePolicy":"credential.AddCredential"),width:500,destroyOnHidden:!0,onOk:()=>{var e;null===(e=t.current)||void 0===e||e.validateFields().then((e=>{var a,l;s?u({variables:{access_key:null!==(a=s.access_key)&&void 0!==a?a:"",props:{rate_limit:e.rate_limit,resource_policy:e.resource_policy}},onCompleted:(e,a)=>{var l,t;if(null===(l=e.modify_keypair)||void 0===l||!l.ok||a)return r.error(null===e||void 0===e||null===(t=e.modify_keypair)||void 0===t?void 0:t.msg),void n(!1);r.success(i("notification.SuccessfullyUpdated")),n(!0)},onError:e=>{r.error(e.message),n(!1)}}):o({variables:{user_id:null!==(l=e.user_id)&&void 0!==l?l:"",props:{rate_limit:e.rate_limit,resource_policy:e.resource_policy}},onCompleted:(e,a)=>{var l,t;if(null===(l=e.create_keypair)||void 0===l||!l.ok||a)return r.error(null===e||void 0===e||null===(t=e.create_keypair)||void 0===t?void 0:t.msg),void n(!1);r.success(i("credential.KeypairCreated")),n(!0)},onError:e=>{r.error(e.message),n(!1)}})})).catch((()=>{}))},okButtonProps:{loading:d||c},onCancel:()=>n(!1)},l),{},{children:(0,j.jsxs)(G.A,{ref:t,layout:"vertical",initialValues:s?(0,m.A)({},s):{},children:[!s&&(0,j.jsx)(G.A.Item,{name:"user_id",label:i("credential.UserIDAsEmail"),rules:[{required:!0},{type:"email"}],children:(0,j.jsx)(X.A,{})}),(0,j.jsxs)(Y.A,{gutter:16,children:[(0,j.jsx)(H.A,{span:12,children:(0,j.jsx)(G.A.Item,{name:"resource_policy",label:i("credential.ResourcePolicy"),rules:[{required:!0}],children:(0,j.jsx)(z,{})})}),(0,j.jsx)(H.A,{span:12,children:(0,j.jsx)(G.A.Item,{name:"rate_limit",label:i("credential.RateLimitFor15min"),rules:[{required:!0},{type:"number",min:0,max:5e4},{validator:(e,a)=>a<=100?Promise.reject(i("credential.WarningLessRateLimit")):Promise.resolve(),warningOnly:!0}],children:(0,j.jsx)(W.A,{min:0,max:5e4,style:{width:"100%"}})})})]})]})}))};var ae=n(74285),ne=n(64284),le=n(10292),ie=n(75909),re=n(87844),te=n(15121),se=n(20908),oe=n(52866),de=n(71928),ue=n(14781),ce=n(73233);const me=()=>{const{t:e}=(0,E.Bd)(),{token:a}=v.A.useToken(),{message:n,modal:l}=B.A.useApp(),{logger:r}=(0,K.Q7)(),[s,m]=(0,ce.useQueryParam)("action",ce.StringParam),[g,y]=(0,K.Tw)("first"),[p,k]=(0,ce.useQueryParams)({activeType:(0,ce.withDefault)(ce.StringParam,"active"),order:(0,ce.withDefault)(ce.StringParam,void 0),filter:(0,ce.withDefault)(ce.StringParam,void 0)}),[_,b]=(0,Z.useState)(null),[h,A]=(0,Z.useState)(!1),[M,I]=(0,Z.useState)(null),[L,P]=(0,Z.useTransition)(),[C,U]=(0,Z.useTransition)(),{baiPaginationOption:w,tablePaginationOption:D,setTablePaginationOption:O}=(0,u.L0)({current:1,pageSize:20}),N={limit:w.limit,offset:w.offset,is_active:"active"===p.activeType,filter:p.filter,order:p.order},V=(0,Z.useDeferredValue)(N),q=(0,Z.useDeferredValue)(g),{keypair_list:R}=(0,F.useLazyLoadQuery)(o,V,{fetchKey:q,fetchPolicy:q===d.eI?"store-and-network":"network-only"}),[$,z]=(0,F.useMutation)(t),[G,X]=(0,F.useMutation)(i);return(0,Z.useEffect)((()=>{"add"===s&&(A(!0),m(void 0))}),[s,m]),(0,j.jsxs)(K.OO,{direction:"column",align:"stretch",gap:"sm",children:[(0,j.jsxs)(K.OO,{justify:"between",align:"start",gap:"xs",wrap:"wrap",children:[(0,j.jsxs)(K.OO,{gap:"sm",align:"start",children:[(0,j.jsx)(c.A,{value:p.activeType,onChange:e=>{k({activeType:e.target.value},"replaceIn"),O({current:1,pageSize:D.pageSize})},optionType:"button",options:[{label:e("general.Active"),value:"active"},{label:e("general.Inactive"),value:"inactive"}]}),(0,j.jsx)(K.Af,{filterProperties:[{key:"email",propertyLabel:e("credential.UserID"),type:"string"},{key:"access_key",propertyLabel:e("credential.AccessKey"),type:"string"},{key:"is_admin",propertyLabel:e("credential.Permission"),type:"boolean",strictSelection:!0,defaultOperator:"==",options:[{label:"admin",value:"true"},{label:"user",value:"false"}]},{key:"resource_policy",propertyLabel:e("credential.ResourcePolicy"),type:"string"}],value:p.filter,onChange:e=>{k({filter:e},"replaceIn")}})]}),(0,j.jsxs)(K.OO,{gap:"xs",children:[(0,j.jsx)(re.A,{title:e("button.Refresh"),children:(0,j.jsx)(te.Ay,{loading:q!==g,onClick:()=>{y()},icon:(0,j.jsx)(ae.A,{})})}),(0,j.jsx)(te.Ay,{type:"primary",icon:(0,j.jsx)(oe.A,{}),onClick:()=>{A(!0)},children:e("credential.AddCredential")})]})]}),(0,j.jsx)(K.zx,{rowKey:"id",scroll:{x:"max-content"},loading:V!==N,dataSource:(0,K.f)(null===R||void 0===R?void 0:R.items),columns:(0,K.YM)([{key:"accessKey",title:e("credential.AccessKey"),sorter:!0,render:(e,a)=>(0,j.jsx)(K.mQ,{monospace:!0,children:a.access_key})},{key:"userID",title:e("credential.UserID"),dataIndex:"email",fixed:"left",sorter:!0,render:(e,a)=>a.user_id},{key:"control",title:e("general.Control"),fixed:"left",render:(i,t)=>(0,j.jsxs)(K.OO,{gap:a.marginXS,children:[(0,j.jsx)(te.Ay,{type:"text",icon:(0,j.jsx)(ne.A,{style:{color:a.colorInfo}}),onClick:()=>{P((()=>{I(t)}))}}),(0,j.jsx)(te.Ay,{type:"text",icon:(0,j.jsx)(le.A,{style:{color:a.colorInfo}}),onClick:()=>{U((()=>{b(t)}))}}),"inactive"===p.activeType&&(0,j.jsx)(re.A,{title:e("credential.Activate"),children:(0,j.jsx)(se.A,{title:e("credential.ActivateCredential"),description:t.user_id,okText:e("credential.Activate"),placement:"left",onConfirm:()=>{var a;$({variables:{access_key:null!==(a=t.access_key)&&void 0!==a?a:"",props:{is_active:!0}},onCompleted:(a,l)=>{var i,r;null!==a&&void 0!==a&&null!==(i=a.modify_keypair)&&void 0!==i&&i.ok&&!l?(n.success(e("credential.KeypairStatusUpdatedSuccessfully")),y()):n.error(null===a||void 0===a||null===(r=a.modify_keypair)||void 0===r?void 0:r.msg)},onError:e=>{n.error(null===e||void 0===e?void 0:e.message),r.error(e)}})},children:(0,j.jsx)(te.Ay,{type:"text",icon:(0,j.jsx)(de.A,{})})})}),"active"===p.activeType?(0,j.jsx)(re.A,{title:e("credential.Deactivate"),children:(0,j.jsx)(se.A,{title:e("credential.DeactivateCredential"),description:t.user_id,okButtonProps:{loading:z},okType:"danger",okText:e("credential.Deactivate"),placement:"left",onConfirm:()=>{var a;$({variables:{access_key:null!==(a=t.access_key)&&void 0!==a?a:"",props:{is_active:!1}},onCompleted:(a,l)=>{var i,r;null!==a&&void 0!==a&&null!==(i=a.modify_keypair)&&void 0!==i&&i.ok&&!l?(n.success(e("credential.KeypairStatusUpdatedSuccessfully")),y()):n.error(null===a||void 0===a||null===(r=a.modify_keypair)||void 0===r?void 0:r.msg)},onError:e=>{n.error(null===e||void 0===e?void 0:e.message),r.error(e)}})},children:(0,j.jsx)(te.Ay,{type:"text",danger:!0,icon:(0,j.jsx)(ue.A,{})})})}):(0,j.jsx)(te.Ay,{type:"text",danger:!0,icon:(0,j.jsx)(ie.A,{}),loading:X,onClick:()=>{l.confirm({title:e("credential.DeleteCredential"),content:(0,j.jsxs)(K.OO,{direction:"column",align:"stretch",children:[(0,j.jsx)(f.A.Text,{children:e("credential.YouAreAboutToDeleteCredential")}),(0,j.jsx)(f.A.Text,{strong:!0,children:t.user_id}),(0,j.jsx)("br",{}),(0,j.jsx)(f.A.Text,{type:"danger",children:e("dialog.warning.CannotBeUndone")})]}),onOk:()=>{var a;G({variables:{access_key:null!==(a=t.access_key)&&void 0!==a?a:""},onCompleted:(a,l)=>{var i,r;null!==a&&void 0!==a&&null!==(i=a.delete_keypair)&&void 0!==i&&i.ok&&!l?(n.success(e("credential.KeypairSuccessfullyDeleted")),y()):n.error(null===a||void 0===a||null===(r=a.delete_keypair)||void 0===r?void 0:r.msg)},onError:e=>{n.error(null===e||void 0===e?void 0:e.message),r.error(e)}})},okButtonProps:{danger:!0},okText:e("button.Delete")})}})]})},{key:"permission",title:e("credential.Permission"),dataIndex:"is_admin",render:e=>e?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(S.A,{color:"red",children:"admin"}),(0,j.jsx)(S.A,{color:"green",children:"user"})]}):(0,j.jsx)(S.A,{color:"green",children:"user"}),sorter:!0},{key:"keyAge",title:e("credential.KeyAge"),dataIndex:"created_at",render:a=>"".concat(x()().diff(a,"day")).concat(e("credential.Days")),sorter:!0},{key:"createdAt",title:e("credential.CreatedAt"),dataIndex:"created_at",render:e=>x()(e).format("lll"),sorter:!0},{key:"resourcePolicy",title:e("credential.ResourcePolicy"),dataIndex:"resource_policy",sorter:!0},{key:"allocation",title:e("credential.Allocation"),render:n=>(0,j.jsxs)(K.OO,{direction:"column",align:"start",children:[(0,j.jsxs)(f.A.Text,{children:[n.concurrency_used,(0,j.jsx)(f.A.Text,{type:"secondary",style:{marginLeft:a.marginXXS,fontSize:a.fontSizeSM},children:e("credential.Sessions")})]}),(0,j.jsxs)(f.A.Text,{style:{fontSize:a.fontSizeSM},children:[n.rate_limit,(0,j.jsx)(f.A.Text,{type:"secondary",style:{marginLeft:a.marginXXS,fontSize:a.fontSizeSM},children:e("credential.ReqPer15Min")})]}),(0,j.jsxs)(f.A.Text,{style:{fontSize:a.fontSizeSM},children:[n.num_queries,(0,j.jsx)(f.A.Text,{type:"secondary",style:{marginLeft:a.marginXXS,fontSize:a.fontSizeSM},children:e("credential.Queries")})]})]})}]),showSorterTooltip:!1,pagination:{pageSize:D.pageSize,total:(null===R||void 0===R?void 0:R.total_count)||0,current:D.current,onChange(e,a){Q().isNumber(e)&&Q().isNumber(a)&&O({current:e,pageSize:a})}},onChangeOrder:e=>{k({order:e},"replaceIn")}}),(0,j.jsx)(T,{keypairInfoModalFrgmt:M,open:!!M||L,loading:L,onRequestClose:()=>{I(null)}}),(0,j.jsx)(ee,{keypairSettingModalFrgmt:_,loading:C,open:!!_||C||h,onRequestClose:e=>{b(null),A(!1),e&&y()}})]})},ge=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"email"},{defaultValue:null,kind:"LocalArgument",name:"props"}],a=[{alias:null,args:[{kind:"Variable",name:"email",variableName:"email"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyUser",kind:"LinkedField",name:"modify_user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserManagementModifyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserManagementModifyMutation",selections:a},params:{cacheID:"cd14b770d01d9b6e13257faa0f84f3cd",id:null,metadata:{},name:"UserManagementModifyMutation",operationKind:"mutation",text:"mutation UserManagementModifyMutation(\n  $email: String!\n  $props: ModifyUserInput!\n) {\n  modify_user(email: $email, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();ge.hash="ebfe36ddd47871027ed7d1e84b98c347";const ye=ge,pe=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},a={defaultValue:null,kind:"LocalArgument",name:"first"},n={defaultValue:null,kind:"LocalArgument",name:"offset"},l={defaultValue:null,kind:"LocalArgument",name:"order"},i=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"order",variableName:"order"}],r={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null};return{fragment:{argumentDefinitions:[e,a,n,l],kind:"Fragment",metadata:null,name:"UserManagementQuery",selections:[{alias:null,args:i,concreteType:"UserConnection",kind:"LinkedField",name:"user_nodes",plural:!1,selections:[r,{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"UserNode",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"RequiredField",field:t,action:"THROW"},{kind:"RequiredField",field:s,action:"THROW"},{args:null,kind:"FragmentSpread",name:"BAIUserNodesFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,e,l],kind:"Operation",name:"UserManagementQuery",selections:[{alias:null,args:i,concreteType:"UserConnection",kind:"LinkedField",name:"user_nodes",plural:!1,selections:[r,{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"UserNode",kind:"LinkedField",name:"node",plural:!1,selections:[t,s,{alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modified_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"domain_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowed_client_ip",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"container_gids",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"container_main_gid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"container_uid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status_info",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sudo_session_enabled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"need_password_change",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"totp_activated",storageKey:null},{alias:null,args:null,concreteType:"GroupConnection",kind:"LinkedField",name:"project_nodes",plural:!1,selections:[r,{alias:null,args:null,concreteType:"GroupEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"GroupNode",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"c4e4acde8eabe104fff9fd39b0200dee",id:null,metadata:{},name:"UserManagementQuery",operationKind:"query",text:"query UserManagementQuery(\n  $first: Int\n  $offset: Int\n  $filter: String\n  $order: String\n) {\n  user_nodes(first: $first, offset: $offset, filter: $filter, order: $order) {\n    count\n    edges {\n      node {\n        id\n        email\n        ...BAIUserNodesFragment\n      }\n    }\n  }\n}\n\nfragment BAIUserNodesFragment on UserNode {\n  id\n  email\n  full_name\n  role\n  description\n  username\n  created_at\n  modified_at\n  status\n  domain_name\n  resource_policy\n  allowed_client_ip\n  container_gids\n  container_main_gid\n  container_uid\n  status_info\n  sudo_session_enabled\n  need_password_change\n  totp_activated\n  project_nodes {\n    count\n    edges {\n      node {\n        name\n        id\n      }\n    }\n  }\n}\n"}}}();pe.hash="488306ac4e06660bb4637ecf72e106a0";const ke=pe;var _e=n(39120);const ve=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"email"},{defaultValue:null,kind:"LocalArgument",name:"isNotSupportSudoSessionEnabled"},{defaultValue:null,kind:"LocalArgument",name:"isTOTPSupported"}],a=[{kind:"Variable",name:"email",variableName:"email"}],n={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"need_password_change",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"domain_name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,concreteType:"UserGroup",kind:"LinkedField",name:"groups",plural:!0,selections:[u,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"sudo_session_enabled",storageKey:null},y={condition:"isTOTPSupported",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"totp_activated",storageKey:null}]},p={alias:null,args:null,kind:"ScalarField",name:"main_access_key",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserInfoModalQuery",selections:[{alias:null,args:a,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,l,i,r,t,s,o,d,c,m,g,y,p],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserInfoModalQuery",selections:[{alias:null,args:a,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,l,i,r,t,s,o,d,c,m,g,y,p,u],storageKey:null}]},params:{cacheID:"d675c49fbcf67cc926cd8f0f3f7a0a93",id:null,metadata:{},name:"UserInfoModalQuery",operationKind:"query",text:'query UserInfoModalQuery(\n  $email: String\n  $isNotSupportSudoSessionEnabled: Boolean!\n  $isTOTPSupported: Boolean!\n) {\n  user(email: $email) {\n    email\n    username\n    need_password_change\n    full_name\n    description\n    status\n    domain_name\n    role\n    groups {\n      id\n      name\n    }\n    resource_policy\n    sudo_session_enabled @skipOnClient(if: $isNotSupportSudoSessionEnabled)\n    totp_activated @include(if: $isTOTPSupported)\n    main_access_key @since(version: "23.09.7")\n    id\n  }\n}\n'}}}();ve.hash="4c1eaa080e82b723c9491072604e8925";const fe=ve;var Se=n(72828),be=n(40554);const Ke=["userEmail","onRequestClose"],he=e=>{let{userEmail:a,onRequestClose:n}=e,l=(0,g.A)(e,Ke);const{t:i}=(0,E.Bd)(),{isTOTPSupported:r,isLoading:t}=(0,Se.F4)(),{user:s}=(0,F.useLazyLoadQuery)(fe,{email:a,isNotSupportSudoSessionEnabled:!1,isTOTPSupported:null!==r&&void 0!==r&&r}),o={xxl:1,xl:1,lg:1,md:1,sm:1,xs:1};return(0,j.jsxs)(K.Ib,(0,m.A)((0,m.A)({centered:!0,title:i("credential.UserDetail"),footer:null,onCancel:n},l),{},{children:[(0,j.jsxs)(b.A,{size:"small",column:o,title:i("credential.Information"),labelStyle:{width:"50%"},children:[(0,j.jsx)(b.A.Item,{label:i("credential.UserID"),children:null===s||void 0===s?void 0:s.email}),(0,j.jsx)(b.A.Item,{label:i("credential.Description"),children:null===s||void 0===s?void 0:s.description}),(0,j.jsx)(b.A.Item,{label:i("credential.UserName"),children:null===s||void 0===s?void 0:s.username}),(0,j.jsx)(b.A.Item,{label:i("credential.FullName"),children:null===s||void 0===s?void 0:s.full_name}),(0,j.jsx)(b.A.Item,{label:i("credential.MainAccessKey"),children:null===s||void 0===s?void 0:s.main_access_key}),(0,j.jsx)(b.A.Item,{label:i("credential.DescActiveUser"),children:"active"===(null===s||void 0===s?void 0:s.status)?i("button.Yes"):i("button.No")}),(0,j.jsx)(b.A.Item,{label:i("credential.DescRequirePasswordChange"),children:null!==s&&void 0!==s&&s.need_password_change?i("button.Yes"):i("button.No")}),(0,j.jsx)(b.A.Item,{label:i("credential.EnableSudoSession"),children:null!==s&&void 0!==s&&s.sudo_session_enabled?i("button.Yes"):i("button.No")}),r&&(0,j.jsx)(b.A.Item,{label:i("webui.menu.TotpActivated"),children:(0,j.jsx)(be.A,{spinning:t,children:null!==s&&void 0!==s&&s.totp_activated?i("button.Yes"):i("button.No")})})]}),(0,j.jsx)("br",{}),(0,j.jsxs)(b.A,{size:"small",column:o,title:i("credential.Association"),labelStyle:{width:"50%"},children:[(0,j.jsx)(b.A.Item,{label:i("credential.Role"),children:null===s||void 0===s?void 0:s.role}),(0,j.jsx)(b.A.Item,{label:i("credential.Domain"),children:null===s||void 0===s?void 0:s.domain_name}),(0,j.jsx)(b.A.Item,{label:i("credential.ResourcePolicy"),children:null===s||void 0===s?void 0:s.resource_policy})]}),(0,j.jsx)("br",{}),(0,j.jsx)(b.A,{title:i("credential.ProjectAndGroup"),labelStyle:{width:"50%"},children:(0,j.jsx)(b.A.Item,{children:Q().map(null===s||void 0===s?void 0:s.groups,(e=>(0,j.jsx)(S.A,{children:null===e||void 0===e?void 0:e.name},null===e||void 0===e?void 0:e.id)))})})]}))},xe=function(){var e={defaultValue:null,kind:"LocalArgument",name:"email"},a={defaultValue:null,kind:"LocalArgument",name:"isNotSupportTotp"},n={defaultValue:null,kind:"LocalArgument",name:"props"},l=[{kind:"Variable",name:"email",variableName:"email"},{kind:"Variable",name:"props",variableName:"props"}],i={alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"need_password_change",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"domain_name",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},p={alias:null,args:null,concreteType:"UserGroup",kind:"LinkedField",name:"groups",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"sudo_session_enabled",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"totp_activated",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"allowed_client_ip",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"main_access_key",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"container_uid",storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"container_main_gid",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"container_gids",storageKey:null};return{fragment:{argumentDefinitions:[e,a,n],kind:"Fragment",metadata:null,name:"UserSettingModalCreateMutation",selections:[{alias:null,args:l,concreteType:"CreateUser",kind:"LinkedField",name:"create_user",plural:!1,selections:[i,r,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,s,o,d,u,c,m,g,y,p,k,_,v,f,S,b,K,h,{args:null,kind:"FragmentSpread",name:"TOTPActivateModalFragment"}],storageKey:null},{alias:null,args:null,concreteType:"KeyPair",kind:"LinkedField",name:"keypair",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"GeneratedKeypairListModalFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,n,a],kind:"Operation",name:"UserSettingModalCreateMutation",selections:[{alias:null,args:l,concreteType:"CreateUser",kind:"LinkedField",name:"create_user",plural:!1,selections:[i,r,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,s,o,d,u,c,m,g,y,p,k,_,v,f,S,b,K,h],storageKey:null},{alias:null,args:null,concreteType:"KeyPair",kind:"LinkedField",name:"keypair",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"secret_key",storageKey:null},{alias:null,args:null,concreteType:"UserInfo",kind:"LinkedField",name:"user_info",plural:!1,selections:[s],storageKey:null},t],storageKey:null}],storageKey:null}]},params:{cacheID:"e2216aeec5b3a041ac90522ef40e9b90",id:null,metadata:{},name:"UserSettingModalCreateMutation",operationKind:"mutation",text:"mutation UserSettingModalCreateMutation(\n  $email: String!\n  $props: UserInput!\n  $isNotSupportTotp: Boolean!\n) {\n  create_user(email: $email, props: $props) {\n    ok\n    msg\n    user {\n      id\n      email\n      username\n      need_password_change\n      full_name\n      description\n      status\n      domain_name\n      role\n      groups {\n        id\n        name\n      }\n      resource_policy\n      sudo_session_enabled\n      totp_activated @skipOnClient(if: $isNotSupportTotp)\n      allowed_client_ip\n      main_access_key\n      container_uid\n      container_main_gid\n      container_gids\n      ...TOTPActivateModalFragment\n    }\n    keypair {\n      ...GeneratedKeypairListModalFragment\n      id\n    }\n  }\n}\n\nfragment GeneratedKeypairListModalFragment on KeyPair {\n  access_key\n  secret_key\n  user_info {\n    email\n  }\n}\n\nfragment TOTPActivateModalFragment on User {\n  email\n  totp_activated @skipOnClient(if: $isNotSupportTotp)\n}\n"}}}();xe.hash="6eac042d5d8dba3d8446023d51158e3d";const Ae=xe,Fe=function(){var e={defaultValue:null,kind:"LocalArgument",name:"email"},a={defaultValue:null,kind:"LocalArgument",name:"isNotSupportTotp"},n={defaultValue:null,kind:"LocalArgument",name:"props"},l=[{kind:"Variable",name:"email",variableName:"email"},{kind:"Variable",name:"props",variableName:"props"}],i={alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"need_password_change",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"domain_name",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},p={alias:null,args:null,concreteType:"UserGroup",kind:"LinkedField",name:"groups",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"sudo_session_enabled",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"totp_activated",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"allowed_client_ip",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"main_access_key",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"container_uid",storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"container_main_gid",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"container_gids",storageKey:null};return{fragment:{argumentDefinitions:[e,a,n],kind:"Fragment",metadata:null,name:"UserSettingModalModifyMutation",selections:[{alias:null,args:l,concreteType:"ModifyUser",kind:"LinkedField",name:"modify_user",plural:!1,selections:[i,r,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,s,o,d,u,c,m,g,y,p,k,_,v,f,S,b,K,h,{args:null,kind:"FragmentSpread",name:"TOTPActivateModalFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,n,a],kind:"Operation",name:"UserSettingModalModifyMutation",selections:[{alias:null,args:l,concreteType:"ModifyUser",kind:"LinkedField",name:"modify_user",plural:!1,selections:[i,r,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,s,o,d,u,c,m,g,y,p,k,_,v,f,S,b,K,h],storageKey:null}],storageKey:null}]},params:{cacheID:"0f0585f16e798616c877e40a868728ea",id:null,metadata:{},name:"UserSettingModalModifyMutation",operationKind:"mutation",text:"mutation UserSettingModalModifyMutation(\n  $email: String!\n  $props: ModifyUserInput!\n  $isNotSupportTotp: Boolean!\n) {\n  modify_user(email: $email, props: $props) {\n    ok\n    msg\n    user {\n      id\n      email\n      username\n      need_password_change\n      full_name\n      description\n      status\n      domain_name\n      role\n      groups {\n        id\n        name\n      }\n      resource_policy\n      sudo_session_enabled\n      totp_activated @skipOnClient(if: $isNotSupportTotp)\n      allowed_client_ip\n      main_access_key\n      container_uid\n      container_main_gid\n      container_gids\n      ...TOTPActivateModalFragment\n    }\n  }\n}\n\nfragment TOTPActivateModalFragment on User {\n  email\n  totp_activated @skipOnClient(if: $isNotSupportTotp)\n}\n"}}}();Fe.hash="8c396239b33e382efa79b54f230378b8";const je=Fe,Me=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"email"},{defaultValue:null,kind:"LocalArgument",name:"isNotSupportTotp"}],a=[{kind:"Variable",name:"email",variableName:"email"}],n={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"need_password_change",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"full_name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"domain_name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,concreteType:"UserGroup",kind:"LinkedField",name:"groups",plural:!0,selections:[u,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"sudo_session_enabled",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"totp_activated",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"allowed_client_ip",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"main_access_key",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"container_uid",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"container_main_gid",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"container_gids",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserSettingModalQuery",selections:[{alias:null,args:a,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,l,i,r,t,s,o,d,c,m,g,y,p,k,_,v,f,{args:null,kind:"FragmentSpread",name:"TOTPActivateModalFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserSettingModalQuery",selections:[{alias:null,args:a,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,l,i,r,t,s,o,d,c,m,g,y,p,k,_,v,f,u],storageKey:null}]},params:{cacheID:"ce891f6376e333692778e57d40812a10",id:null,metadata:{},name:"UserSettingModalQuery",operationKind:"query",text:"query UserSettingModalQuery(\n  $email: String\n  $isNotSupportTotp: Boolean!\n) {\n  user(email: $email) {\n    email\n    username\n    need_password_change\n    full_name\n    description\n    status\n    domain_name\n    role\n    groups {\n      id\n      name\n    }\n    resource_policy\n    sudo_session_enabled\n    totp_activated @skipOnClient(if: $isNotSupportTotp)\n    allowed_client_ip\n    main_access_key\n    container_uid\n    container_main_gid\n    container_gids\n    ...TOTPActivateModalFragment\n    id\n  }\n}\n\nfragment TOTPActivateModalFragment on User {\n  email\n  totp_activated @skipOnClient(if: $isNotSupportTotp)\n}\n"}}}();Me.hash="fcd314cd2f431ffb74017e8c3b0d71bc";const Te=Me;var Ie=n(520),Le=n(62378);const Pe=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"email"}],a=[{kind:"Variable",name:"email",variableName:"email"}],n={alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"is_active",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"AccessKeySelectQuery",selections:[{alias:null,args:a,concreteType:"KeyPair",kind:"LinkedField",name:"keypairs",plural:!0,selections:[n,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"AccessKeySelectQuery",selections:[{alias:null,args:a,concreteType:"KeyPair",kind:"LinkedField",name:"keypairs",plural:!0,selections:[n,l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"f8b8c1a3ee357c66b8050c241b494312",id:null,metadata:{},name:"AccessKeySelectQuery",operationKind:"query",text:"query AccessKeySelectQuery(\n  $email: String!\n) {\n  keypairs(email: $email) {\n    access_key\n    is_active\n    id\n  }\n}\n"}}}();Pe.hash="7facb8a400bfd30d710d936f1551e2fb";const Ce=Pe,Ue=["userEmail","fetchKey"],we=e=>{let{userEmail:a,fetchKey:n}=e,l=(0,g.A)(e,Ue);const{t:i}=(0,E.Bd)(),{keypairs:r}=(0,F.useLazyLoadQuery)(Ce,{email:a},{fetchPolicy:"store-and-network",fetchKey:n}),t=Q().map(r,(e=>({value:null===e||void 0===e?void 0:e.access_key,label:null===e||void 0===e?void 0:e.access_key,disabled:!(null!==e&&void 0!==e&&e.is_active)})));return(0,j.jsx)(K.xr,(0,m.A)({placeholder:i("credential.SelectAccessKey"),options:t},l))},De={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"GeneratedKeypairListModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"secret_key",storageKey:null},{alias:null,args:null,concreteType:"UserInfo",kind:"LinkedField",name:"user_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],type:"KeyPair",abstractKey:null,hash:"a3a1b6d9c401dfb603fdda3157146445"},Oe=De;var Ne=n(73635),Ve=n(1125),qe=n(24446);const Re=["keypairFragment","onRequestClose"],$e=e=>{let{keypairFragment:a,onRequestClose:n}=e,l=(0,g.A)(e,Re);const{t:i}=(0,E.Bd)(),r=(0,F.useFragment)(Oe,a);return(0,j.jsx)(K.Ib,(0,m.A)((0,m.A)({title:i("credential.NewCredentialCreated"),width:600,destroyOnHidden:!0,okText:i("button.Download"),onOk:()=>{r&&(0,Ne.RM)(Q().map(r,(e=>{var a;return{email:null===e||void 0===e||null===(a=e.user_info)||void 0===a?void 0:a.email,"access key":null===e||void 0===e?void 0:e.access_key,"secret key":null===e||void 0===e?void 0:e.secret_key}})),"backendai_api_keypair")},okButtonProps:{icon:(0,j.jsx)(qe.A,{})},cancelText:i("button.Close"),onCancel:n},l),{},{children:(0,j.jsxs)(K.OO,{direction:"column",align:"stretch",gap:"sm",children:[(0,j.jsx)(Ve.A,{showIcon:!0,type:"success",title:i("credential.GeneratedKeypairSuccess")}),(0,j.jsx)(Ve.A,{showIcon:!0,type:"warning",title:i("credential.GeneratedKeypairWarning")}),(0,j.jsx)(K.mQ,{children:i("credential.GeneratedKeypairInfo")}),(0,j.jsx)(K.zx,{size:"small",style:{overflowX:"auto"},scroll:{x:"max-content",y:500},pagination:!1,dataSource:r,rowKey:"access_key",columns:[{title:i("general.E-Mail"),dataIndex:["user_info","email"],key:"email",sorter:(e,a)=>{var n,l;return(0,V._f)(null===e||void 0===e||null===(n=e.user_info)||void 0===n?void 0:n.email,null===a||void 0===a||null===(l=a.user_info)||void 0===l?void 0:l.email)},defaultSortOrder:"ascend"},{title:i("credential.AccessKey"),dataIndex:"access_key",key:"access_key",render:e=>(0,j.jsx)(K.mQ,{copyable:!0,monospace:!0,children:e}),sorter:(e,a)=>(0,V._f)(null===e||void 0===e?void 0:e.access_key,null===a||void 0===a?void 0:a.access_key)},{title:i("credential.SecretKey"),dataIndex:"secret_key",key:"secret_key",render:e=>(0,j.jsx)(K.mQ,{copyable:{text:e},children:"**********"}),sorter:(e,a)=>(0,V._f)(null===e||void 0===e?void 0:e.secret_key,null===a||void 0===a?void 0:a.secret_key)}]})]})}))};var Qe=n(76132),Ee=n(55857);const ze=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"max_session_count_per_model_session",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"max_customized_image_count",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserResourcePolicySelectorQuery",selections:[{alias:null,args:null,concreteType:"UserResourcePolicy",kind:"LinkedField",name:"user_resource_policies",plural:!0,selections:[e,a,n,l,i,r,t,{args:null,kind:"FragmentSpread",name:"UserResourcePolicySettingModalFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserResourcePolicySelectorQuery",selections:[{alias:null,args:null,concreteType:"UserResourcePolicy",kind:"LinkedField",name:"user_resource_policies",plural:!0,selections:[e,a,n,l,i,r,t],storageKey:null}]},params:{cacheID:"5c0bb0244594feb3fc33aadcac7ffb2f",id:null,metadata:{},name:"UserResourcePolicySelectorQuery",operationKind:"query",text:'query UserResourcePolicySelectorQuery {\n  user_resource_policies {\n    id\n    name\n    created_at\n    max_vfolder_count @since(version: "23.09.6")\n    max_session_count_per_model_session @since(version: "23.09.10")\n    max_quota_scope_size @since(version: "23.09.2")\n    max_customized_image_count @since(version: "24.03.0")\n    ...UserResourcePolicySettingModalFragment\n  }\n}\n\nfragment UserResourcePolicySettingModalFragment on UserResourcePolicy {\n  id\n  name\n  max_vfolder_count @since(version: "23.09.6")\n  max_session_count_per_model_session @since(version: "23.09.10")\n  max_quota_scope_size @since(version: "23.09.2")\n  max_customized_image_count @since(version: "24.03.0")\n}\n'}}}();ze.hash="df2a28e16edd8e8b4791053a89f9917f";const Be=ze,Ge=e=>{let a=Object.assign({},((0,D.A)(e),e));const{t:n}=(0,E.Bd)(),{user_resource_policies:l}=(0,F.useLazyLoadQuery)(Be,{},{fetchPolicy:"store-and-network"});return(0,j.jsx)(R.A,(0,m.A)({showSearch:!0,placeholder:n("credential.SelectPolicy"),options:Q().map(l,(e=>({value:null===e||void 0===e?void 0:e.name,label:null===e||void 0===e?void 0:e.name}))).sort(((e,a)=>(0,V._f)(null===e||void 0===e?void 0:e.label,null===a||void 0===a?void 0:a.label)))},a))};var Xe=n(45711),Ye=n(84423),He=n(42124),We=n(30270),Ze=n(9359),Je=n(61471);const ea=["userEmail","onRequestClose"],aa={superadmin:["superadmin","user"],admin:["user"]},na=e=>{let{userEmail:a=null,onRequestClose:n}=e,l=(0,g.A)(e,ea);const{t:i}=(0,E.Bd)(),{token:r}=v.A.useToken(),{modal:t}=B.A.useApp(),s=(0,Z.useRef)(null),{logger:o}=(0,K.Q7)(),u=(0,Se.Am)(),c=(0,d.eZ)(),y=(0,d.CX)(),{isTOTPSupported:p,isLoading:k}=(0,Se.F4)(),[_,{toggle:b}]=(0,Ye.A)(!1),[h,x]=(0,K.Tw)("initial-fetch"),A=(0,Z.useDeferredValue)(l.open),[M,T]=(0,Z.useState)(),{user:I}=(0,F.useLazyLoadQuery)(Te,{email:null!==a&&void 0!==a?a:"",isNotSupportTotp:!p},{fetchPolicy:A&&a?"network-only":"store-only",fetchKey:h}),[L,P]=(0,F.useMutation)(je),[C,U]=(0,F.useMutation)(Ae),w=(0,Le.ET)({mutationFn:e=>y.remove_totp(e)});return(0,j.jsx)(K.Ib,(0,m.A)((0,m.A)({centered:!0,title:i(I?"credential.ModifyUserDetail":"credential.CreateUser"),destroyOnHidden:!0,onOk:()=>{var e;null===(e=s.current)||void 0===e||e.validateFields().then((async e=>{const a=(0,m.A)((0,m.A)({},Q().omit(e,"email","password_confirm")),{},{container_gids:Q().map(e.container_gids,(e=>Q().toNumber(e))),need_password_change:e.need_password_change||!1});I?L({variables:{email:(null===e||void 0===e?void 0:e.email)||"",props:a,isNotSupportTotp:!p},onCompleted:(e,a)=>{var l,r,t;const s=null===a||void 0===a||null===(l=a[0])||void 0===l?void 0:l.message,d=!1===(null===e||void 0===e||null===(r=e.modify_user)||void 0===r?void 0:r.ok)?e.modify_user.msg:void 0;var u;if(!1===(null===(t=e.modify_user)||void 0===t?void 0:t.ok)||null!==a&&void 0!==a&&a[0])return He.Ay.error(d||s||i("error.UnknownError")),void o.error(null===e||void 0===e||null===(u=e.modify_user)||void 0===u?void 0:u.msg,s);He.Ay.success(i("environment.SuccessfullyModified")),n(!0)},onError:e=>{He.Ay.error(i("dialog.ErrorOccurred")),o.error(e)}}):C({variables:{email:(null===e||void 0===e?void 0:e.email)||"",props:(0,m.A)((0,m.A)({},a),{},{password:e.password}),isNotSupportTotp:!p},onCompleted:(e,a)=>{var l,r,t,s;const d=null===a||void 0===a||null===(l=a[0])||void 0===l?void 0:l.message,u=!1===(null===e||void 0===e||null===(r=e.create_user)||void 0===r?void 0:r.ok)?e.create_user.msg:void 0;var c;return u&&u.includes("already exists")||d&&d.includes("The user already exists")?(He.Ay.error(i("credential.UserAccountCreatedError")),void o.error(null===e||void 0===e||null===(c=e.create_user)||void 0===c?void 0:c.msg,d)):!1===(null===(t=e.create_user)||void 0===t?void 0:t.ok)||null!==a&&void 0!==a&&a[0]?(He.Ay.error(u||d||i("error.UnknownError")),void o.error(e,a)):void(null!==(s=e.create_user)&&void 0!==s&&s.keypair?T([e.create_user.keypair]):n(!0))},onError:e=>{He.Ay.error(i("dialog.ErrorOccurred")),o.error(e)}})})).catch((e=>o.error(e)))},confirmLoading:P||U,onCancel:()=>n(!1),loading:A!==l.open},l),{},{children:(0,j.jsxs)(Z.Suspense,{fallback:(0,j.jsx)(We.A,{active:!0}),children:[(0,j.jsxs)(G.A,{ref:s,preserve:!1,validateTrigger:["onChange","onBlur"],initialValues:I?(0,m.A)((0,m.A)({},I),{},{container_gids:I.container_gids?Q().map(I.container_gids,(e=>String(e))):void 0}):{need_password_change:!1,status:"active",domain_name:c,role:"user",is_active:!0,resource_policy:"default"},layout:"vertical",children:[(0,j.jsx)(G.A.Item,{name:"email",label:i("general.E-Mail"),rules:[{required:!I},{type:"email"}],children:(0,j.jsx)(X.A,{disabled:!!I})}),(0,j.jsx)(G.A.Item,{name:"username",label:i("credential.UserName"),rules:[{max:64},{required:!0}],children:(0,j.jsx)(X.A,{placeholder:i("maxLength.64chars")})}),(0,j.jsx)(G.A.Item,{name:"full_name",label:i("credential.FullName"),rules:[{max:64}],children:(0,j.jsx)(X.A,{placeholder:i("maxLength.64chars")})}),(0,j.jsx)(G.A.Item,{name:"password",label:i(I?"general.NewPassword":"general.Password"),rules:[{required:!I},{pattern:/^(?=.*\d)(?=.*[a-zA-Z])(?=.*[_\W]).{8,}$/,message:i("webui.menu.InvalidPasswordMessage")}],children:(0,j.jsx)(X.A.Password,{})}),(0,j.jsx)(G.A.Item,{name:"password_confirm",dependencies:["password"],label:i(I?"webui.menu.NewPasswordAgain":"general.ConfirmPassword"),rules:[{required:!I,message:""},e=>{let{getFieldValue:a}=e;return{validator:(e,n)=>!n&&a("password")?Promise.reject(new Error(i("webui.menu.PleaseConfirmYourPassword"))):n&&a("password")!==n?Promise.reject(new Error(i("environment.PasswordsDoNotMatch"))):Promise.resolve()}}],children:(0,j.jsx)(X.A.Password,{})}),(0,j.jsx)(G.A.Item,{name:"need_password_change",label:i("credential.DescRequirePasswordChange"),valuePropName:"checked",tooltip:i("credential.TooltipForRequirePasswordChange"),children:(0,j.jsx)(Ze.A,{})}),(0,j.jsx)(G.A.Item,{name:"description",label:i("credential.Description"),rules:[{max:500}],children:(0,j.jsx)(X.A.TextArea,{placeholder:i("maxLength.500chars")})}),(0,j.jsx)(G.A.Item,{name:"status",label:i("credential.UserStatus"),children:(0,j.jsx)(R.A,{options:[{value:"active",label:i("general.Active")},{value:"inactive",label:i("general.Inactive")},{value:"before-verification",label:i("credential.BeforeVerification")},{value:"deleted",label:i("credential.Deleted")}]})}),!!u&&u in aa&&(0,j.jsx)(G.A.Item,{name:"role",label:i("credential.Role"),children:(0,j.jsx)(R.A,{options:Q().map(aa[u],(e=>({value:e,label:e})))})}),(0,j.jsx)(G.A.Item,{name:"sudo_session_enabled",label:i("credential.EnableSudoSession"),valuePropName:"checked",children:(0,j.jsx)(Ze.A,{})}),!!p&&(0,j.jsx)(G.A.Item,{name:"totp_activated",label:i("webui.menu.TotpActivated"),valuePropName:"checked",extra:(null===I||void 0===I?void 0:I.email)!==(null===y||void 0===y?void 0:y.email)&&(0,j.jsx)(f.A.Text,{type:"secondary",style:{fontSize:r.fontSizeSM},children:i("credential.AdminCanOnlyRemoveTotp")}),children:(0,j.jsx)(Je.A,{loading:k||w.isPending,disabled:(null===I||void 0===I?void 0:I.email)!==(null===y||void 0===y?void 0:y.email)&&!(null!==I&&void 0!==I&&I.totp_activated),onChange:e=>{var a;e?b():null!==I&&void 0!==I&&I.totp_activated&&(null===(a=s.current)||void 0===a||a.setFieldValue("totp_activated",!0),t.confirm({title:i("totp.TurnOffTotp"),icon:(0,j.jsx)(Xe.A,{}),content:i("totp.ConfirmTotpRemovalBody"),okText:i("button.Yes"),okType:"danger",cancelText:i("button.No"),onOk(){w.mutate((null===I||void 0===I?void 0:I.email)||"",{onSuccess:()=>{var e;He.Ay.success(i("totp.RemoveTotpSetupCompleted")),x(),null===(e=s.current)||void 0===e||e.setFieldValue("totp_activated",!1)},onError:e=>{o.error(e)}})},onCancel(){var e;null===(e=s.current)||void 0===e||e.setFieldValue("totp_activated",!0)}}))}})}),(0,j.jsx)(G.A.Item,{name:"resource_policy",label:i("resourcePolicy.ResourcePolicy"),rules:[{required:!I}],children:(0,j.jsx)(Ge,{})}),(0,j.jsx)(G.A.Item,{name:"domain_name",label:i("credential.Domain"),rules:[{required:!0}],children:(0,j.jsx)(K.in,{})}),(0,j.jsx)(Z.Suspense,{fallback:(0,j.jsx)(G.A.Item,{label:i("credential.Projects"),children:(0,j.jsx)(R.A,{loading:!0})}),children:(0,j.jsx)(G.A.Item,{noStyle:!0,dependencies:["domain_name"],children:e=>{let{getFieldValue:a}=e;return(0,j.jsx)(G.A.Item,{name:"group_ids",label:i("credential.Projects"),getValueFromEvent:e=>e,getValueProps:e=>({value:Q().isArray(e)?e:Q().map(null===I||void 0===I?void 0:I.groups,(e=>null===e||void 0===e?void 0:e.id))}),children:(0,j.jsx)(Qe.A,{mode:"multiple",domain:a("domain_name"),disableDefaultFilter:!0})})}})}),(0,j.jsx)(G.A.Item,{name:"allowed_client_ip",label:i("credential.AllowedClientIP"),extra:i("credential.AllowedClientIPHint"),rules:[{validator:async(e,a)=>{if(!a||0===a.length)return Promise.resolve();const n=a.filter((e=>!(0,V.hD)(e)));return n.length>0?Promise.reject(new Error("".concat(i("credential.InvalidIP"),": ").concat(n.join(", ")))):Promise.resolve()}}],children:(0,j.jsx)(R.A,{mode:"tags",tokenSeparators:[","," "],tagRender:e=>{const a=Q().isString(e.label)&&(0,V.hD)(e.label);return(0,j.jsx)(S.A,(0,m.A)((0,m.A)({color:a?void 0:"red"},e),{},{children:e.label}))},open:!1,suffixIcon:null,placeholder:i("credential.AllowedClientIPPlaceholder")})}),(0,j.jsx)(G.A.Item,{name:"container_uid",label:i("credential.ContainerUID"),tooltip:i("credential.ContainerUIDTooltip"),children:(0,j.jsx)(W.A,{style:{width:"100%"},max:Ie.tu,min:0})}),(0,j.jsx)(G.A.Item,{name:"container_main_gid",label:i("credential.ContainerGID"),tooltip:i("credential.ContainerGIDTooltip"),children:(0,j.jsx)(W.A,{style:{width:"100%"},max:Ie.tu,min:0})}),(0,j.jsx)(G.A.Item,{name:"container_gids",label:i("credential.ContainerSupplementaryGIDs"),tooltip:i("credential.ContainerSupplementaryGIDsTooltip"),rules:[()=>({validator:(e,a)=>Q().isEmpty(a)||Q().every(a,(e=>Q().toNumber(e)<=Ie.tu))?Promise.resolve():Promise.reject(new Error(i("credential.validation.PleaseEnterUnder2_31")))}),()=>({validator:(e,a)=>Q().isEmpty(a)||Q().every(a,(e=>Q().isInteger(Q().toNumber(e))))?Promise.resolve():Promise.reject(new Error(i("credential.validation.PleaseEnterValidNumber")))}),()=>({validator:(e,a)=>Q().isEmpty(a)||Q().uniq(a).length===a.length?Promise.resolve():Promise.reject(new Error(i("credential.validation.PleaseEnterUniqueNumbers")))})],children:(0,j.jsx)(R.A,{mode:"tags",tokenSeparators:[","," "],open:!1,suffixIcon:null,placeholder:i("credential.ContainerSupplementaryGIDsPlaceholder")})}),!!I&&a&&(0,j.jsx)(Z.Suspense,{fallback:(0,j.jsx)(G.A.Item,{label:i("credential.MainAccessKey"),children:(0,j.jsx)(R.A,{loading:!0})}),children:(0,j.jsx)(G.A.Item,{name:"main_access_key",label:i("credential.MainAccessKey"),children:(0,j.jsx)(we,{userEmail:a,fetchKey:h})})})]}),!!p&&(0,j.jsx)(Ee.A,{userFrgmt:I,open:_,onRequestClose:e=>{var a;e?x():null===(a=s.current)||void 0===a||a.setFieldValue("totp_activated",!1);b()}}),(0,j.jsx)(K.Xc,{children:(0,j.jsx)($e,{open:!!M,keypairFragment:(0,K.f)(M),onRequestClose:()=>{T(null),n(!0)}})})]})}))};const la=(0,n(24604).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var ia=n(80122),ra=n(10979);const ta=()=>{const e=(0,_e.c)(122),{logger:a}=(0,K.Q7)(),{t:n}=(0,E.Bd)(),{token:l}=v.A.useToken(),[i,r]=(0,d.zu)(),t=(0,d.CX)();let s,o;e[0]===Symbol.for("react.memo_cache_sentinel")?(s=ia.tU.withDefault(""),e[0]=s):s=e[0],e[1]===Symbol.for("react.memo_cache_sentinel")?(o={filter:s,order:ia.tU,status:(0,ia.M1)(["active","inactive"]).withDefault("active")},e[1]=o):o=e[1];const[m,g]=(0,ia.ab)(o),{message:y}=B.A.useApp(),[p,k]=(0,Z.useState)(null),[_,f]=(0,Z.useTransition)(),[S,b]=(0,Z.useTransition)(),[h,x]=(0,Z.useState)(null),[A,M]=(0,Z.useState)(!1);let T;e[2]===Symbol.for("react.memo_cache_sentinel")?(T={current:1,pageSize:10},e[2]=T):T=e[2];const{baiPaginationOption:I,tablePaginationOption:L,setTablePaginationOption:P}=(0,u.aW)(T),[C,U]=(0,Z.useState)(),w="active"===m.status?'status == "active"':'status != "active"',D=I.limit,O=I.offset;let N;e[3]!==m.filter||e[4]!==w?(N=(0,K.r2)([m.filter,w]),e[3]=m.filter,e[4]=w,e[5]=N):N=e[5];const V=m.order||"-created_at";let q;e[6]!==I.limit||e[7]!==I.offset||e[8]!==N||e[9]!==V?(q={first:D,offset:O,filter:N,order:V},e[6]=I.limit,e[7]=I.offset,e[8]=N,e[9]=V,e[10]=q):q=e[10];const R=q,$=(0,Z.useDeferredValue)(R),z=(0,Z.useDeferredValue)(i),[G,X]=(0,ra.q)("table_column_overrides.UserManagement");let Y;e[11]===Symbol.for("react.memo_cache_sentinel")?(Y=ke,e[11]=Y):Y=e[11];const H=z===d.eI?"store-and-network":"network-only";let W;e[12]!==z||e[13]!==H?(W={fetchKey:z,fetchPolicy:H},e[12]=z,e[13]=H,e[14]=W):W=e[14];const{user_nodes:J}=(0,F.useLazyLoadQuery)(Y,$,W);let ee;e[15]===Symbol.for("react.memo_cache_sentinel")?(ee=ye,e[15]=ee):ee=e[15];const[ae,le]=(0,F.useMutation)(ee);let ie,re,ce;e[16]!==n?(ie=n("general.Control"),e[16]=n,e[17]=ie):ie=e[17],e[18]!==ae||e[19]!==le||e[20]!==a||e[21]!==y||e[22]!==C||e[23]!==n||e[24]!==l.colorInfo||e[25]!==l.marginXXS||e[26]!==r?(re=(e,i)=>{const t="active"===(null===i||void 0===i?void 0:i.status);return(0,j.jsxs)(K.OO,{gap:l.marginXXS,children:[(0,j.jsx)(te.Ay,{type:"text",title:n("credential.UserDetail"),icon:(0,j.jsx)(ne.A,{style:{color:l.colorInfo}}),onClick:()=>{f((()=>{k((null===i||void 0===i?void 0:i.email)||null)}))}}),(0,j.jsx)(te.Ay,{type:"text",title:n("button.Edit"),icon:(0,j.jsx)(la,{style:{color:l.colorInfo}}),onClick:()=>{b((()=>{x((null===i||void 0===i?void 0:i.email)||null)}))}}),(0,j.jsx)(se.A,{title:n(t?"credential.DeactivateUser":"credential.ActivateUser"),placement:"left",okType:t?"danger":"primary",okText:n(t?"credential.Deactivate":"credential.Activate"),description:null===i||void 0===i?void 0:i.email,onConfirm:()=>{U((null===i||void 0===i?void 0:i.id)||""),ae({variables:{email:(null===i||void 0===i?void 0:i.email)||"",props:{status:t?"inactive":"active"}},onCompleted:()=>{y.success(n("credential.StatusUpdatedSuccessfully")),r()},onError:e=>{y.error(null===e||void 0===e?void 0:e.message),a.error(e)}})},children:(0,j.jsx)(te.Ay,{title:n(t?"credential.Deactivate":"credential.Activate"),type:"text",danger:t,icon:t?(0,j.jsx)(ue.A,{}):(0,j.jsx)(de.A,{}),disabled:le&&C!==(null===i||void 0===i?void 0:i.id),loading:le&&C===(null===i||void 0===i?void 0:i.id)})})]})},e[18]=ae,e[19]=le,e[20]=a,e[21]=y,e[22]=C,e[23]=n,e[24]=l.colorInfo,e[25]=l.marginXXS,e[26]=r,e[27]=re):re=e[27],e[28]!==ie||e[29]!==re?(ce={key:"control",title:ie,fixed:!0,required:!0,render:re},e[28]=ie,e[29]=re,e[30]=ce):ce=e[30];const me=ce,ge=m.status;let pe,ve,fe,Se,be,Ke,xe,Ae;e[31]!==g||e[32]!==P?(pe=e=>{g({status:e.target.value}),P({current:1})},e[31]=g,e[32]=P,e[33]=pe):pe=e[33],e[34]!==n?(ve=n("general.Active"),e[34]=n,e[35]=ve):ve=e[35],e[36]!==ve?(fe={label:ve,value:"active"},e[36]=ve,e[37]=fe):fe=e[37],e[38]!==n?(Se=n("general.Inactive"),e[38]=n,e[39]=Se):Se=e[39],e[40]!==Se?(be={label:Se,value:"inactive"},e[40]=Se,e[41]=be):be=e[41],e[42]!==fe||e[43]!==be?(Ke=[fe,be],e[42]=fe,e[43]=be,e[44]=Ke):Ke=e[44],e[45]!==m.status||e[46]!==pe||e[47]!==Ke?(xe=(0,j.jsx)(c.A,{value:ge,onChange:pe,optionType:"button",options:Ke}),e[45]=m.status,e[46]=pe,e[47]=Ke,e[48]=xe):xe=e[48],e[49]!==t||e[50]!==n?(Ae=(0,K.YM)([{key:"email",propertyLabel:n("general.E-Mail"),type:"string"},{key:"uuid",propertyLabel:"ID",type:"string",defaultOperator:"==",rule:{message:"Invalid UUID.",validate:sa}},{key:"username",propertyLabel:n("credential.Name"),type:"string"},{key:"full_name",propertyLabel:n("credential.FullName"),type:"string"},t.supports("user-node-query-project-filter")&&{key:"project_name",propertyLabel:n("general.Project"),type:"string"},{key:"role",propertyLabel:n("credential.Role"),type:"string",strictSelection:!0,defaultOperator:"==",options:[{label:"superadmin",value:"superadmin"},{label:"user",value:"user"}]},{key:"resource_policy",propertyLabel:n("credential.ResourcePolicy"),type:"string"},{key:"description",propertyLabel:n("credential.Description"),type:"string"},{key:"status_info",propertyLabel:n("credential.StatusInfo"),type:"string"},{key:"need_password_change",propertyLabel:n("credential.DescRequirePasswordChange"),type:"boolean"},{key:"totp_activated",propertyLabel:n("credential.2FAEnabled"),type:"boolean"},{key:"sudo_session_enabled",propertyLabel:n("credential.EnableSudoSession"),type:"boolean"}]),e[49]=t,e[50]=n,e[51]=Ae):Ae=e[51];const Fe=m.filter||void 0;let je,Me,Te;e[52]!==g?(je=e=>{g({filter:e||""})},e[52]=g,e[53]=je):je=e[53],e[54]!==Ae||e[55]!==Fe||e[56]!==je?(Me=(0,j.jsx)(K.Af,{filterProperties:Ae,value:Fe,onChange:je}),e[54]=Ae,e[55]=Fe,e[56]=je,e[57]=Me):Me=e[57],e[58]!==xe||e[59]!==Me?(Te=(0,j.jsxs)(K.OO,{direction:"row",gap:"sm",align:"start",wrap:"wrap",children:[xe,Me]}),e[58]=xe,e[59]=Me,e[60]=Te):Te=e[60];const Ie=z!==i;let Le,Pe,Ce,Ue,we,De,Oe,Ne,Ve,qe;e[61]!==i||e[62]!==Ie||e[63]!==r?(Le=(0,j.jsx)(K.u8,{loading:Ie,value:i,onChange:r}),e[61]=i,e[62]=Ie,e[63]=r,e[64]=Le):Le=e[64],e[65]===Symbol.for("react.memo_cache_sentinel")?(Pe=(0,j.jsx)(oe.A,{}),Ce=()=>{M(!0)},e[65]=Pe,e[66]=Ce):(Pe=e[65],Ce=e[66]),e[67]!==n?(Ue=n("credential.CreateUser"),e[67]=n,e[68]=Ue):Ue=e[68],e[69]!==Ue?(we=(0,j.jsx)(te.Ay,{type:"primary",icon:Pe,onClick:Ce,children:Ue}),e[69]=Ue,e[70]=we):we=e[70],e[71]!==Le||e[72]!==we?(De=(0,j.jsxs)(K.OO,{gap:"xs",children:[Le,we]}),e[71]=Le,e[72]=we,e[73]=De):De=e[73],e[74]!==Te||e[75]!==De?(Oe=(0,j.jsxs)(K.OO,{justify:"between",align:"start",gap:"xs",wrap:"wrap",children:[Te,De]}),e[74]=Te,e[75]=De,e[76]=Oe):Oe=e[76],e[77]!==(null===J||void 0===J?void 0:J.edges)?(Ne=(0,K.f)(Q().map(null===J||void 0===J?void 0:J.edges,"node")),e[77]=null===J||void 0===J?void 0:J.edges,e[78]=Ne):Ne=e[78],e[79]!==me?(Ve=e=>[e[0],me,...e.slice(1)],e[79]=me,e[80]=Ve):Ve=e[80],e[81]===Symbol.for("react.memo_cache_sentinel")?(qe={x:"max-content"},e[81]=qe):qe=e[81];const Re=(null===J||void 0===J?void 0:J.count)||0;let $e,Qe,Ee,ze;e[82]!==l.marginXS?($e={marginRight:l.marginXS},e[82]=l.marginXS,e[83]=$e):$e=e[83],e[84]!==P?(Qe=(e,a)=>{Q().isNumber(e)&&Q().isNumber(a)&&P({current:e,pageSize:a})},e[84]=P,e[85]=Qe):Qe=e[85],e[86]!==Re||e[87]!==$e||e[88]!==Qe||e[89]!==L.current||e[90]!==L.pageSize?(Ee={pageSize:L.pageSize,total:Re,current:L.current,style:$e,onChange:Qe},e[86]=Re,e[87]=$e,e[88]=Qe,e[89]=L.current,e[90]=L.pageSize,e[91]=Ee):Ee=e[91],e[92]!==g?(ze=e=>{g({order:e})},e[92]=g,e[93]=ze):ze=e[93];const Be=$!==R||z!==i;let Ge,Xe;e[94]!==G||e[95]!==X?(Ge={columnOverrides:G,onColumnOverridesChange:X},e[94]=G,e[95]=X,e[96]=Ge):Ge=e[96],e[97]!==m.order||e[98]!==Ne||e[99]!==Ve||e[100]!==Ee||e[101]!==ze||e[102]!==Be||e[103]!==Ge?(Xe=(0,j.jsx)(K.ti,{usersFrgmt:Ne,customizeColumns:Ve,scroll:qe,pagination:Ee,onChangeOrder:ze,order:m.order,loading:Be,tableSettings:Ge}),e[97]=m.order,e[98]=Ne,e[99]=Ve,e[100]=Ee,e[101]=ze,e[102]=Be,e[103]=Ge,e[104]=Xe):Xe=e[104];const Ye=p||"",He=!!p||_;let We,Ze;e[105]===Symbol.for("react.memo_cache_sentinel")?(We=()=>{k(null)},e[105]=We):We=e[105],e[106]!==_||e[107]!==Ye||e[108]!==He?(Ze=(0,j.jsx)(he,{userEmail:Ye,open:He,loading:_,onRequestClose:We}),e[106]=_,e[107]=Ye,e[108]=He,e[109]=Ze):Ze=e[109];const Je=!!h||S||A;let ea,aa,ta;return e[110]!==r?(ea=e=>{x(null),M(!1),e&&r()},e[110]=r,e[111]=ea):ea=e[111],e[112]!==h||e[113]!==S||e[114]!==Je||e[115]!==ea?(aa=(0,j.jsx)(na,{userEmail:h,open:Je,loading:S,onRequestClose:ea}),e[112]=h,e[113]=S,e[114]=Je,e[115]=ea,e[116]=aa):aa=e[116],e[117]!==Oe||e[118]!==Xe||e[119]!==Ze||e[120]!==aa?(ta=(0,j.jsxs)(K.OO,{direction:"column",align:"stretch",gap:"sm",children:[Oe,Xe,Ze,aa]}),e[117]=Oe,e[118]=Xe,e[119]=Ze,e[120]=aa,e[121]=ta):ta=e[121],ta};function sa(e){return(0,K.aJ)(e)}var oa=n(9264),da=n(40720),ua=n(60609);const ca=()=>{const{t:e}=(0,E.Bd)(),[a]=(0,oa.ok)(),n=a.get("tab")||"users",l=(0,da.Zp)(),i=[{key:"users",label:e("credential.Users")},{key:"credentials",label:e("credential.Credentials")}];return(0,j.jsx)(K.Zu,{activeTabKey:n,onTabChange:e=>l({pathname:"/credential",search:"?tab=".concat(e)}),tabList:i,children:(0,j.jsxs)(Z.Suspense,{fallback:(0,j.jsx)(We.A,{active:!0}),children:["users"===n&&(0,j.jsx)(ua.A,{children:(0,j.jsx)(K.OO,{direction:"column",align:"stretch",children:(0,j.jsx)(ta,{})})}),"credentials"===n&&(0,j.jsx)(ua.A,{children:(0,j.jsx)(K.OO,{direction:"column",align:"stretch",children:(0,j.jsx)(me,{})})})]})})}},71928:(e,a,n)=>{n.d(a,{A:()=>l});const l=(0,n(24604).A)("undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]])}}]);
//# sourceMappingURL=6974.cd2a2926.chunk.js.map