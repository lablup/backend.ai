/*! For license information please see 1609.1766baff.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1609],{20192:(e,n,a)=>{a.d(n,{A:()=>o});var l=a(29262);const r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"};var i=a(7422);function t(){return t=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},t.apply(this,arguments)}const s=(e,n)=>l.createElement(i.A,t({},e,{ref:n,icon:r}));const o=l.forwardRef(s)},36254:(e,n,a)=>{a.d(n,{A:()=>c});var l=a(56276),r=a(11863),i=a(28529),t=a(42829),s=a(77404),o=a(45470),d=a(26862);const u=["value","onChange","language","editable","showLineNumbers","lineWrapping"],c=e=>{let{value:n,onChange:a,language:c="sh",editable:m=!1,showLineNumbers:g=!0,lineWrapping:y=!1}=e,p=(0,r.A)(e,u);const{isDarkMode:v}=(0,t.e)(),[f,k]=(0,i.A)({defaultValue:"",value:n,onChange:a}),h=[(0,s.rI)(c)];return(0,d.jsx)(o.Ay,(0,l.A)({theme:v?"dark":"light",extensions:y?[o.Lz.lineWrapping,...h]:h,editable:m,readOnly:!m,basicSetup:{lineNumbers:g},value:f,onChange:e=>k(e)},p))}},38861:(e,n,a)=>{a.d(n,{a:()=>r});var l=a(7075);const r=e=>{const[n,a]=(0,l.q)("hiddenColumnKeys.".concat(e));return[n,a]}},71609:(e,n,a)=>{a.r(n),a.d(n,{default:()=>rn});var l=a(56276);const r=function(){var e={defaultValue:null,kind:"LocalArgument",name:"allowed_docker_registries"},n={defaultValue:null,kind:"LocalArgument",name:"domain"},a=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"domain"},{fields:[{kind:"Variable",name:"allowed_docker_registries",variableName:"allowed_docker_registries"}],kind:"ObjectValue",name:"props"}],concreteType:"ModifyDomain",kind:"LinkedField",name:"modify_domain",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,n],kind:"Fragment",metadata:null,name:"ContainerRegistryListDomainMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,e],kind:"Operation",name:"ContainerRegistryListDomainMutation",selections:a},params:{cacheID:"5ea7ebdd79d15e15b23a9fb2d8568d34",id:null,metadata:{},name:"ContainerRegistryListDomainMutation",operationKind:"mutation",text:"mutation ContainerRegistryListDomainMutation(\n  $domain: String!\n  $allowed_docker_registries: [String]!\n) {\n  modify_domain(name: $domain, props: {allowed_docker_registries: $allowed_docker_registries}) {\n    ok\n    msg\n  }\n}\n"}}}();r.hash="647ec7cdf3bcffc8cc1d8cd3cced159f";const i=r,t=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],n=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"id"}],concreteType:"DeleteContainerRegistryNodeV2",kind:"LinkedField",name:"delete_container_registry_node_v2",plural:!1,selections:[{alias:null,args:null,concreteType:"ContainerRegistryNode",kind:"LinkedField",name:"container_registry",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ContainerRegistryListDeleteMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ContainerRegistryListDeleteMutation",selections:n},params:{cacheID:"dee7dc9351edf924f27f36708081392a",id:null,metadata:{},name:"ContainerRegistryListDeleteMutation",operationKind:"mutation",text:"mutation ContainerRegistryListDeleteMutation(\n  $id: String!\n) {\n  delete_container_registry_node_v2(id: $id) {\n    container_registry {\n      id\n    }\n  }\n}\n"}}}();t.hash="9c376270f9537afa6a7b9c2c8b821097";const s=t,o=function(){var e={defaultValue:null,kind:"LocalArgument",name:"domain"},n={defaultValue:null,kind:"LocalArgument",name:"filter"},a={defaultValue:null,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"offset"},r={defaultValue:null,kind:"LocalArgument",name:"order"},i=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"order",variableName:"order"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"row_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"registry_name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"project",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"password",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"ssl_verify",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},f={alias:null,args:[{kind:"Variable",name:"name",variableName:"domain"}],concreteType:"Domain",kind:"LinkedField",name:"domain",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"allowed_docker_registries",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[e,n,a,l,r],kind:"Fragment",metadata:null,name:"ContainerRegistryListQuery",selections:[{alias:null,args:i,concreteType:"ContainerRegistryConnection",kind:"LinkedField",name:"container_registry_nodes",plural:!1,selections:[{alias:null,args:null,concreteType:"ContainerRegistryEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ContainerRegistryNode",kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ContainerRegistryEditorModalFragment"},t,s,o,d,u,c,m,g,y,p],storageKey:null}],storageKey:null},v],storageKey:null},f],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,n,r,a,l],kind:"Operation",name:"ContainerRegistryListQuery",selections:[{alias:null,args:i,concreteType:"ContainerRegistryConnection",kind:"LinkedField",name:"container_registry_nodes",plural:!1,selections:[{alias:null,args:null,concreteType:"ContainerRegistryEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ContainerRegistryNode",kind:"LinkedField",name:"node",plural:!1,selections:[t,s,d,o,u,c,m,g,p,{alias:null,args:null,kind:"ScalarField",name:"extra",storageKey:null},y],storageKey:null}],storageKey:null},v],storageKey:null},f]},params:{cacheID:"0bba862c155dc1896b2f2d0989b83320",id:null,metadata:{},name:"ContainerRegistryListQuery",operationKind:"query",text:'query ContainerRegistryListQuery(\n  $domain: String!\n  $filter: String\n  $order: String\n  $first: Int\n  $offset: Int\n) {\n  container_registry_nodes(filter: $filter, order: $order, first: $first, offset: $offset) @since(version: "24.09.0") {\n    edges {\n      node {\n        ...ContainerRegistryEditorModalFragment\n        id\n        row_id\n        registry_name\n        name\n        url\n        type\n        project\n        username\n        password\n        ssl_verify\n      }\n    }\n    count\n  }\n  domain(name: $domain) {\n    name\n    allowed_docker_registries\n  }\n}\n\nfragment ContainerRegistryEditorModalFragment on ContainerRegistryNode {\n  id\n  row_id\n  name\n  registry_name\n  url\n  type\n  project\n  username\n  ssl_verify\n  extra @since(version: "24.09.3")\n}\n'}}}();o.hash="83d2445a2d783eb91f99f02f22559918";const d=o;var u=a(37138),c=a(30105),m=a(62601),g=a(38861),y=a(52570),p=a(11863);const v=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"id"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyContainerRegistryNodeV2",kind:"LinkedField",name:"modify_container_registry_node_v2",plural:!1,selections:[{alias:null,args:null,concreteType:"ContainerRegistryNode",kind:"LinkedField",name:"container_registry",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ContainerRegistryEditorModalModifyRegistryMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ContainerRegistryEditorModalModifyRegistryMutation",selections:n},params:{cacheID:"904d92a2293c34d32d71678fe19436e6",id:null,metadata:{},name:"ContainerRegistryEditorModalModifyRegistryMutation",operationKind:"mutation",text:"mutation ContainerRegistryEditorModalModifyRegistryMutation(\n  $id: String!\n  $props: ModifyContainerRegistryNodeInputV2!\n) {\n  modify_container_registry_node_v2(id: $id, props: $props) {\n    container_registry {\n      id\n    }\n  }\n}\n"}}}();v.hash="7d37cec70d1be6699f386f7c09adc572";const f=v,k=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateContainerRegistryNodeV2",kind:"LinkedField",name:"create_container_registry_node_v2",plural:!1,selections:[{alias:null,args:null,concreteType:"ContainerRegistryNode",kind:"LinkedField",name:"container_registry",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ContainerRegistryEditorModalCreateMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ContainerRegistryEditorModalCreateMutation",selections:n},params:{cacheID:"4df9116bd277ca16eb13281d543cbe04",id:null,metadata:{},name:"ContainerRegistryEditorModalCreateMutation",operationKind:"mutation",text:"mutation ContainerRegistryEditorModalCreateMutation(\n  $props: CreateContainerRegistryNodeInputV2!\n) {\n  create_container_registry_node_v2(props: $props) {\n    container_registry {\n      id\n    }\n  }\n}\n"}}}();k.hash="6c83e8833822dff8f1b0fa55b80d0b19";const h=k,x={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ContainerRegistryEditorModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"row_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"registry_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"project",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ssl_verify",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"extra",storageKey:null}],type:"ContainerRegistryNode",abstractKey:null,hash:"d3edee648e1c09fef66ed49a916ee5e7"},b=x;var A=a(42829),_=a(36254),j=a(89147),S=a(87272),R=a(36961),F=a(66203),I=a(91129),M=a(96922),C=a(29268),K=a(7265),w=a(60669),P=a.n(w),L=a(29262),O=a(99118),N=a(84372),T=a(26862);const D=["containerRegistryFrgmt","onOk"],E=e=>{let{containerRegistryFrgmt:n=null,onOk:a}=e,r=(0,p.A)(e,D);const{t:i}=(0,O.Bd)(),{token:t}=S.A.useToken(),{isDarkMode:s}=(0,A.e)(),{message:o,modal:d}=R.A.useApp(),c=(0,u.CX)().supports("extra-field"),m=(0,L.useRef)(null),g=(0,N.useFragment)(b,n),[y,v]=(0,N.useMutation)(h),[k,x]=(0,N.useMutation)(f),w=async()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.validateFields().then((e=>{var n;let l={id:e.row_id,registry_name:e.registry_name,url:e.url,type:e.type,project:e.project,username:P().isEmpty(e.username)?null:e.username,password:e.isChangedPassword||!g?P().isEmpty(e.password)?null:e.password:void 0,extra:P().isEmpty(e.extra)?null:JSON.stringify(JSON.parse(null!==(n=e.extra)&&void 0!==n?n:"{}"))};var r;g?k({variables:{id:null!==(r=l.id)&&void 0!==r?r:"",props:P().omit(l,"id")},onCompleted:(e,n)=>{var l;if(P().isEmpty(null===(l=e.modify_container_registry_node_v2)||void 0===l?void 0:l.container_registry))o.error(i("dialog.ErrorOccurred"));else if(n&&n.length>0){const e=P().map(n,(e=>e.message));for(const n of e)o.error(n)}else a&&a("modify")},onError:()=>{o.error(i("dialog.ErrorOccurred"))}}):(l=P().omitBy(l,P().isNil),y({variables:{props:l},onCompleted:(e,n)=>{var l;if(P().isEmpty(null===e||void 0===e||null===(l=e.create_container_registry_node_v2)||void 0===l?void 0:l.container_registry))o.error(i("dialog.ErrorOccurred"));else if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=P().map(n,(e=>e.message));for(const n of e)o.error(n)}else a&&a("create")},onError(){o.error(i("dialog.ErrorOccurred"))}}))})).catch((()=>{}))};return(0,T.jsx)(K.IbE,(0,l.A)((0,l.A)({title:i(g?"registry.ModifyRegistry":"registry.AddRegistry"),okText:i(g?"button.Save":"button.Add"),confirmLoading:v||x,onOk:()=>{var e;null===(e=m.current)||void 0===e||e.validateFields().then((e=>{P().includes(null===e||void 0===e?void 0:e.type,"harbor")&&(P().isEmpty(e.username)||(g?e.isChangedPassword&&P().isEmpty(e.password):P().isEmpty(e.password)))?d.confirm({title:i("button.Confirm"),content:i("registry.ConfirmNoUserName"),onOk:()=>{w()}}):w()})).catch((()=>{}))}},r),{},{destroyOnHidden:!0,children:(0,T.jsxs)(F.A,{ref:m,layout:"vertical",initialValues:g?(0,l.A)((0,l.A)({},g),{},{extra:null!==g&&void 0!==g&&g.extra?JSON.stringify(JSON.parse(null===g||void 0===g?void 0:g.extra),null,2):""}):{},preserve:!1,children:[g&&(0,T.jsx)(j.A,{name:"row_id",value:g.row_id}),(0,T.jsx)(F.A.Item,{label:i("registry.RegistryName"),name:"registry_name",required:!0,rules:[{required:!0,message:i("registry.DescRegistryNameIsEmpty"),pattern:new RegExp("^.+$")},{type:"string",max:50,message:i("maxLength.50chars")}],children:(0,T.jsx)(I.A,{disabled:!!g,value:(null===g||void 0===g?void 0:g.registry_name)||void 0})}),(0,T.jsx)(F.A.Item,{name:"url",label:i("registry.RegistryURL"),required:!0,rules:[{required:!0},{validator:(e,n)=>{if(n){if(!n.startsWith("http://")&&!n.startsWith("https://"))return Promise.reject(i("registry.DescURLStartString"));try{new URL(n)}catch(a){return Promise.reject(i("registry.DescURLFormat"))}}return Promise.resolve()}},{type:"string",max:512,message:i("maxLength.512chars")}],children:(0,T.jsx)(I.A,{})}),(0,T.jsx)(F.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>P().isEmpty(null===e||void 0===e?void 0:e.password)!==P().isEmpty(null===n||void 0===n?void 0:n.password),children:e=>{let{validateFields:n,getFieldValue:a}=e;return n(["username"]),(0,T.jsx)(F.A.Item,{name:"username",label:i("registry.Username"),rules:[{required:!P().isEmpty(a("password"))},{type:"string",max:255,message:i("maxLength.255chars")}],children:(0,T.jsx)(I.A,{})})}}),(0,T.jsxs)(F.A.Item,{label:i("registry.Password"),children:[(0,T.jsx)(F.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.isChangedPassword!==n.isChangedPassword,children:e=>{let{getFieldValue:n}=e;return(0,T.jsx)(F.A.Item,{noStyle:!0,name:"password",children:(0,T.jsx)(I.A.Password,{disabled:!P().isEmpty(g)&&!n("isChangedPassword")})})}}),!P().isEmpty(g)&&(0,T.jsx)(F.A.Item,{noStyle:!0,name:"isChangedPassword",valuePropName:"checked",children:(0,T.jsx)(M.A,{onChange:e=>{var n;e.target.checked||(null===(n=m.current)||void 0===n||n.setFieldValue("password",""))},children:i("webui.menu.ChangePassword")})})]}),(0,T.jsx)(F.A.Item,{name:"type",label:i("registry.RegistryType"),required:!0,rules:[{required:!0,message:i("registry.PleaseSelectOption")}],children:(0,T.jsx)(C.A,{options:[{value:"docker"},{value:"harbor"},{value:"harbor2"},{value:"github"},{value:"gitlab"},{value:"ecr"},{value:"ecr-public"}]})}),(0,T.jsx)(F.A.Item,{shouldUpdate:(e,n)=>(null===e||void 0===e?void 0:e.type)!==(null===n||void 0===n?void 0:n.type),noStyle:!0,children:()=>(0,T.jsx)(F.A.Item,{name:"project",label:i("registry.ProjectName"),required:!0,rules:[{required:!0,message:i("registry.ProjectNameIsRequired")},{type:"string",max:255,message:i("maxLength.255chars")}],children:(0,T.jsx)(I.A,{allowClear:!0})})}),c&&(0,T.jsx)(F.A.Item,{label:i("registry.ExtraInformation"),children:(0,T.jsx)(K.OOm,{style:{border:"1px solid ".concat(t.colorBorder),borderRadius:t.borderRadius,overflow:"hidden"},children:(0,T.jsx)(F.A.Item,{name:"extra",noStyle:!0,rules:[{validator:(e,n)=>{if(n)try{JSON.parse(n)}catch(a){return Promise.reject(i("registry.DescExtraJsonFormat"))}return Promise.resolve()}}],children:(0,T.jsx)(_.A,{editable:!0,language:"json",theme:s?"dark":"light",style:{width:"100%"}})})})})]})}))};var V=a(98078),q=a(76184),$=a(33651),B=a(20192),z=a(53156),U=a(37499),Q=a(50914),H=a(80391),J=a(86425),W=a(71905),X=a(69266),G=a(37717),Y=a(69319),Z=a(31495);const ee=e=>{var n;let{style:a}=e;const{logger:r}=(0,K.Q7t)(),t=(0,u.CX)(),[o,p]=(0,K.zui)(),v=(0,y.b)(),{message:f}=R.A.useApp(),{upsertNotification:k}=(0,m.js)(),[h,{toggle:x}]=(0,H.A)(),[b,A]=(0,Z.useQueryParams)({filter:(0,Z.withDefault)(Z.StringParam,void 0),order:(0,Z.withDefault)(Z.StringParam,void 0)}),{baiPaginationOption:_,tablePaginationOption:j,setTablePaginationOption:M}=(0,c.L0)({current:1,pageSize:20}),C=(0,L.useMemo)((()=>({domain:t._config.domainName,filter:b.filter,order:b.order,first:_.limit,offset:_.offset})),[t._config.domainName,b.filter,b.order,_.limit,_.offset]),w=(0,L.useDeferredValue)(C),D=(0,L.useDeferredValue)(o),{container_registry_nodes:ee,domain:ne}=(0,N.useLazyLoadQuery)(d,w,{fetchPolicy:D===K.eIE?"store-and-network":"network-only",fetchKey:D}),ae=P().map(null===ee||void 0===ee?void 0:ee.edges,"node"),[le,re]=(0,N.useMutation)(s),[ie,te]=(0,N.useMutation)(i),{t:se}=(0,O.Bd)(),{token:oe}=S.A.useToken(),[de,ue]=(0,L.useState)(),[ce,me]=(0,L.useState)(),[ge,ye]=(0,L.useState)(""),[pe,ve]=(0,L.useState)(!1),[fe,ke]=(0,L.useState)(),he=[{key:"registry_name",title:se("registry.RegistryName"),dataIndex:"registry_name",sorter:!0},{key:"url",title:se("registry.RegistryURL"),dataIndex:"url"},{key:"type",title:se("registry.Type"),dataIndex:"type"},{key:"project",title:se("registry.Project"),dataIndex:"project",render:e=>(0,T.jsx)(J.A,{children:e||""},e||"")},{key:"username",title:se("registry.Username"),dataIndex:"username"},{key:"password",title:se("registry.Password"),dataIndex:"password"},{key:"enabled",title:se("general.Enabled"),render:(e,n)=>{const a=P().includes(null===ne||void 0===ne?void 0:ne.allowed_docker_registries,n.registry_name);return(0,T.jsx)(W.A,{checked:fe===n.id+D?!a:a,disabled:D!==o||te,loading:(D!==o||te)&&fe===n.id+D,onChange:e=>{if(!P().isString(n.registry_name))return;let a=P().clone((null===ne||void 0===ne?void 0:ne.allowed_docker_registries)||[]);e?a.push(n.registry_name):a=P().without(a,n.registry_name),ke(n.id+D),ie({variables:{domain:t._config.domainName,allowed_docker_registries:a},onCompleted:(n,a)=>{var l;if(null!==n&&void 0!==n&&null!==(l=n.modify_domain)&&void 0!==l&&l.ok){if(a&&(null===a||void 0===a?void 0:a.length)>0){const e=P().map(a,(e=>e.message));for(const n of e)f.error(n)}else p();f.success({key:"registry-enabled",content:se(e?"registry.RegistryTurnedOn":"registry.RegistryTurnedOff")})}else{var r;f.error(null===n||void 0===n||null===(r=n.modify_domain)||void 0===r?void 0:r.msg)}}})}})}},{title:se("general.Control"),fixed:"right",render:(e,n)=>(0,T.jsxs)(K.OOm,{children:[(0,T.jsx)(X.A,{title:se("button.Edit"),children:(0,T.jsx)(G.Ay,{style:{color:oe.colorInfo},type:"text",icon:(0,T.jsx)(q.A,{}),onClick:()=>{ue(n)}})}),(0,T.jsx)(X.A,{title:se("button.Delete"),children:(0,T.jsx)(G.Ay,{danger:!0,type:"text",icon:(0,T.jsx)($.A,{}),onClick:()=>{me(n)}})}),(0,T.jsx)(X.A,{title:se("maintenance.RescanImages"),children:(0,T.jsx)(G.Ay,{type:"text",icon:(0,T.jsx)(B.A,{onClick:()=>{n.registry_name&&(async(e,n)=>{const a=k({message:"".concat(se("maintenance.RescanImages"),": ").concat(e).concat(n?"/".concat(n):""),description:se("registry.UpdatingRegistryInfo"),open:!0,backgroundTask:{status:"pending"},duration:0}),l=t.supports("image_rescan_by_project");t.maintenance.rescan_images(e,l&&null!==n&&void 0!==n?n:void 0).then((e=>{let{rescan_images:n}=e;n.ok?k({key:a,backgroundTask:{status:"pending",percent:0,taskId:n.task_id,onChange:{pending:se("registry.RescanImages"),resolved:se("registry.RegistryUpdateFinished"),rejected:se("registry.RegistryUpdateFailed")}}}):k({key:a,backgroundTask:{status:"rejected"},duration:1})})).catch((e=>{r.error(e),k({key:a,backgroundTask:{status:"rejected"},duration:1}),e&&e.message&&(globalThis.lablupNotification.text=v.relieve(e.title),globalThis.lablupNotification.detail=e.message,globalThis.lablupNotification.show(!0,e))}))})(n.registry_name,n.project)}})})})]})}],[xe,be]=(0,g.a)("ContainerRegistryList");return(0,T.jsxs)(K.OOm,{direction:"column",align:"stretch",gap:"sm",style:(0,l.A)({flex:1},a),children:[(0,T.jsxs)(K.OOm,{direction:"row",justify:"between",gap:"sm",align:"start",wrap:"wrap",children:[(0,T.jsx)(K.Af6,{filterProperties:[{key:"registry_name",propertyLabel:se("registry.RegistryName"),type:"string"}],value:b.filter,onChange:e=>{A({filter:e},"replaceIn")}}),(0,T.jsxs)(K.OOm,{gap:"xs",children:[(0,T.jsx)(X.A,{title:se("button.Refresh"),children:(0,T.jsx)(G.Ay,{loading:D!==o,icon:(0,T.jsx)(z.A,{}),onClick:()=>{p()}})}),(0,T.jsx)(G.Ay,{type:"primary",icon:(0,T.jsx)(U.A,{}),onClick:()=>{ve(!0)},children:se("registry.AddRegistry")})]})]}),(0,T.jsx)(K.zxw,{rowKey:e=>e.id,scroll:{x:"max-content"},showSorterTooltip:!1,pagination:{pageSize:j.pageSize,total:null!==(n=null===ee||void 0===ee?void 0:ee.count)&&void 0!==n?n:0,current:j.current,onChange(e,n){P().isNumber(e)&&P().isNumber(n)&&M({current:e,pageSize:n})},extraContent:(0,T.jsx)(G.Ay,{type:"text",icon:(0,T.jsx)(q.A,{}),onClick:()=>{x()}})},onChangeOrder:e=>{A({order:e},"replaceIn")},loading:w!==C||D!==o,dataSource:(0,K.faj)(ae),columns:P().filter(he,(e=>!P().includes(xe,P().toString(null===e||void 0===e?void 0:e.key))))}),(0,T.jsx)(E,{containerRegistryFrgmt:de,open:!!de||pe,onOk:e=>{"create"===e?f.success({key:"registry-added",content:se("registry.RegistrySuccessfullyAdded")}):"modify"===e&&f.success({key:"registry-modified",content:se("registry.RegistrySuccessfullyModified")}),p(),ue(null),ve(!1)},onCancel:()=>{ue(null),ve(!1)},centered:!1}),(0,T.jsx)(K.IbE,{title:(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Q.A,{style:{color:oe.colorWarning}})," ",se("dialog.warning.CannotBeUndone")]}),okText:se("button.Delete"),okButtonProps:{danger:!0,disabled:ge!==(null===ce||void 0===ce?void 0:ce.registry_name)},onOk:()=>{ce?le({variables:{id:ce.id},onCompleted:(e,n)=>{n?(me(null),f.error({key:"registry-deletion-failed",content:se("dialog.ErrorOccurred")})):(p(),f.success({key:"registry-deleted",content:se("registry.RegistrySuccessfullyDeleted")}),me(null))},onError:()=>{f.error({key:"registry-deletion-failed",content:se("dialog.ErrorOccurred")})}}):me(null)},confirmLoading:re,onCancel:()=>{me(null)},destroyOnHidden:!0,open:!!ce,children:(0,T.jsxs)(K.OOm,{direction:"column",align:"stretch",gap:"sm",style:{marginTop:oe.marginMD},children:[(0,T.jsxs)(Y.A.Text,{children:[(0,T.jsx)(Y.A.Text,{code:!0,children:null===ce||void 0===ce?void 0:ce.registry_name})," ",se("registry.TypeRegistryNameToDelete")]}),(0,T.jsx)(F.A,{children:(0,T.jsx)(F.A.Item,{name:"confirmText",rules:[{required:!0,message:se("registry.HostnameDoesNotMatch"),validator:()=>ge===(null===ce||void 0===ce?void 0:ce.registry_name)?Promise.resolve():Promise.reject()}],children:(0,T.jsx)(I.A,{autoComplete:"off",value:ge,onChange:e=>ye(e.target.value)})})})]})}),(0,T.jsx)(V.A,{open:h,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&be(P().difference(he.map((e=>P().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),x()},columns:he,hiddenColumnKeys:xe})]})},ne=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"digest",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"installed",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},o=[s,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],d={alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:o,storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"humanized_name",storageKey:null},c={alias:null,args:null,concreteType:"ResourceLimit",kind:"LinkedField",name:"resource_limits",plural:!0,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"min",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"namespace",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"base_image_name",storageKey:null},y={alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"tags",plural:!0,selections:o,storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ImageListQuery",selections:[{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"images",plural:!0,selections:[e,n,a,l,r,i,t,d,u,c,m,g,y,p,{args:null,kind:"FragmentSpread",name:"ManageImageResourceLimitModal_image"},{args:null,kind:"FragmentSpread",name:"ManageAppsModal_image"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ImageListQuery",selections:[{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"images",plural:!0,selections:[e,n,a,l,r,i,t,d,u,c,m,g,y,p],storageKey:null}]},params:{cacheID:"dfcaa29c2b5019c25c0a7a5e2ed454bf",id:null,metadata:{},name:"ImageListQuery",operationKind:"query",text:'query ImageListQuery {\n  images {\n    id\n    name @deprecatedSince(version: "24.12.0")\n    tag\n    registry\n    architecture\n    digest\n    installed\n    labels {\n      key\n      value\n    }\n    humanized_name\n    resource_limits {\n      key\n      min\n      max\n    }\n    namespace @since(version: "24.12.0")\n    base_image_name @since(version: "24.12.0")\n    tags @since(version: "24.12.0") {\n      key\n      value\n    }\n    version @since(version: "24.12.0")\n    ...ManageImageResourceLimitModal_image\n    ...ManageAppsModal_image\n  }\n}\n\nfragment ManageAppsModal_image on Image {\n  labels {\n    key\n    value\n  }\n  registry\n  name @deprecatedSince(version: "24.12.0")\n  namespace @since(version: "24.12.0")\n  architecture\n  installed\n  tag\n}\n\nfragment ManageImageResourceLimitModal_image on Image {\n  resource_limits {\n    key\n    min\n    max\n  }\n  registry\n  name @deprecatedSince(version: "24.12.0")\n  namespace @since(version: "24.12.0")\n  architecture\n  installed\n  tag\n}\n'}}}();ne.hash="35b5ff7c2c78020b5828c46f420506f0";const ae=ne;var le=a(31871),re=a(60443);const ie=["onRequestClose","selectedRows","setInstallingImages"],te=e=>{let{onRequestClose:n,selectedRows:a,setInstallingImages:r}=e,i=(0,p.A)(e,ie);const{t:t}=(0,O.Bd)(),s=(0,u.CX)(),{upsertNotification:o}=(0,m.js)(),d=(0,y.b)();if(!i.open)return null;const{imagesToInstall:c,hasInstalledImage:g}=(()=>{let e=!1;return{imagesToInstall:a.filter((n=>(n.installed&&(e=!0),!n.installed))),hasInstalledImage:e}})();return(0,T.jsx)(K.IbE,(0,l.A)((0,l.A)({},i),{},{destroyOnHidden:!0,maskClosable:!1,onCancel:()=>n(),title:t("environment.CheckImageInstallation"),okText:t("environment.Install"),onOk:()=>{n();const e=c.map((async e=>{var n,a,r,i;const u="".concat(null===e||void 0===e?void 0:e.registry,"/").concat(null!==(n=null===e||void 0===e?void 0:e.namespace)&&void 0!==n?n:null===e||void 0===e?void 0:e.name,":").concat(null===e||void 0===e?void 0:e.tag),c=(null!==(a=null===e||void 0===e?void 0:e.labels)&&void 0!==a?a:[]).reduce(((e,n)=>(null!==n&&void 0!==n&&n.key&&null!==n&&void 0!==n&&n.value&&(e[n.key]=n.value),e)),{})["ai.backend.resource.preferred.shmem"]||"64m",m=null!==(r=(0,le.sL)(null!==(i=P().get(P().find(null===e||void 0===e?void 0:e.resource_limits,{key:"mem"}),"min"))&&void 0!==i?i:"256m",c,"m"))&&void 0!==r?r:"320m",g={group_name:s.current_group,domain:s._config.domainName,type:"batch",cluster_mode:"single-node",cluster_size:1,startupCommand:'echo "Image is installed"',enqueueOnly:!0,config:{resources:(0,l.A)((0,l.A)({},P().mapValues(P().keyBy(null===e||void 0===e?void 0:e.resource_limits,"key"),"min")),{},{cpu:P().get(P().find(null===e||void 0===e?void 0:e.resource_limits,{key:"cpu"}),"min",1),mem:m}),resource_opts:{shmem:c}}};P().some(["cuda.device","cuda.shares"],(e=>{var n,a;return e in(null!==(n=null===(a=g.config)||void 0===a?void 0:a.resources)&&void 0!==n?n:{})}))&&g.config&&P().assign(g.config.resources,{gpu:P().get(g.config.resources,"cuda.device",0),fgpu:P().get(g.config.resources,"cuda.shares")});const y=await s.get_resource_slots(),p=P().chain(["cuda.device","cuda.shares","gpu","fgpu"]).filter((e=>!(e in y))).value();var v,f,k,h,x;g.config&&(g.config.resources=(0,l.A)((0,l.A)({},P().omit(null!==(v=g.config.resources)&&void 0!==v?v:{},p)),{},{cpu:null!==(f=null===(k=g.config.resources)||void 0===k?void 0:k.cpu)&&void 0!==f?f:1,mem:null!==(h=null===(x=g.config.resources)||void 0===x?void 0:x.mem)&&void 0!==h?h:"320m"}));o({message:"".concat(t("environment.InstallingImage")).concat(u).concat(t("environment.TakesTime")),open:!0,duration:2});const b=await globalThis.lablupIndicator.start("indeterminate");b.set(10,t("import.Downloading"));try{return await s.image.install(u,null===e||void 0===e?void 0:e.architecture,g),b.end(1e3),null===e||void 0===e?void 0:e.id}catch(A){return globalThis.lablupNotification.text=d.relieve(A.title),globalThis.lablupNotification.detail=A.message,globalThis.lablupNotification.show(!0,A),b.set(100,t("environment.DescProblemOccurred")),b.end(1e3),null}}));Promise.allSettled(e).then((e=>{const n=e.filter((e=>"fulfilled"===e.status&&null!==e.value)).map((e=>e.value));r(n)}))},children:(0,T.jsxs)(K.OOm,{direction:"column",gap:"md",align:"start",children:[g?t("environment.InstalledImagesAreExcluded"):null,(0,T.jsx)(K.OOm,{direction:"column",align:"start",style:{width:"100%"},children:(0,T.jsx)(re.A,{size:"small",dataSource:c.map((e=>{var n;return"".concat(null===e||void 0===e?void 0:e.registry,"/").concat(null!==(n=null===e||void 0===e?void 0:e.namespace)&&void 0!==n?n:null===e||void 0===e?void 0:e.name,":").concat(null===e||void 0===e?void 0:e.tag)})),style:{width:"100%"},renderItem:e=>(0,T.jsx)(re.A.Item,{children:(0,T.jsx)(Y.A.Text,{strong:!0,children:e})}),pagination:{pageSize:5,showTotal:e=>t("general.TotalItems",{total:e})}})}),(0,T.jsxs)(Y.A.Text,{children:[t("environment.DescSignificantInstallTime"),"\xa0",t("dialog.ask.DoYouWantToProceed")]})]})}))};var se=a(93594);const oe=function(){var e={defaultValue:null,kind:"LocalArgument",name:"architecture"},n={defaultValue:null,kind:"LocalArgument",name:"props"},a={defaultValue:null,kind:"LocalArgument",name:"target"},l=[{alias:null,args:[{kind:"Variable",name:"architecture",variableName:"architecture"},{kind:"Variable",name:"props",variableName:"props"},{kind:"Variable",name:"target",variableName:"target"}],concreteType:"ModifyImage",kind:"LinkedField",name:"modify_image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,n,a],kind:"Fragment",metadata:null,name:"ManageAppsModalMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,e,n],kind:"Operation",name:"ManageAppsModalMutation",selections:l},params:{cacheID:"b7a57119037085ec9f08346991633e0a",id:null,metadata:{},name:"ManageAppsModalMutation",operationKind:"mutation",text:"mutation ManageAppsModalMutation(\n  $target: String!\n  $architecture: String\n  $props: ModifyImageInput!\n) {\n  modify_image(target: $target, architecture: $architecture, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();oe.hash="bb280196745e96f5c488d1d785a5b012";const de=oe,ue={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ManageAppsModal_image",selections:[{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namespace",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"installed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null}],type:"Image",abstractKey:null,hash:"27f7f45d8961ee26a76e432436ed81e2"},ce=ue;var me=a(44032);const ge=["open","imageFrgmt","onRequestClose"],ye=e=>{let{open:n,imageFrgmt:a,onRequestClose:r}=e,i=(0,p.A)(e,ge);const{t:t}=(0,O.Bd)(),s=L.useRef(null),o=R.A.useApp(),{token:d}=S.A.useToken(),u=(0,N.useFragment)(ce,a),[c,m]=(0,N.useMutation)(de);if(!u)return null;const g=(()=>{let e=[];if(u.labels){const a=P().findIndex(u.labels,(e=>null!==e&&"ai.backend.service-ports"===(null===e||void 0===e?void 0:e.key)));if(-1!==a){var n;const l=null===(n=u.labels[a])||void 0===n?void 0:n.value;l&&(e=l.split(",").map((e=>{const n=e.split(":");return{app:n[0],protocol:n[1],port:Number(n[2])}})))}}return e})();return(0,T.jsxs)(K.IbE,(0,l.A)((0,l.A)({destroyOnHidden:!0,open:n,onOk:()=>{var e;null===(e=s.current)||void 0===e||e.validateFields().then((()=>{var e;const n=null===(e=s.current)||void 0===e?void 0:e.getFieldValue("apps").map((e=>"".concat(e.app,":").concat(e.protocol,":").concat(e.port))).join(","),a=P().map(u.labels,(e=>{return e.key.includes("service-ports")?{key:e.key,value:n}:{key:e.key,value:(null===(a=e.value)||void 0===a?void 0:a.toString())||""};var a})),l=()=>{var e;return c({variables:{target:"".concat(null===u||void 0===u?void 0:u.registry,"/").concat(null!==(e=null===u||void 0===u?void 0:u.name)&&void 0!==e?e:u.namespace,":").concat(null===u||void 0===u?void 0:u.tag),architecture:null===u||void 0===u?void 0:u.architecture,props:{labels:a,resource_limits:void 0}},onCompleted:(e,n)=>{var a,l;if(null!==e&&void 0!==e&&null!==(a=e.modify_image)&&void 0!==a&&a.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=P().map(n,(e=>e.message));for(const n of e)me.Ay.error(n)}else me.Ay.success(t("environment.DescImagePortsModified")),r(!0);else me.Ay.error(null===e||void 0===e||null===(l=e.modify_image)||void 0===l?void 0:l.msg)},onError:()=>{me.Ay.error(t("dialog.ErrorOccurred"))}})};null!==u&&void 0!==u&&u.installed?o.modal.confirm({title:"Image reinstallation required",content:(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(O.x6,{i18nKey:"environment.ModifyImageResourceLimitReinstallRequired"})}),onOk:l,getContainer:()=>document.body,closable:!0}):l()})).catch((()=>{}))},onCancel:()=>r(!1),confirmLoading:m,title:t("environment.ManageApps")},i),{},{children:[(0,T.jsxs)(K.OOm,{direction:"row",style:{width:"100%",marginBottom:d.marginXS},children:[(0,T.jsx)(Y.A.Text,{strong:!0,style:{width:"32%"},children:t("environment.AppName")}),(0,T.jsx)(Y.A.Text,{strong:!0,style:{width:"32%"},children:t("environment.Protocol")}),(0,T.jsx)(Y.A.Text,{strong:!0,style:{width:"32%"},children:t("environment.Port")}),(0,T.jsx)(K.OOm,{})]}),(0,T.jsx)(F.A,{ref:s,layout:"vertical",autoComplete:"off",initialValues:{apps:g},children:(0,T.jsx)(K.OOm,{direction:"column",children:(0,T.jsx)(F.A.List,{name:"apps",children:(e,n)=>{let{add:a,remove:r}=n;return(0,T.jsxs)(K.OOm,{direction:"column",style:{width:"100%"},children:[P().map(e,((e,n)=>(0,T.jsx)(F.A.Item,{children:(0,T.jsxs)(K.OOm,{direction:"row",gap:"xs",children:[(0,T.jsx)(F.A.Item,(0,l.A)((0,l.A)({},e),{},{name:[e.name,"app"],noStyle:!0,rules:[{required:!0,message:t("environment.AppNameMustNotBeEmpty")}],children:(0,T.jsx)(I.A,{placeholder:t("environment.AppName")})})),(0,T.jsx)(F.A.Item,(0,l.A)((0,l.A)({},e),{},{name:[e.name,"protocol"],noStyle:!0,rules:[{pattern:/^(http|tcp|pty|preopen)$/,required:!0,message:t("environment.ProtocolMustBeOneOfSupported")}],children:(0,T.jsx)(I.A,{placeholder:t("environment.Protocol")})})),(0,T.jsx)(F.A.Item,(0,l.A)((0,l.A)({},e),{},{name:[e.name,"port"],noStyle:!0,required:!0,rules:[{validator:(e,n)=>{const a=P().isUndefined(n)||""===n?NaN:P().toNumber(n);return P().isNaN(a)||a<0||a>=65535?Promise.reject(t("environment.PortMustBeInRange")):[2e3,2001,2002,2003,2200,7681].includes(Number(a))?Promise.reject(t("environment.PortReservedForInternalUse")):Promise.resolve()}},{validator:(e,a)=>{var l;const r=null===(l=s.current)||void 0===l?void 0:l.getFieldValue("apps");return P().isString(a)&&a.length>0&&r.some(((e,l)=>l!==n&&(null===e||void 0===e?void 0:e.port)===a))?Promise.reject(t("environment.PortMustBeUnique")):Promise.resolve()}}],children:(0,T.jsx)(I.A,{placeholder:t("environment.Port")})})),(0,T.jsx)(G.Ay,{type:"text",danger:!0,onClick:()=>r(e.name),style:0===n?{width:"10%",marginTop:8}:{width:"10%"},icon:(0,T.jsx)($.A,{})})]},e.key)}))),(0,T.jsx)(G.Ay,{type:"dashed",onClick:()=>a(),block:!0,icon:(0,T.jsx)(U.A,{}),disabled:!u,children:t("button.Add")})]})}})})})]}))},pe=function(){var e={defaultValue:null,kind:"LocalArgument",name:"architecture"},n={defaultValue:null,kind:"LocalArgument",name:"props"},a={defaultValue:null,kind:"LocalArgument",name:"target"},l=[{alias:null,args:[{kind:"Variable",name:"architecture",variableName:"architecture"},{kind:"Variable",name:"props",variableName:"props"},{kind:"Variable",name:"target",variableName:"target"}],concreteType:"ModifyImage",kind:"LinkedField",name:"modify_image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,n,a],kind:"Fragment",metadata:null,name:"ManageImageResourceLimitModalMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,e,n],kind:"Operation",name:"ManageImageResourceLimitModalMutation",selections:l},params:{cacheID:"b4c4a5b17c6aa265df64e4d2d6338684",id:null,metadata:{},name:"ManageImageResourceLimitModalMutation",operationKind:"mutation",text:"mutation ManageImageResourceLimitModalMutation(\n  $target: String!\n  $architecture: String\n  $props: ModifyImageInput!\n) {\n  modify_image(target: $target, architecture: $architecture, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();pe.hash="491b6e500587a3630195d9025ef76f29";const ve=pe,fe={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ManageImageResourceLimitModal_image",selections:[{alias:null,args:null,concreteType:"ResourceLimit",kind:"LinkedField",name:"resource_limits",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"min",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namespace",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"installed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null}],type:"Image",abstractKey:null,hash:"ff5d624d540d655b81042a14595b72d2"},ke=fe;var he=a(22787),xe=a(24213),be=a(72927);const Ae=["imageFrgmt","open","onRequestClose"],_e="1g",je=e=>{var n,a;let{imageFrgmt:r,open:i,onRequestClose:t}=e,s=(0,p.A)(e,Ae);const{t:o}=(0,O.Bd)(),d=(0,L.useRef)(null),u=R.A.useApp(),{mergedResourceSlots:c}=(0,K.Hvp)(),m=(0,N.useFragment)(ke,r),[g,y]=(0,N.useMutation)(ve);return(0,T.jsx)(K.IbE,(0,l.A)((0,l.A)({destroyOnHidden:!0,open:i,maskClosable:!1,onOk:async()=>{var e,n;if(!await(null===(e=d.current)||void 0===e?void 0:e.validateFields().catch((()=>!1))))return;const a=await(null===(n=d.current)||void 0===n?void 0:n.getFieldsValue()),l=Object.entries(a).map((e=>{var n,a,l,r;let[i,t]=e;return{key:i,min:null!==(n=P().toString(t))&&void 0!==n?n:"0",max:null!==(a=null===m||void 0===m||null===(l=m.resource_limits)||void 0===l||null===(r=l.find((e=>(null===e||void 0===e?void 0:e.key)===i)))||void 0===r?void 0:r.max)&&void 0!==a?a:void 0}})).filter((e=>!P().isEmpty(null===e||void 0===e?void 0:e.min))),r=()=>{var e;return g({variables:{target:"".concat(null===m||void 0===m?void 0:m.registry,"/").concat(null!==(e=null===m||void 0===m?void 0:m.name)&&void 0!==e?e:null===m||void 0===m?void 0:m.namespace,":").concat(null===m||void 0===m?void 0:m.tag),architecture:null===m||void 0===m?void 0:m.architecture,props:{resource_limits:l}},onCompleted:(e,n)=>{var a,l;null!==e&&void 0!==e&&null!==(a=e.modify_image)&&void 0!==a&&a.ok?null!==n&&void 0!==n&&n.length?P().forEach(n,(e=>me.Ay.error(e.message))):(me.Ay.success(o("environment.DescImageResourceModified")),t(!0)):me.Ay.error(null===e||void 0===e||null===(l=e.modify_image)||void 0===l?void 0:l.msg)},onError:()=>{me.Ay.error(o("dialog.ErrorOccurred"))}})};null!==m&&void 0!==m&&m.installed?u.modal.confirm({title:o("environment.ImageReinstallationRequired"),content:(0,T.jsx)(O.x6,{i18nKey:"environment.ModifyImageResourceLimitReinstallRequired"}),onOk:r,getContainer:()=>document.body,closable:!0}):r()},onCancel:()=>t(!1),confirmLoading:y,centered:!0,title:o("environment.ModifyMinimumImageResourceLimit")},s),{},{children:(0,T.jsx)(F.A,{ref:d,layout:"vertical",initialValues:P().fromPairs(P().map(null!==(n=null===m||void 0===m?void 0:m.resource_limits)&&void 0!==n?n:[],(e=>[null===e||void 0===e?void 0:e.key,null===e||void 0===e?void 0:e.min]))),children:(0,T.jsx)(he.A,{gutter:[24,16],children:P().map(P().chunk(null!==(a=null===m||void 0===m?void 0:m.resource_limits)&&void 0!==a?a:[],2),((e,n)=>(0,T.jsx)(L.Fragment,{children:P().map(e,(e=>{var n,a;const l=P().get(e,"key","");return l?(0,T.jsx)(xe.A,{span:12,style:{alignSelf:"start"},children:(0,T.jsx)(F.A.Item,{label:(null===(n=P().get(c,l))||void 0===n?void 0:n.description)||P().upperCase(l),name:l,rules:[{required:!0},{validator:(e,n)=>{var a;return"mem"===l&&n&&(0,le.Mh)(n,_e)<0?Promise.reject(new Error(o("environment.ErrorMinimumValue",{value:_e,key:null===c||void 0===c||null===(a=c[l])||void 0===a?void 0:a.description}))):Promise.resolve()}}],children:"mem"===l?(0,T.jsx)(K.HiE,{min:_e,style:{width:"100%"}}):(0,T.jsx)(be.A,{min:"cpu"===l?1:0,step:P().includes(l,".shares")?.1:1,style:{width:"100%"},suffix:(null===c||void 0===c||null===(a=c[l])||void 0===a?void 0:a.display_unit)||""})})},l):null}))},n)))})})}))};var Se=a(49272);const Re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zM464 544H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H212V612h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200z"}}]},name:"appstore",theme:"outlined"};var Fe=a(7422);function Ie(){return Ie=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},Ie.apply(this,arguments)}const Me=(e,n)=>L.createElement(Fe.A,Ie({},e,{ref:n,icon:Re}));const Ce=L.forwardRef(Me);var Ke=a(57134);const we={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"};function Pe(){return Pe=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},Pe.apply(this,arguments)}const Le=(e,n)=>L.createElement(Fe.A,Pe({},e,{ref:n,icon:we}));const Oe=L.forwardRef(Le);var Ne=a(41448);const Te=e=>{let{style:n}=e;const{t:a}=(0,O.Bd)(),[r,i]=(0,L.useState)([]),[,{getBaseVersion:t,getBaseImages:s,getBaseImage:o,tagAlias:d,getTags:c}]=(0,u.Gj)(),{token:m}=S.A.useToken(),[y,p]=(0,L.useState)(null),[v,f]=(0,L.useState)(null),[k,h]=(0,L.useState)(!1),[x,b]=(0,K.TwB)("initial-fetch"),[,A]=(0,L.useTransition)(),[_,j]=(0,L.useState)([]),{message:F}=R.A.useApp(),[M,C]=(0,L.useState)(""),[w,{toggle:D}]=(0,H.A)(),[E,$]=(0,L.useTransition)(),[B,U]=(0,L.useTransition)(),Q=(0,u.CX)(),W=null===Q||void 0===Q?void 0:Q.supports("extended-image-info"),{run:Z}=(0,Ne.A)((e=>{U((()=>C(e)))}),{wait:500}),{images:ee}=(0,N.useLazyLoadQuery)(ae,{},{fetchPolicy:"store-and-network",fetchKey:x}),ne=(0,L.useMemo)((()=>P().sortBy(ee,(e=>null===e||void 0===e?void 0:e.humanized_name))),[ee]),re=(0,L.useMemo)((()=>(0,K.YM3)([{title:a("environment.Status"),dataIndex:"installed",key:"installed",defaultSortOrder:"descend",sorter:(e,n)=>P().toNumber((null===e||void 0===e?void 0:e.installed)||0)-P().toNumber((null===n||void 0===n?void 0:n.installed)||0),render:(e,n)=>null!==n&&void 0!==n&&n.id&&_.includes(n.id)?(0,T.jsx)(J.A,{color:"gold",children:(0,T.jsx)(Se.A,{keyword:M,children:a("environment.Installing")})}):null!==n&&void 0!==n&&n.installed?(0,T.jsx)(J.A,{color:"gold",children:(0,T.jsx)(Se.A,{keyword:M,children:a("environment.Installed")})}):null},{title:a("environment.FullImagePath"),key:"fullImagePath",render:e=>(0,T.jsx)(Y.A.Text,{copyable:{text:(0,le.A_)(e)||""},children:(0,T.jsx)(Se.A,{keyword:M,children:(0,le.A_)(e)||""})}),sorter:(e,n)=>(0,le._f)((0,le.A_)(e),(0,le.A_)(n)),width:m.screenXS},{title:a("environment.Registry"),dataIndex:"registry",key:"registry",sorter:(e,n)=>(0,le._f)(null===e||void 0===e?void 0:e.registry,null===n||void 0===n?void 0:n.registry),render:e=>(0,T.jsx)(Se.A,{keyword:M,children:e})},{title:a("environment.Architecture"),dataIndex:"architecture",key:"architecture",sorter:(e,n)=>(0,le._f)(null===e||void 0===e?void 0:e.architecture,null===n||void 0===n?void 0:n.architecture),render:e=>(0,T.jsx)(Se.A,{keyword:M,children:e})},!W&&{title:a("environment.Namespace"),key:"namespace",dataIndex:"namespace",sorter:(e,n)=>(0,le._f)(null===e||void 0===e?void 0:e.namespace,null===n||void 0===n?void 0:n.namespace),render:e=>(0,T.jsx)(Se.A,{keyword:M,children:e})},!W&&{title:a("environment.BaseImageName"),key:"base_image_name",dataIndex:"base_image_name",sorter:(e,n)=>(0,le._f)(null===e||void 0===e?void 0:e.base_image_name,null===n||void 0===n?void 0:n.base_image_name),render:e=>(0,T.jsx)(Se.A,{keyword:M,children:d(e)})},!W&&{title:a("environment.Version"),key:"version",dataIndex:"version",sorter:(e,n)=>(0,le._f)(null===e||void 0===e?void 0:e.version,null===n||void 0===n?void 0:n.version),render:e=>(0,T.jsx)(Se.A,{keyword:M,children:e})},!W&&{title:a("environment.Tags"),key:"tags",dataIndex:"tags",render:(e,n)=>(0,T.jsx)(K.OOm,{direction:"row",align:"start",gap:"xs",wrap:"wrap",children:P().map(e,(e=>{var a;const l=P().includes(e.key,"customized_"),r=l?null===(a=P().find(null===n||void 0===n?void 0:n.labels,{key:"ai.backend.customized-image.name"}))||void 0===a?void 0:a.value:e.value,i=d(e.key+r);return P().isEqual(i,(0,le.WY)(e.key+r))||l?(0,T.jsx)(K.qnQ,{highlightKeyword:M,values:[{label:d(e.key),color:l?"cyan":"blue"},{label:null!==r&&void 0!==r?r:"",color:l?"cyan":"blue"}]},e.key):(0,T.jsx)(J.A,{color:l?"cyan":"blue",children:(0,T.jsx)(Se.A,{keyword:M,children:i})},e.key)}))})},!W&&{title:a("environment.Namespace"),key:"name",dataIndex:"name",sorter:(e,n)=>(0,le._f)((0,le.A_)(e),(0,le.A_)(n)),render:e=>(0,T.jsx)(Se.A,{keyword:M,children:e})},!W&&{title:a("environment.Base"),key:"baseimage",dataIndex:"baseimage",sorter:(e,n)=>(0,le._f)(o((0,le.A_)(e)||""),o((0,le.A_)(n)||"")),render:(e,n)=>(0,T.jsx)(Se.A,{keyword:M,children:d(o((0,le.A_)(n)||""))})},!W&&{title:a("environment.Version"),key:"baseversion",dataIndex:"baseversion",sorter:(e,n)=>(0,le._f)(t((0,le.A_)(e)||""),t((0,le.A_)(n)||"")),render:(e,n)=>(0,T.jsx)(Se.A,{keyword:M,children:t((0,le.A_)(n)||"")})},!W&&{title:a("environment.Tags"),key:"tag",dataIndex:"tag",sorter:(e,n)=>(0,le._f)(null===e||void 0===e?void 0:e.tag,null===n||void 0===n?void 0:n.tag),render:(e,n)=>(0,T.jsx)(se.J,{tag:e,labels:n.labels,highlightKeyword:M})},{title:a("environment.Digest"),dataIndex:"digest",key:"digest",sorter:(e,n)=>(0,le._f)((null===e||void 0===e?void 0:e.digest)||"",(null===n||void 0===n?void 0:n.digest)||""),render:(e,n)=>(0,T.jsx)(Y.A.Text,{ellipsis:{tooltip:!0},style:{maxWidth:200},children:(0,T.jsx)(Se.A,{keyword:M,children:n.digest})})},{title:a("environment.ResourceLimit"),dataIndex:"resource_limits",key:"resource_limits",render:(e,n)=>{var a;return(0,T.jsx)(K.OOm,{direction:"row",gap:"xxs",children:null===n||void 0===n||null===(a=n.resource_limits)||void 0===a?void 0:a.map((e=>(0,T.jsx)(K.jOc,{type:(null===e||void 0===e?void 0:e.key)||"",value:(null===e||void 0===e?void 0:e.min)||"0",max:(null===e||void 0===e?void 0:e.max)||"Infinity"},null===e||void 0===e?void 0:e.key)))})}},{title:a("general.Control"),key:"control",dataIndex:"control",fixed:"right",render:(e,n)=>(0,T.jsxs)(K.OOm,{direction:"row",align:"stretch",justify:"center",gap:"xxs",onClick:e=>{e.stopPropagation()},children:[(0,T.jsx)(G.Ay,{type:"text",icon:(0,T.jsx)(q.A,{style:{color:m.colorInfo}}),onClick:()=>f(n)}),(0,T.jsx)(G.Ay,{type:"text",icon:(0,T.jsx)(Ce,{style:{color:m.colorInfo}}),onClick:()=>{p(n)}})]})}])),[a,M,_,m,W,o,t,d]),[ie,oe]=(0,g.a)("ImageList"),de=(0,L.useMemo)((()=>null===ne||void 0===ne?void 0:ne.map((e=>({namespace:W?null===e||void 0===e?void 0:e.namespace:null===e||void 0===e?void 0:e.name,fullName:(0,le.A_)(e)||"",digest:(null===e||void 0===e?void 0:e.digest)||"",baseversion:t((0,le.A_)(e)||""),baseimage:null!==e&&void 0!==e&&e.tag&&null!==e&&void 0!==e&&e.name?s(e.tag,e.name):[],tag:c((null===e||void 0===e?void 0:e.tag)||"",null===e||void 0===e?void 0:e.labels)||[],isCustomized:!(null===e||void 0===e||!e.tag)&&-1!==e.tag.indexOf("customized"),baseImageName:W?null===e||void 0===e?void 0:e.base_image_name:"",tags:W?null===e||void 0===e?void 0:e.tags:[],version:W?null===e||void 0===e?void 0:e.version:""})))),[ne]),ue=(0,L.useMemo)((()=>{if(P().isEmpty(M))return ne;const e=new RegExp("".concat(P().escapeRegExp(M)),"i");return P().filter(ne,((n,a)=>P().some(n,((n,l)=>{if("id"===l)return!1;if(["digest","architecture","registry"].includes(l))return e.test(P().toString(n));const r=de[a]||{},i=e.test(r.baseversion),t=P().some(r.baseimage,(n=>e.test(n))),s=P().some(r.tag,(n=>e.test(n.key)||e.test(n.value))),o=!!r.isCustomized&&e.test("customized"),d=e.test(r.namespace||""),u=e.test(r.fullName),c=P().some(r.tags,(n=>e.test(n.key)||e.test(n.value))),m=e.test(r.version||""),g=e.test(r.digest);return i||t||s||d||o||u||c||m||g}))))}),[M,de,ne]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(K.OOm,{direction:"column",align:"stretch",style:(0,l.A)({flex:1},n),gap:"sm",children:[(0,T.jsxs)(K.OOm,{justify:"between",children:[(0,T.jsx)(I.A,{allowClear:!0,prefix:(0,T.jsx)(Ke.A,{}),placeholder:a("environment.SearchImages"),onChange:e=>{Z(e.target.value)},style:{width:200}}),(0,T.jsxs)(K.OOm,{gap:"xs",children:[r.length>0?(0,T.jsx)(Y.A.Text,{children:a("general.NSelected",{count:r.length})}):null,(0,T.jsx)(X.A,{title:a("button.Refresh"),children:(0,T.jsx)(G.Ay,{icon:(0,T.jsx)(z.A,{}),loading:E,onClick:()=>{i([]),$((()=>b()))}})}),(0,T.jsx)(G.Ay,{icon:(0,T.jsx)(Oe,{}),style:{backgroundColor:m.colorPrimary,color:"white"},onClick:()=>{0!==r.length?r.some((e=>!e.installed))?h(!0):F.error(a("environment.AlreadyInstalledImage")):F.error(a("environment.NoImagesAreSelected"))},children:a("environment.Install")})]})]}),(0,T.jsx)(K.zxw,{resizable:!0,rowKey:"id",scroll:{x:"max-content"},pagination:{extraContent:(0,T.jsx)(G.Ay,{type:"text",icon:(0,T.jsx)(q.A,{}),onClick:()=>{D()}})},dataSource:(0,K.faj)(ue),columns:P().filter(re,(e=>!P().includes(ie,P().toString(null===e||void 0===e?void 0:e.key)))),loading:B,rowSelection:{type:"checkbox",onChange:(e,n)=>{i(n)},selectedRowKeys:r.map((e=>e.id))},onRow:e=>({onClick:()=>{r.find((n=>n.id===e.id))?i((n=>n.filter((n=>n.id!==e.id)))):i((n=>[...n,e]))}}),showSorterTooltip:!1})]}),(0,T.jsx)(je,{open:!!v,onRequestClose:e=>{f(null),e&&A((()=>{b()}))},imageFrgmt:v}),(0,T.jsx)(ye,{open:!!y,onRequestClose:e=>{p(null),e&&A((()=>{b()}))},imageFrgmt:y}),(0,T.jsx)(te,{open:k,onRequestClose:()=>{h(!1)},setInstallingImages:j,selectedRows:r}),(0,T.jsx)(V.A,{open:w,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&oe(P().difference(re.map((e=>P().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),D()},columns:re,hiddenColumnKeys:ie})]})},De=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"DeleteResourcePreset",kind:"LinkedField",name:"delete_resource_preset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ResourcePresetListDeleteMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ResourcePresetListDeleteMutation",selections:n},params:{cacheID:"66d1ae4fe23653f392529fb39e2e61f2",id:null,metadata:{},name:"ResourcePresetListDeleteMutation",operationKind:"mutation",text:"mutation ResourcePresetListDeleteMutation(\n  $name: String!\n) {\n  delete_resource_preset(name: $name) {\n    ok\n    msg\n  }\n}\n"}}}();De.hash="99b502a95d31e84e4de261e06fb89915";const Ee=De,Ve=function(){var e={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"resource_slots",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"shared_memory",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"scaling_group_name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResourcePresetListQuery",selections:[{alias:null,args:null,concreteType:"ResourcePreset",kind:"LinkedField",name:"resource_presets",plural:!0,selections:[e,n,a,l,{args:null,kind:"FragmentSpread",name:"ResourcePresetSettingModalFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ResourcePresetListQuery",selections:[{alias:null,args:null,concreteType:"ResourcePreset",kind:"LinkedField",name:"resource_presets",plural:!0,selections:[e,n,a,l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"5077b740e419c95cf7f162d8ad950d6d",id:null,metadata:{},name:"ResourcePresetListQuery",operationKind:"query",text:'query ResourcePresetListQuery {\n  resource_presets {\n    name\n    resource_slots\n    shared_memory\n    scaling_group_name @since(version: "25.4.0")\n    ...ResourcePresetSettingModalFragment\n  }\n}\n\nfragment ResourcePresetSettingModalFragment on ResourcePreset {\n  id @since(version: "25.4.0")\n  name\n  resource_slots\n  shared_memory\n  scaling_group_name @since(version: "25.4.0")\n}\n'}}}();Ve.hash="0284e5247dbfb40e6290f58570ba5fd7";const qe=Ve,$e=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"id"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyResourcePreset",kind:"LinkedField",name:"modify_resource_preset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ResourcePresetSettingModalModifyByIdMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ResourcePresetSettingModalModifyByIdMutation",selections:n},params:{cacheID:"a9e04a9d13321e5f45297f1b8b657c7f",id:null,metadata:{},name:"ResourcePresetSettingModalModifyByIdMutation",operationKind:"mutation",text:"mutation ResourcePresetSettingModalModifyByIdMutation(\n  $id: UUID!\n  $props: ModifyResourcePresetInput!\n) {\n  modify_resource_preset(id: $id, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();$e.hash="ea2ed67aec94a7a731f279a6c539a21a";const Be=$e,ze=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyResourcePreset",kind:"LinkedField",name:"modify_resource_preset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ResourcePresetSettingModalModifyByNameMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ResourcePresetSettingModalModifyByNameMutation",selections:n},params:{cacheID:"6ce07dbffc5597af1943b0840e1b3810",id:null,metadata:{},name:"ResourcePresetSettingModalModifyByNameMutation",operationKind:"mutation",text:"mutation ResourcePresetSettingModalModifyByNameMutation(\n  $name: String!\n  $props: ModifyResourcePresetInput!\n) {\n  modify_resource_preset(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();ze.hash="a3d038466cde4ef350d21929ee0513b1";const Ue=ze,Qe=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateResourcePreset",kind:"LinkedField",name:"create_resource_preset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ResourcePresetSettingModalCreateMutation",selections:n,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ResourcePresetSettingModalCreateMutation",selections:n},params:{cacheID:"4c6d8ef938cb69d5336e86c9d7fca415",id:null,metadata:{},name:"ResourcePresetSettingModalCreateMutation",operationKind:"mutation",text:"mutation ResourcePresetSettingModalCreateMutation(\n  $name: String!\n  $props: CreateResourcePresetInput!\n) {\n  create_resource_preset(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();Qe.hash="6d3e941d6668ba2fda013fa61adb004d";const He=Qe,Je={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResourcePresetSettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shared_memory",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"scaling_group_name",storageKey:null}],type:"ResourcePreset",abstractKey:null,hash:"0ee1263d70c0a64795de2223e0513101"},We=Je;var Xe=a(476),Ge=a(52053);const Ye=["resourcePresetFrgmt","existingResourcePresetNames","onRequestClose"],Ze=e=>{var n;let{resourcePresetFrgmt:a,existingResourcePresetNames:r,onRequestClose:i}=e,t=(0,p.A)(e,Ye);const{t:s}=(0,O.Bd)(),{message:o}=R.A.useApp(),d=(0,L.useRef)(null),c=(0,u.CX)(),m=(0,Ge.hd)(),[g]=(0,Xe.bL)(),{mergedResourceSlots:y}=(0,K.Hvp)(),v=(0,N.useFragment)(We,a),[f,k]=(0,N.useMutation)(He),[h,x]=(0,N.useMutation)(Ue),[b,A]=(0,N.useMutation)(Be);return(0,T.jsx)(K.IbE,(0,l.A)((0,l.A)({},t),{},{title:s(v?"resourcePreset.ModifyResourcePreset":"resourcePreset.CreateResourcePreset"),onOk:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.validateFields().then((e=>{var n;let a=P().mapValues(null===e||void 0===e?void 0:e.resource_slots,((e,n)=>{var a;return e&&P().includes(n,"mem")?null===(a=(0,le.mv)(e,"",0))||void 0===a?void 0:a.numberFixed:e}));a=P().pickBy(a,P().negate(P().isNil));const l={resource_slots:JSON.stringify(a||{}),shared_memory:null!==e&&void 0!==e&&e.shared_memory?null===(n=(0,le.mv)(null===e||void 0===e?void 0:e.shared_memory,"",0))||void 0===n?void 0:n.numberFixed:null};null!==c&&void 0!==c&&c.supports("resource-presets-per-resource-group")&&(l.scaling_group_name=(null===e||void 0===e?void 0:e.scaling_group_name)||null),P().isEmpty(v)?f({variables:{name:null===e||void 0===e?void 0:e.name,props:l},onCompleted:(e,n)=>{var a,l;if(null!==e&&void 0!==e&&null!==(a=e.create_resource_preset)&&void 0!==a&&a.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=P().map(n,(e=>e.message));P().forEach(e,(e=>{o.error(e)})),i(!1)}else o.success(s("resourcePreset.Created")),i(!0);else o.error(null===e||void 0===e||null===(l=e.create_resource_preset)||void 0===l?void 0:l.msg),i(!1)},onError(e){o.error(null===e||void 0===e?void 0:e.message)}}):v.id?b({variables:{id:v.id,props:l},onCompleted:(e,n)=>{var a,l;if(null!==e&&void 0!==e&&null!==(a=e.modify_resource_preset)&&void 0!==a&&a.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=P().map(n,(e=>null===e||void 0===e?void 0:e.message));P().forEach(e,(e=>{o.error(e)})),i(!1)}else o.success(s("resourcePreset.Updated")),i(!0);else o.error(null===e||void 0===e||null===(l=e.modify_resource_preset)||void 0===l?void 0:l.msg),i(!1)},onError(e){o.error(null===e||void 0===e?void 0:e.message)}}):h({variables:{name:null===e||void 0===e?void 0:e.name,props:l},onCompleted:(e,n)=>{var a,l;if(null!==e&&void 0!==e&&null!==(a=e.modify_resource_preset)&&void 0!==a&&a.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=P().map(n,(e=>null===e||void 0===e?void 0:e.message));P().forEach(e,(e=>{o.error(e)})),i(!1)}else o.success(s("resourcePreset.Updated")),i(!0);else o.error(null===e||void 0===e||null===(l=e.modify_resource_preset)||void 0===l?void 0:l.msg),i(!1)},onError(e){o.error(null===e||void 0===e?void 0:e.message)}})})).catch((()=>{}))},onCancel:()=>i(!1),destroyOnHidden:!0,confirmLoading:k||x||A,okText:s(v?"button.Save":"button.Create"),children:(0,T.jsxs)(F.A,{ref:d,layout:"vertical",preserve:!1,initialValues:v?(0,l.A)((0,l.A)({},v),{},{resource_slots:P().mapValues(JSON.parse((null===v||void 0===v?void 0:v.resource_slots)||"{}"),((e,n)=>{var a;return P().includes(n,"mem")?null===(a=(0,le.mv)(e,"0"===e?"g":"auto"))||void 0===a?void 0:a.value:e}))||{},shared_memory:null!==v&&void 0!==v&&v.shared_memory?null===(n=(0,le.mv)(null===v||void 0===v?void 0:v.shared_memory,"0"===(null===v||void 0===v?void 0:v.shared_memory)?"g":"auto"))||void 0===n?void 0:n.value:null}):{resource_slots:{mem:null},shared_memory:null},children:[(0,T.jsx)(F.A.Item,{label:s("resourcePreset.PresetName"),name:"name",rules:[{required:!0,message:s("resourcePreset.NoPresetName")},{pattern:/^[a-zA-Z0-9._-]*$/,message:s("data.AllowsLettersNumbersAnd-_Dot")},{validator:(e,n)=>!v&&null!==r&&void 0!==r&&r.includes(n)?Promise.reject(new Error(s("resourcePreset.PresetNameAlreadyExists"))):Promise.resolve()}],children:(0,T.jsx)(I.A,{disabled:!!v})}),(null===c||void 0===c?void 0:c.supports("resource-presets-per-resource-group"))&&(0,T.jsx)(F.A.Item,{label:s("general.ResourceGroup"),name:"scaling_group_name",children:(0,T.jsx)(K.ZPT,{projectName:m.name,allowClear:!0,popupMatchSelectWidth:!1})}),(0,T.jsxs)(F.A.Item,{label:s("resourcePreset.ResourcePreset"),required:!0,layout:"vertical",children:[P().map(P().chunk(P().keys(g),2),((e,n)=>(0,T.jsx)(L.Fragment,{children:P().map(e,(e=>{var n,a;return(0,T.jsx)(F.A.Item,{label:(null===(n=P().get(y,e))||void 0===n?void 0:n.description)||e,name:["resource_slots",e],rules:[P().includes(["cpu","mem"],e)?{required:!0,message:s("data.explorer.ValueRequired")}:{},{validator:(n,a)=>a&&P().includes(e,"mem")&&(0,le.mv)(a,"p").number>(0,le.mv)("300p","p").number?Promise.reject(new Error("Memory size should be less than 300 PiB")):Promise.resolve()}],children:P().includes(e,"mem")?(0,T.jsx)(K.HiE,{style:{width:"100%"}}):(0,T.jsx)(be.A,{stringMode:!0,min:"cpu"===e?1:0,step:P().includes(e,".shares")?.1:1,suffix:null===(a=P().get(y,e))||void 0===a?void 0:a.display_unit,style:{width:"100%"}})})}))},n))),(0,T.jsx)(F.A.Item,{label:s("resourcePreset.SharedMemory"),name:"shared_memory",dependencies:[["resource_slots","mem"]],rules:[e=>{let{getFieldValue:n}=e;return{validator(e,a){var l,r,i,t,o,d;return a&&null!==(l=n("resource_slots"))&&void 0!==l&&l.mem&&(null!==(r=null===(i=(0,le.mv)(null===(t=n("resource_slots"))||void 0===t?void 0:t.mem,""))||void 0===i?void 0:i.number)&&void 0!==r?r:0)<(null!==(o=null===(d=(0,le.mv)(a,""))||void 0===d?void 0:d.number)&&void 0!==o?o:0)?Promise.reject(s("resourcePreset.MemoryShouldBeLargerThanSHMEM")):Promise.resolve()}}}],children:(0,T.jsx)(K.HiE,{max:"7.999p",style:{width:"100%"}})})]})]})}))},en=()=>{const{t:e}=(0,O.Bd)(),{token:n}=S.A.useToken(),{modal:a,message:l}=R.A.useApp(),[r,i]=(0,L.useTransition)(),[t,s]=(0,K.TwB)("initial-fetch"),[o,d]=(0,L.useState)(),[c,m]=(0,L.useState)(null),[g,y]=(0,L.useState)(!1),p=(0,u.CX)(),{resource_presets:v}=(0,N.useLazyLoadQuery)(qe,{},{fetchPolicy:"initial-fetch"===t?"store-and-network":"network-only",fetchKey:t}),[f,k]=(0,N.useMutation)(Ee),h=(0,K.YM3)([{title:e("resourcePreset.Name"),dataIndex:"name",sorter:(e,n)=>(0,le._f)(null===e||void 0===e?void 0:e.name,null===n||void 0===n?void 0:n.name)},{title:e("resourcePreset.Resources"),dataIndex:"resource_slots",render:e=>(0,T.jsx)(K.OOm,{gap:"xxs",children:P().isEmpty(e)?"-":P().map(JSON.parse(e),((e,n)=>(0,T.jsx)(K.jOc,{type:n,value:e},n)))})},{title:e("resourcePreset.SharedMemory"),dataIndex:"shared_memory",render:e=>e?(0,T.jsx)(K.M9B,{numberUnit:e,targetUnit:"g",unitType:"binary"}):"-"},(null===p||void 0===p?void 0:p.supports("resource-presets-per-resource-group"))&&{title:e("general.ResourceGroup"),dataIndex:"scaling_group_name",sorter:(e,n)=>(0,le._f)(null===e||void 0===e?void 0:e.scaling_group_name,null===n||void 0===n?void 0:n.scaling_group_name),render:e=>null!==e&&void 0!==e?e:"-"},{title:e("general.Control"),key:"control",fixed:"right",render:(r,u)=>(0,T.jsxs)(K.OOm,{align:"stretch",children:[(0,T.jsx)(X.A,{title:e("button.Edit"),children:(0,T.jsx)(G.Ay,{type:"text",icon:(0,T.jsx)(q.A,{}),style:{color:n.colorInfo},onClick:()=>{u&&m(u)}})}),(0,T.jsx)(X.A,{title:e("button.Delete"),children:(0,T.jsx)(G.Ay,{type:"text",icon:(0,T.jsx)($.A,{style:{color:n.colorError}}),loading:k&&o===(null===u||void 0===u?void 0:u.name)+t,disabled:k&&o!==(null===u||void 0===u?void 0:u.name)+t,onClick:()=>{a.confirm({title:e("resourcePreset.DeleteResourcePreset"),content:(0,T.jsxs)(T.Fragment,{children:[e("resourcePreset.AboutToDeletePreset")," ",(0,T.jsx)(Y.A.Text,{strong:!0,children:null===u||void 0===u?void 0:u.name})]}),onOk:()=>{var n;d((null===u||void 0===u?void 0:u.name)+t),f({variables:{name:null!==(n=null===u||void 0===u?void 0:u.name)&&void 0!==n?n:""},onCompleted:(n,a)=>{var r,t;if(null!==n&&void 0!==n&&null!==(r=n.delete_resource_preset)&&void 0!==r&&r.ok)if(a&&(null===a||void 0===a?void 0:a.length)>0){const e=P().map(a,(e=>null===e||void 0===e?void 0:e.message));P().forEach(e,(e=>l.error(e)))}else l.success(e("resourcePreset.Deleted")),i((()=>{s()}));else l.error(null===n||void 0===n||null===(t=n.delete_resource_preset)||void 0===t?void 0:t.msg)},onError:e=>{l.error(null===e||void 0===e?void 0:e.message)}})},okText:e("button.Delete"),okType:"primary",okButtonProps:{danger:!0}})}})})]})}]);return(0,T.jsxs)(K.OOm,{direction:"column",align:"stretch",gap:"sm",children:[(0,T.jsx)(K.OOm,{direction:"row",gap:"xs",justify:"end",wrap:"wrap",children:(0,T.jsxs)(K.OOm,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:[(0,T.jsx)(X.A,{title:e("button.Refresh"),children:(0,T.jsx)(G.Ay,{icon:(0,T.jsx)(z.A,{}),loading:r,onClick:()=>{i((()=>{s()}))}})}),(0,T.jsx)(G.Ay,{type:"primary",icon:(0,T.jsx)(U.A,{}),onClick:()=>{y(!0)},children:e("resourcePreset.CreatePreset")})]})}),(0,T.jsx)(K.zxw,{rowKey:"name",dataSource:(0,K.faj)(v),scroll:{x:"max-content"},showSorterTooltip:!1,columns:h}),(0,T.jsx)(L.Suspense,{fallback:null,children:(0,T.jsx)(Ze,{resourcePresetFrgmt:c,open:!!c||g,onRequestClose:e=>{m(null),y(!1),e&&i((()=>{s()}))},existingResourcePresetNames:P().map(v,(e=>null===e||void 0===e?void 0:e.name))})})]})};var nn=a(39648),an=a(85105);const ln=(0,Z.withDefault)(Z.StringParam,"image"),rn=()=>{const{t:e}=(0,O.Bd)(),[n,a]=(0,Z.useQueryParam)("tab",ln),l=(0,u.CX)();return(0,T.jsx)(K.Zuv,{activeTabKey:n,onTabChange:a,tabList:[{key:"image",label:e("environment.Images")},{key:"preset",label:e("environment.ResourcePresets")},...l.is_superadmin?[{key:"registry",label:e("environment.Registries")}]:[]],children:(0,T.jsxs)(L.Suspense,{fallback:(0,T.jsx)(nn.A,{active:!0}),children:["image"===n&&(0,T.jsx)(an.A,{children:(0,T.jsx)(Te,{})}),"preset"===n&&(0,T.jsx)(an.A,{children:(0,T.jsx)(en,{})}),"registry"===n&&(0,T.jsx)(an.A,{children:(0,T.jsx)(ee,{})})]})})}},89147:(e,n,a)=>{a.d(n,{A:()=>d});var l=a(56276),r=a(11863),i=a(66203),t=a(29262),s=a(26862);const o=["value"],d=e=>{let{value:n}=e,a=(0,r.A)(e,o);const d=i.A.useFormInstance();return(0,t.useEffect)((()=>{d.setFieldValue(a.name,n)}),[n,d,a.name]),(0,s.jsx)(i.A.Item,(0,l.A)((0,l.A)({},a),{},{hidden:!0,children:(0,s.jsx)("div",{})}))}},93594:(e,n,a)=>{a.d(n,{J:()=>F,e:()=>I});var l=a(56276),r=a(11863);const i=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"uuid"}],n=[{kind:"Variable",name:"id",variableName:"uuid"}],a={alias:null,args:null,kind:"ScalarField",name:"image",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"mounts",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ImageTagsUNSAFELazySessionImageTagQuery",selections:[{alias:null,args:n,concreteType:"ComputeSession",kind:"LinkedField",name:"compute_session",plural:!1,selections:[a,l,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ImageTagsUNSAFELazySessionImageTagQuery",selections:[{alias:null,args:n,concreteType:"ComputeSession",kind:"LinkedField",name:"compute_session",plural:!1,selections:[a,l,r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"561670e250a47b880df70cc432c19049",id:null,metadata:{},name:"ImageTagsUNSAFELazySessionImageTagQuery",operationKind:"query",text:"query ImageTagsUNSAFELazySessionImageTagQuery(\n  $uuid: UUID!\n) {\n  compute_session(id: $uuid) {\n    image\n    mounts\n    architecture\n    id\n  }\n}\n"}}}();i.hash="20cd966dac98c484e7c795ff3d7e78a4";const t=i;var s=a(31871),o=a(37138),d=a(74065),u=a(49272),c=a(86425),m=a(87272),g=a(7265),y=a(60669),p=a.n(y),v=a(29262),f=a(84372),k=a(26862);const h=["image"],x=["image"],b=["image"],A=["tag","labels","highlightKeyword"],_=e=>{let{image:n}=e,a=(0,r.A)(e,h);n=n||"";const[,{getImageAliasName:i,getBaseVersion:t,tagAlias:s}]=(0,o.Gj)();return(0,k.jsx)(g.qnQ,(0,l.A)({values:[{label:s(i(n)),color:"blue"},{label:t(n),color:"green"}]},a))},j=e=>{let{image:n}=e,a=(0,r.A)(e,x);n=n||"";const[,{getBaseImage:i,tagAlias:t}]=(0,o.Gj)();return p().isEmpty(t(i(n)))?null:(0,k.jsx)(c.A,(0,l.A)((0,l.A)({color:"green"},a),{},{children:t(i(n))}))},S=e=>{let{image:n}=e,a=(0,r.A)(e,b);n=n||"";const[,{getArchitecture:i,tagAlias:t}]=(0,o.Gj)();return p().isEmpty(t(i(n)))?null:(0,k.jsx)(c.A,(0,l.A)((0,l.A)({color:"green"},a),{},{children:i(n)}))},R=v.memo((function(e){let{image:n}=e;return n=n||"",(0,k.jsxs)(g.OOm,{gap:"xs",wrap:"wrap",children:[(0,k.jsx)(_,{image:n}),(0,k.jsx)(j,{image:n}),(0,k.jsx)(S,{image:n})]})})),F=e=>{let{tag:n,labels:a,highlightKeyword:i}=e,t=(0,r.A)(e,A);a=a||[];const[,{getTags:d,tagAlias:m}]=(0,o.Gj)(),y=d(n,a);return(0,k.jsx)(v.Fragment,(0,l.A)((0,l.A)({},t),{},{children:p().map(y,((e,n)=>{const a="Customized"===e.key,l=m(e.key+e.value);return p().isEqual(l,(0,s.WY)(e.key+e.value))?(0,k.jsx)(g.qnQ,{highlightKeyword:i,values:[{label:m(e.key),color:a?"cyan":"blue"},{label:e.value,color:a?"cyan":"blue"}]},e.key):(0,k.jsx)(c.A,{color:a?"cyan":"blue",children:(0,k.jsx)(u.A,{keyword:i,children:l},n)},e.key)}))}))},I=e=>{let{sessionId:n}=e;const{token:a}=m.A.useToken(),{compute_session:l}=(0,f.useLazyLoadQuery)(t,{uuid:n||""},{fetchPolicy:n?"store-or-network":"store-only"}),r=(null===l||void 0===l?void 0:l.image)&&(null===l||void 0===l?void 0:l.architecture)&&l.image+"@"+l.architecture;return r?(0,k.jsxs)(g.OOm,{gap:["xs",0],wrap:"wrap",children:[(0,k.jsx)(d.A,{image:r,style:{marginRight:a.marginXS}}),(0,k.jsx)(R,{image:r})]}):null}},98078:(e,n,a)=>{a.d(n,{A:()=>f});var l=a(56276),r=a(11863),i=a(57134),t=a(96922),s=a(66203),o=a(91129),d=a(87272),u=a(7265),c=a(60669),m=a.n(c),g=a(29262),y=a(99118),p=a(26862);const v=["open","onRequestClose","columns","hiddenColumnKeys"],f=e=>{var n;let{open:a,onRequestClose:c,columns:f,hiddenColumnKeys:k}=e,h=(0,r.A)(e,v);const x=(0,g.useRef)(null),{t:b}=(0,y.Bd)(),{token:A}=d.A.useToken(),_=m().map(f,(e=>{return"string"===typeof e.title?{label:e.title,value:m().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(n=e.title,g.Children.map(n.props.children,(e=>{if("string"===typeof e)return e}))),value:m().toString(e.key)}:{label:void 0,value:m().toString(e.key)};var n}));return(0,p.jsx)(u.IbE,(0,l.A)((0,l.A)({title:b("table.SettingTable"),open:a,destroyOnHidden:!0,centered:!0,onOk:()=>{var e;null===(e=x.current)||void 0===e||e.validateFields().then((e=>{c(e)})).catch((()=>{}))},onCancel:()=>{c()}},h),{},{children:(0,p.jsxs)(s.A,{ref:x,preserve:!1,initialValues:{selectedColumnKeys:null===(n=m().map(_,"value"))||void 0===n?void 0:n.filter((e=>!m().includes(k,e)))},layout:"vertical",children:[(0,p.jsx)(s.A.Item,{name:"searchInput",label:b("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,p.jsx)(o.A,{prefix:(0,p.jsx)(i.A,{}),style:{marginBottom:A.marginSM},placeholder:b("table.SearchTableColumn")})}),(0,p.jsx)(s.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.searchInput!==n.searchInput,children:e=>{let{getFieldValue:n}=e;const a=n("searchInput")?m().toLower(n("searchInput")):void 0,r=m().map(_,(e=>m().toLower(m().toString(e.label)).includes(a||"")?e:(0,l.A)((0,l.A)({},e),{},{style:{display:"none"}})));return(0,p.jsx)(s.A.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},rules:[{required:!0,message:b("general.validation.PleaseSelectOptions")}],children:(0,p.jsx)(t.A.Group,{options:r,style:{flexDirection:"column"}})})}})]})}))}}}]);
//# sourceMappingURL=1609.1766baff.chunk.js.map