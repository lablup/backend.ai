"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[3176],{61823:(e,n,l)=>{l.d(n,{A:()=>A});var a=l(17898),i=l(23441),s=l(7971),t=l(73e3),o=l(53350);var r,d=l(9189),u=l(22407),c=l(72338),m=l(43622),g=l(50681),p=l(9571),y=l(9769),k=l(50128),h=l(40056),v=l(82919),f=l(52335),_=l(46976),S=l.n(_),x=l(53102),C=l(91788),F=l(22018),j=l(60598);const A=e=>{var n,_,A,b,K,w;let{sessionFrgmt:T,defaultKernelId:N,...L}=e;const I=(0,i.CX)(),{token:E}=p.A.useToken(),D=(0,s.Am)(),R=(0,F.useFragment)(void 0!==r?r:r=l(50029),T),M=(null===R||void 0===R||null===(n=R.kernel_nodes)||void 0===n||null===(_=n.edges)||void 0===_?void 0:_.map((e=>null===e||void 0===e?void 0:e.node)))||[],[V,O]=(0,o.useState)(N||(null===(A=S().find(M,(e=>"main"===(null===e||void 0===e?void 0:e.cluster_role))))||void 0===A?void 0:A.row_id)||(null===(b=M[0])||void 0===b?void 0:b.row_id));(0,o.useEffect)((()=>{!1===L.open&&O(void 0)}),[L.open]);const{data:U,refetch:$,isPending:B,isRefetching:P,dataUpdatedAt:q}=(0,t.nN)({queryKey:["containerLog",null===R||void 0===R?void 0:R.row_id,null===R||void 0===R?void 0:R.access_key,V,L.open],queryFn:async()=>L.open&&null!==R&&void 0!==R&&R.row_id&&null!==R&&void 0!==R&&R.access_key&&V?await I.get_logs(null===R||void 0===R?void 0:R.row_id,null===R||void 0===R?void 0:R.access_key,V,15e3).then((e=>e.result.logs)):"",staleTime:5e3}),[H,{resetPrevious:z}]=function(e,n){let{initialPrev:l}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=(0,o.useRef)(l),[i,s]=(0,o.useState)({}),t=(0,o.useMemo)(e,n),r=(0,o.useMemo)((()=>a.current),[...n,i]);return(0,o.useEffect)((()=>{a.current=t}),n),[{previous:r,current:t},{resetPrevious:()=>{a.current=l,s({})}}]}((()=>(null===U||void 0===U?void 0:U.split("\n").length)||0),[U]),{md:Q}=y.Ay.useBreakpoint(),{t:G}=(0,C.Bd)();return(0,j.jsx)(d.A,{title:(0,j.jsxs)(c.A,{style:{maxWidth:"100%"},gap:"sm",children:[(0,j.jsx)(k.A.Title,{level:4,style:{margin:0,flexShrink:0},children:"Logs"}),R?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(k.A.Text,{style:{fontWeight:"normal"},ellipsis:!0,children:null===R||void 0===R?void 0:R.name}),(0,j.jsxs)(k.A.Text,{style:{fontWeight:"normal",fontFamily:"monospace"},copyable:{text:null===R||void 0===R?void 0:R.row_id,tooltips:G("button.CopySomething",{name:G("session.SessionId")})},children:["(",Q?null===R||void 0===R?void 0:R.row_id:null===R||void 0===R||null===(K=R.row_id.split("-"))||void 0===K?void 0:K[0],")"]})]}):null]}),width:"100%",styles:{header:{width:"100%"},body:{height:"calc(100vh - 100px)",maxHeight:"calc(100vh - 100px)"}},...L,footer:null,destroyOnClose:!0,children:(0,j.jsxs)(c.A,{direction:"column",align:"start",style:{height:"100%"},gap:"sm",children:[(0,j.jsxs)(c.A,{gap:"sm",wrap:"wrap",children:["Kernel Role",(0,j.jsx)(u.A,{value:V,onChange:e=>{O(e),z()},autoSelectOption:!0,options:S().chain(null===R||void 0===R||null===(w=R.kernel_nodes)||void 0===w?void 0:w.edges).sortBy((e=>{var n,l;return`${null===e||void 0===e||null===(n=e.node)||void 0===n?void 0:n.cluster_role} ${null===e||void 0===e||null===(l=e.node)||void 0===l?void 0:l.cluster_idx}`})).map((e=>{var n,l,a,i,s;return{label:(0,j.jsxs)(j.Fragment,{children:[null===e||void 0===e||null===(n=e.node)||void 0===n?void 0:n.cluster_role,"main"!==(null===e||void 0===e||null===(l=e.node)||void 0===l?void 0:l.cluster_role)?null===e||void 0===e||null===(a=e.node)||void 0===a?void 0:a.cluster_idx:"","admin"===D||"superadmin"===D?(0,j.jsxs)(k.A.Text,{style:{fontFamily:"monospace",fontSize:E.fontSizeSM},type:"secondary",children:["(",((null===e||void 0===e||null===(i=e.node)||void 0===i?void 0:i.row_id)||"").substring(0,5),")"]}):null]}),value:null===e||void 0===e||null===(s=e.node)||void 0===s?void 0:s.row_id}})).value()}),(0,j.jsx)(h.A,{type:"vertical"}),(0,j.jsx)(v.A,{title:G("button.Download"),children:(0,j.jsx)(f.Ay,{size:"middle",icon:(0,j.jsx)(x.A,{}),disabled:B||P,onClick:()=>{const e=new Blob([U||""],{type:"text/plain"});(0,a.WN)(e,`${(null===R||void 0===R?void 0:R.name)||"session"}-logs-${V}-${(new Date).toISOString()}.txt`)}})}),(0,j.jsx)(v.A,{title:G("button.Refresh"),children:(0,j.jsx)(f.Ay,{size:"middle",loading:B||P,icon:(0,j.jsx)(m.A,{}),onClick:()=>$()})})]}),(0,j.jsx)("div",{style:{height:"calc(100% - 50px)",alignSelf:"stretch",border:`1px solid ${E.colorBorder}`,overflow:"hidden"},children:(0,j.jsx)(g.jB,{startFollowing:!0,render:e=>{let{follow:n,onScroll:l}=e;return(0,j.jsx)(g.FT,{caseInsensitive:!0,enableSearch:!0,enableSearchNavigation:!0,selectableLines:!0,text:U||"",highlight:H.previous,extraLines:1,follow:n,onScroll:l})}},q)})]})})}},90857:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"uuid"}],n=[{kind:"Variable",name:"id",variableName:"uuid"}],l={alias:null,args:null,kind:"ScalarField",name:"group_id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ConnectedKernelListLegacyQuery",selections:[{alias:"session_for_project_id",args:n,concreteType:"ComputeSession",kind:"LinkedField",name:"compute_session",plural:!1,selections:[l],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ConnectedKernelListLegacyQuery",selections:[{alias:"session_for_project_id",args:n,concreteType:"ComputeSession",kind:"LinkedField",name:"compute_session",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"b8db3f5005362f059f55439e393c1838",id:null,metadata:{},name:"ConnectedKernelListLegacyQuery",operationKind:"query",text:"query ConnectedKernelListLegacyQuery(\n  $uuid: UUID!\n) {\n  session_for_project_id: compute_session(id: $uuid) {\n    group_id\n    id\n  }\n}\n"}}}();a.hash="19ed5dde0fb95d8ff8cfbe9114129348";const i=a},52476:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"project_id"}],n=[{kind:"Variable",name:"id",variableName:"id"},{kind:"Variable",name:"project_id",variableName:"project_id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"row_id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"cluster_role",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"status_info",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"agent_id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"container_id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ConnectedKernelListQuery",selections:[{alias:"session",args:n,concreteType:"ComputeSessionNode",kind:"LinkedField",name:"compute_session_node",plural:!1,selections:[{alias:null,args:null,concreteType:"KernelConnection",kind:"LinkedField",name:"kernel_nodes",plural:!1,selections:[{alias:null,args:null,concreteType:"KernelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"KernelNode",kind:"LinkedField",name:"node",plural:!1,selections:[l,a,i,s,t,o,r],storageKey:null}],storageKey:null},d],storageKey:null},{args:null,kind:"FragmentSpread",name:"ContainerLogModalFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ConnectedKernelListQuery",selections:[{alias:"session",args:n,concreteType:"ComputeSessionNode",kind:"LinkedField",name:"compute_session_node",plural:!1,selections:[{alias:null,args:null,concreteType:"KernelConnection",kind:"LinkedField",name:"kernel_nodes",plural:!1,selections:[{alias:null,args:null,concreteType:"KernelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"KernelNode",kind:"LinkedField",name:"node",plural:!1,selections:[l,a,i,s,t,o,r,{alias:null,args:null,kind:"ScalarField",name:"cluster_idx",storageKey:null}],storageKey:null}],storageKey:null},d],storageKey:null},l,a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null}],storageKey:null}]},params:{cacheID:"2e6cc39dd042b4d260abf65705f92cb5",id:null,metadata:{},name:"ConnectedKernelListQuery",operationKind:"query",text:"query ConnectedKernelListQuery(\n  $id: GlobalIDField!\n  $project_id: UUID!\n) {\n  session: compute_session_node(id: $id, project_id: $project_id) {\n    kernel_nodes {\n      edges {\n        node {\n          id\n          row_id\n          cluster_role\n          status\n          status_info\n          agent_id\n          container_id\n        }\n      }\n      count\n    }\n    ...ContainerLogModalFragment\n    id\n  }\n}\n\nfragment ContainerLogModalFragment on ComputeSessionNode {\n  id\n  row_id\n  name\n  status\n  access_key\n  kernel_nodes {\n    edges {\n      node {\n        id\n        row_id\n        container_id\n        cluster_idx\n        cluster_role\n      }\n    }\n  }\n}\n"}}}();a.hash="d7ddfbcf29d38fad8451d13a176ce279";const i=a},5545:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ContainerCommitModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{kind:"RequiredField",field:{alias:null,args:null,kind:"ScalarField",name:"row_id",storageKey:null},action:"NONE",path:"row_id"}],type:"ComputeSessionNode",abstractKey:null,hash:"8bcd294de1ffd3f00f6ec0ed7177c304"},i=a},50029:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"row_id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ContainerLogModalFragment",selections:[e,{kind:"RequiredField",field:n,action:"NONE",path:"row_id"},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},{alias:null,args:null,concreteType:"KernelConnection",kind:"LinkedField",name:"kernel_nodes",plural:!1,selections:[{alias:null,args:null,concreteType:"KernelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"KernelNode",kind:"LinkedField",name:"node",plural:!1,selections:[e,n,{alias:null,args:null,kind:"ScalarField",name:"container_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cluster_idx",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cluster_role",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ComputeSessionNode",abstractKey:null}}();a.hash="59dda81185d3d874cd635adcae2ae9d4";const i=a},33589:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EditableSessionNameFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"row_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"priority",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"user_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null}],type:"ComputeSessionNode",abstractKey:null,hash:"9c053b92b568a9b132f7615d1869f32b"},i=a},93178:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"input"}],n={alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ModifyComputeSessionPayload",kind:"LinkedField",name:"modify_compute_session",plural:!1,selections:[{alias:null,args:null,concreteType:"ComputeSessionNode",kind:"LinkedField",name:"item",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"EditableSessionNameMutation",selections:[{kind:"CatchField",field:n,to:"RESULT",path:"modify_compute_session"}],type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"EditableSessionNameMutation",selections:[n]},params:{cacheID:"bea4b6405958ab3b9796129b5807d0fa",id:null,metadata:{},name:"EditableSessionNameMutation",operationKind:"mutation",text:"mutation EditableSessionNameMutation(\n  $input: ModifyComputeSessionInput!\n) {\n  modify_compute_session(input: $input) {\n    item {\n      id\n      name\n    }\n  }\n}\n"}}}();a.hash="055a00b906a6c6ab62ad29ea3ebc6e46";const i=a},79825:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SessionActionButtonsFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"RequiredField",field:{alias:null,args:null,kind:"ScalarField",name:"row_id",storageKey:null},action:"NONE",path:"row_id"},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"service_ports",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commit_status",storageKey:null},{args:null,kind:"FragmentSpread",name:"TerminateSessionModalFragment"},{args:null,kind:"FragmentSpread",name:"ContainerLogModalFragment"},{args:null,kind:"FragmentSpread",name:"ContainerCommitModalFragment"}],type:"ComputeSessionNode",abstractKey:null,hash:"691b7c3c1673640d97620822f4fff09f"},i=a},73921:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SessionIdleChecksFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"idle_checks",storageKey:null}],type:"ComputeSession",abstractKey:null,hash:"d2bf721ec94f22eba99980925b3f9656"},i=a},7281:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SessionIdleChecksNodeFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"idle_checks",storageKey:null}],type:"ComputeSessionNode",abstractKey:null,hash:"09a1dd685c8942ebb5c69e6dddaf6da0"},i=a},15934:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SessionTypeTagFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],type:"ComputeSessionNode",abstractKey:null,hash:"6d4ab2b738125ee81d47483324695349"},i=a},13176:(e,n,l)=>{l.d(n,{A:()=>Ge});var a,i,s=l(23441),t=l(50332),o=l(32715),r=l(72375),d=l(7971),u=l(81530),c=l(94132),m=l(8699),g=l(91238),p=l(72338),y=l(49090),k=l(61823),h=l(50128),v=l(82919),f=l(52335),_=l(24798),S=l(46976),x=l.n(S),C=l(33879),F=l(53350),j=l(91788),A=l(22018),b=l(60598);const K={PREPARING:"blue",BUILDING:"blue",PULLING:"blue",PREPARED:"blue",CREATING:"blue",PENDING:"green",SCHEDULED:"green",RUNNING:"green",RESTARTING:"green",RESIZING:"green",SUSPENDED:"green",TERMINATING:"default",TERMINATED:"default",CANCELLED:"default",ERROR:"red"},w=e=>{let{id:n,fetchKey:s}=e;const{t:t}=(0,j.Bd)(),o=(0,u.hd)(),[d,c]=(0,F.useState)(),{session_for_project_id:S}=(0,A.useLazyLoadQuery)(void 0!==a?a:a=l(90857),{uuid:n},{fetchPolicy:"network-only"}),{session:w}=(0,A.useLazyLoadQuery)(void 0!==i?i:i=l(52476),{id:(0,r.wc)("ComputeSessionNode",n),project_id:(null===S||void 0===S?void 0:S.group_id)||o.id},{fetchPolicy:"network-only",fetchKey:s}),T=null===w||void 0===w?void 0:w.kernel_nodes,N=(0,r.LY)([{title:"#",fixed:"left",render:(e,n,l)=>l+1,showSorterTooltip:!1,rowScope:"row"},{title:t("kernel.KernelId"),fixed:"left",dataIndex:"row_id",render:e=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.A.Text,{copyable:!0,ellipsis:!0,children:e}),(0,b.jsx)(v.A,{title:t("session.SeeContainerLogs"),children:(0,b.jsx)(f.Ay,{icon:(0,b.jsx)(C.A,{}),type:"link",onClick:()=>{c(e)}})})]})},{title:t("kernel.Role"),dataIndex:"cluster_role",render:e=>(0,b.jsx)(_.A,{children:e})},{title:t("kernel.Status"),dataIndex:"status",render:(e,n)=>{var l;return(0,b.jsx)(b.Fragment,{children:""!==(null===n||void 0===n?void 0:n.status_info)?(0,b.jsx)(g.A,{values:[{label:e,color:x().get(K,e)},{label:null===n||void 0===n?void 0:n.status_info,color:x().get(K,null!==(l=null===n||void 0===n?void 0:n.status_info)&&void 0!==l?l:"")}]}):(0,b.jsx)(_.A,{color:x().get(K,e),children:e})})}},{title:t("kernel.ContainerId"),dataIndex:"container_id",onCell:()=>({style:{maxWidth:250}}),render:e=>(0,b.jsx)(h.A.Text,{copyable:!0,ellipsis:!0,children:e})},{title:t("kernel.AgentId"),dataIndex:"agent_id",render:e=>(0,b.jsx)(h.A.Text,{copyable:!0,children:e})}]);return(0,b.jsxs)(p.A,{direction:"column",align:"stretch",gap:"sm",children:[(0,b.jsx)(m.A,{bordered:!0,rowKey:"id",scroll:{x:"max-content"},columns:N,dataSource:(0,r.tS)(null===T||void 0===T?void 0:T.edges.map((e=>null===e||void 0===e?void 0:e.node))),style:{width:"100%"},pagination:!1}),(0,b.jsx)(y.A,{children:(0,b.jsx)(k.A,{open:!!d,sessionFrgmt:w||null,defaultKernelId:d,onCancel:()=>{c(void 0)}})})]})};var T,N,L=l(60661),I=l(9571),E=l(67710),D=l(13170),R=l(83978),M=l(96365),V=l(7824);const O=e=>{let{component:n=M.A,sessionFrgmt:a,editable:i,style:s,...t}=e;const o=(0,A.useFragment)(void 0!==T?T:T=l(33589),a),[r,u]=(0,F.useState)(o.name),[c]=(0,d.U6)(),[m,g]=(0,A.useMutation)(void 0!==N?N:N=l(93178)),{t:p}=(0,j.Bd)(),{token:y}=I.A.useToken(),[k,h]=(0,F.useState)(!1),{message:v}=E.A.useApp(),f=!["RESTARTING","PREPARING","PREPARED","CREATING","PULLING"].includes(o.status||""),_=i&&c.uuid===o.user_id&&f;return(0,b.jsxs)(b.Fragment,{children:[(!k||g)&&(0,b.jsx)(n,{editable:!(!_||g)&&{onStart:()=>{h(!0)},triggerType:["icon","text"]},copyable:!0,style:{...s,color:g?y.colorTextTertiary:null===s||void 0===s?void 0:s.color},...t,children:g?r:o.name}),k&&!g&&(0,b.jsx)(D.A,{onFinish:e=>{h(!1),u(e.sessionName),m({variables:{input:{id:o.id,name:e.sessionName}},onCompleted(e,n){if(e.modify_compute_session.ok)document.dispatchEvent(new CustomEvent("backend-ai-session-list-refreshed"));else{var l;var a;if(((null===n||void 0===n||null===(l=n[0])||void 0===l?void 0:l.message)||"").includes("Duplicate session name."))v.error(p("session.launcher.SessionAlreadyExists"));else null!==n&&void 0!==n&&null!==(a=n[0])&&void 0!==a&&a.message&&v.error(p("session.FailToRenameSession"))}},onError(e){v.error(p("session.FailToRenameSession"))}})},initialValues:{sessionName:o.name},style:{flex:1},children:(0,b.jsx)(D.A.Item,{name:"sessionName",rules:(0,L.j)(p),style:{margin:0},children:(0,b.jsx)(R.A,{size:"large",suffix:(0,b.jsx)(V.A,{style:{fontSize:"0.8em",color:y.colorTextTertiary}}),autoFocus:!0,onKeyDown:e=>{"Escape"===e.key&&h(!1)}})})})]})};var U,$,B,P;function q(){return q=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var a in l)({}).hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},q.apply(null,arguments)}function H(e,n){let{title:l,titleId:a,...i}=e;return F.createElement("svg",q({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":a},i),l?F.createElement("title",{id:a},l):null,U||(U=F.createElement("path",{d:"M8.20078 5.99951H6.19967C6.08939 5.99951 6 6.0889 6 6.19918V17.7998C6 17.9101 6.08939 17.9995 6.19967 17.9995H8.20078C8.31105 17.9995 8.40045 17.9101 8.40045 17.7998V6.19918C8.40045 6.0889 8.31105 5.99951 8.20078 5.99951Z",fill:"currentColor"})),$||($=F.createElement("path",{d:"M13.0016 5.99951H11.0004C10.8902 5.99951 10.8008 6.0889 10.8008 6.19918V17.7998C10.8008 17.9101 10.8902 17.9995 11.0004 17.9995H13.0016C13.1118 17.9995 13.2012 17.9101 13.2012 17.7998V6.19918C13.2012 6.0889 13.1118 5.99951 13.0016 5.99951Z",fill:"currentColor"})),B||(B=F.createElement("path",{d:"M17.8004 5.99951H15.7993C15.689 5.99951 15.5996 6.0889 15.5996 6.19918V17.7998C15.5996 17.9101 15.689 17.9995 15.7993 17.9995H17.8004C17.9107 17.9995 18.0001 17.9101 18.0001 17.7998V6.19918C18.0001 6.0889 17.9107 5.99951 17.8004 5.99951Z",fill:"currentColor"})),P||(P=F.createElement("path",{d:"M21.2002 2H2.79978C2.35694 2 2 2.35694 2 2.79978V21.2002C2 21.6431 2.35694 22 2.79978 22H21.2002C21.6431 22 22 21.6419 22 21.2002V2.79978C22 2.35694 21.6419 2 21.2002 2ZM20.2008 20.2008H3.80033V3.80033H20.2008V20.2008Z",fill:"currentColor"})))}const z=F.forwardRef(H);l.p;var Q=l(53090);const G=e=>(0,b.jsx)(Q.A,{component:z,...e});var Z;function W(){return W=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var a in l)({}).hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},W.apply(null,arguments)}function X(e,n){let{title:l,titleId:a,...i}=e;return F.createElement("svg",W({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",ref:n,"aria-labelledby":a},i),l?F.createElement("title",{id:a},l):null,Z||(Z=F.createElement("g",{fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},F.createElement("path",{d:"M15 12H10"}),F.createElement("path",{d:"M15 8H10"}),F.createElement("path",{d:"M19 17V5C19 4.46957 18.7893 3.96086 18.4142 3.58579C18.0391 3.21071 17.5304 3 17 3H4"}),F.createElement("path",{d:"M8 21H20C20.5304 21 21.0391 20.7893 21.4142 20.4142C21.7893 20.0391 22 19.5304 22 19V18C22 17.7348 21.8946 17.4804 21.7071 17.2929C21.5196 17.1054 21.2652 17 21 17H11C10.7348 17 10.4804 17.1054 10.2929 17.2929C10.1054 17.4804 10 17.7348 10 18V19C10 19.5304 9.78929 20.0391 9.41421 20.4142C9.03914 20.7893 8.53043 21 8 21ZM8 21C7.46957 21 6.96086 20.7893 6.58579 20.4142C6.21071 20.0391 6 19.5304 6 19V5C6 4.46957 5.78929 3.96086 5.41421 3.58579C5.03914 3.21071 4.53043 3 4 3C3.46957 3 2.96086 3.21071 2.58579 3.58579C2.21071 3.96086 2 4.46957 2 5V7C2 7.26522 2.10536 7.51957 2.29289 7.70711C2.48043 7.89464 2.73478 8 3 8H6"}))))}const J=F.forwardRef(X),Y=(l.p,e=>(0,b.jsx)(Q.A,{component:J,...e}));var ee,ne;function le(){return le=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var a in l)({}).hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},le.apply(null,arguments)}function ae(e,n){let{title:l,titleId:a,...i}=e;return F.createElement("svg",le({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":a},i),l?F.createElement("title",{id:a},l):null,ee||(ee=F.createElement("path",{d:"M19.7639 16.6396H11.9259C11.7133 16.6396 11.541 16.812 11.541 17.0245V19.0089C11.541 19.2215 11.7133 19.3938 11.9259 19.3938H19.7639C19.9765 19.3938 20.1488 19.2215 20.1488 19.0089V17.0245C20.1488 16.812 19.9765 16.6396 19.7639 16.6396Z",fill:"currentColor"})),ne||(ne=F.createElement("path",{d:"M11.5231 12.122C11.5231 12.122 11.526 12.1161 11.526 12.1132H11.5187C11.5187 12.0035 11.485 11.8937 11.3928 11.8176C11.3928 11.8176 3.52112 5.23958 3.33088 5.08446C3.1421 4.92934 3.04698 4.81666 2.80844 4.87958C2.57576 4.94105 2.586 5.23812 2.586 5.39471C2.586 5.55129 2.58747 7.88982 2.58747 7.88982C2.58747 7.98933 2.63137 8.08299 2.70747 8.14738L7.44014 12.122L2.70747 16.0966C2.63137 16.161 2.58747 16.2547 2.58747 16.3542C2.58747 16.3542 2.586 18.6927 2.586 18.8493C2.586 19.0059 2.57576 19.303 2.80844 19.3644C3.04698 19.4273 3.1421 19.3147 3.33088 19.1595C3.51966 19.0044 11.3928 12.4264 11.3928 12.4264C11.485 12.3488 11.5187 12.2391 11.5187 12.1308H11.526C11.526 12.1308 11.5231 12.1249 11.5231 12.122Z",fill:"currentColor"})))}const ie=F.forwardRef(ae),se=(l.p,e=>(0,b.jsx)(Q.A,{component:ie,...e}));var te,oe;function re(){return re=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var l=arguments[n];for(var a in l)({}).hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},re.apply(null,arguments)}function de(e,n){let{title:l,titleId:a,...i}=e;return F.createElement("svg",re({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":a},i),l?F.createElement("title",{id:a},l):null,te||(te=F.createElement("path",{d:"M21.0504 12.8503C21.0595 9.6413 19.3992 6.81833 16.8899 5.20326C16.7783 5.13238 16.6305 5.21231 16.6305 5.3435V6.82285C16.6305 6.92389 16.6742 7.01889 16.7526 7.08223C16.9321 7.23001 17.104 7.38684 17.2684 7.55423C17.9515 8.24037 18.4913 9.0381 18.8653 9.92631C19.2529 10.8432 19.4504 11.8204 19.4504 12.8277C19.4504 13.835 19.2544 14.8122 18.8653 15.7291C18.4913 16.6173 17.9515 17.415 17.2684 18.1012C16.5852 18.7873 15.7875 19.3242 14.9008 19.6997C13.9839 20.0887 13.0098 20.2848 12.0009 20.2848C10.9921 20.2848 10.0194 20.0872 9.10104 19.6997C8.21584 19.3257 7.41811 18.7858 6.73348 18.1012C6.05036 17.415 5.51049 16.6173 5.13651 15.7291C4.74895 14.8107 4.5499 13.8245 4.5514 12.8277C4.5514 11.8204 4.74895 10.8432 5.13651 9.92631C5.51049 9.03961 6.05337 8.23434 6.73348 7.55423C6.89936 7.38835 7.07278 7.23303 7.24921 7.08223C7.32763 7.01889 7.37136 6.92238 7.37136 6.82285V5.3435C7.37136 5.2108 7.22358 5.12937 7.11199 5.20326C4.61021 6.81531 2.95142 9.62622 2.95142 12.8262C2.95142 17.7966 6.95214 21.832 11.9074 21.8832C16.9426 21.9345 21.0353 17.8916 21.0474 12.8503H21.0504Z",fill:"currentColor",stroke:"currentColor",strokeWidth:.7,strokeMiterlimit:10})),oe||(oe=F.createElement("path",{d:"M12.6253 1.88867H11.3797C11.2465 1.88867 11.1384 1.9967 11.1384 2.12995V11.1599C11.1384 11.2931 11.2465 11.4011 11.3797 11.4011H12.6253C12.7586 11.4011 12.8666 11.2931 12.8666 11.1599V2.12995C12.8666 1.9967 12.7586 1.88867 12.6253 1.88867Z",fill:"currentColor",stroke:"currentColor",strokeWidth:.7,strokeMiterlimit:10})))}const ue=F.forwardRef(de),ce=(l.p,e=>(0,b.jsx)(Q.A,{component:ue,...e}));var me,ge=l(25905),pe=l(9189),ye=l(8227),ke=l(40056);const he=e=>{let{sessionFrgmt:n,onRequestClose:a,...i}=e;const{t:t}=(0,j.Bd)(),o=(0,F.useRef)(null),r=(0,s.CX)(),{upsertNotification:d}=(0,ge.js)(),[u,c]=(0,F.useState)(!1),m=(0,A.useFragment)(void 0!==me?me:me=l(5545),n);return(0,b.jsx)(pe.A,{title:t("session.CommitSession"),onOk:()=>(()=>{var e;c(!0),null===o||void 0===o||null===(e=o.current)||void 0===e||e.validateFields().then((e=>{var n;r.computeSession.convertSessionToImage(null!==(n=null===m||void 0===m?void 0:m.name)&&void 0!==n?n:"",e.imageName).then((e=>{a(),d({key:"commitSession:"+(null===m||void 0===m?void 0:m.name),backgroundTask:{taskId:e.task_id,status:"pending",onChange:{pending:t("session.CommitOnGoing"),resolved:t("session.CommitFinished"),rejected:t("session.CommitFailed")}},duration:0,message:"commitSession: "+(null===m||void 0===m?void 0:m.name),open:!0})})).catch((e=>{throw null!==e&&void 0!==e&&e.message?new Error(e.message):e})).finally((()=>{c(!1)}))})).catch((e=>{console.log(e)}))})(),okButtonProps:{loading:u},onCancel:a,...i,destroyOnClose:!0,children:(0,b.jsxs)(p.A,{direction:"column",gap:"xs",align:"stretch",style:{overflow:"hidden"},children:[(0,b.jsx)(h.A.Text,{children:t("session.DescCommitSession")}),(0,b.jsxs)(ye.A,{bordered:!0,size:"small",column:1,children:[(0,b.jsx)(ye.A.Item,{label:t("session.SessionName"),children:null===m||void 0===m?void 0:m.name}),(0,b.jsx)(ye.A.Item,{label:t("session.SessionId"),children:null===m||void 0===m?void 0:m.row_id})]}),(0,b.jsx)(ke.A,{style:{marginTop:12,marginBottom:12}}),(0,b.jsx)(D.A,{ref:o,children:(0,b.jsx)(D.A.Item,{label:t("session.CommitImageName"),name:"imageName",required:!0,rules:[{required:!0},{min:4,max:32},{pattern:/^[a-zA-Z0-9-_.]+$/,message:t("session.Validation.EnterValidSessionName")}],children:(0,b.jsx)(R.A,{placeholder:t("inputLimit.4to32chars")})})})]})})};var ve,fe=l(26059);const _e=e=>!["TERMINATED","CANCELLED"].includes((null===e||void 0===e?void 0:e.status)||""),Se=e=>{const{t:n}=(0,j.Bd)(),{token:a}=I.A.useToken(),i={runTerminal:e=>{globalThis.appLauncher.runTerminal(e)},showLauncher:e=>{}},t=(0,s.CX)(),o=(0,A.useFragment)(void 0!==ve?ve:ve=l(79825),e.sessionFrgmt),[r,d]=(0,F.useState)(!1),[u,c]=(0,F.useState)(!1),[m,g]=(0,F.useState)(!1);return o&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.A,{title:n("session.ExecuteTerminalApp"),children:(0,b.jsx)(f.Ay,{disabled:!_e(o),icon:(0,b.jsx)(se,{}),onClick:()=>{i.runTerminal(null===o||void 0===o?void 0:o.row_id)}})}),(0,b.jsx)(fe.A,{sessionFrgmts:[o],open:r,onRequestClose:()=>{d(!1)}}),(0,b.jsx)(v.A,{title:n("session.SeeContainerLogs"),children:(0,b.jsx)(f.Ay,{icon:(0,b.jsx)(Y,{}),onClick:()=>{c(!0)}})}),(0,b.jsx)(k.A,{sessionFrgmt:o,open:u,onCancel:()=>{c(!1)}}),(0,b.jsx)(v.A,{title:n("session.RequestContainerCommit"),children:(0,b.jsx)(f.Ay,{disabled:(!t.supports("image-commit")||!t._config.enableContainerCommit)&&"system"!==o.type,icon:(0,b.jsx)(G,{}),onClick:()=>{g(!0)}})}),(0,b.jsx)(he,{sessionFrgmt:o,open:m,onRequestClose:()=>g(!1)}),(0,b.jsx)(v.A,{title:n("session.TerminateSession"),children:(0,b.jsx)(f.Ay,{disabled:!_e(o),icon:(0,b.jsx)(ce,{style:{color:_e(o)?a.colorError:void 0}}),onClick:()=>{d(!0)}})})]})};var xe,Ce,Fe=l(30351);function je(e){let n,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!l){const[n,l]=e;return n<2*l?"red":n<10*l?"orange":"green"}return"and"===l&&x().every(e,(e=>{let[l,a]=e;return l<Math.min(2*a,a+5)?(n="red",!0):l<Math.min(10*a,a+10)?(n="orange",!0):(n="green",!0)})),"or"===l&&x().some(e,(e=>{let[l,a]=e;return l<Math.min(2*a,a+5)?(n="red",!0):l<Math.min(10*a,a+10)?(n="orange",!0):(n="green",!0)})),n}function Ae(e,n){return"remaining"===n?!e.remaining||e.remaining<3600?"red":e.remaining<14400?"orange":"green":e.extra&&(!e.remaining||e.remaining<14400)?je(e.extra.resources,e.extra.thresholds_check_operator):void 0}const be=e=>{let{sessionNodeFrgmt:n=null,sessionFrgmt:a=null,direction:i="row"}=e;const{t:s}=(0,j.Bd)(),{token:t}=I.A.useToken(),{mergedResourceSlots:o}=(0,d.Hv)(),u=(0,A.useFragment)(void 0!==xe?xe:xe=l(7281),n),c=(0,A.useFragment)(void 0!==Ce?Ce:Ce=l(73921),a),m=JSON.parse((null===u||void 0===u?void 0:u.idle_checks)||(null===c||void 0===c?void 0:c.idle_checks)||"{}"),y=e=>s("network_timeout"===e?"session.NetworkIdleTimeout":"session_lifetime"===e?"session.MaxSessionLifetime":"session.UtilizationIdleTimeout");return(0,b.jsx)(p.A,{direction:i,align:"stretch",gap:"sm",children:x().map(m,((e,n)=>{var l,a;return e.remaining?(0,b.jsxs)(p.A,{style:{flex:1},direction:"column",align:"stretch",children:[(0,b.jsxs)(p.A,{gap:"xxs",children:[(0,b.jsx)(h.A.Text,{children:y(n)}),"utilization"===n&&(0,b.jsx)(v.A,{title:(0,b.jsxs)(b.Fragment,{children:[`${s("session.Utilization")} / ${s("session.Threshold")} (%)`,(0,b.jsx)("br",{}),x().map(null===(l=e.extra)||void 0===l?void 0:l.resources,((e,n)=>{var l;const a=["cpu_util","mem"].includes(n)?x().split(n,"_")[0]:x().split(n,"_")[0]+".device",[i,s]=e;return(0,b.jsxs)(p.A,{gap:"xs",children:[(0,b.jsx)(h.A.Text,{style:{color:t.colorWhite},children:`${null===o||void 0===o||null===(l=o[a])||void 0===l?void 0:l.human_readable_name}:`}),(0,b.jsx)(h.A.Text,{style:{color:je(e)},children:`${i>=0?(0,r.Z1)(i,1):"-"} / ${s}`}),(0,b.jsx)("br",{})]},n)}))]}),children:(0,b.jsx)(Fe.A,{style:{color:t.colorTextSecondary,cursor:"pointer"}})})]}),e.remaining>=0?(0,b.jsx)(g.A,{values:[{label:(a=e.remaining_time_type,s("expire_after"===a?"session.ExpiresAfter":"session.GracePeriod")),color:Ae(e,"utilization"===n?"utilization":"remaining")},{label:(0,r.bB)((new Date).toISOString(),new Date((new Date).getTime()+1e3*(e.remaining||0)).toISOString()),color:Ae(e,"utilization"===n?"utilization":"remaining")}]}):(0,b.jsx)(h.A.Text,{type:"danger",children:s("session.TimeoutExceeded")})]},n):null}))})};var Ke,we=l(61207),Te=l(5415);const Ne={INTERACTIVE:"green",BATCH:"darkgreen",INFERENCE:"blue"},Le=e=>{let{sessionFrgmt:n}=e;const a=(0,A.useFragment)(void 0!==Ke?Ke:Ke=l(15934),n);return(0,b.jsx)(_.A,{color:x().get(Ne,x().toUpper(a.type||"")),children:x().toUpper(a.type||"")})};var Ie=l(75863);const Ee=e=>{let{...n}=e;const{t:l}=(0,j.Bd)(),{token:a}=I.A.useToken();return(0,b.jsxs)(pe.A,{title:l("session.IdleChecks"),footer:null,width:700,...n,children:[(0,b.jsx)(h.A.Text,{children:l("session.IdleChecksDesc")}),(0,b.jsx)(h.A.Title,{level:5,children:l("session.MaxSessionLifetime")}),(0,b.jsx)("p",{children:l("session.MaxSessionLifetimeDesc")}),(0,b.jsx)(h.A.Title,{level:5,children:l("session.NetworkIdleTimeout")}),(0,b.jsx)("p",{children:l("session.NetworkIdleTimeoutDesc")}),(0,b.jsx)(h.A.Title,{level:5,children:l("session.UtilizationIdleTimeout")}),(0,b.jsx)("p",{children:l("session.UtilizationIdleTimeoutDesc")}),(0,b.jsxs)(p.A,{direction:"column",align:"stretch",style:{marginLeft:a.marginMD},children:[(0,b.jsx)(h.A.Title,{level:5,style:{margin:0},children:l("session.GracePeriod")}),(0,b.jsx)("p",{children:l("session.GracePeriodDesc")}),(0,b.jsx)(h.A.Title,{level:5,style:{margin:0},children:l("session.UtilizationThreshold")}),(0,b.jsx)("p",{children:l("session.UtilizationThresholdDesc")})]})]})};var De,Re,Me=l(90184),Ve=l(95950),Oe=l(2759),Ue=l(38639),$e=l(9769),Be=l(58325),Pe=l(91867),qe=l(9542);const He=e=>{var n;let{id:a,fetchKey:i}=e;const{t:t}=(0,j.Bd)(),{token:m}=I.A.useToken(),{md:g}=$e.Ay.useBreakpoint(),{open:y}=(0,Ie.useFolderExplorerOpener)(),k=(0,u.hd)(),S=(0,d.Am)(),C=(0,s.CX)(),[K,T]=(0,F.useState)(!1),{session_for_project_id:N}=(0,A.useLazyLoadQuery)(void 0!==De?De:De=l(66427),{uuid:a},{fetchPolicy:"network-only"}),{session:L,legacy_session:E}=(0,A.useLazyLoadQuery)(void 0!==Re?Re:Re=l(4078),{id:(0,r.wc)("ComputeSessionNode",a),uuid:a,project_id:(null===N||void 0===N?void 0:N.group_id)||k.id},{fetchPolicy:"network-only",fetchKey:i}),D=(null===E||void 0===E?void 0:E.image)&&(null===E||void 0===E?void 0:E.architecture)&&E.image+"@"+E.architecture,R=JSON.parse((null===L||void 0===L?void 0:L.idle_checks)||(null===E||void 0===E?void 0:E.idle_checks)||"{}"),M=x().min(x().values(R).map((e=>e.remaining)).filter(Boolean)),V=C._config.showKernelList;return L?(0,b.jsxs)(p.A,{direction:"column",gap:"lg",align:"stretch",children:[(null===N||void 0===N?void 0:N.group_id)!==k.id&&(0,b.jsx)(Be.A,{message:t("session.NotInProject"),type:"warning",showIcon:!0}),M&&M<3600&&(0,b.jsx)(Be.A,{message:t("session.IdleCheckExpirationWarning"),type:"warning",showIcon:!0}),(0,b.jsxs)(p.A,{direction:"column",gap:"sm",align:"stretch",children:[(0,b.jsxs)(p.A,{direction:"row",justify:"between",align:"start",style:{alignSelf:"stretch"},gap:"sm",children:[(0,b.jsx)(O,{sessionFrgmt:L,component:qe.A,level:3,style:{margin:0,color:["TERMINATED","CANCELLED"].includes(L.status||"")?m.colorTextTertiary:void 0},editable:!["TERMINATED","CANCELLED"].includes(L.status||"")}),(0,b.jsx)(f.Ay.Group,{size:"large",children:(0,b.jsx)(Se,{sessionFrgmt:L})})]}),(0,b.jsxs)(ye.A,{bordered:!0,column:g?2:1,children:[(0,b.jsx)(ye.A.Item,{label:t("session.SessionId"),span:g?2:1,children:(0,b.jsx)(h.A.Text,{ellipsis:!0,copyable:!0,style:{fontFamily:"monospace"},children:L.row_id})}),("admin"===S||"superadmin"===S)&&(0,b.jsx)(ye.A.Item,{label:t("credential.UserID"),span:g?2:1,children:null===E||void 0===E?void 0:E.user_email}),(0,b.jsx)(ye.A.Item,{label:t("session.Status"),contentStyle:{display:"flex",gap:m.marginSM},children:(0,b.jsx)(Te.A,{sessionFrgmt:L,showInfo:!0})}),(0,b.jsx)(ye.A.Item,{label:t("session.SessionType"),children:(0,b.jsx)(Le,{sessionFrgmt:L})}),(0,b.jsx)(ye.A.Item,{label:t("session.launcher.Environments"),children:D?(0,b.jsxs)(p.A,{gap:["xs",0],wrap:"wrap",children:[(0,b.jsx)(Me.A,{image:D,style:{marginRight:m.marginXS}}),(0,b.jsx)(o.Ay,{image:D})]}):"-"}),(0,b.jsx)(ye.A.Item,{label:t("session.launcher.MountedFolders"),children:C.supports("vfolder-mounts")?x().map(x().zip(null===E||void 0===E?void 0:E.mounts,null===L||void 0===L?void 0:L.vfolder_mounts),(e=>{const[n,l]=e;return(0,b.jsx)(f.Ay,{type:"link",size:"small",icon:(0,b.jsx)(Oe.A,{}),onClick:()=>{y(null!==l&&void 0!==l?l:"")},children:n},l)})):null===E||void 0===E||null===(n=E.mounts)||void 0===n?void 0:n.join(", ")}),(0,b.jsx)(ye.A.Item,{label:t("session.launcher.ResourceAllocation"),children:(0,b.jsxs)(p.A,{gap:"sm",wrap:"wrap",children:[(0,b.jsx)(v.A,{title:t("session.ResourceGroup"),children:(0,b.jsx)(_.A,{children:L.scaling_group})}),(0,b.jsx)(c.ResourceNumbersOfSession,{resource:JSON.parse(L.requested_slots||"{}")})]})}),(0,b.jsx)(ye.A.Item,{label:t("session.Agent"),children:L.agent_ids||"-"}),(0,b.jsx)(ye.A.Item,{label:t("session.Reservation"),span:g?2:1,children:(0,b.jsx)(p.A,{gap:"xs",wrap:"wrap",children:(0,b.jsx)(we.A,{sessionFrgmt:L})})}),C.supports("idle-checks-gql")&&"RUNNING"===L.status&&M?(0,b.jsx)(ye.A.Item,{label:(0,b.jsxs)(p.A,{gap:"xxs",children:[t("session.IdleChecks"),(0,b.jsx)(v.A,{title:t("button.ClickForMoreDetails"),children:(0,b.jsx)(Ue.A,{style:{cursor:"pointer"},onClick:()=>T(!0)})})]}),span:g?2:1,children:(0,b.jsx)(be,{sessionNodeFrgmt:L,sessionFrgmt:E,direction:g?"row":"column"})}):null,(0,b.jsx)(ye.A.Item,{label:"Resource Usage",span:g?2:1,children:(0,b.jsx)(Ve.A,{sessionFrgmt:L})})]})]}),V?(0,b.jsx)(F.Suspense,{fallback:(0,b.jsx)(Pe.A,{}),children:(0,b.jsxs)(p.A,{direction:"column",gap:"sm",align:"stretch",children:[(0,b.jsx)(h.A.Title,{level:4,style:{margin:0},children:t("kernel.Kernels")}),(0,b.jsx)(w,{id:a,fetchKey:i})]})}):null,(0,b.jsx)(Ee,{open:K,onCancel:()=>T(!1)})]}):(0,b.jsx)(Be.A,{showIcon:!0,message:t("session.SessionNotFound"),type:"error",description:a})};var ze=l(43622),Qe=l(43710);const Ge=e=>{let{sessionId:n,...l}=e;const{t:a}=(0,j.Bd)();(0,s.CX)();const[i,o]=(0,F.useTransition)(),[r,d]=(0,s.Tw)("first");return(0,t.$)((()=>{o((()=>{d()}))}),7e3),(0,b.jsx)(Qe.A,{title:a("session.SessionInfo"),width:800,keyboard:!1,...l,open:!!n,onClose:e=>{var n;null===(n=l.onClose)||void 0===n||n.call(l,e)},extra:(0,b.jsx)(v.A,{title:a("button.Refresh"),children:(0,b.jsx)(f.Ay,{loading:i,icon:(0,b.jsx)(ze.A,{}),onClick:()=>{o((()=>{d()}))}})}),children:(0,b.jsx)(F.Suspense,{fallback:(0,b.jsx)(Pe.A,{}),children:n&&(0,b.jsx)(He,{id:n,fetchKey:r})})})}},49090:(e,n,l)=>{l.d(n,{A:()=>i});var a=l(53350);const i=e=>{let{children:n}=e;const l=a.Children.only(n),i=l.props.open,[s,t]=(0,a.useState)(i);if((0,a.useLayoutEffect)((()=>{i&&t(!0)}),[i]),!s)return null;const o=l.props.afterClose;return a.cloneElement(l,{afterClose:function(){o&&o(...arguments),t(!1)}})}},66427:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"uuid"}],n=[{kind:"Variable",name:"id",variableName:"uuid"}],l={alias:null,args:null,kind:"ScalarField",name:"group_id",storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"SessionDetailContentLegacyQuery",selections:[{alias:"session_for_project_id",args:n,concreteType:"ComputeSession",kind:"LinkedField",name:"compute_session",plural:!1,selections:[l],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"SessionDetailContentLegacyQuery",selections:[{alias:"session_for_project_id",args:n,concreteType:"ComputeSession",kind:"LinkedField",name:"compute_session",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"1c0255a2836eb7e492954c7ab0212c7f",id:null,metadata:{},name:"SessionDetailContentLegacyQuery",operationKind:"query",text:"query SessionDetailContentLegacyQuery(\n  $uuid: UUID!\n) {\n  session_for_project_id: compute_session(id: $uuid) {\n    group_id\n    id\n  }\n}\n"}}}();a.hash="d6a0dfbccdec8393f1a058dab48a0757";const i=a},4078:(e,n,l)=>{l.r(n),l.d(n,{default:()=>i});const a=function(){var e={defaultValue:null,kind:"LocalArgument",name:"id"},n={defaultValue:null,kind:"LocalArgument",name:"project_id"},l={defaultValue:null,kind:"LocalArgument",name:"uuid"},a=[{kind:"Variable",name:"id",variableName:"id"},{kind:"Variable",name:"project_id",variableName:"project_id"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"row_id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"project_id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"user_id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"resource_opts",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"vfolder_mounts",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"terminated_at",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"scaling_group",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"agent_ids",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"requested_slots",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"idle_checks",storageKey:null},v=[{kind:"Variable",name:"id",variableName:"uuid"}],f={alias:null,args:null,kind:"ScalarField",name:"image",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"mounts",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"user_email",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null};return{fragment:{argumentDefinitions:[e,n,l],kind:"Fragment",metadata:null,name:"SessionDetailContentQuery",selections:[{alias:"session",args:a,concreteType:"ComputeSessionNode",kind:"LinkedField",name:"compute_session_node",plural:!1,selections:[i,s,t,o,r,d,u,c,{kind:"RequiredField",field:m,action:"NONE",path:"session.created_at"},g,p,y,k,h,{args:null,kind:"FragmentSpread",name:"SessionStatusTagFragment"},{args:null,kind:"FragmentSpread",name:"SessionActionButtonsFragment"},{args:null,kind:"FragmentSpread",name:"SessionTypeTagFragment"},{args:null,kind:"FragmentSpread",name:"EditableSessionNameFragment"},{args:null,kind:"FragmentSpread",name:"SessionReservationFragment"},{args:null,kind:"FragmentSpread",name:"ContainerLogModalFragment"},{args:null,kind:"FragmentSpread",name:"SessionUsageMonitorFragment"},{args:null,kind:"FragmentSpread",name:"ContainerCommitModalFragment"},{args:null,kind:"FragmentSpread",name:"SessionIdleChecksNodeFragment"}],storageKey:null},{alias:"legacy_session",args:v,concreteType:"ComputeSession",kind:"LinkedField",name:"compute_session",plural:!1,selections:[f,_,S,x,h,{args:null,kind:"FragmentSpread",name:"SessionIdleChecksFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,l,n],kind:"Operation",name:"SessionDetailContentQuery",selections:[{alias:"session",args:a,concreteType:"ComputeSessionNode",kind:"LinkedField",name:"compute_session_node",plural:!1,selections:[i,s,t,o,r,d,u,c,m,g,p,y,k,h,{alias:null,args:null,kind:"ScalarField",name:"status_info",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"access_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"service_ports",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commit_status",storageKey:null},{alias:null,args:null,concreteType:"KernelConnection",kind:"LinkedField",name:"kernel_nodes",plural:!1,selections:[{alias:null,args:null,concreteType:"KernelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"KernelNode",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"container_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"agent_id",storageKey:null},i,s,{alias:null,args:null,kind:"ScalarField",name:"cluster_idx",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cluster_role",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"live_stat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"occupied_slots",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"priority",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"starts_at",storageKey:null}],storageKey:null},{alias:"legacy_session",args:v,concreteType:"ComputeSession",kind:"LinkedField",name:"compute_session",plural:!1,selections:[f,_,S,x,h,i],storageKey:null}]},params:{cacheID:"e0308612a16a49c1d3f8af5b039313ca",id:null,metadata:{},name:"SessionDetailContentQuery",operationKind:"query",text:'query SessionDetailContentQuery(\n  $id: GlobalIDField!\n  $uuid: UUID!\n  $project_id: UUID!\n) {\n  session: compute_session_node(id: $id, project_id: $project_id) {\n    id\n    row_id\n    name\n    project_id\n    user_id\n    resource_opts\n    status\n    vfolder_mounts\n    created_at\n    terminated_at\n    scaling_group\n    agent_ids\n    requested_slots\n    idle_checks @since(version: "24.12.0")\n    ...SessionStatusTagFragment\n    ...SessionActionButtonsFragment\n    ...SessionTypeTagFragment\n    ...EditableSessionNameFragment\n    ...SessionReservationFragment\n    ...ContainerLogModalFragment\n    ...SessionUsageMonitorFragment\n    ...ContainerCommitModalFragment\n    ...SessionIdleChecksNodeFragment\n  }\n  legacy_session: compute_session(id: $uuid) {\n    image\n    mounts\n    user_email\n    architecture\n    idle_checks @since(version: "24.09.0")\n    ...SessionIdleChecksFragment\n    id\n  }\n}\n\nfragment ContainerCommitModalFragment on ComputeSessionNode {\n  id\n  name\n  row_id\n}\n\nfragment ContainerLogModalFragment on ComputeSessionNode {\n  id\n  row_id\n  name\n  status\n  access_key\n  kernel_nodes {\n    edges {\n      node {\n        id\n        row_id\n        container_id\n        cluster_idx\n        cluster_role\n      }\n    }\n  }\n}\n\nfragment EditableSessionNameFragment on ComputeSessionNode {\n  id\n  row_id\n  name\n  priority\n  user_id\n  status\n}\n\nfragment SessionActionButtonsFragment on ComputeSessionNode {\n  id\n  row_id\n  type\n  status\n  access_key\n  service_ports\n  commit_status\n  ...TerminateSessionModalFragment\n  ...ContainerLogModalFragment\n  ...ContainerCommitModalFragment\n}\n\nfragment SessionIdleChecksFragment on ComputeSession {\n  id\n  idle_checks @since(version: "24.09.0")\n}\n\nfragment SessionIdleChecksNodeFragment on ComputeSessionNode {\n  id\n  idle_checks @since(version: "24.12.0")\n}\n\nfragment SessionReservationFragment on ComputeSessionNode {\n  id\n  created_at\n  starts_at\n  terminated_at\n}\n\nfragment SessionStatusTagFragment on ComputeSessionNode {\n  id\n  name\n  status\n  status_info\n}\n\nfragment SessionTypeTagFragment on ComputeSessionNode {\n  type\n}\n\nfragment SessionUsageMonitorFragment on ComputeSessionNode {\n  kernel_nodes {\n    edges {\n      node {\n        live_stat\n        occupied_slots\n        id\n      }\n    }\n  }\n}\n\nfragment TerminateSessionModalFragment on ComputeSessionNode {\n  id\n  row_id\n  name\n  scaling_group\n  kernel_nodes {\n    edges {\n      node {\n        container_id\n        agent_id\n        id\n      }\n    }\n  }\n}\n'}}}();a.hash="93950b0e90c5428c5cac947b9590f657";const i=a},17898:(e,n,l)=>{l.d(n,{RM:()=>o,WN:()=>t});var a=l(46976),i=l.n(a);function s(e){return null===e||void 0===e?"":"number"===typeof e||"boolean"===typeof e?String(e):`"${(e=i().isString(e)?e:JSON.stringify(e)).replace(/"/g,'""')}"`}const t=(e,n)=>{const l=URL.createObjectURL(e),a=document.createElement("a");a.href=l,a.download=n,a.click(),URL.revokeObjectURL(l)},o=(e,n,l)=>{const a=((e,n)=>{const l=i().map(e,(e=>i().omit(e,"__fragments","__fragmentOwner","__id"))),a=i().keys(l[0]),t=i().map(l,(e=>i().map(e,((e,l)=>{var a;return null!==n&&void 0!==n&&n[l]&&(null===(a=n[l])||void 0===a?void 0:a.call(n,e))||e})))).map((e=>e.map(s).join(","))).join("\n");return[a.map(s).join(","),t].join("\n")})(e,l),o=new Blob([a],{type:"text/csv"});t(o,`${n}.csv`)}}}]);
//# sourceMappingURL=3176.de481277.chunk.js.map