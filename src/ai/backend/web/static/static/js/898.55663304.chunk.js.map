{"version":3,"file":"static/js/898.55663304.chunk.js","mappings":"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","sources":["../node_modules/@ant-design/icons-svg/es/asn/WarningTwoTone.js","../node_modules/@ant-design/icons/es/icons/WarningTwoTone.js","components/ResetPasswordRequired.tsx"],"sourcesContent":["// This icon file is generated automatically.\nvar WarningTwoTone = { \"icon\": function render(primaryColor, secondaryColor) { return { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M955.7 856l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z\", \"fill\": primaryColor } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M172.2 828.1h679.6L512 239.9 172.2 828.1zM560 720a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm-16-304v184c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V416c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8z\", \"fill\": secondaryColor } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8z\", \"fill\": primaryColor } }] }; }, \"name\": \"warning\", \"theme\": \"twotone\" };\nexport default WarningTwoTone;\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport WarningTwoToneSvg from \"@ant-design/icons-svg/es/asn/WarningTwoTone\";\nimport AntdIcon from \"../components/AntdIcon\";\nvar WarningTwoTone = function WarningTwoTone(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n    ref: ref,\n    icon: WarningTwoToneSvg\n  }));\n};\nif (process.env.NODE_ENV !== 'production') {\n  WarningTwoTone.displayName = 'WarningTwoTone';\n}\nexport default /*#__PURE__*/React.forwardRef(WarningTwoTone);","import { Button, Form, Modal, Typography, Input, theme } from \"antd\";\nimport { useWebComponentInfo } from \"./DefaultProviders\";\nimport Flex from \"./Flex\";\nimport { useTranslation } from \"react-i18next\";\nimport { WarningTwoTone } from \"@ant-design/icons\";\nimport { useMutation as useTanMutation } from \"react-query\";\nimport { useAnonymousBackendaiClient } from \"../hooks\";\nimport { baiSignedRequestWithPromise } from \"../helper\";\nimport { useEffect } from \"react\";\n\n// src/components/backend-ai-common-utils.ts\nexport const passwordPattern = /^(?=.*\\d)(?=.*[a-zA-Z])(?=.*[_\\W]).{8,}$/;\n\nconst ResetPasswordRequired = () => {\n  const { value, dispatchEvent } = useWebComponentInfo();\n  let parsedValue: {\n    open: boolean;\n    currentPassword: string;\n    username: string;\n    api_endpoint: string;\n  };\n  try {\n    parsedValue = JSON.parse(value || \"\");\n  } catch (error) {\n    parsedValue = {\n      open: false,\n      currentPassword: \"\",\n      username: \"\",\n      api_endpoint: \"\",\n    };\n  }\n  const { open, currentPassword, username, api_endpoint } = parsedValue;\n\n  const { token } = theme.useToken();\n  const [form] = Form.useForm<{\n    newPassword: string;\n    confirm: string;\n  }>();\n  const { t } = useTranslation();\n\n  useEffect(() => {\n    if (open) {\n      form.resetFields();\n    }\n  }, [open, form]);\n\n  const anonymousBaiClient = useAnonymousBackendaiClient({ api_endpoint });\n\n  const mutation = useTanMutation({\n    mutationFn: (body: {\n      username: string;\n      current_password: string;\n      new_password: string;\n    }) => {\n      return baiSignedRequestWithPromise({\n        method: \"POST\",\n        url: \"/server/update-password-no-auth\",\n        body,\n        client: anonymousBaiClient,\n      });\n    },\n  });\n\n  const onSubmit = () => {\n    form.validateFields().then((values) => {\n      mutation.mutate(\n        {\n          username: username,\n          current_password: currentPassword,\n          new_password: values.newPassword,\n        },\n        {\n          onSuccess(data, variables, context) {\n            dispatchEvent(\"ok\", null);\n          },\n          onError(error, variables, context) {},\n        }\n      );\n    });\n  };\n\n  return (\n    <Modal\n      open={open}\n      centered\n      mask={false}\n      onCancel={() => {\n        dispatchEvent(\"cancel\", null);\n      }}\n      keyboard={false}\n      maskClosable={false}\n      footer={null}\n      width={450}\n      destroyOnClose={true}\n      forceRender\n    >\n      <Flex\n        direction=\"column\"\n        justify=\"start\"\n        align=\"stretch\"\n        gap={\"md\"}\n        style={{\n          alignSelf: \"stretch\",\n          paddingTop: token.paddingMD,\n          paddingBottom: token.paddingMD,\n        }}\n      >\n        <Typography.Title level={3} style={{ margin: 0 }}>\n          <WarningTwoTone twoToneColor={token.colorWarning} />{\" \"}\n          {t(\"webui.menu.PleaseChangeYourPassword\")}\n        </Typography.Title>\n        {t(\"webui.menu.YouMushChangeYourPassword\")}\n        <Form\n          form={form}\n          layout=\"vertical\"\n          initialValues={{\n            currentPassword: currentPassword,\n          }}\n          disabled={mutation.isLoading}\n        >\n          <Form.Item\n            name=\"newPassword\"\n            label={t(\"webui.menu.NewPassword\")}\n            rules={[\n              {\n                required: true,\n              },\n              {\n                pattern: passwordPattern,\n                message: t(\"webui.menu.InvalidPasswordMessage\").toString(),\n              },\n              () => ({\n                validator(_, value) {\n                  if (currentPassword === value) {\n                    return Promise.reject(\n                      new Error(\n                        t(\"webui.menu.NewPasswordCannotBeSame\").toString()\n                      )\n                    );\n                  }\n                  return Promise.resolve();\n                },\n              }),\n            ]}\n            hasFeedback\n          >\n            <Input.Password />\n          </Form.Item>\n\n          <Form.Item\n            name=\"confirm\"\n            label={t(\"webui.menu.NewPasswordAgain\")}\n            dependencies={[\"newPassword\"]}\n            hasFeedback\n            rules={[\n              {\n                required: true,\n              },\n              ({ getFieldValue }) => ({\n                validator(_, value) {\n                  if (!value || getFieldValue(\"newPassword\") === value) {\n                    return Promise.resolve();\n                  }\n                  return Promise.reject(\n                    new Error(t(\"environment.PasswordsDoNotMatch\").toString())\n                  );\n                },\n              }),\n            ]}\n          >\n            <Input.Password onPressEnter={onSubmit} />\n          </Form.Item>\n        </Form>\n        <Button type=\"primary\" onClick={onSubmit} loading={mutation.isLoading}>\n          {t(\"webui.menu.Update\")}\n        </Button>\n      </Flex>\n    </Modal>\n  );\n};\n\nexport default ResetPasswordRequired;\n"],"names":["primaryColor","secondaryColor","WarningTwoTone","props","ref","React","AntdIcon","_extends","icon","WarningTwoToneSvg","passwordPattern","parsedValue","_useWebComponentInfo","useWebComponentInfo","value","dispatchEvent","JSON","parse","error","open","currentPassword","username","api_endpoint","_parsedValue","token","theme","_Form$useForm","Form","form","_slicedToArray","t","useTranslation","useEffect","resetFields","anonymousBaiClient","useAnonymousBackendaiClient","mutation","useTanMutation","mutationFn","body","baiSignedRequestWithPromise","method","url","client","onSubmit","validateFields","then","values","mutate","current_password","new_password","newPassword","onSuccess","data","variables","context","onError","_jsx","Modal","centered","mask","onCancel","keyboard","maskClosable","footer","width","destroyOnClose","forceRender","children","_jsxs","Flex","direction","justify","align","gap","style","alignSelf","paddingTop","paddingMD","paddingBottom","Typography","level","margin","twoToneColor","colorWarning","layout","initialValues","disabled","isLoading","name","label","rules","required","pattern","message","toString","validator","_","Promise","reject","Error","resolve","hasFeedback","Input","dependencies","_ref","getFieldValue","onPressEnter","Button","type","onClick","loading"],"sourceRoot":""}