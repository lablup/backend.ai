{"version":3,"file":"static/js/807.5614154e.chunk.js","mappings":"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","sources":["components/ResetPasswordRequired.tsx","components/UserProfileSettingModal.tsx","../node_modules/@ant-design/icons-svg/es/asn/WarningTwoTone.js","../node_modules/@ant-design/icons/es/icons/WarningTwoTone.js"],"sourcesContent":["import { baiSignedRequestWithPromise } from '../helper';\nimport { useAnonymousBackendaiClient } from '../hooks';\nimport { useTanMutation } from '../hooks/reactQueryAlias';\nimport { useWebComponentInfo } from './DefaultProviders';\nimport Flex from './Flex';\nimport { WarningTwoTone } from '@ant-design/icons';\nimport { Button, Form, Modal, Typography, Input, theme } from 'antd';\nimport { useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\n\n// src/components/backend-ai-common-utils.ts\nexport const passwordPattern = /^(?=.*\\d)(?=.*[a-zA-Z])(?=.*[_\\W]).{8,}$/;\n\nconst ResetPasswordRequired = () => {\n  const { value, dispatchEvent } = useWebComponentInfo();\n  let parsedValue: {\n    open: boolean;\n    currentPassword: string;\n    username: string;\n    api_endpoint: string;\n  };\n  try {\n    parsedValue = JSON.parse(value || '');\n  } catch (error) {\n    parsedValue = {\n      open: false,\n      currentPassword: '',\n      username: '',\n      api_endpoint: '',\n    };\n  }\n  const { open, currentPassword, username, api_endpoint } = parsedValue;\n\n  const { token } = theme.useToken();\n  const [form] = Form.useForm<{\n    newPassword: string;\n    confirm: string;\n  }>();\n  const { t } = useTranslation();\n\n  useEffect(() => {\n    if (open) {\n      form.resetFields();\n    }\n  }, [open, form]);\n\n  const anonymousBaiClient = useAnonymousBackendaiClient({ api_endpoint });\n\n  const mutation = useTanMutation({\n    mutationFn: (body: {\n      username: string;\n      current_password: string;\n      new_password: string;\n    }) => {\n      return baiSignedRequestWithPromise({\n        method: 'POST',\n        url: '/server/update-password-no-auth',\n        body,\n        client: anonymousBaiClient,\n      });\n    },\n  });\n\n  const onSubmit = () => {\n    form.validateFields().then((values) => {\n      mutation.mutate(\n        {\n          username: username,\n          current_password: currentPassword,\n          new_password: values.newPassword,\n        },\n        {\n          onSuccess(data, variables, context) {\n            dispatchEvent('ok', null);\n          },\n          onError(error, variables, context) {},\n        },\n      );\n    });\n  };\n\n  return (\n    <Modal\n      open={open}\n      centered\n      mask={false}\n      onCancel={() => {\n        dispatchEvent('cancel', null);\n      }}\n      keyboard={false}\n      maskClosable={false}\n      footer={null}\n      width={450}\n      destroyOnClose={true}\n      forceRender\n    >\n      <Flex\n        direction=\"column\"\n        justify=\"start\"\n        align=\"stretch\"\n        gap={'md'}\n        style={{\n          alignSelf: 'stretch',\n          paddingTop: token.paddingMD,\n          paddingBottom: token.paddingMD,\n        }}\n      >\n        <Typography.Title level={3} style={{ margin: 0 }}>\n          <WarningTwoTone twoToneColor={token.colorWarning} />{' '}\n          {t('webui.menu.PleaseChangeYourPassword')}\n        </Typography.Title>\n        {t('webui.menu.YouMushChangeYourPassword')}\n        <Form\n          form={form}\n          layout=\"vertical\"\n          initialValues={{\n            currentPassword: currentPassword,\n          }}\n          disabled={mutation.isLoading}\n        >\n          <Form.Item\n            name=\"newPassword\"\n            label={t('webui.menu.NewPassword')}\n            rules={[\n              {\n                required: true,\n              },\n              {\n                pattern: passwordPattern,\n                message: t('webui.menu.InvalidPasswordMessage').toString(),\n              },\n              () => ({\n                validator(_, value) {\n                  if (currentPassword === value) {\n                    return Promise.reject(\n                      new Error(\n                        t('webui.menu.NewPasswordCannotBeSame').toString(),\n                      ),\n                    );\n                  }\n                  return Promise.resolve();\n                },\n              }),\n            ]}\n            hasFeedback\n          >\n            <Input.Password />\n          </Form.Item>\n\n          <Form.Item\n            name=\"confirm\"\n            label={t('webui.menu.NewPasswordAgain')}\n            dependencies={['newPassword']}\n            hasFeedback\n            rules={[\n              {\n                required: true,\n              },\n              ({ getFieldValue }) => ({\n                validator(_, value) {\n                  if (!value || getFieldValue('newPassword') === value) {\n                    return Promise.resolve();\n                  }\n                  return Promise.reject(\n                    new Error(t('environment.PasswordsDoNotMatch').toString()),\n                  );\n                },\n              }),\n            ]}\n          >\n            <Input.Password onPressEnter={onSubmit} />\n          </Form.Item>\n        </Form>\n        <Button type=\"primary\" onClick={onSubmit} loading={mutation.isLoading}>\n          {t('webui.menu.Update')}\n        </Button>\n      </Flex>\n    </Modal>\n  );\n};\n\nexport default ResetPasswordRequired;\n","/**\n @license\n Copyright (c) 2015-2024 Lablup Inc. All rights reserved.\n */\nimport { useSuspendedBackendaiClient } from '../hooks';\nimport { useCurrentUserInfo } from '../hooks/backendai';\nimport { useTanMutation } from '../hooks/reactQueryAlias';\nimport BAIModal from './BAIModal';\nimport { passwordPattern } from './ResetPasswordRequired';\nimport TOTPActivateModal from './TOTPActivateModal';\nimport { UserProfileQuery } from './UserProfileSettingModalQuery';\n// @ts-ignore\nimport { UserProfileSettingModalQuery } from './__generated__/UserProfileSettingModalQuery.graphql';\nimport { ExclamationCircleFilled, LoadingOutlined } from '@ant-design/icons';\nimport { useToggle } from 'ahooks';\nimport {\n  Modal,\n  ModalProps,\n  Input,\n  Form,\n  message,\n  Switch,\n  Spin,\n  FormInstance,\n} from 'antd';\nimport React, { useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PreloadedQuery, usePreloadedQuery } from 'react-relay';\n\ninterface Props extends ModalProps {\n  queryRef: PreloadedQuery<UserProfileSettingModalQuery>;\n  onRequestClose: (success?: boolean) => void;\n  onRequestRefresh: () => void;\n  totpSupported?: boolean;\n  isRefreshModalPending?: boolean;\n}\n\ntype UserProfileFormValues = {\n  full_name: string;\n  originalPassword?: string;\n  newPasswordConfirm?: string;\n  newPassword?: string;\n  totp_activated: boolean;\n};\n\nconst UserProfileSettingModal: React.FC<Props> = ({\n  onRequestClose,\n  onRequestRefresh,\n  isRefreshModalPending,\n  totpSupported,\n  queryRef,\n  ...baiModalProps\n}) => {\n  const { t } = useTranslation();\n  const formRef = useRef<FormInstance<UserProfileFormValues>>(null);\n  const [messageApi, contextHolder] = message.useMessage();\n  const [modal, modalContextHolder] = Modal.useModal();\n  const [isOpenTOTPActivateModal, { toggle: toggleTOTPActivateModal }] =\n    useToggle(false);\n  const baiClient = useSuspendedBackendaiClient();\n  const [userInfo, userMutations] = useCurrentUserInfo();\n  // const [fetchKey, updateFetchKey] = useUpdatableState('initial-fetch');\n\n  const { user } = usePreloadedQuery(UserProfileQuery, queryRef);\n\n  const mutationToRemoveTotp = useTanMutation({\n    mutationFn: () => {\n      return baiClient.remove_totp();\n    },\n  });\n\n  const onSubmit = () => {\n    formRef.current\n      ?.validateFields()\n      .then((values) => {\n        userMutations.updateFullName(values.full_name, {\n          onSuccess: (newFullName) => {\n            if (newFullName !== userInfo.full_name) {\n              messageApi.open({\n                type: 'success',\n                content: t('webui.menu.FullnameUpdated'),\n              });\n            }\n\n            if (\n              values.newPassword &&\n              values.newPasswordConfirm &&\n              values.originalPassword\n            ) {\n              userMutations.updatePassword(\n                {\n                  new_password: values.newPassword,\n                  new_password2: values.newPasswordConfirm,\n                  old_password: values.originalPassword,\n                },\n                {\n                  onSuccess: () => {\n                    messageApi.open({\n                      type: 'success',\n                      content: t('webui.menu.PasswordUpdated'),\n                    });\n                    onRequestClose(true);\n                  },\n                  onError: (e) => {\n                    messageApi.open({\n                      type: 'error',\n                      content: e.message,\n                    });\n                  },\n                },\n              );\n            } else {\n              onRequestClose(true);\n            }\n          },\n          onError: (e) => {\n            messageApi.open({\n              type: 'error',\n              content: e.message,\n            });\n          },\n        });\n      })\n      .catch(() => {});\n  };\n\n  return (\n    <>\n      <BAIModal\n        {...baiModalProps}\n        okText={t('webui.menu.Update')}\n        cancelText={t('webui.menu.Cancel')}\n        onCancel={() => {\n          onRequestClose();\n        }}\n        confirmLoading={userInfo.isPendingMutation}\n        onOk={() => onSubmit()}\n        centered\n        destroyOnClose\n        title={t('webui.menu.MyAccountInformation')}\n      >\n        <Spin spinning={isRefreshModalPending} indicator={<LoadingOutlined />}>\n          <Form\n            ref={formRef}\n            layout=\"vertical\"\n            labelCol={{ span: 8 }}\n            initialValues={{\n              full_name: userInfo.full_name,\n              totp_activated: user?.totp_activated || false,\n            }}\n            preserve={false}\n          >\n            <Form.Item\n              name=\"full_name\"\n              label={t('webui.menu.FullName')}\n              rules={[\n                () => ({\n                  validator(_, value) {\n                    if (value && value.length < 65) {\n                      return Promise.resolve();\n                    }\n                    return Promise.reject(\n                      new Error(t('webui.menu.FullNameInvalid')),\n                    );\n                  },\n                }),\n              ]}\n            >\n              <Input />\n            </Form.Item>\n            <Form.Item\n              name=\"originalPassword\"\n              label={t('webui.menu.OriginalPassword')}\n              rules={[\n                ({ getFieldValue }) => ({\n                  validator(_, value) {\n                    if (\n                      !value &&\n                      (getFieldValue('newPassword') ||\n                        getFieldValue('newPasswordConfirm'))\n                    ) {\n                      return Promise.reject(\n                        new Error(t('webui.menu.InputOriginalPassword')),\n                      );\n                    }\n                    return Promise.resolve();\n                  },\n                }),\n              ]}\n              dependencies={['newPassword', 'newPasswordConfirm']}\n            >\n              <Input.Password />\n            </Form.Item>\n            <Form.Item\n              name=\"newPassword\"\n              label={t('webui.menu.NewPassword')}\n              rules={[\n                {\n                  pattern: passwordPattern,\n                  message: t('webui.menu.InvalidPasswordMessage'),\n                },\n              ]}\n            >\n              <Input.Password />\n            </Form.Item>\n            <Form.Item\n              name=\"newPasswordConfirm\"\n              label={t('webui.menu.NewPasswordAgain')}\n              dependencies={['newPassword']}\n              rules={[\n                ({ getFieldValue }) => ({\n                  validator(_, value) {\n                    if (!value || getFieldValue('newPassword') === value) {\n                      return Promise.resolve();\n                    }\n                    return Promise.reject(\n                      new Error(t('webui.menu.NewPasswordMismatch')),\n                    );\n                  },\n                }),\n              ]}\n            >\n              <Input.Password />\n            </Form.Item>\n            {!!totpSupported && (\n              <Form.Item\n                name=\"totp_activated\"\n                label={t('webui.menu.TotpActivated')}\n                valuePropName=\"checked\"\n              >\n                <Switch\n                  loading={mutationToRemoveTotp.isLoading}\n                  onChange={(checked: boolean) => {\n                    if (checked) {\n                      toggleTOTPActivateModal();\n                    } else {\n                      if (user?.totp_activated) {\n                        formRef.current?.setFieldValue('totp_activated', true);\n                        modal.confirm({\n                          title: t('totp.TurnOffTotp'),\n                          icon: <ExclamationCircleFilled />,\n                          content: t('totp.ConfirmTotpRemovalBody'),\n                          okText: t('button.Yes'),\n                          okType: 'danger',\n                          cancelText: t('button.No'),\n                          onOk() {\n                            mutationToRemoveTotp.mutate(undefined, {\n                              onSuccess: () => {\n                                message.success(\n                                  t('totp.RemoveTotpSetupCompleted'),\n                                );\n                                // updateFetchKey();\n                                onRequestRefresh();\n\n                                formRef.current?.setFieldValue(\n                                  'totp_activated',\n                                  false,\n                                );\n                              },\n                              onError: (error: any) => {\n                                message.error(error.message);\n                              },\n                            });\n                          },\n                          onCancel() {\n                            formRef.current?.setFieldValue(\n                              'totp_activated',\n                              true,\n                            );\n                          },\n                        });\n                      }\n                    }\n                  }}\n                />\n              </Form.Item>\n            )}\n          </Form>\n        </Spin>\n        {!!totpSupported && (\n          <TOTPActivateModal\n            userFrgmt={user}\n            open={isOpenTOTPActivateModal}\n            onRequestClose={(success) => {\n              if (success) {\n                // updateFetchKey();\n                onRequestRefresh();\n              } else {\n                formRef.current?.setFieldValue('totp_activated', false);\n              }\n              toggleTOTPActivateModal();\n            }}\n          />\n        )}\n      </BAIModal>\n      {contextHolder}\n      {modalContextHolder}\n    </>\n  );\n};\n\nexport default UserProfileSettingModal;\n","// This icon file is generated automatically.\nvar WarningTwoTone = { \"icon\": function render(primaryColor, secondaryColor) { return { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M955.7 856l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z\", \"fill\": primaryColor } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M172.2 828.1h679.6L512 239.9 172.2 828.1zM560 720a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm-16-304v184c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V416c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8z\", \"fill\": secondaryColor } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8z\", \"fill\": primaryColor } }] }; }, \"name\": \"warning\", \"theme\": \"twotone\" };\nexport default WarningTwoTone;\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport WarningTwoToneSvg from \"@ant-design/icons-svg/es/asn/WarningTwoTone\";\nimport AntdIcon from \"../components/AntdIcon\";\nvar WarningTwoTone = function WarningTwoTone(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n    ref: ref,\n    icon: WarningTwoToneSvg\n  }));\n};\n\n/**![warning](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTk1NS43IDg1NmwtNDE2LTcyMGMtNi4yLTEwLjctMTYuOS0xNi0yNy43LTE2cy0yMS42IDUuMy0yNy43IDE2bC00MTYgNzIwQzU2IDg3Ny40IDcxLjQgOTA0IDk2IDkwNGg4MzJjMjQuNiAwIDQwLTI2LjYgMjcuNy00OHptLTc4My41LTI3LjlMNTEyIDIzOS45bDMzOS44IDU4OC4ySDE3Mi4yeiIgZmlsbD0iIzE2NzdmZiIgLz48cGF0aCBkPSJNMTcyLjIgODI4LjFoNjc5LjZMNTEyIDIzOS45IDE3Mi4yIDgyOC4xek01NjAgNzIwYTQ4LjAxIDQ4LjAxIDAgMDEtOTYgMCA0OC4wMSA0OC4wMSAwIDAxOTYgMHptLTE2LTMwNHYxODRjMCA0LjQtMy42IDgtOCA4aC00OGMtNC40IDAtOC0zLjYtOC04VjQxNmMwLTQuNCAzLjYtOCA4LThoNDhjNC40IDAgOCAzLjYgOCA4eiIgZmlsbD0iI2U2ZjRmZiIgLz48cGF0aCBkPSJNNDY0IDcyMGE0OCA0OCAwIDEwOTYgMCA0OCA0OCAwIDEwLTk2IDB6bTE2LTMwNHYxODRjMCA0LjQgMy42IDggOCA4aDQ4YzQuNCAwIDgtMy42IDgtOFY0MTZjMC00LjQtMy42LTgtOC04aC00OGMtNC40IDAtOCAzLjYtOCA4eiIgZmlsbD0iIzE2NzdmZiIgLz48L3N2Zz4=) */\nvar RefIcon = /*#__PURE__*/React.forwardRef(WarningTwoTone);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'WarningTwoTone';\n}\nexport default RefIcon;"],"names":["passwordPattern","ResetPasswordRequired","value","dispatchEvent","useWebComponentInfo","parsedValue","JSON","parse","error","open","currentPassword","username","api_endpoint","token","theme","useToken","form","Form","useForm","t","useTranslation","useEffect","resetFields","anonymousBaiClient","useAnonymousBackendaiClient","mutation","useTanMutation","mutationFn","body","baiSignedRequestWithPromise","method","url","client","onSubmit","validateFields","then","values","mutate","current_password","new_password","newPassword","onSuccess","data","variables","context","onError","_jsx","Modal","centered","mask","onCancel","keyboard","maskClosable","footer","width","destroyOnClose","forceRender","children","_jsxs","Flex","direction","justify","align","gap","style","alignSelf","paddingTop","paddingMD","paddingBottom","Typography","Title","level","margin","WarningTwoTone","twoToneColor","colorWarning","layout","initialValues","disabled","isLoading","Item","name","label","rules","required","pattern","message","toString","validator","_","Promise","reject","Error","resolve","hasFeedback","Input","Password","dependencies","_ref","getFieldValue","onPressEnter","Button","type","onClick","loading","onRequestClose","onRequestRefresh","isRefreshModalPending","totpSupported","queryRef","baiModalProps","formRef","useRef","messageApi","contextHolder","useMessage","modal","modalContextHolder","useModal","isOpenTOTPActivateModal","toggle","toggleTOTPActivateModal","useToggle","baiClient","useSuspendedBackendaiClient","userInfo","userMutations","useCurrentUserInfo","user","usePreloadedQuery","UserProfileQuery","mutationToRemoveTotp","remove_totp","_Fragment","BAIModal","okText","cancelText","confirmLoading","isPendingMutation","onOk","_formRef$current","current","updateFullName","full_name","newFullName","content","newPasswordConfirm","originalPassword","updatePassword","new_password2","old_password","e","catch","title","Spin","spinning","indicator","LoadingOutlined","ref","labelCol","span","totp_activated","preserve","length","_ref2","_ref3","valuePropName","Switch","onChange","checked","_formRef$current2","setFieldValue","confirm","icon","ExclamationCircleFilled","okType","undefined","_formRef$current3","success","_formRef$current4","TOTPActivateModal","userFrgmt","_formRef$current5","primaryColor","secondaryColor","props","React","AntdIcon","_extends","WarningTwoToneSvg"],"sourceRoot":""}