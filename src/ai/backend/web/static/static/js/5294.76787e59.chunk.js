"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[5294],{25294:(e,n,i)=>{i.r(n),i.d(n,{default:()=>x});const a=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},n={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:null,kind:"LocalArgument",name:"limit"},a={defaultValue:null,kind:"LocalArgument",name:"offset"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o=[r,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],d={alias:null,args:null,concreteType:"SourceInfo",kind:"LinkedField",name:"registry",plural:!1,selections:o,storageKey:null},c={alias:null,args:null,concreteType:"SourceInfo",kind:"LinkedField",name:"source",plural:!1,selections:o,storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},g={kind:"Literal",name:"orderBy",value:{direction:"DESC",field:"VERSION"}},f=[{kind:"Literal",name:"filter",value:{status:{equals:"PULLING"}}},g],m={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},A={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},y={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},k={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]},F=[{kind:"Literal",name:"first",value:1},g],R={alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null},L={args:null,kind:"FragmentSpread",name:"BAIImportArtifactModalArtifactRevisionFragment"},S=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},g];return{fragment:{argumentDefinitions:[e,n,i,a],kind:"Fragment",metadata:null,name:"ReservoirArtifactDetailPageQuery",selections:[{alias:null,args:t,concreteType:"Artifact",kind:"LinkedField",name:"artifact",plural:!1,selections:[l,r,{args:null,kind:"FragmentSpread",name:"BAIArtifactTypeTagFragment"},s,d,c,u,{alias:"pullingArtifactRevisions",args:f,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"__ReservoirArtifactDetailPage_pullingArtifactRevisions_connection",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,v,{args:null,kind:"FragmentSpread",name:"BAIPullingArtifactRevisionAlertFragment"},A],storageKey:null},p],storageKey:null},y,k],storageKey:'__ReservoirArtifactDetailPage_pullingArtifactRevisions_connection(filter:{"status":{"equals":"PULLING"}},orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:"latestVersion",args:F,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,R,I,v,L,{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionTableLatestRevisionFragment"}],storageKey:null}],storageKey:null}],storageKey:'revisions(first:1,orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:null,args:S,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,v,{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionTableArtifactRevisionFragment"},L,{args:null,kind:"FragmentSpread",name:"BAIDeleteArtifactRevisionsModalArtifactRevisionFragment"},{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionDeleteButtonFragment"},{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionDownloadButtonFragment"}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"BAIImportArtifactModalArtifactFragment"},{args:null,kind:"FragmentSpread",name:"BAIDeleteArtifactRevisionsModalArtifactFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,i,e],kind:"Operation",name:"ReservoirArtifactDetailPageQuery",selections:[{alias:null,args:t,concreteType:"Artifact",kind:"LinkedField",name:"artifact",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},s,d,c,u,{alias:"pullingArtifactRevisions",args:f,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,v,I,A],storageKey:null},p],storageKey:null},y,k],storageKey:'revisions(filter:{"status":{"equals":"PULLING"}},orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:"pullingArtifactRevisions",args:f,filters:["filter","orderBy"],handle:"connection",key:"ReservoirArtifactDetailPage_pullingArtifactRevisions",kind:"LinkedHandle",name:"revisions"},{alias:"latestVersion",args:F,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,R,I,v],storageKey:null}],storageKey:null}],storageKey:'revisions(first:1,orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:null,args:S,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,v,I,R,u],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"0d1cbe108f844759d49f2a65d38b28c4",id:null,metadata:{connection:[{count:null,cursor:null,direction:"bidirectional",path:["artifact","pullingArtifactRevisions"]}]},name:"ReservoirArtifactDetailPageQuery",operationKind:"query",text:"query ReservoirArtifactDetailPageQuery(\n  $id: ID!\n  $offset: Int!\n  $limit: Int!\n  $filter: ArtifactRevisionFilter!\n) {\n  artifact(id: $id) {\n    id\n    name\n    ...BAIArtifactTypeTagFragment\n    description\n    registry {\n      name\n      url\n    }\n    source {\n      name\n      url\n    }\n    updatedAt\n    pullingArtifactRevisions: revisions(filter: {status: {equals: PULLING}}, orderBy: {field: VERSION, direction: DESC}) {\n      count\n      edges {\n        node {\n          id\n          status\n          ...BAIPullingArtifactRevisionAlertFragment\n          __typename\n        }\n        cursor\n      }\n      pageInfo {\n        endCursor\n        hasNextPage\n        hasPreviousPage\n        startCursor\n      }\n    }\n    latestVersion: revisions(first: 1, orderBy: {field: VERSION, direction: DESC}) {\n      edges {\n        node {\n          id\n          size\n          version\n          status\n          ...BAIImportArtifactModalArtifactRevisionFragment\n          ...BAIArtifactRevisionTableLatestRevisionFragment\n        }\n      }\n    }\n    revisions(offset: $offset, limit: $limit, orderBy: {field: VERSION, direction: DESC}, filter: $filter) {\n      count\n      edges {\n        node {\n          id\n          status\n          ...BAIArtifactRevisionTableArtifactRevisionFragment\n          ...BAIImportArtifactModalArtifactRevisionFragment\n          ...BAIDeleteArtifactRevisionsModalArtifactRevisionFragment\n          ...BAIArtifactRevisionDeleteButtonFragment\n          ...BAIArtifactRevisionDownloadButtonFragment\n        }\n      }\n    }\n    ...BAIImportArtifactModalArtifactFragment\n    ...BAIDeleteArtifactRevisionsModalArtifactFragment\n  }\n}\n\nfragment BAIArtifactDescriptionsFragment on Artifact {\n  name\n  description\n  source {\n    name\n    url\n  }\n  ...BAIArtifactTypeTagFragment\n}\n\nfragment BAIArtifactRevisionDeleteButtonFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactRevisionDownloadButtonFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactRevisionTableArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n  updatedAt\n  ...BAIArtifactStatusTagFragment\n  ...BAIArtifactRevisionDownloadButtonFragment\n  ...BAIArtifactRevisionDeleteButtonFragment\n}\n\nfragment BAIArtifactRevisionTableLatestRevisionFragment on ArtifactRevision {\n  id\n}\n\nfragment BAIArtifactStatusTagFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactTypeTagFragment on Artifact {\n  type\n}\n\nfragment BAIDeleteArtifactRevisionsModalArtifactFragment on Artifact {\n  id\n  ...BAIArtifactDescriptionsFragment\n}\n\nfragment BAIDeleteArtifactRevisionsModalArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n}\n\nfragment BAIImportArtifactModalArtifactFragment on Artifact {\n  id\n  name\n  ...BAIArtifactDescriptionsFragment\n}\n\nfragment BAIImportArtifactModalArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n}\n\nfragment BAIPullingArtifactRevisionAlertFragment on ArtifactRevision {\n  id\n  status\n  version\n}\n"}}}();a.hash="84c2e87c5b490db6c7abb4854da057af";const t=a;var l=i(96223),r=i(76591),s=i(8343),o=i(94824),d=i(20714),c=i(67631),u=i(8905),g=i.n(u),f=i(13215),m=i.n(f),v=i(47699),A=i.n(v),p=i(24446),y=i(17534),k=i(62962),F=i(46336),R=i(40720),I=i(40690),L=i(91225),S=i(86167),B=i(73233),b=i(89374);g().extend(m());const{Title:h,Text:P,Paragraph:D}=l.A,x=()=>{var e,n,i,a;const{token:u}=r.A.useToken(),{t:f}=(0,k.Bd)(),{upsertNotification:m}=(0,S.js)(),{artifactId:v}=(0,R.g)(),[x,T]=(0,I.Tw)(I.eI),[E,K]=(0,y.useState)([]),[N,C]=(0,y.useState)([]),[j,V]=(0,y.useState)([]),[O,_]=(0,B.useQueryParams)({filter:(0,B.withDefault)(B.JsonParam,{})}),M=JSON.stringify(O.filter),{baiPaginationOption:w,tablePaginationOption:z,setTablePaginationOption:G}=(0,L.L0)({current:1,pageSize:10}),U=(0,y.useMemo)((()=>({id:null!==v&&void 0!==v?v:"",offset:w.offset,limit:w.limit,filter:JSON.parse(M||"{}")})),[v,w.limit,w.offset,M]),$=(0,y.useDeferredValue)(U),q=(0,y.useDeferredValue)(x),{artifact:Q}=(0,F.useLazyLoadQuery)(t,$,{fetchKey:q===I.eI?void 0:q,fetchPolicy:q===I.eI?"store-and-network":"network-only"}),J=null===Q||void 0===Q||null===(e=Q.latestVersion.edges[0])||void 0===e?void 0:e.node,Y=(0,c.f)(null===Q||void 0===Q?void 0:Q.pullingArtifactRevisions.edges.map((e=>null===e||void 0===e?void 0:e.node)));return(0,b.jsxs)("div",{children:[(0,b.jsxs)(c.OO,{align:"center",style:{marginBottom:u.marginLG},justify:"between",children:[(0,b.jsxs)(c.OO,{align:"center",gap:"xs",children:[(0,b.jsx)(h,{level:3,style:{margin:0},children:null===Q||void 0===Q?void 0:Q.name}),Q&&(0,b.jsx)(c.bk,{artifactTypeFrgmt:Q})]}),(0,b.jsx)(c.u8,{value:x,autoUpdateDelay:1e4,loading:q!==x,onChange:()=>{T()}})]}),Y.length>0&&(0,b.jsx)(c.OO,{direction:"column",gap:"sm",align:"stretch",style:{marginBottom:u.marginMD},children:Y.map((e=>(0,b.jsx)(c.vy,{pullingArtifactRevisionFrgmt:e,onOk:()=>{T()}},e.id)))}),(0,b.jsx)(c.Zu,{title:f("reservoirPage.BasicInformation"),showDivider:!0,extra:(0,b.jsx)(s.Ay,{type:"primary",icon:(0,b.jsx)(p.A,{size:16}),onClick:()=>{J&&V([J])},disabled:!J||"SCANNED"!==J.status,children:J?f("reservoirPage.PullLatestVersion",{version:J.version}):"N/A"}),style:{marginBottom:u.marginMD},children:(0,b.jsxs)(o.A,{column:2,bordered:!0,children:[(0,b.jsx)(o.A.Item,{label:f("reservoirPage.Name"),children:null===Q||void 0===Q?void 0:Q.name}),(0,b.jsx)(o.A.Item,{label:f("reservoirPage.Type"),children:Q&&(0,b.jsx)(c.bk,{artifactTypeFrgmt:Q})}),(0,b.jsx)(o.A.Item,{label:f("reservoirPage.Size"),children:(0,b.jsx)(c.mQ,{monospace:!0,children:null!==J&&void 0!==J&&J.size?null===(n=(0,c.Gh)(J.size,"auto"))||void 0===n?void 0:n.displayValue:"N/A"})}),(0,b.jsx)(o.A.Item,{label:f("reservoirPage.Source"),children:null!==Q&&void 0!==Q&&Q.source?(0,b.jsx)(l.A.Link,{href:null!==(i=Q.source.url)&&void 0!==i?i:"",target:"_blank",rel:"noopener noreferrer",children:Q.source.name||"N/A"}):"N/A"}),(0,b.jsx)(o.A.Item,{label:f("reservoirPage.Registry"),children:(0,b.jsx)(l.A,{children:null!==Q&&void 0!==Q&&Q.registry?"".concat(Q.registry.name,"(").concat(Q.registry.url,")"):"N/A"})}),(0,b.jsx)(o.A.Item,{label:f("reservoirPage.LastUpdated"),span:2,children:null!==Q&&void 0!==Q&&Q.updatedAt?g()(null===Q||void 0===Q?void 0:Q.updatedAt).format("lll"):"N/A"}),(0,b.jsx)(o.A.Item,{label:f("reservoirPage.Description"),span:2,children:null!==Q&&void 0!==Q&&Q.description?(0,b.jsx)(D,{children:Q.description}):"N/A"})]})}),(0,b.jsx)(c.Zu,{title:f("reservoirPage.VersionList"),showDivider:!0,style:{marginBottom:u.marginMD},styles:{body:{padding:"".concat(u.paddingSM,"px ").concat(u.paddingLG,"px ").concat(u.paddingLG,"px ").concat(u.paddingLG,"px")}},children:(0,b.jsxs)(c.OO,{direction:"column",gap:"sm",align:"stretch",children:[(0,b.jsxs)(c.OO,{align:"stretch",justify:"between",children:[(0,b.jsx)(c.tX,{combinationMode:"AND",onChange:e=>{_({filter:null!==e&&void 0!==e?e:{}},"replaceIn")},filterProperties:[{fixedOperator:"equals",propertyLabel:f("reservoirPage.Status"),key:"status",type:"enum",options:[{label:"SCANNED",value:"SCANNED"},{label:"PULLING",value:"PULLING"},{label:"PULLED",value:"PULLED"},{label:"VERIFYING",value:"VERIFYING"},{label:"NEEDS_APPROVAL",value:"NEEDS_APPROVAL"},{label:"FAILED",value:"FAILED"},{label:"AVAILABLE",value:"AVAILABLE"},{label:"REJECTED",value:"REJECTED"}]},{fixedOperator:"contains",propertyLabel:f("reservoirPage.Version"),key:"version",type:"string"},{propertyLabel:f("reservoirPage.ArtifactID"),key:"artifactId",valueMode:"scalar",type:"string"}]}),E.length>0?(0,b.jsxs)(c.OO,{gap:"xs",children:[(0,b.jsxs)(P,{children:[E.length," selected"]}),(0,b.jsx)(d.A,{title:f("reservoirPage.PullSelectedVersions"),children:(0,b.jsx)(c.eM,{revisionsFrgmt:E.flatMap((e=>e.data)),onClick:()=>{Q&&V(E.flatMap((e=>e.data)))}})}),(0,b.jsx)(d.A,{title:f("reservoirPage.RemoveSelectedVersions"),children:(0,b.jsx)(c.Ty,{revisionsFrgmt:E.flatMap((e=>e.data)),style:{borderColor:u.colorBorder,backgroundColor:u.colorBgContainer},onClick:()=>{Q&&C(E.flatMap((e=>e.data)))}})})]}):null]}),(0,b.jsx)(c.eU,{artifactRevisionFrgmt:(0,c.f)(null===Q||void 0===Q?void 0:Q.revisions.edges.map((e=>e.node))),latestRevisionFrgmt:null===Q||void 0===Q?void 0:Q.latestVersion.edges[0].node,loading:$!==U,onClickDownload:e=>{null===Q||void 0===Q||Q.revisions.edges.forEach((n=>{if(n.node.id===e)return V([n.node])}))},onClickDelete:e=>{null===Q||void 0===Q||Q.revisions.edges.forEach((n=>{if(n.node.id===e)return C([n.node])}))},pagination:{current:z.current,pageSize:z.pageSize,total:null!==(a=null===Q||void 0===Q?void 0:Q.revisions.count)&&void 0!==a?a:0,onChange:(e,n)=>{A().isNumber(e)&&A().isNumber(n)&&G({current:e,pageSize:n})}},onRow:e=>({onClick:n=>{var i;n.stopPropagation();const a=n.target;if(a.closest("button")||a.closest("a"))return;if(!Q)return;const t=null===(i=Q.revisions.edges.find((n=>n.node.id===e.id)))||void 0===i?void 0:i.node;t&&K((n=>{const i=n.filter((n=>n.id!==e.id));return i.length===n.length?[...n,{id:e.id,data:t}]:i}))}}),rowSelection:{type:"checkbox",onChange:e=>{if(!Q)return;const n=Q.revisions,i=n.edges.map((e=>e.node.id));K((a=>{const t=a.filter((e=>!i.includes(e.id))),l=n.edges.filter((n=>e.includes(n.node.id))).map((e=>({id:e.node.id,data:e.node})));return t.concat(l)}))},selectedRowKeys:E.map((e=>e.id))}})]})}),(0,b.jsx)(c.VC,{selectedArtifactFrgmt:null!==Q&&void 0!==Q?Q:null,selectedArtifactRevisionFrgmt:j,open:!!Q&&!A().isEmpty(j),connectionIds:Q?[Q.pullingArtifactRevisions.__id]:void 0,onOk:(e,n)=>{V([]),n.forEach((e=>{m({message:f("reservoirPage.PullingArtifact",{name:e.artifact.name,version:e.version}),type:"info",open:!0,duration:0,backgroundTask:{status:"pending",taskId:e.taskId,promise:null,percent:0,onChange:{resolved:(n,i)=>({type:"success",message:f("reservoirPage.SuccessFullyPulledArtifact",{name:e.artifact.name,version:e.version}),showIcon:!0,toText:f("reservoirPage.GoToArtifact"),to:"/reservoir/".concat(e.artifact.id)}),rejected:(n,i)=>f("reservoirPage.FailedToPullArtifact",{name:e.artifact.name,version:e.version})}}})}))},onCancel:()=>{V([])}}),(0,b.jsx)(c.L$,{selectedArtifactFrgmt:null!==Q&&void 0!==Q?Q:null,selectedArtifactRevisionFrgmt:N,onOk:()=>{C([])},onCancel:()=>{C([])},open:!!Q&&!A().isEmpty(N)})]})}}}]);
//# sourceMappingURL=5294.76787e59.chunk.js.map