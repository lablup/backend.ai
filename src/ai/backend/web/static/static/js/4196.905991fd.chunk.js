"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[4196],{91069:(e,t,n)=>{n.d(t,{A:()=>O});var a=n(39718),s=n(88153),i=n(27480),c=n(88813),l=n(37325),o=n(89798),r=n(64240),d=n(63872),g=n(8348),m=n.n(g),u=n(66610),h=n(66906);const p=(0,r.rU)((e=>{let{css:t}=e;return{baiSettingItemCheckbox:t`
    .ant-checkbox {
      align-self: flex-start;
      margin-top: 0.2rem;
    }
  `}})),x=e=>{let{"data-testid":t,type:n,title:a,description:r,children:g,defaultValue:u,value:x,selectProps:y,onChange:j,disabled:b}=e;const{token:k}=s.A.useToken(),{styles:A}=p();return(0,h.jsxs)(d.OO,{"data-testid":t,direction:"column",align:"start",gap:"xxs",children:[(0,h.jsxs)(d.OO,{direction:"row",gap:"xxs",children:[(0,h.jsx)(i.A.Text,{strong:!0,style:{fontSize:k.fontSize},children:a}),!b&&void 0!==x&&null!==x&&u!==x&&(0,h.jsx)(c.A,{dot:!0,status:"warning"})]}),"custom"===n&&(0,h.jsxs)(h.Fragment,{children:[r,(0,h.jsx)("div",{style:{marginTop:k.marginXS},children:g})]}),"checkbox"===n&&(0,h.jsx)(l.A,{checked:x,onChange:j,disabled:b,className:A.baiSettingItemCheckbox,children:(0,h.jsx)(i.A.Text,{type:b?"secondary":void 0,children:r})}),"select"===n&&(0,h.jsxs)(h.Fragment,{children:[r,(0,h.jsx)(o.A,{value:x,popupMatchSelectWidth:!1,onChange:j,disabled:b,style:{marginTop:k.marginXS,...null===y||void 0===y?void 0:y.style},...m().omit(y,["style"])})]})]})};var y=n(45885),j=n(4866),b=n(89644),k=n(82851),A=n(22065),v=n(84395),C=n(49358),f=n(18144),S=n(84321),w=n(54070);const I=(0,r.rU)((e=>{let{css:t,token:n}=e;return{TabStyles:t`
    .ant-tabs-tab-active {
      font-weight: var(--token-fontWeightSuperStrong, 700);
    }
    .ant-typography-secondary {
      font-weight: normal !important;
    }
  `}})),T=e=>{let{title:t,count:n}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(i.A.Text,{children:t}),(0,h.jsx)(i.A.Text,{type:"secondary",children:` (${n})`})]})},R=e=>{let{group:t,hideEmpty:n,...a}=e;const{token:c}=s.A.useToken();return(!n||0!==t.settingItems.length)&&(0,h.jsxs)(d.OO,{direction:"column",align:"stretch",style:{marginBottom:c.marginMD},...a,children:[(0,h.jsxs)(d.OO,{direction:"column",align:"stretch",style:{zIndex:1,marginBottom:c.marginMD,background:c.colorBgContainer},children:[(0,h.jsx)(i.A.Title,{level:5,style:{marginTop:0},children:t.title}),(0,h.jsx)(k.A,{style:{marginTop:0,marginBottom:0}}),t.description&&(0,h.jsx)(i.A.Text,{type:"secondary",style:{marginTop:c.marginSM},children:t.description})]}),(0,h.jsx)(d.OO,{direction:"column",align:"start",gap:"lg",children:t.settingItems.map(((e,t)=>(0,h.jsx)(x,{...e},e.title+t)))})]})},O=e=>{let{settingGroups:t,tabDirection:n="left",showChangedOptionFilter:i,showResetButton:c,showSearchBar:o}=e;const{t:r}=(0,w.Bd)(),{token:g}=s.A.useToken(),{styles:p}=I(),[x,k]=(0,u.useState)(""),[O,E]=(0,u.useState)(!1),[B,{toggle:_}]=(0,b.A)(!1),[D,M]=(0,u.useState)("all"),F=m().map(t,(e=>({...e,settingItems:m().filter(e.settingItems,(e=>(!O||(e=>null!==e.value&&void 0!==e.value&&!e.disabled&&e.value!==e.defaultValue)(e))&&(e=>e.title.toLowerCase().includes(x.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(x.toLowerCase()))(e)))})));return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(d.OO,{direction:"column",gap:"md",align:"stretch",style:{padding:g.paddingContentHorizontal,maxWidth:g.screenLG},children:[(0,h.jsxs)(d.OO,{justify:"start",gap:"xs",children:[!!o&&(0,h.jsx)(A.A,{prefix:(0,h.jsx)(y.A,{}),placeholder:r("settings.SearchPlaceholder"),onChange:e=>k(e.target.value),value:x}),!!i&&(0,h.jsx)(l.A,{onChange:e=>E(e.target.checked),style:{whiteSpace:"nowrap"},children:r("settings.ShowOnlyChanged")}),!!c&&(0,h.jsx)(v.Ay,{icon:(0,h.jsx)(j.A,{}),onClick:()=>_(),children:r("button.Reset")})]}),(0,h.jsx)(C.A,{activeKey:D,onChange:M,className:p.TabStyles,tabPosition:n?"left":"top",tabBarStyle:{minWidth:200},items:[{key:"all",label:(0,h.jsx)(T,{title:r("general.All"),count:m().sumBy(F,(e=>e.settingItems.length))}),children:(0,h.jsx)(d.OO,{direction:"column",align:"stretch",gap:"xl",children:m().sumBy(F,(e=>e.settingItems.length))>0?m().map(F,(e=>(0,h.jsx)(R,{"data-testid":null===e||void 0===e?void 0:e["data-testid"],group:e,hideEmpty:!0},e.title))):(0,h.jsx)(f.A,{image:f.A.PRESENTED_IMAGE_SIMPLE,description:r("settings.NoChangesToDisplay")})})},...m().map(F,((e,t)=>({key:`index${t}`,label:(0,h.jsx)(T,{title:e.title,count:e.settingItems.length}),children:e.settingItems.length>0?(0,h.jsx)(R,{group:e,hideEmpty:!0}):(0,h.jsx)(f.A,{image:f.A.PRESENTED_IMAGE_SIMPLE,description:r("settings.NoChangesToDisplay")})})))]})]}),(0,h.jsx)(a.A,{open:B,title:r("dialog.ask.DoYouWantToResetChanges"),okText:r("button.Reset"),okButtonProps:{danger:!0},onOk:()=>{m().flatMap(t,(e=>e.settingItems)).forEach((e=>{!e.disabled&&(null===e||void 0===e?void 0:e.setValue)&&e.setValue(e.defaultValue)})),_()},cancelText:r("button.Cancel"),onCancel:()=>_(),children:(0,h.jsx)(S.A,{showIcon:!0,message:r("dialog.warning.CannotBeUndone"),type:"warning"})})]})}},84196:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var a=n(19885),s=n(82860),i=n(91069),c=n(4866),l=n(84395),o=n(66610),r=n(54070),d=n(66906);const g=()=>{const[e,t]=(0,o.useState)(!1),[n,g]=(0,o.useState)(!1),{t:m}=(0,r.Bd)(),{upsertNotification:u}=(0,s.js)(),h=(0,a.CX)(),p=[{"data-testid":"maintenance-fix",title:m("maintenance.Fix"),settingItems:[{type:"custom",title:m("maintenance.MatchDatabase"),description:m("maintenance.DescMatchDatabase"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{t(!0),u({message:m("maintenance.RecalculateUsage"),description:m("maintenance.Recalculating"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.recalculate_usage().finally((()=>t(!1))),onChange:{pending:m("maintenance.Recalculating"),resolved:m("maintenance.RecalculationFinished"),rejected:m("maintenance.RecalculationFailed")}}})},loading:e,children:m(e?"maintenance.Recalculating":"maintenance.RecalculateUsage")})}]},{"data-testid":"maintenance-images",title:m("maintenance.ImagesEnvironment"),settingItems:[{type:"custom",title:m("maintenance.RescanImageList"),description:m("maintenance.DescRescanImageList"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{g(!0),u({message:m("maintenance.RescanImages"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.rescan_images(),onChange:{pending:m("maintenance.RescanImageScanning"),resolved:e=>{const t=e;if(t.rescan_images.ok)return{backgroundTask:{status:"pending",taskId:t.rescan_images.task_id,promise:null,percent:0,onChange:{resolved:(e,t)=>(g(!1),m("maintenance.RescanImageFinished"))}},duration:0};throw new Error(m("maintenance.RescanFailed"))},rejected:(e,t)=>{const n=e;return g(!1),(null===n||void 0===n?void 0:n.message)||m("maintenance.RescanFailed")}}}})},loading:n,children:m(n?"maintenance.RescanImageScanning":"maintenance.RescanImages")})}]}];return(0,d.jsx)(i.A,{settingGroups:p,showSearchBar:!0})};var m=n(57010),u=n(83203);const h=(0,u.withDefault)(u.StringParam,"maintenance"),p=()=>{const{t:e}=(0,r.Bd)(),[t,n]=(0,u.useQueryParam)("tab",h);return(0,d.jsx)(m.A,{activeTabKey:"maintenance",onTabChange:e=>n(e),tabList:[{key:"maintenance",tab:e("webui.menu.Maintenance")}],styles:{body:{padding:0}},children:"maintenance"===t&&(0,d.jsx)(g,{})})}},4866:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(1139),s=n(66610);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};var c=n(35525),l=function(e,t){return s.createElement(c.A,(0,a.A)({},e,{ref:t,icon:i}))};const o=s.forwardRef(l)}}]);
//# sourceMappingURL=4196.905991fd.chunk.js.map