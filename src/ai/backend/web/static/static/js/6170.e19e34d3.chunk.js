"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[6170],{68707:(e,t,n)=>{n.d(t,{A:()=>p});var l=n(38053),a=n(58394),i=n(37090),r=n(79837),s=n(294),o=n(36256),u=n(64428),d=n.n(u),c=n(55202),m=n(44617),g=n(52426);const p=e=>{var t;let{open:n,onRequestClose:u,columns:p,hiddenColumnKeys:y,...h}=e;const f=(0,c.useRef)(null),{t:x}=(0,m.Bd)(),{token:b}=i.A.useToken(),v=d().map(p,(e=>{return"string"===typeof e.title?{label:e.title,value:d().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(t=e.title,c.Children.map(t.props.children,(e=>{if("string"===typeof e)return e}))),value:d().toString(e.key)}:{label:void 0,value:d().toString(e.key)};var t}));return(0,g.jsx)(l.A,{title:x("table.SettingTable"),open:n,destroyOnClose:!0,centered:!0,onOk:()=>{var e;null===(e=f.current)||void 0===e||e.validateFields().then((e=>{u(e)})).catch((()=>{}))},onCancel:()=>{u()},...h,children:(0,g.jsxs)(r.A,{ref:f,preserve:!1,initialValues:{selectedColumnKeys:null===(t=d().map(v,"value"))||void 0===t?void 0:t.filter((e=>!d().includes(y,e)))},layout:"vertical",children:[(0,g.jsx)(r.A.Item,{name:"searchInput",label:x("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,g.jsx)(s.A,{prefix:(0,g.jsx)(a.A,{}),style:{marginBottom:b.marginSM},placeholder:x("table.SearchTableColumn")})}),(0,g.jsx)(r.A.Item,{noStyle:!0,shouldUpdate:(e,t)=>e.searchInput!==t.searchInput,children:e=>{let{getFieldValue:t}=e;const n=t("searchInput")?d().toLower(t("searchInput")):void 0,l=d().map(v,(e=>d().toLower(d().toString(e.label)).includes(n||"")?e:{...e,style:{display:"none"}}));return(0,g.jsx)(r.A.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},children:(0,g.jsx)(o.A.Group,{options:l,style:{flexDirection:"column"}})})}})]})})}},54987:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});const l=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},t={defaultValue:null,kind:"LocalArgument",name:"limit"},n={defaultValue:null,kind:"LocalArgument",name:"offset"},l={defaultValue:null,kind:"LocalArgument",name:"order"},a={defaultValue:null,kind:"LocalArgument",name:"status"},i=[{alias:null,args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"order",variableName:"order"},{kind:"Variable",name:"status",variableName:"status"}],concreteType:"AgentSummaryList",kind:"LinkedField",name:"agent_summary_list",plural:!1,selections:[{alias:null,args:null,concreteType:"AgentSummary",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"available_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"occupied_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"scaling_group",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"schedulable",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t,n,l,a],kind:"Fragment",metadata:null,name:"AgentSummaryListQuery",selections:i,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,n,e,a,l],kind:"Operation",name:"AgentSummaryListQuery",selections:i},params:{cacheID:"caaf8909248bac69bce5c748e6d28032",id:null,metadata:{},name:"AgentSummaryListQuery",operationKind:"query",text:"query AgentSummaryListQuery(\n  $limit: Int!\n  $offset: Int!\n  $filter: String\n  $status: String\n  $order: String\n) {\n  agent_summary_list(limit: $limit, offset: $offset, filter: $filter, status: $status, order: $order) {\n    items {\n      id\n      status\n      architecture\n      available_slots\n      occupied_slots\n      scaling_group\n      schedulable\n    }\n    total_count\n  }\n}\n"}}}();l.hash="dab7ef4f1205af54a6f80ce0d28098c7";const a=l},92674:(e,t,n)=>{n.d(t,{a:()=>a});var l=n(79678);const a=e=>{const[t,n]=(0,l.q)(`hiddenColumnKeys.${e}`);return[t,n]}},56170:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var l,a=n(77813),i=n(81751),r=n(78909),s=n(14504),o=n(43992),u=n(92674),d=n(10200),c=n(30544),m=n(62867),g=n(96520),p=n(62010),y=n(68707),h=n(66021),f=n(51142),x=n(24262),b=n(83150),v=n(50473),S=n(82844),A=n(37090),j=n(18959),k=n(86663),w=n(90086),T=n(56909),C=n(64428),L=n.n(C),_=n(55202),I=n(44617),K=n(18139),z=n(52426);const F=e=>{let{containerStyle:t,tableProps:C}=e;const{t:F}=(0,I.Bd)(),{token:N}=A.A.useToken(),{mergedResourceSlots:V}=(0,r.Hv)(),[$,{toggle:D}]=(0,S.A)(),[R,E]=(0,_.useTransition)(),[O,X]=(0,_.useTransition)(),[B,P]=(0,_.useTransition)(),[Q,Z]=(0,_.useState)("ALIVE"),[q,G]=(0,_.useState)(Q),[M,W]=(0,_.useTransition)(),[H,J]=(0,_.useState)(),{baiPaginationOption:U,tablePaginationOption:Y,setTablePaginationOption:ee}=(0,s.w4)({current:1,pageSize:20}),[te,ne]=(0,_.useState)(),[le,ae]=(0,i.Tw)("first"),[ie]=(0,_.useState)("network-only"),{allSftpScalingGroups:re}=(0,o.Bk)(),{agent_summary_list:se}=(0,K.useLazyLoadQuery)(void 0!==l?l:l=n(54987),{limit:U.limit,offset:U.offset,filter:H,order:te,status:Q},{fetchKey:le,fetchPolicy:ie}),oe=L().filter(null===se||void 0===se?void 0:se.items,(e=>!L().includes(re,null===e||void 0===e?void 0:e.scaling_group))),ue=[{title:(0,z.jsx)(z.Fragment,{children:"ID"}),key:"id",dataIndex:"id",fixed:"left",render:(e,t)=>(0,z.jsx)(g.A,{direction:"column",align:"start",children:(0,z.jsx)(j.A.Text,{children:e})}),sorter:!0},{title:F("agent.Architecture"),key:"architecture",dataIndex:"architecture"},{title:F("agent.Allocation"),key:"allocation",render:(e,t)=>{const n=JSON.parse((null===t||void 0===t?void 0:t.occupied_slots)||"{}"),l=JSON.parse((null===t||void 0===t?void 0:t.available_slots)||"{}");return(0,z.jsx)(g.A,{direction:"column",gap:"xxs",children:L().map(l,((e,t)=>{if("cpu"===t){var i;const e=L().toFinite(L().toNumber(n.cpu)/L().toNumber(l.cpu)*100);return(0,z.jsxs)(g.A,{justify:"between",style:{minWidth:220},children:[(0,z.jsxs)(g.A,{gap:"xxs",children:[(0,z.jsx)(p.s,{type:t},t),(0,z.jsxs)(j.A.Text,{children:[(0,a.Z1)(n.cpu||0,0),"/",(0,a.Z1)(l.cpu||0,0)]}),(0,z.jsx)(j.A.Text,{type:"secondary",style:{fontSize:N.sizeXS},children:null===V||void 0===V||null===(i=V.cpu)||void 0===i?void 0:i.display_unit})]}),(0,z.jsx)(d.A,{percent:e,strokeColor:e>80?N.colorError:N.colorSuccess,width:120,valueLabel:(0,a.Z1)(e,1)+" %"})]},t)}if("mem"===t){var r,s,o,u;const e=L().toFinite(L().toNumber(n.mem)/L().toNumber(l.mem)*100);return(0,z.jsxs)(g.A,{justify:"between",style:{minWidth:220},children:[(0,z.jsxs)(g.A,{gap:"xxs",children:[(0,z.jsx)(p.s,{type:"mem"}),(0,z.jsxs)(j.A.Text,{children:[null!==(r=null===(s=(0,a.Is)(n.mem,"g",0))||void 0===s?void 0:s.numberFixed)&&void 0!==r?r:0,"/",null!==(o=null===(u=(0,a.Is)(l.mem,"g",0))||void 0===u?void 0:u.numberFixed)&&void 0!==o?o:0]}),(0,z.jsx)(j.A.Text,{type:"secondary",style:{fontSize:N.sizeXS},children:"GiB"})]}),(0,z.jsx)(d.A,{percent:e,strokeColor:e>80?N.colorError:N.colorSuccess,width:120,valueLabel:(0,a.Z1)(e,1)+" %"})]},"mem")}if(l[t]){var c;const e=L().toFinite(L().toNumber(n[t])/L().toNumber(l[t])*100);return(0,z.jsxs)(g.A,{justify:"between",style:{minWidth:220},gap:"xxs",children:[(0,z.jsxs)(g.A,{gap:"xxs",children:[(0,z.jsx)(p.s,{type:t},t),(0,z.jsxs)(j.A.Text,{children:[(0,a.Z1)(n[t]||0,2),"/",(0,a.Z1)(l[t],2)]}),(0,z.jsx)(j.A.Text,{type:"secondary",style:{fontSize:N.sizeXS},children:null===V||void 0===V||null===(c=V[t])||void 0===c?void 0:c.display_unit})]}),(0,z.jsx)(d.A,{percent:e,strokeColor:e>80?N.colorError:N.colorSuccess,width:120,valueLabel:(0,a.Z1)(e,1)+" %"})]},t)}}))})}},{title:F("general.ResourceGroup"),key:"scaling_group",dataIndex:"scaling_group",sorter:!0},{title:F("agent.Schedulable"),key:"schedulable",dataIndex:"schedulable",render:e=>(0,z.jsx)(g.A,{justify:"center",children:!0===e?(0,z.jsx)(h.A,{style:{color:N.colorSuccess,fontSize:N.fontSizeXL}}):(0,z.jsx)(f.A,{style:{color:N.colorTextDisabled,fontSize:N.fontSizeXL}})}),sorter:!0}],[de,ce]=(0,u.a)("AgentSummaryList");return(0,z.jsxs)(g.A,{direction:"column",align:"stretch",style:t,children:[(0,z.jsxs)(g.A,{justify:"between",align:"start",gap:"xs",style:{padding:N.paddingXS},wrap:"wrap",children:[(0,z.jsxs)(g.A,{direction:"row",gap:"sm",align:"start",style:{flex:1},wrap:"wrap",children:[(0,z.jsx)(m.A,{options:[{label:F("agent.Connected"),value:"ALIVE"},{label:F("agent.Terminated"),value:"TERMINATED"}],value:R?q:Q,onChange:e=>{const t=e.target.value;G(t),E((()=>{Z(t)}))}}),(0,z.jsx)(c.Ay,{filterProperties:[{key:"id",propertyLabel:"ID",type:"string"},{key:"schedulable",propertyLabel:F("agent.Schedulable"),type:"boolean",options:[{label:F("general.Enabled"),value:"true"},{label:F("general.Disabled"),value:"false"}]}],value:H,onChange:e=>{W((()=>{J(e)}))}})]}),(0,z.jsx)(g.A,{gap:"xs",children:(0,z.jsx)(k.A,{title:F("button.Refresh"),children:(0,z.jsx)(w.Ay,{loading:O,onClick:()=>X((()=>{ae()})),icon:(0,z.jsx)(x.A,{})})})})]}),(0,z.jsx)(T.A,{bordered:!0,scroll:{x:"max-content"},rowKey:"id",dataSource:(0,a.tS)(oe),showSorterTooltip:!1,columns:L().filter(ue,(e=>!L().includes(de,L().toString(null===e||void 0===e?void 0:e.key)))),pagination:{pageSize:Y.pageSize,showSizeChanger:!0,total:null===se||void 0===se?void 0:se.total_count,current:Y.current,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`,pageSizeOptions:["10","20","50"],style:{marginRight:N.marginXS}},onChange:(e,t,n)=>{let{pageSize:l,current:i}=e;P((()=>{L().isNumber(i)&&L().isNumber(l)&&ee({current:i,pageSize:l}),ne((0,a.Wh)(n))}))},loading:{spinning:B||R||M,indicator:(0,z.jsx)(b.A,{})},...C}),(0,z.jsx)(g.A,{justify:"end",style:{padding:N.paddingXXS},children:(0,z.jsx)(w.Ay,{type:"text",icon:(0,z.jsx)(v.A,{}),onClick:()=>{D()}})}),(0,z.jsx)(y.A,{open:$,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&ce(L().difference(ue.map((e=>L().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),D()},columns:ue,hiddenColumnKeys:de})]})};var N=n(70554),V=n(60073),$=n(47174);const D=(0,$.withDefault)($.StringParam,"agent-summary"),R=e=>{const{t:t}=(0,I.Bd)(),[n,l]=(0,$.useQueryParam)("tab",D,{updateType:"replace"}),{token:a}=A.A.useToken();return(0,z.jsx)(N.A,{activeTabKey:n,onTabChange:e=>l(e),tabList:[{key:"agent-summary",tab:t("webui.menu.AgentSummary")}],styles:{body:{padding:0,paddingTop:1,overflow:"hidden"}},children:"agent-summary"===n?(0,z.jsx)(_.Suspense,{fallback:(0,z.jsx)(V.A,{active:!0,style:{padding:a.paddingContentVerticalLG}}),children:(0,z.jsx)(F,{containerStyle:{marginLeft:-1,marginRight:-1}})}):null})}},51142:(e,t,n)=>{n.d(t,{A:()=>o});var l=n(81679),a=n(55202);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"};var r=n(42688),s=function(e,t){return a.createElement(r.A,(0,l.A)({},e,{ref:t,icon:i}))};const o=a.forwardRef(s)}}]);
//# sourceMappingURL=6170.e19e34d3.chunk.js.map