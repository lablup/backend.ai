"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[3473],{34458:(e,t,n)=>{n.a(e,(async(e,l)=>{try{n.d(t,{A:()=>V});var a,i=n(72375),r=n(23441),s=n(7971),o=n(54690),u=n(69949),d=n(53767),c=n(95762),m=n(8570),g=n(72338),y=n(42388),p=n(74325),f=n(30788),x=n(42926),h=n(99159),b=n(68260),S=n(61539),A=n(11956),v=n(66596),k=n(12221),j=n(35111),w=n(2556),T=n(91043),_=n(8656),L=n(46976),C=n.n(L),z=n(55093),K=n(33364),F=n(63821),N=n(79569),I=e([d]);d=(I.then?(await I)():I)[0];const V=e=>{let{containerStyle:t,tableProps:l}=e;const{t:L}=(0,K.Bd)(),{token:I}=v.A.useToken(),{mergedResourceSlots:V}=(0,s.Hv)(),[$,{toggle:X}]=(0,A.A)(),[D,P]=(0,z.useTransition)(),[E,O]=(0,z.useTransition)(),[Q,R]=(0,z.useTransition)(),[Z,q]=(0,z.useState)("ALIVE"),[B,W]=(0,z.useState)(Z),[G,J]=(0,z.useTransition)(),[M,H]=(0,z.useState)(),{baiPaginationOption:U,tablePaginationOption:Y,setTablePaginationOption:ee}=(0,o.w4)({current:1,pageSize:20}),[te,ne]=(0,z.useState)(),[le,ae]=(0,r.Tw)("first"),[ie]=(0,z.useState)("network-only"),re=(0,r.CX)(),{agent_summary_list:se}=(0,F.useLazyLoadQuery)(void 0!==a?a:a=n(25669),{limit:U.limit,offset:U.offset,filter:M,order:te,status:Z},{fetchKey:le,fetchPolicy:ie}),{data:oe}=(0,u.nj)({queryKey:["baiClient.setting.list"],queryFn:()=>(0,i.hu)({method:"POST",url:"/config/get",body:{key:"volumes/proxies",prefix:!0},client:re})}),ue=C().flatMap(null===oe||void 0===oe?void 0:oe.result,(e=>C().get(e,"sftp_scaling_groups",null))).filter(Boolean),de=C().filter(null===se||void 0===se?void 0:se.items,(e=>!C().includes(ue,null===e||void 0===e?void 0:e.scaling_group))),ce=[{title:"#",fixed:"left",render:(e,t,n)=>n+1+(Y.current-1)*Y.pageSize,showSorterTooltip:!1,rowScope:"row"},{title:(0,N.jsx)(N.Fragment,{children:"ID"}),key:"id",dataIndex:"id",fixed:"left",render:(e,t)=>(0,N.jsx)(g.A,{direction:"column",align:"start",children:(0,N.jsx)(k.A.Text,{children:e})}),sorter:!0},{title:L("agent.Architecture"),key:"architecture",dataIndex:"architecture"},{title:L("agent.Allocation"),key:"allocation",render:(e,t)=>{const n=JSON.parse((null===t||void 0===t?void 0:t.occupied_slots)||"{}"),l=JSON.parse((null===t||void 0===t?void 0:t.available_slots)||"{}");return(0,N.jsx)(g.A,{direction:"column",gap:"xxs",children:C().map(l,((e,t)=>{if("cpu"===t){var a;const e=C().toFinite(C().toNumber(n.cpu)/C().toNumber(l.cpu)*100);return(0,N.jsxs)(g.A,{justify:"between",style:{minWidth:220},children:[(0,N.jsxs)(g.A,{gap:"xxs",children:[(0,N.jsx)(y.s,{type:t},t),(0,N.jsxs)(k.A.Text,{children:[(0,i.Z1)(n.cpu||0,0),"/",(0,i.Z1)(l.cpu||0,0)]}),(0,N.jsx)(k.A.Text,{type:"secondary",style:{fontSize:I.sizeXS},children:null===V||void 0===V||null===(a=V.cpu)||void 0===a?void 0:a.display_unit})]}),(0,N.jsx)(c.A,{percent:e,strokeColor:e>80?I.colorError:I.colorSuccess,width:120,valueLabel:(0,i.Z1)(e,1)+" %"})]},t)}if("mem"===t){var r,s,o,u;const e=C().toFinite(C().toNumber(n.mem)/C().toNumber(l.mem)*100);return(0,N.jsxs)(g.A,{justify:"between",style:{minWidth:220},children:[(0,N.jsxs)(g.A,{gap:"xxs",children:[(0,N.jsx)(y.s,{type:"mem"}),(0,N.jsxs)(k.A.Text,{children:[null!==(r=null===(s=(0,i.Is)(n.mem,"g",0))||void 0===s?void 0:s.numberFixed)&&void 0!==r?r:0,"/",null!==(o=null===(u=(0,i.Is)(l.mem,"g",0))||void 0===u?void 0:u.numberFixed)&&void 0!==o?o:0]}),(0,N.jsx)(k.A.Text,{type:"secondary",style:{fontSize:I.sizeXS},children:"GiB"})]}),(0,N.jsx)(c.A,{percent:e,strokeColor:e>80?I.colorError:I.colorSuccess,width:120,valueLabel:(0,i.Z1)(e,1)+" %"})]},"mem")}if(l[t]){var d;const e=C().toFinite(C().toNumber(n[t])/C().toNumber(l[t])*100);return(0,N.jsxs)(g.A,{justify:"between",style:{minWidth:220},gap:"xxs",children:[(0,N.jsxs)(g.A,{gap:"xxs",children:[(0,N.jsx)(y.s,{type:t},t),(0,N.jsxs)(k.A.Text,{children:[(0,i.Z1)(n[t]||0,2),"/",(0,i.Z1)(l[t],2)]}),(0,N.jsx)(k.A.Text,{type:"secondary",style:{fontSize:I.sizeXS},children:null===V||void 0===V||null===(d=V[t])||void 0===d?void 0:d.display_unit})]}),(0,N.jsx)(c.A,{percent:e,strokeColor:e>80?I.colorError:I.colorSuccess,width:120,valueLabel:(0,i.Z1)(e,1)+" %"})]},t)}}))})}},{title:L("agent.Schedulable"),key:"schedulable",dataIndex:"schedulable",render:e=>(0,N.jsx)(g.A,{justify:"center",children:!0===e?(0,N.jsx)(f.A,{style:{color:I.colorSuccess,fontSize:I.fontSizeXL}}):(0,N.jsx)(x.A,{style:{color:I.colorTextDisabled,fontSize:I.fontSizeXL}})}),sorter:!0}],[me,ge]=(0,d.a)("AgentSummaryList");return(0,N.jsxs)(g.A,{direction:"column",align:"stretch",style:t,children:[(0,N.jsxs)(g.A,{justify:"between",align:"start",gap:"xs",style:{padding:I.paddingXS},wrap:"wrap",children:[(0,N.jsxs)(g.A,{direction:"row",gap:"sm",align:"start",style:{flex:1},wrap:"wrap",children:[(0,N.jsx)(j.A,{options:[{label:L("agent.Connected"),value:"ALIVE"},{label:L("agent.Terminated"),value:"TERMINATED"}],value:D?B:Z,onChange:e=>{W(e),P((()=>{q(e)}))}}),(0,N.jsx)(m.Ay,{filterProperties:[{key:"id",propertyLabel:"ID",type:"string"},{key:"schedulable",propertyLabel:L("agent.Schedulable"),type:"boolean",options:[{label:L("general.Enabled"),value:"true"},{label:L("general.Disabled"),value:"false"}]}],value:M,onChange:e=>{J((()=>{H(e)}))}})]}),(0,N.jsx)(g.A,{gap:"xs",children:(0,N.jsx)(w.A,{title:L("button.Refresh"),children:(0,N.jsx)(T.Ay,{loading:E,onClick:()=>O((()=>{ae()})),icon:(0,N.jsx)(h.A,{})})})})]}),(0,N.jsx)(_.A,{bordered:!0,scroll:{x:"max-content"},rowKey:"id",dataSource:(0,i.tS)(de),showSorterTooltip:!1,columns:C().filter(ce,(e=>!C().includes(me,C().toString(null===e||void 0===e?void 0:e.key)))),pagination:{pageSize:Y.pageSize,showSizeChanger:!0,total:null===se||void 0===se?void 0:se.total_count,current:Y.current,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`,pageSizeOptions:["10","20","50"],style:{marginRight:I.marginXS}},onChange:(e,t,n)=>{let{pageSize:l,current:a}=e;R((()=>{C().isNumber(a)&&C().isNumber(l)&&ee({current:a,pageSize:l}),ne((0,i.Wh)(n))}))},loading:{spinning:Q||D||G,indicator:(0,N.jsx)(b.A,{})},...l}),(0,N.jsx)(g.A,{justify:"end",style:{padding:I.paddingXXS},children:(0,N.jsx)(T.Ay,{type:"text",icon:(0,N.jsx)(S.A,{}),onClick:()=>{X()}})}),(0,N.jsx)(p.A,{open:$,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&ge(C().difference(ce.map((e=>C().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),X()},columns:ce,hiddenColumnKeys:me})]})};l()}catch(V){l(V)}}))},25669:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});const l=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},t={defaultValue:null,kind:"LocalArgument",name:"limit"},n={defaultValue:null,kind:"LocalArgument",name:"offset"},l={defaultValue:null,kind:"LocalArgument",name:"order"},a={defaultValue:null,kind:"LocalArgument",name:"status"},i=[{alias:null,args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"order",variableName:"order"},{kind:"Variable",name:"status",variableName:"status"}],concreteType:"AgentSummaryList",kind:"LinkedField",name:"agent_summary_list",plural:!1,selections:[{alias:null,args:null,concreteType:"AgentSummary",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"available_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"occupied_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"scaling_group",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"schedulable",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,t,n,l,a],kind:"Fragment",metadata:null,name:"AgentSummaryListQuery",selections:i,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,n,e,a,l],kind:"Operation",name:"AgentSummaryListQuery",selections:i},params:{cacheID:"caaf8909248bac69bce5c748e6d28032",id:null,metadata:{},name:"AgentSummaryListQuery",operationKind:"query",text:"query AgentSummaryListQuery(\n  $limit: Int!\n  $offset: Int!\n  $filter: String\n  $status: String\n  $order: String\n) {\n  agent_summary_list(limit: $limit, offset: $offset, filter: $filter, status: $status, order: $order) {\n    items {\n      id\n      status\n      architecture\n      available_slots\n      occupied_slots\n      scaling_group\n      schedulable\n    }\n    total_count\n  }\n}\n"}}}();l.hash="dab7ef4f1205af54a6f80ce0d28098c7";const a=l},63473:(e,t,n)=>{n.a(e,(async(e,l)=>{try{n.r(t),n.d(t,{default:()=>y});var a=n(34458),i=n(66596),r=n(80963),s=n(16954),o=n(55093),u=n(33364),d=n(2647),c=n(79569),m=e([a]);a=(m.then?(await m)():m)[0];const g=(0,d.withDefault)(d.StringParam,"agent-summary"),y=e=>{const{t:t}=(0,u.Bd)(),[n,l]=(0,d.useQueryParam)("tab",g,{updateType:"replace"}),{token:m}=i.A.useToken();return(0,c.jsx)(r.A,{activeTabKey:n,onTabChange:e=>l(e),tabList:[{key:"agent-summary",tab:t("webui.menu.AgentSummary")}],styles:{body:{padding:0,paddingTop:1,overflow:"hidden"}},children:"agent-summary"===n?(0,c.jsx)(o.Suspense,{fallback:(0,c.jsx)(s.A,{active:!0,style:{padding:m.paddingContentVerticalLG}}),children:(0,c.jsx)(a.A,{containerStyle:{marginLeft:-1,marginRight:-1}})}):null})};l()}catch(g){l(g)}}))}}]);
//# sourceMappingURL=3473.6d54e2e4.chunk.js.map