"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[2959],{7064:(e,t,n)=>{n.d(t,{A:()=>L});var a,s=n(56276),i=n(11863),o=n(7871),l=n(39120),c=n(89353),r=n(84423),d=n(76591),g=n(96223),u=n(42286),m=n(78428),h=n(82609),p=n(30782),x=n(31035),b=n(84791),v=n(67631),y=n(84765),j=n(47699),A=n.n(j),k=n(17534),f=n(89374);const S=(0,b.rU)((e=>{let{css:t}=e;return{baiSettingItemCheckbox:t(a||(a=(0,o.A)(["\n    .ant-checkbox {\n      align-self: flex-start;\n      margin-top: 0.2rem;\n    }\n  "])))}})),C=e=>{const t=(0,l.c)(71),{"data-testid":n,type:a,title:i,description:o,children:b,defaultValue:j,value:C,onChange:w,onReset:R,selectProps:T,checkboxProps:I,showResetButton:O}=e,_=void 0===O||O,{token:B}=d.A.useToken(),{styles:E}=S(),[P,M]=(0,k.useState)(!1),[D,F]=(0,r.A)(!1),{toggle:L}=F;let N,z,U,W,G,X,V,K,Y,Q,Z,q,H,J,$,ee,te,ne,ae,se,ie;if(t[0]!==(null===I||void 0===I?void 0:I.disabled)||t[1]!==j||t[2]!==w||t[3]!==R||t[4]!==(null===T||void 0===T?void 0:T.disabled)||t[5]!==a){let e;t[8]!==j||t[9]!==w||t[10]!==R?(e=()=>{R?R():N&&w&&w(j)},t[8]=j,t[9]=w,t[10]=R,t[11]=e):e=t[11],z=e,N="select"===a&&!(null!==T&&void 0!==T&&T.disabled)||"checkbox"===a&&!(null!==I&&void 0!==I&&I.disabled)||"custom"===a,t[0]=null===I||void 0===I?void 0:I.disabled,t[1]=j,t[2]=w,t[3]=R,t[4]=null===T||void 0===T?void 0:T.disabled,t[5]=a,t[6]=N,t[7]=z}else N=t[6],z=t[7];return t[12]===Symbol.for("react.memo_cache_sentinel")?(U=()=>M(!0),W=()=>M(!1),t[12]=U,t[13]=W):(U=t[12],W=t[13]),t[14]!==B.fontSize?(G={fontSize:B.fontSize},t[14]=B.fontSize,t[15]=G):G=t[15],t[16]!==G||t[17]!==i?(X=(0,f.jsx)(g.A.Text,{strong:!0,style:G,children:i}),t[16]=G,t[17]=i,t[18]=X):X=t[18],t[19]!==j||t[20]!==N||t[21]!==C?(V=N&&void 0!==C&&null!==C&&j!==C&&(0,f.jsx)(u.A,{dot:!0,status:"warning"}),t[19]=j,t[20]=N,t[21]=C,t[22]=V):V=t[22],t[23]!==P||t[24]!==N||t[25]!==L||t[26]!==_?(K=N&&_&&(0,f.jsx)(m.A,{menu:{items:[{key:"reset",label:(0,y.t)("button.Reset"),onClick:()=>L(),danger:!0}]},placement:"topLeft",onOpenChange:e=>e&&M(!0),children:(0,f.jsx)(v.Fv,{icon:(0,f.jsx)(c.A,{}),type:"text",style:{width:20,height:20,opacity:P?1:0,transition:"opacity 0.2s ease-in-out"}})}),t[23]=P,t[24]=N,t[25]=L,t[26]=_,t[27]=K):K=t[27],t[28]!==X||t[29]!==V||t[30]!==K?(Y=(0,f.jsx)(v.OO,{direction:"row",gap:"xxs",children:(0,f.jsxs)(v.OO,{gap:"xxs",align:"start",children:[X,V,K]})}),t[28]=X,t[29]=V,t[30]=K,t[31]=Y):Y=t[31],t[32]!==b||t[33]!==o||t[34]!==a?(Q="custom"===a&&(0,f.jsxs)(v.OO,{direction:"column",gap:"xs",align:"start",style:{width:"100%"},children:[o,b]}),t[32]=b,t[33]=o,t[34]=a,t[35]=Q):Q=t[35],t[36]!==I||t[37]!==o||t[38]!==w||t[39]!==E||t[40]!==a||t[41]!==C?(Z="checkbox"===a&&(0,f.jsx)(h.A,(0,s.A)((0,s.A)({className:E.baiSettingItemCheckbox,checked:C,onChange:e=>{null===w||void 0===w||w(e.target.checked)}},I),{},{children:(0,f.jsx)(g.A.Text,{type:null!==I&&void 0!==I&&I.disabled?"secondary":void 0,children:o})})),t[36]=I,t[37]=o,t[38]=w,t[39]=E,t[40]=a,t[41]=C,t[42]=Z):Z=t[42],t[43]!==o||t[44]!==w||t[45]!==T||t[46]!==B.marginXS||t[47]!==a||t[48]!==C?(q="select"===a&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(g.A.Text,{type:null!==T&&void 0!==T&&T.disabled?"secondary":void 0,children:o}),(0,f.jsx)(p.A,(0,s.A)({value:C,popupMatchSelectWidth:!1,onChange:e=>{null===w||void 0===w||w(e)},style:(0,s.A)({marginTop:B.marginXS},null===T||void 0===T?void 0:T.style)},A().omit(T,["style"])))]}),t[43]=o,t[44]=w,t[45]=T,t[46]=B.marginXS,t[47]=a,t[48]=C,t[49]=q):q=t[49],t[50]===Symbol.for("react.memo_cache_sentinel")?(H=(0,y.t)("dialog.ask.DoYouWantToResetChanges"),J=(0,y.t)("button.Reset"),$={danger:!0},t[50]=H,t[51]=J,t[52]=$):(H=t[50],J=t[51],$=t[52]),t[53]!==z||t[54]!==L?(ee=()=>{z(),L()},t[53]=z,t[54]=L,t[55]=ee):ee=t[55],t[56]===Symbol.for("react.memo_cache_sentinel")?(te=(0,y.t)("button.Cancel"),t[56]=te):te=t[56],t[57]!==L?(ne=()=>L(),t[57]=L,t[58]=ne):ne=t[58],t[59]===Symbol.for("react.memo_cache_sentinel")?(ae=(0,f.jsx)(x.A,{showIcon:!0,message:(0,y.t)("dialog.warning.CannotBeUndone"),type:"warning"}),t[59]=ae):ae=t[59],t[60]!==D||t[61]!==ee||t[62]!==ne?(se=(0,f.jsx)(v.Ib,{open:D,title:H,okText:J,okButtonProps:$,onOk:ee,cancelText:te,onCancel:ne,children:ae}),t[60]=D,t[61]=ee,t[62]=ne,t[63]=se):se=t[63],t[64]!==n||t[65]!==Q||t[66]!==Z||t[67]!==q||t[68]!==se||t[69]!==Y?(ie=(0,f.jsxs)(v.OO,{"data-testid":n,direction:"column",align:"start",gap:"xxs",onMouseEnter:U,onMouseLeave:W,children:[Y,Q,Z,q,se]}),t[64]=n,t[65]=Q,t[66]=Z,t[67]=q,t[68]=se,t[69]=Y,t[70]=ie):ie=t[70],ie};var w=n(9157),R=n(21153),T=n(72245),I=n(90711),O=n(39763),_=n(73635),B=n(62962);const E=["group","hideEmpty"];var P;const M=(0,b.rU)((e=>{let{css:t}=e;return{TabStyles:t(P||(P=(0,o.A)(["\n    .ant-tabs-tab-active {\n      font-weight: var(--token-fontWeightSuperStrong, 700);\n    }\n    .ant-typography-secondary {\n      font-weight: normal !important;\n    }\n  "])))}})),D=e=>{let{title:t,count:n}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(g.A.Text,{children:t}),(0,f.jsx)(g.A.Text,{type:"secondary",children:" (".concat(n,")")})]})},F=e=>{let{group:t,hideEmpty:n=!0}=e,a=(0,i.A)(e,E);const{token:o}=d.A.useToken();return(!n||0!==t.settingItems.length)&&(0,f.jsxs)(v.OO,(0,s.A)((0,s.A)({direction:"column",align:"stretch",style:{marginBottom:o.marginMD}},a),{},{children:[(0,f.jsxs)(v.OO,{direction:"column",align:"stretch",style:{zIndex:1,marginBottom:o.marginMD,background:o.colorBgContainer},children:[(0,f.jsx)(v.OO,{align:"start",justify:"between",children:(0,f.jsxs)(v.OO,{gap:"sm",align:"start",children:[(0,f.jsx)(g.A.Title,{level:5,style:{marginTop:0},children:t.title}),t.titleExtra&&(0,f.jsx)("div",{children:t.titleExtra})]})}),(0,f.jsx)(T.A,{style:{marginTop:0,marginBottom:0}}),t.description&&(0,f.jsx)(g.A.Text,{type:"secondary",style:{marginTop:o.marginSM},children:t.description})]}),(0,f.jsxs)(v.OO,{direction:"column",align:"stretch",gap:"lg",children:[t.alert,t.settingItems.map(((e,t)=>(0,f.jsx)(C,(0,s.A)({},e),e.title+t)))]})]}))},L=e=>{const t=(0,l.c)(96),{settingGroups:n,tabDirection:a,showChangedOptionFilter:i,showResetButton:o,showSearchBar:c,primaryButton:d,extraButton:g}=e,u=void 0===a?"left":a,{t:m}=(0,B.Bd)(),{styles:p}=M(),[b,y]=(0,k.useState)(""),[j,S]=(0,k.useState)(!1),[C,T]=(0,r.A)(!1),{toggle:E}=T,[P,L]=(0,k.useState)("all");let G;t[0]!==b?(G=e=>e.title.toLowerCase().includes(b.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(b.toLowerCase()),t[0]=b,t[1]=G):G=t[1];const X=G,V=z;let K,Y,Q,Z,q,H,J,$,ee,te,ne,ae,se,ie,oe,le,ce,re,de,ge,ue,me,he,pe;if(t[2]!==P||t[3]!==j||t[4]!==g||t[5]!==d||t[6]!==b||t[7]!==X||t[8]!==E||t[9]!==n||t[10]!==i||t[11]!==o||t[12]!==c||t[13]!==p.TabStyles||t[14]!==m||t[15]!==u){let e;t[28]!==j||t[29]!==X?(e=e=>(0,s.A)((0,s.A)({},e),{},{settingItems:A().filter(e.settingItems,(e=>(!j||V(e))&&X(e)))}),t[28]=j,t[29]=X,t[30]=e):e=t[30];const a=A().map(n,e);let l,r,x,k,C;Y=v.OO,Q="column",Z="md",q="stretch",t[31]!==b||t[32]!==c||t[33]!==m?(l=!!c&&(0,f.jsx)(I.A,{prefix:(0,f.jsx)(w.A,{}),placeholder:m("settings.SearchPlaceholder"),onChange:e=>y(e.target.value),value:b}),t[31]=b,t[32]=c,t[33]=m,t[34]=l):l=t[34],t[35]!==i||t[36]!==m?(r=!!i&&(0,f.jsx)(h.A,{onChange:e=>S(e.target.checked),style:{whiteSpace:"nowrap"},children:m("settings.ShowOnlyChanged")}),t[35]=i,t[36]=m,t[37]=r):r=t[37],t[38]!==E||t[39]!==o||t[40]!==m?(x=!!o&&(0,f.jsx)(v.Fv,{danger:!0,icon:(0,f.jsx)(R.A,{}),onClick:()=>E(),children:m("button.Reset")}),t[38]=E,t[39]=o,t[40]=m,t[41]=x):x=t[41],t[42]!==g||t[43]!==d||t[44]!==l||t[45]!==r||t[46]!==x?(H=(0,f.jsxs)(v.OO,{justify:"start",gap:"xs",children:[l,r,g,x,d]}),t[42]=g,t[43]=d,t[44]=l,t[45]=r,t[46]=x,t[47]=H):H=t[47],K=O.A,J=P,$=L,ee=p.TabStyles,te=u?"left":"top",t[48]===Symbol.for("react.memo_cache_sentinel")?(ne={minWidth:200},t[48]=ne):ne=t[48],t[49]!==m?(k=m("general.All"),t[49]=m,t[50]=k):k=t[50],t[51]!==E||t[52]!==m?(C=(e,t)=>({key:"index".concat(t),label:(0,f.jsx)(D,{title:e.title,count:e.settingItems.length}),children:(0,f.jsx)(v.OO,{direction:"column",align:"stretch",gap:"xl",children:e.settingItems.length>0?(0,f.jsx)(F,{group:e,hideEmpty:!0,onReset:()=>{E()}}):(0,f.jsx)(_.A,{image:_.A.PRESENTED_IMAGE_SIMPLE,description:m("settings.NoChangesToDisplay")})})}),t[51]=E,t[52]=m,t[53]=C):C=t[53],ae=[{key:"all",label:(0,f.jsx)(D,{title:k,count:A().sumBy(a,U)}),children:(0,f.jsx)(v.OO,{direction:"column",align:"stretch",gap:"xl",children:A().sumBy(a,W)>0?A().map(a,(e=>(0,f.jsx)(F,{"data-testid":null===e||void 0===e?void 0:e["data-testid"],group:e,hideEmpty:!0,onReset:()=>{E()}},e.title))):(0,f.jsx)(_.A,{image:_.A.PRESENTED_IMAGE_SIMPLE,description:m("settings.NoChangesToDisplay")})})},...A().map(a,C)],t[2]=P,t[3]=j,t[4]=g,t[5]=d,t[6]=b,t[7]=X,t[8]=E,t[9]=n,t[10]=i,t[11]=o,t[12]=c,t[13]=p.TabStyles,t[14]=m,t[15]=u,t[16]=K,t[17]=Y,t[18]=Q,t[19]=Z,t[20]=q,t[21]=H,t[22]=J,t[23]=$,t[24]=ee,t[25]=te,t[26]=ne,t[27]=ae}else K=t[16],Y=t[17],Q=t[18],Z=t[19],q=t[20],H=t[21],J=t[22],$=t[23],ee=t[24],te=t[25],ne=t[26],ae=t[27];return t[54]!==K||t[55]!==J||t[56]!==$||t[57]!==ee||t[58]!==te||t[59]!==ne||t[60]!==ae?(se=(0,f.jsx)(K,{activeKey:J,onChange:$,className:ee,tabPosition:te,tabBarStyle:ne,items:ae}),t[54]=K,t[55]=J,t[56]=$,t[57]=ee,t[58]=te,t[59]=ne,t[60]=ae,t[61]=se):se=t[61],t[62]!==Y||t[63]!==Q||t[64]!==Z||t[65]!==q||t[66]!==H||t[67]!==se?(ie=(0,f.jsxs)(Y,{direction:Q,gap:Z,align:q,children:[H,se]}),t[62]=Y,t[63]=Q,t[64]=Z,t[65]=q,t[66]=H,t[67]=se,t[68]=ie):ie=t[68],t[69]!==m?(oe=m("dialog.ask.DoYouWantToResetChanges"),t[69]=m,t[70]=oe):oe=t[70],t[71]!==m?(le=m("button.Reset"),t[71]=m,t[72]=le):le=t[72],t[73]===Symbol.for("react.memo_cache_sentinel")?(ce={danger:!0},t[73]=ce):ce=t[73],t[74]!==E||t[75]!==n?(re=()=>{N(n),E()},t[74]=E,t[75]=n,t[76]=re):re=t[76],t[77]!==m?(de=m("button.Cancel"),t[77]=m,t[78]=de):de=t[78],t[79]!==E?(ge=()=>E(),t[79]=E,t[80]=ge):ge=t[80],t[81]!==m?(ue=m("dialog.warning.CannotBeUndone"),t[81]=m,t[82]=ue):ue=t[82],t[83]!==ue?(me=(0,f.jsx)(x.A,{showIcon:!0,message:ue,type:"warning"}),t[83]=ue,t[84]=me):me=t[84],t[85]!==C||t[86]!==oe||t[87]!==le||t[88]!==re||t[89]!==de||t[90]!==ge||t[91]!==me?(he=(0,f.jsx)(v.Ib,{open:C,title:oe,okText:le,okButtonProps:ce,onOk:re,cancelText:de,onCancel:ge,children:me}),t[85]=C,t[86]=oe,t[87]=le,t[88]=re,t[89]=de,t[90]=ge,t[91]=me,t[92]=he):he=t[92],t[93]!==ie||t[94]!==he?(pe=(0,f.jsxs)(f.Fragment,{children:[ie,he]}),t[93]=ie,t[94]=he,t[95]=pe):pe=t[95],pe},N=e=>{A().flatMap(e,(e=>e.settingItems)).forEach((e=>{var t,n,a;e.onReset?e.onReset():(null===e||void 0===e||null===(t=e.selectProps)||void 0===t||!t.disabled)&&(null===e||void 0===e||null===(n=e.checkboxProps)||void 0===n||!n.disabled)&&(null===e||void 0===e||null===(a=e.onChange)||void 0===a||a.call(e,e.defaultValue))}))};function z(e){var t,n;return!(null===e.value||void 0===e.value||null!==e&&void 0!==e&&null!==(t=e.selectProps)&&void 0!==t&&t.disabled||null!==e&&void 0!==e&&null!==(n=e.checkboxProps)&&void 0!==n&&n.disabled)&&e.value!==e.defaultValue}function U(e){return e.settingItems.length}function W(e){return e.settingItems.length}},21153:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(1139),s=n(17534);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};var o=n(5436),l=function(e,t){return s.createElement(o.A,(0,a.A)({},e,{ref:t,icon:i}))};const c=s.forwardRef(l)},22959:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a=n(40690),s=n(86167),i=n(7064),o=n(21153),l=n(8343),c=n(17534),r=n(62962),d=n(89374);const g=()=>{const[e,t]=(0,c.useState)(!1),[n,g]=(0,c.useState)(!1),{t:u}=(0,r.Bd)(),{upsertNotification:m}=(0,s.js)(),h=(0,a.CX)(),p=[{"data-testid":"maintenance-fix",title:u("maintenance.Fix"),settingItems:[{type:"custom",title:u("maintenance.MatchDatabase"),description:u("maintenance.DescMatchDatabase"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(o.A,{}),onClick:()=>{t(!0),m({message:u("maintenance.RecalculateUsage"),description:u("maintenance.Recalculating"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.recalculate_usage().finally((()=>t(!1))),onChange:{pending:u("maintenance.Recalculating"),resolved:u("maintenance.RecalculationFinished"),rejected:u("maintenance.RecalculationFailed")}}})},loading:e,children:u(e?"maintenance.Recalculating":"maintenance.RecalculateUsage")}),showResetButton:!1}]},{"data-testid":"maintenance-images",title:u("maintenance.ImagesEnvironment"),settingItems:[{type:"custom",title:u("maintenance.RescanImageList"),description:u("maintenance.DescRescanImageList"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(o.A,{}),onClick:()=>{g(!0),m({message:u("maintenance.RescanImages"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.rescan_images(),onChange:{pending:u("maintenance.RescanImageScanning"),resolved:e=>{const t=e;if(t.rescan_images.ok)return{backgroundTask:{status:"pending",taskId:t.rescan_images.task_id,promise:null,percent:0,onChange:{resolved:(e,t)=>(g(!1),u("maintenance.RescanImageFinished"))}},duration:0};throw new Error(u("maintenance.RescanFailed"))},rejected:(e,t)=>{const n=e;return g(!1),(null===n||void 0===n?void 0:n.message)||u("maintenance.RescanFailed")}}}})},loading:n,children:u(n?"maintenance.RescanImageScanning":"maintenance.RescanImages")}),showResetButton:!1}]}];return(0,d.jsx)(i.A,{settingGroups:p,showSearchBar:!0})};var u=n(30332),m=n(67631),h=n(69362),p=n(73233);const x=(0,p.withDefault)(p.StringParam,"maintenance"),b=()=>{const{t:e}=(0,r.Bd)(),[t,n]=(0,p.useQueryParam)("tab",x);return(0,d.jsx)(m.Zu,{activeTabKey:t,onTabChange:e=>n(e),tabList:[{key:"maintenance",tab:e("webui.menu.Maintenance")}],children:(0,d.jsx)(c.Suspense,{fallback:(0,d.jsx)(u.A,{active:!0}),children:"maintenance"===t&&(0,d.jsx)(h.A,{children:(0,d.jsx)(g,{})})})})}}}]);
//# sourceMappingURL=2959.c8390dfa.chunk.js.map