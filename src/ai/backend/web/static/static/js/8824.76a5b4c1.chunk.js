/*! For license information please see 8824.76a5b4c1.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[8824],{69875:(e,n,a)=>{a.d(n,{A:()=>v});var l=a(52280),i=a(77731),t=a(59286),r=a(89608),s=a.n(r),o=a(43373),d=a(85501),u=a(73689);const c=(0,t.rU)((e=>{let{token:n,css:a}=e;return{resizableTable:a`
    .react-resizable-handle {
      position: absolute;
      inset-inline-end: 0px;
      bottom: 0;
      z-index: 1;
      width: 10px;
      height: 100%;
      cursor: col-resize;
    }
    .ant-table-cell {
      overflow: hidden;
      whitespace: 'pre';
      wordwrap: 'break-word';
    }
  `}})),m=e=>{const{onResize:n,width:a,onClick:i,...t}=e,r=(0,o.useRef)(null),[c,m]=(0,o.useState)(!1),g=(0,l.A)(c,{wait:100});return(0,o.useEffect)((()=>{r.current&&s().isUndefined(a)&&(null===n||void 0===n||n(void 0,{size:{width:r.current.offsetWidth,height:r.current.offsetHeight},node:r.current,handle:"e"}))})),s().isUndefined(a)?(0,u.jsx)("th",{ref:r,...t}):(0,u.jsx)(d.Resizable,{width:a,height:0,handle:(0,u.jsx)("span",{className:"react-resizable-handle",onClick:e=>{e.stopPropagation()}}),onResize:n,onResizeStart:()=>{m(!0)},onResizeStop:()=>{m(!1)},draggableOpts:{enableUserSelectHack:!1},children:(0,u.jsx)("th",{onClick:e=>{g?e.preventDefault():null===i||void 0===i||i(e)},...t})})},g=(e,n)=>e.key||`index_${n}`,v=e=>{let{resizable:n=!1,columns:a,components:l,...t}=e;const{styles:r}=c(),[d,v]=(0,o.useState)((e=>{const n={};return s().each(e,((e,a)=>{n[g(e,a)]=e.width})),n})(a)),p=(0,o.useMemo)((()=>n?s().map(a,((e,n)=>({...e,width:d[g(e,n)]||e.width,onHeaderCell:e=>({width:e.width,onResize:(a,l)=>{let{size:i}=l;v((a=>({...a,[g(e,n)]:i.width})))}})}))):a),[n,a,d]);return(0,u.jsx)(i.A,{sortDirections:["descend","ascend","descend"],showSorterTooltip:!1,className:n?r.resizableTable:"",components:n?s().merge(l||{},{header:{cell:m}}):l,columns:p,...t})}},20782:(e,n,a)=>{a.d(n,{A:()=>u});var l=a(89130),i=a(6597),t=a(15934),r=a(89608),s=a.n(r),o=a(43373),d=a(73689);const u=e=>{let n,{values:a=[],highlightKeyword:r}=e;return 0===a.length?null:(n=a[0]&&("string"===typeof a[0]||o.isValidElement(a[0]))?a.map((e=>({label:e,color:"blue"}))):a,(0,d.jsx)(l.A,{direction:"row",children:s().map(n,((e,a)=>s().isEmpty(e.label)?null:(0,d.jsx)(t.A,{style:s().last(n)===e?void 0:{margin:0,marginRight:-1},color:e.color,children:s().isUndefined(r)?e.label:(0,d.jsx)(i.A,{keyword:r,children:e.label})},a)))}))}},40471:(e,n,a)=>{a.d(n,{A:()=>g});var l=a(58879),i=a(7194),t=a(27666),r=a(86917),s=a(69056),o=a(52515),d=a(89608),u=a.n(d),c=a(43373),m=a(73689);const g=e=>{var n;let{dynamicSteps:a=[1,2,4,8,16,32,64,128,256,512],units:d=["m","g","t","p"],disableAutoUnit:g=!1,min:v="0m",max:p="300p",roundStep:y,...h}=e;const[f,k]=(0,i.A)(h,{defaultValue:"0g"}),[x,b]=null===f||void 0===f?[null,null]:(0,l.E8)(f),A=(0,t.A)(b),j=b||A||d[0],[_,S]=(0,l.E8)(v),[C,R]=(0,l.E8)(p),w=(0,c.useRef)(null);return(0,c.useEffect)((()=>{if(w.current){const e=e=>{var n;const a=null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value;/^\d+(g|m)$/.test(a)&&k(a)},n=w.current;return null===n||void 0===n||n.addEventListener("input",e),()=>{null===n||void 0===n||n.removeEventListener("input",e)}}}),[w,x,b,k]),(0,m.jsx)(r.A,{ref:w,...h,onBlur:()=>{if(u().isNumber(y)&&y>0){var e,n,a;const l=(null===(e=y.toString().split(".")[1])||void 0===e?void 0:e.length)||0;if(isNaN(Math.round(u().toNumber((null===(n=w.current)||void 0===n?void 0:n.value)||"0")/y)*y))return;k(`${(Math.round(u().toNumber((null===(a=w.current)||void 0===a?void 0:a.value)||"0")/y)*y).toFixed(l)}${j}`)}},value:x,onChange:e=>{k(null===e||void 0===e?e:`${e}${j}`)},max:R===j?C:null===(n=(0,l.Is)(p,j))||void 0===n?void 0:n.number,min:S===j?_:(0,l.Is)(v,j).number,addonAfter:(0,m.jsx)(s.A,{tabIndex:-1,value:j,onChange:e=>{k(`${x}${e}`)},onDropdownVisibleChange:e=>{(e&&null===f||void 0===f)&&k(`0${j}`)},options:u().map(d,(e=>({value:e,label:(0,m.jsx)(o.A.Text,{style:{fontFamily:"'SFMono-Regular',Consolas,'Liberation Mono',Menlo,Courier,monospace"},children:e.toUpperCase()+"iB"})}))),suffixIcon:d.length>1?void 0:null,open:d.length>1&&void 0,style:{cursor:d.length>1?void 0:"default"}}),step:0,onStep:(e,n)=>{const l=u().isNull(x)||u().isUndefined(x)?0:x,i=u().sortedIndex(u().sortBy(a),l);let t;t="up"===n.type?l===a[i]?i+1:i:i-1;const r=d.indexOf(j);if(!g&&t<0)if(0===r)k(`0${j}`);else{const e=a[a.length-1],n=d[r-1];k(`${e}${n}`)}else if(!g&&t>a.length-1)if(r===d.length-1)k(`${l+("up"===n.type?1:-1)}${R}`);else{const e=a[0],n=d[r+1];k(`${e}${n}`)}else if(t>=0&&t<a.length){let e=a[t];S===j&&e<_?e=_:R===j&&e>C&&(e=C),k(`${e}${j}`)}}})}},69715:(e,n,a)=>{a.d(n,{Ay:()=>h,Jj:()=>f});var l=a(58879),i=a(51593),t=a(20782),r=a(89130),s=a(6597),o=a(15934),d=a(89608),u=a.n(d),c=a(43373),m=a(73689);const g=e=>{let{image:n,...a}=e;n=n||"";const[,{getImageAliasName:l,getBaseVersion:r,tagAlias:s}]=(0,i.Gj)();return(0,m.jsx)(t.A,{values:[{label:s(l(n)),color:"blue"},{label:r(n),color:"green"}],...a})},v=e=>{let{image:n,...a}=e;n=n||"";const[,{getBaseImage:l,tagAlias:t}]=(0,i.Gj)();return u().isEmpty(t(l(n)))?null:(0,m.jsx)(o.A,{color:"green",...a,children:t(l(n))})},p=e=>{let{image:n,...a}=e;n=n||"";const[,{getArchitecture:l,tagAlias:t}]=(0,i.Gj)();return u().isEmpty(t(l(n)))?null:(0,m.jsx)(o.A,{color:"green",...a,children:l(n)})},y=(e,n)=>{let{image:a,style:l={}}=e;return a=a||"",(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(g,{image:a}),(0,m.jsx)(v,{image:a}),(0,m.jsx)(p,{image:a})]})},h=c.memo(y),f=e=>{let{tag:n,labels:a,highlightKeyword:d,...c}=e;a=a||[];const[,{getTags:g,tagAlias:v}]=(0,i.Gj)(),p=g(n,a);return(0,m.jsx)(r.A,{direction:"row",align:"start",children:u().map(p,((e,n)=>{const a="Customized"===e.key,i=v(e.key+e.value);return u().isEqual(i,(0,l.WY)(e.key+e.value))?(0,m.jsx)(t.A,{highlightKeyword:d,values:[{label:v(e.key),color:a?"cyan":"blue"},{label:e.value,color:a?"cyan":"blue"}]},e.key):(0,m.jsx)(o.A,{color:a?"cyan":"blue",children:(0,m.jsx)(s.A,{keyword:d,children:i},n)},e.key)}))})}},76604:(e,n,a)=>{a.d(n,{A:()=>f,s:()=>h});var l=a(58879),i=a(11899),t=a(15634),r=a(89130),s=a(50868),o=a(52515),d=a(33789),u=a(89608),c=a.n(u),m=a(8652),g=a(43373),v=a(73689);const p=e=>{var n,a;let{type:d,value:u,extra:m,opts:g,hideTooltip:p=!1,max:y}=e;const{token:f}=s.A.useToken(),k=(0,t.Nw)(),{mergedResourceSlots:x}=(0,i.Hv)(k||void 0),b=e=>{var n,a,i;return null!==x&&void 0!==x&&null!==(n=x[d])&&void 0!==n&&n.number_format.binary?Number(null===(a=(0,l.Is)(e,"g",3,!0))||void 0===a?void 0:a.numberFixed).toString():((null===x||void 0===x||null===(i=x[d])||void 0===i?void 0:i.number_format.round_length)||0)>0?parseFloat(e).toFixed(2):e};return(0,v.jsxs)(r.A,{direction:"row",gap:"xxs",children:[null!==x&&void 0!==x&&x[d]?(0,v.jsx)(h,{type:d,showTooltip:!p}):d,(0,v.jsxs)(o.A.Text,{children:[b(u),c().isUndefined(y)?null:"Infinity"===y?"~\u221e":`~${b(y)}`]}),(0,v.jsx)(o.A.Text,{type:"secondary",children:(null===x||void 0===x||null===(n=x[d])||void 0===n?void 0:n.display_unit)||""}),"mem"===d&&null!==g&&void 0!==g&&g.shmem&&(null===g||void 0===g?void 0:g.shmem)>0?(0,v.jsxs)(o.A.Text,{type:"secondary",style:{fontSize:f.fontSizeSM},children:["(SHM:"," ",null===(a=(0,l.Is)(g.shmem+"b","g",2,!0))||void 0===a?void 0:a.numberFixed,"GiB)"]}):null,m]})},y=e=>{let{size:n=16,children:a}=e;return(0,v.jsx)("mwc-icon",{style:{"--mdc-icon-size":`${n+2}px`,width:n,height:n},children:a})},h=e=>{var n,a;let{type:l,size:t=16,showIcon:s=!0,showUnit:o=!0,showTooltip:u=!0,...c}=e;const g={cpu:(0,v.jsx)(y,{size:t,children:"developer_board"}),mem:(0,v.jsx)(y,{size:t,children:"memory"}),"cuda.device":"/resources/icons/file_type_cuda.svg","cuda.shares":"/resources/icons/file_type_cuda.svg","rocm.device":"/resources/icons/rocm.svg","tpu.device":(0,v.jsx)(y,{size:t,children:"view_module"}),"ipu.device":(0,v.jsx)(y,{size:t,children:"view_module"}),"atom.device":"/resources/icons/rebel.svg","atom-plus.device":"/resources/icons/rebel.svg","gaudi2.device":"/resources/icons/gaudi.svg","warboy.device":"/resources/icons/furiosa.svg","rngd.device":"/resources/icons/furiosa.svg","hyperaccel-lpu.device":"/resources/icons/npu_generic.svg"},p=null!==(n=g[l])&&void 0!==n?n:(0,v.jsx)(m.A,{}),{mergedResourceSlots:h}=(0,i.Hv)(),f="string"===typeof p?(0,v.jsx)("img",{...c,style:{height:t,alignSelf:"center",...c.style||{}},src:g[l]||"",alt:l}):(0,v.jsx)(r.A,{style:{width:16,height:16},children:p||l});return u?(0,v.jsx)(d.A,{title:(null===(a=h[l])||void 0===a?void 0:a.description)||l,children:f}):(0,v.jsx)(r.A,{style:{pointerEvents:"none"},children:f})},f=g.memo(p)},61087:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"hostname"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"hostname",variableName:"hostname"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateContainerRegistry",kind:"LinkedField",name:"create_container_registry",plural:!1,selections:[{alias:null,args:null,concreteType:"ContainerRegistry",kind:"LinkedField",name:"container_registry",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hostname",storageKey:null},{alias:null,args:null,concreteType:"ContainerRegistryConfig",kind:"LinkedField",name:"config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"project",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"password",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ssl_verify",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ContainerRegistryEditorModalBefore2409CreateMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ContainerRegistryEditorModalBefore2409CreateMutation",selections:n},params:{cacheID:"f21828a823b9278da3fc0a20757ffbcb",id:null,metadata:{},name:"ContainerRegistryEditorModalBefore2409CreateMutation",operationKind:"mutation",text:"mutation ContainerRegistryEditorModalBefore2409CreateMutation(\n  $hostname: String!\n  $props: CreateContainerRegistryInput!\n) {\n  create_container_registry(hostname: $hostname, props: $props) {\n    container_registry {\n      id\n      hostname\n      config {\n        url\n        type\n        project\n        username\n        password\n        ssl_verify\n      }\n    }\n  }\n}\n"}}}();l.hash="83f522a461f69fe3d5e72fe56992bf5b";const i=l},39444:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ContainerRegistryEditorModalBefore2409Fragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hostname",storageKey:null},{alias:null,args:null,concreteType:"ContainerRegistryConfig",kind:"LinkedField",name:"config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"project",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ssl_verify",storageKey:null}],storageKey:null}],type:"ContainerRegistry",abstractKey:null,hash:"1d6d4ae52fe80807408b6c0ea72545a0"},i=l},43293:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"hostname"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"hostname",variableName:"hostname"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyContainerRegistry",kind:"LinkedField",name:"modify_container_registry",plural:!1,selections:[{alias:null,args:null,concreteType:"ContainerRegistry",kind:"LinkedField",name:"container_registry",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hostname",storageKey:null},{alias:null,args:null,concreteType:"ContainerRegistryConfig",kind:"LinkedField",name:"config",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"project",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"password",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ssl_verify",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ContainerRegistryEditorModalBefore2409ModifyMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ContainerRegistryEditorModalBefore2409ModifyMutation",selections:n},params:{cacheID:"388a0a43f6b8ef7fb36e034276e48eba",id:null,metadata:{},name:"ContainerRegistryEditorModalBefore2409ModifyMutation",operationKind:"mutation",text:"mutation ContainerRegistryEditorModalBefore2409ModifyMutation(\n  $hostname: String!\n  $props: ModifyContainerRegistryInput!\n) {\n  modify_container_registry(hostname: $hostname, props: $props) {\n    container_registry {\n      id\n      hostname\n      config {\n        url\n        type\n        project\n        username\n        password\n        ssl_verify\n      }\n    }\n  }\n}\n"}}}();l.hash="7866a8d403db359b43bf7cf9442affd9";const i=l},2326:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"hostname"}],n=[{alias:null,args:[{kind:"Variable",name:"hostname",variableName:"hostname"}],concreteType:"DeleteContainerRegistry",kind:"LinkedField",name:"delete_container_registry",plural:!1,selections:[{alias:null,args:null,concreteType:"ContainerRegistry",kind:"LinkedField",name:"container_registry",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ContainerRegistryListBefore2409DeleteMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ContainerRegistryListBefore2409DeleteMutation",selections:n},params:{cacheID:"7a89a33c0115cf7f5ff9d6b1c04eb7f3",id:null,metadata:{},name:"ContainerRegistryListBefore2409DeleteMutation",operationKind:"mutation",text:"mutation ContainerRegistryListBefore2409DeleteMutation(\n  $hostname: String!\n) {\n  delete_container_registry(hostname: $hostname) {\n    container_registry {\n      id\n    }\n  }\n}\n"}}}();l.hash="730f8ac68060fef479daec8a61f7eb30";const i=l},92169:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e={defaultValue:null,kind:"LocalArgument",name:"allowed_docker_registries"},n={defaultValue:null,kind:"LocalArgument",name:"domain"},a=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"domain"},{fields:[{kind:"Variable",name:"allowed_docker_registries",variableName:"allowed_docker_registries"}],kind:"ObjectValue",name:"props"}],concreteType:"ModifyDomain",kind:"LinkedField",name:"modify_domain",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,n],kind:"Fragment",metadata:null,name:"ContainerRegistryListBefore2409DomainMutation",selections:a,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,e],kind:"Operation",name:"ContainerRegistryListBefore2409DomainMutation",selections:a},params:{cacheID:"c5850fcfa6ce8b87223b284f69ae3f66",id:null,metadata:{},name:"ContainerRegistryListBefore2409DomainMutation",operationKind:"mutation",text:"mutation ContainerRegistryListBefore2409DomainMutation(\n  $domain: String!\n  $allowed_docker_registries: [String]!\n) {\n  modify_domain(name: $domain, props: {allowed_docker_registries: $allowed_docker_registries}) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="4064ba252ad6ddf8da2ef507a8e9df76";const i=l},29930:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"domain"}],n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"hostname",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"project",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"password",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"ssl_verify",storageKey:null},d={alias:null,args:[{kind:"Variable",name:"name",variableName:"domain"}],concreteType:"Domain",kind:"LinkedField",name:"domain",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowed_docker_registries",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ContainerRegistryListBefore2409Query",selections:[{alias:null,args:null,concreteType:"ContainerRegistry",kind:"LinkedField",name:"container_registries",plural:!0,selections:[{args:null,kind:"FragmentSpread",name:"ContainerRegistryEditorModalBefore2409Fragment"},n,a,{alias:null,args:null,concreteType:"ContainerRegistryConfig",kind:"LinkedField",name:"config",plural:!1,selections:[l,i,t,r,s,o],storageKey:null}],storageKey:null},d],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ContainerRegistryListBefore2409Query",selections:[{alias:null,args:null,concreteType:"ContainerRegistry",kind:"LinkedField",name:"container_registries",plural:!0,selections:[n,a,{alias:null,args:null,concreteType:"ContainerRegistryConfig",kind:"LinkedField",name:"config",plural:!1,selections:[l,i,t,r,o,s],storageKey:null}],storageKey:null},d]},params:{cacheID:"ef5b9c798ccb0219aaaa9c4496aca0d0",id:null,metadata:{},name:"ContainerRegistryListBefore2409Query",operationKind:"query",text:"query ContainerRegistryListBefore2409Query(\n  $domain: String!\n) {\n  container_registries {\n    ...ContainerRegistryEditorModalBefore2409Fragment\n    id\n    hostname\n    config {\n      url\n      type\n      project\n      username\n      password\n      ssl_verify\n    }\n  }\n  domain(name: $domain) {\n    name\n    allowed_docker_registries\n  }\n}\n\nfragment ContainerRegistryEditorModalBefore2409Fragment on ContainerRegistry {\n  id\n  hostname\n  config {\n    url\n    type\n    project\n    username\n    ssl_verify\n  }\n}\n"}}}();l.hash="4b60048616461e0148810fd027e9d6ac";const i=l},58368:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},n=[e,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],a=[{alias:null,args:null,concreteType:"Image",kind:"LinkedField",name:"images",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"digest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"installed",storageKey:null},{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"humanized_name",storageKey:null},{alias:null,args:null,concreteType:"ResourceLimit",kind:"LinkedField",name:"resource_limits",plural:!0,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"min",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namespace",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base_image_name",storageKey:null},{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"tags",plural:!0,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ImageListQuery",selections:a,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ImageListQuery",selections:a},params:{cacheID:"5377a9e1eb682509003f0cbca35f4b74",id:null,metadata:{},name:"ImageListQuery",operationKind:"query",text:'query ImageListQuery {\n  images {\n    id\n    name @deprecatedSince(version: "24.12.0")\n    tag\n    registry\n    architecture\n    digest\n    installed\n    labels {\n      key\n      value\n    }\n    humanized_name\n    resource_limits {\n      key\n      min\n      max\n    }\n    namespace @since(version: "24.12.0")\n    base_image_name @since(version: "24.12.0")\n    tags @since(version: "24.12.0") {\n      key\n      value\n    }\n    version @since(version: "24.12.0")\n  }\n}\n'}}}();l.hash="fa384be922b4c222ca7e95ff788b1dec";const i=l},36751:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e={defaultValue:null,kind:"LocalArgument",name:"architecture"},n={defaultValue:null,kind:"LocalArgument",name:"props"},a={defaultValue:null,kind:"LocalArgument",name:"target"},l=[{alias:null,args:[{kind:"Variable",name:"architecture",variableName:"architecture"},{kind:"Variable",name:"props",variableName:"props"},{kind:"Variable",name:"target",variableName:"target"}],concreteType:"ModifyImage",kind:"LinkedField",name:"modify_image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,n,a],kind:"Fragment",metadata:null,name:"ManageAppsModalMutation",selections:l,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,e,n],kind:"Operation",name:"ManageAppsModalMutation",selections:l},params:{cacheID:"b7a57119037085ec9f08346991633e0a",id:null,metadata:{},name:"ManageAppsModalMutation",operationKind:"mutation",text:"mutation ManageAppsModalMutation(\n  $target: String!\n  $architecture: String\n  $props: ModifyImageInput!\n) {\n  modify_image(target: $target, architecture: $architecture, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="bb280196745e96f5c488d1d785a5b012";const i=l},28499:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e={defaultValue:null,kind:"LocalArgument",name:"architecture"},n={defaultValue:null,kind:"LocalArgument",name:"props"},a={defaultValue:null,kind:"LocalArgument",name:"target"},l=[{alias:null,args:[{kind:"Variable",name:"architecture",variableName:"architecture"},{kind:"Variable",name:"props",variableName:"props"},{kind:"Variable",name:"target",variableName:"target"}],concreteType:"ModifyImage",kind:"LinkedField",name:"modify_image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,n,a],kind:"Fragment",metadata:null,name:"ManageImageResourceLimitModalMutation",selections:l,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,e,n],kind:"Operation",name:"ManageImageResourceLimitModalMutation",selections:l},params:{cacheID:"b4c4a5b17c6aa265df64e4d2d6338684",id:null,metadata:{},name:"ManageImageResourceLimitModalMutation",operationKind:"mutation",text:"mutation ManageImageResourceLimitModalMutation(\n  $target: String!\n  $architecture: String\n  $props: ModifyImageInput!\n) {\n  modify_image(target: $target, architecture: $architecture, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="491b6e500587a3630195d9025ef76f29";const i=l},10791:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"DeleteResourcePreset",kind:"LinkedField",name:"delete_resource_preset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ResourcePresetListDeleteMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ResourcePresetListDeleteMutation",selections:n},params:{cacheID:"66d1ae4fe23653f392529fb39e2e61f2",id:null,metadata:{},name:"ResourcePresetListDeleteMutation",operationKind:"mutation",text:"mutation ResourcePresetListDeleteMutation(\n  $name: String!\n) {\n  delete_resource_preset(name: $name) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="99b502a95d31e84e4de261e06fb89915";const i=l},82045:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"resource_slots",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"shared_memory",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResourcePresetListQuery",selections:[{alias:null,args:null,concreteType:"ResourcePreset",kind:"LinkedField",name:"resource_presets",plural:!0,selections:[e,n,a,{args:null,kind:"FragmentSpread",name:"ResourcePresetSettingModalFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ResourcePresetListQuery",selections:[{alias:null,args:null,concreteType:"ResourcePreset",kind:"LinkedField",name:"resource_presets",plural:!0,selections:[e,n,a],storageKey:null}]},params:{cacheID:"f8093b3bde88909fa6f5ab7fdf92dcb0",id:null,metadata:{},name:"ResourcePresetListQuery",operationKind:"query",text:"query ResourcePresetListQuery {\n  resource_presets {\n    name\n    resource_slots\n    shared_memory\n    ...ResourcePresetSettingModalFragment\n  }\n}\n\nfragment ResourcePresetSettingModalFragment on ResourcePreset {\n  name\n  resource_slots\n  shared_memory\n}\n"}}}();l.hash="d720729122a85e155a7f334eba9156fc";const i=l},87941:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateResourcePreset",kind:"LinkedField",name:"create_resource_preset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ResourcePresetSettingModalCreateMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ResourcePresetSettingModalCreateMutation",selections:n},params:{cacheID:"4c6d8ef938cb69d5336e86c9d7fca415",id:null,metadata:{},name:"ResourcePresetSettingModalCreateMutation",operationKind:"mutation",text:"mutation ResourcePresetSettingModalCreateMutation(\n  $name: String!\n  $props: CreateResourcePresetInput!\n) {\n  create_resource_preset(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="6d3e941d6668ba2fda013fa61adb004d";const i=l},69674:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResourcePresetSettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shared_memory",storageKey:null}],type:"ResourcePreset",abstractKey:null,hash:"e0519643146e095e7a6ac81fee9d922a"},i=l},10275:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyResourcePreset",kind:"LinkedField",name:"modify_resource_preset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ResourcePresetSettingModalModifyMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ResourcePresetSettingModalModifyMutation",selections:n},params:{cacheID:"8096f8cb30e3ac68ed767977d4f44061",id:null,metadata:{},name:"ResourcePresetSettingModalModifyMutation",operationKind:"mutation",text:"mutation ResourcePresetSettingModalModifyMutation(\n  $name: String!\n  $props: ModifyResourcePresetInput!\n) {\n  modify_resource_preset(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="80ba55bd668ca590b31674b9b0c280ed";const i=l},38824:(e,n,a)=>{a.r(n),a.d(n,{default:()=>Le});var l,i,t,r=a(4703),s=a(58879),o=a(51593),d=a(3643),u=a(34357),c=a(94126),m=a(44733),g=a(23702),v=a(67378),p=a(9833),y=a(69056),h=a(89608),f=a.n(h),k=a(43373),x=a(56762),b=a(88789),A=a(73689);const j=e=>{var n;let{existingHostnames:r,containerRegistryFrgmt:s=null,onOk:o,...d}=e;const{t:u}=(0,x.Bd)(),h=(0,k.useRef)(null),{message:j,modal:_}=m.A.useApp(),S=(0,b.useFragment)(void 0!==l?l:l=a(39444),s),[C,R]=(0,b.useMutation)(void 0!==i?i:i=a(61087)),[w,I]=(0,b.useMutation)(void 0!==t?t:t=a(43293)),F=async()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.validateFields().then((e=>{const n={hostname:e.hostname,props:{url:e.config.url,type:e.config.type,project:"docker"===e.config.project?void 0:e.config.project,username:f().isEmpty(e.config.username)?null:e.config.username,password:e.isChangedPassword?f().isEmpty(e.config.password)?null:e.config.password:void 0}};S?(e.isChangedPassword||delete n.props.password,w({variables:n,onCompleted:(e,n)=>{var a;if(f().isEmpty(null===(a=e.modify_container_registry)||void 0===a?void 0:a.container_registry))j.error(u("dialog.ErrorOccurred"));else if(n&&n.length>0){const e=f().map(n,(e=>e.message));for(const n of e)j.error(n,2.5)}else o&&o("modify")},onError:e=>{j.error(u("dialog.ErrorOccurred"))}})):C({variables:n,onCompleted:(e,n)=>{var a;if(f().isEmpty(null===e||void 0===e||null===(a=e.create_container_registry)||void 0===a?void 0:a.container_registry))j.error(u("dialog.ErrorOccurred"));else if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=f().map(n,(e=>e.message));for(const n of e)j.error(n,2.5)}else o&&o("create")},onError(e){j.error(u("dialog.ErrorOccurred"))}})})).catch((e=>{}))};return(0,A.jsx)(c.A,{title:u(S?"registry.ModifyRegistry":"registry.AddRegistry"),okText:u(S?"button.Save":"button.Add"),confirmLoading:R||I,onOk:()=>{var e;null===(e=h.current)||void 0===e||e.validateFields().then((e=>{var n;f().includes(null===(n=e.config)||void 0===n?void 0:n.type,"harbor")&&(f().isEmpty(e.config.username)||(S?e.isChangedPassword&&f().isEmpty(e.config.password):f().isEmpty(e.config.password)))?_.confirm({title:u("button.Confirm"),content:u("registry.ConfirmNoUserName"),onOk:()=>{F()}}):F()})).catch((()=>{}))},...d,destroyOnClose:!0,children:(0,A.jsxs)(g.A,{ref:h,layout:"vertical",requiredMark:"optional",initialValues:S?{...S,config:{...S.config,project:(null===(n=S.config)||void 0===n?void 0:n.project)||void 0}}:{config:{type:"docker"}},preserve:!1,children:[(0,A.jsx)(g.A.Item,{label:u("registry.Hostname"),name:"hostname",required:!0,rules:[{required:!0,message:u("registry.DescHostnameIsEmpty"),pattern:new RegExp("^.+$")},{validator:(e,n)=>!S&&null!==r&&void 0!==r&&r.includes(n)?Promise.reject(u("registry.RegistryHostnameAlreadyExists")):Promise.resolve()}],children:(0,A.jsx)(v.A,{disabled:!!S,value:(null===S||void 0===S?void 0:S.hostname)||void 0})}),(0,A.jsx)(g.A.Item,{name:["config","url"],label:u("registry.RegistryURL"),required:!0,rules:[{required:!0},{validator:(e,n)=>{if(n){if(!n.startsWith("http://")&&!n.startsWith("https://"))return Promise.reject(u("registry.DescURLStartString"));try{new URL(n)}catch(a){return Promise.reject(u("registry.DescURLFormat"))}}return Promise.resolve()}},{type:"string",max:512,message:u("maxLength.512chars")}],children:(0,A.jsx)(v.A,{})}),(0,A.jsx)(g.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>{var a,l;return f().isEmpty(null===(a=e.config)||void 0===a?void 0:a.password)!==f().isEmpty(null===(l=n.config)||void 0===l?void 0:l.password)},children:e=>{let{validateFields:n,getFieldValue:a}=e;return n([["config","username"]]),(0,A.jsx)(g.A.Item,{name:["config","username"],label:u("registry.Username"),rules:[{required:!f().isEmpty(a(["config","password"]))},{type:"string",max:255,message:u("maxLength.255chars")}],children:(0,A.jsx)(v.A,{})})}}),(0,A.jsxs)(g.A.Item,{label:u("registry.Password"),children:[(0,A.jsx)(g.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.isChangedPassword!==n.isChangedPassword,children:e=>{let{getFieldValue:n}=e;return(0,A.jsx)(g.A.Item,{noStyle:!0,name:["config","password"],children:(0,A.jsx)(v.A.Password,{disabled:!f().isEmpty(S)&&!n("isChangedPassword")})})}}),!f().isEmpty(S)&&(0,A.jsx)(g.A.Item,{noStyle:!0,name:"isChangedPassword",valuePropName:"checked",children:(0,A.jsx)(p.A,{onChange:e=>{var n;e.target.checked||(null===(n=h.current)||void 0===n||n.setFieldValue(["config","password"],""))},children:u("webui.menu.ChangePassword")})})]}),(0,A.jsx)(g.A.Item,{name:["config","type"],label:u("registry.RegistryType"),required:!0,rules:[{required:!0,message:u("registry.PleaseSelectOption")}],children:(0,A.jsx)(y.A,{options:[{value:"docker"},{value:"harbor"},{value:"harbor2"}],onChange:()=>{}})}),(0,A.jsx)(g.A.Item,{shouldUpdate:(e,n)=>{var a,l;return(null===e||void 0===e||null===(a=e.config)||void 0===a?void 0:a.type)!==(null===n||void 0===n||null===(l=n.config)||void 0===l?void 0:l.type)},noStyle:!0,children:e=>{let{getFieldValue:n}=e;return"docker"!==n(["config","type"])&&(0,A.jsx)(g.A.Item,{name:["config","project"],label:u("registry.ProjectName"),required:!0,rules:[{required:!0,message:u("registry.ProjectNameIsRequired")},{validator:(e,n,a)=>(f().map(n,(e=>{if(e.length>255)return Promise.reject(u("maxLength.255chars"))})),Promise.resolve())}],children:(0,A.jsx)(y.A,{mode:"tags",open:!1,tokenSeparators:[","," "],suffixIcon:null})})}})]})})};var _,S,C,R=a(89130),w=a(40567),I=a(4342),F=a(81850),M=a(64703),K=a(84197),P=a(53566),L=a(50868),T=a(33789),$=a(60822),N=a(77731),D=a(15934),V=a(15480),E=a(52515);const z=e=>{let{style:n}=e;const l=(0,o.CX)(),[i,t]=(0,o.Tw)("initial-fetch"),[r,p]=(0,k.useTransition)(),y=(0,u.b)(),{message:h}=m.A.useApp(),{upsertNotification:z}=(0,d.js)(),{container_registries:B,domain:O}=(0,b.useLazyLoadQuery)(void 0!==_?_:_=a(29930),{domain:l._config.domainName},{fetchPolicy:"store-and-network",fetchKey:i}),[q,U]=(0,b.useMutation)(void 0!==S?S:S=a(2326)),[H,Q]=(0,b.useMutation)(void 0!==C?C:C=a(92169)),{t:W}=(0,x.Bd)(),{token:X}=L.A.useToken(),[G,J]=(0,k.useState)(null),[Y,Z]=(0,k.useState)(null),[ee,ne]=(0,k.useState)(""),[ae,le]=(0,k.useState)(!1),[ie,te]=(0,k.useState)();return(0,A.jsxs)(R.A,{direction:"column",align:"stretch",style:{flex:1,...n},children:[(0,A.jsxs)(R.A,{direction:"row",justify:"end",gap:"sm",style:{padding:X.paddingContentVertical,paddingLeft:X.paddingContentHorizontalSM,paddingRight:X.paddingContentHorizontalSM},children:[(0,A.jsx)(T.A,{title:W("button.Refresh"),children:(0,A.jsx)($.Ay,{loading:r,icon:(0,A.jsx)(w.A,{}),onClick:()=>{p((()=>{t()}))}})}),(0,A.jsx)($.Ay,{type:"primary",icon:(0,A.jsx)(I.A,{}),onClick:()=>{le(!0)},children:W("registry.AddRegistry")})]}),(0,A.jsx)(N.A,{rowKey:e=>e.id,scroll:{x:"max-content"},pagination:!1,columns:[{title:W("registry.Hostname"),dataIndex:"hostname"},{title:W("registry.RegistryURL"),dataIndex:["config","url"]},{title:W("registry.Type"),dataIndex:["config","type"]},{title:W("registry.HarborProject"),dataIndex:["config","project"],render:(e,n)=>f().map(e,(e=>(0,A.jsx)(D.A,{children:e||""},e||"")))},{title:W("registry.Username"),dataIndex:["config","username"]},{title:W("registry.Password"),dataIndex:["config","password"]},{title:W("general.Enabled"),render:(e,n)=>{const a=f().includes(null===O||void 0===O?void 0:O.allowed_docker_registries,n.hostname);return(0,A.jsx)(V.A,{checked:ie===n.hostname+i?!a:a,disabled:r||Q,loading:(r||Q)&&ie===n.hostname+i,onChange:e=>{if(!f().isString(n.hostname))return;let a=f().clone((null===O||void 0===O?void 0:O.allowed_docker_registries)||[]);e?a.push(n.hostname):a=f().without(a,n.hostname),te(n.hostname+i),H({variables:{domain:l._config.domainName,allowed_docker_registries:a},onCompleted:(n,a)=>{var l;if(null!==n&&void 0!==n&&null!==(l=n.modify_domain)&&void 0!==l&&l.ok){if(a&&(null===a||void 0===a?void 0:a.length)>0){const e=f().map(a,(e=>e.message));for(const n of e)h.error(n,2.5)}else p((()=>{t()}));h.info({key:"registry-enabled",content:W(e?"registry.RegistryTurnedOn":"registry.RegistryTurnedOff")})}else{var i;h.error(null===n||void 0===n||null===(i=n.modify_domain)||void 0===i?void 0:i.msg)}}})}})}},{title:W("general.Control"),fixed:"right",render:(e,n,a)=>(0,A.jsxs)(R.A,{children:[(0,A.jsx)(T.A,{title:W("button.Edit"),children:(0,A.jsx)($.Ay,{size:"large",style:{color:X.colorInfo},type:"text",icon:(0,A.jsx)(F.A,{}),onClick:()=>{J(n)}})}),(0,A.jsx)(T.A,{title:W("button.Delete"),children:(0,A.jsx)($.Ay,{size:"large",danger:!0,type:"text",icon:(0,A.jsx)(M.A,{}),onClick:()=>{Z(n)}})}),(0,A.jsx)(T.A,{title:W("maintenance.RescanImages"),children:(0,A.jsx)($.Ay,{size:"large",type:"text",icon:(0,A.jsx)(K.A,{onClick:()=>{n.hostname&&(async e=>{const n=z({message:`${e} ${W("maintenance.RescanImages")}`,description:W("registry.UpdatingRegistryInfo"),open:!0,backgroundTask:{status:"pending"},duration:0});l.maintenance.rescan_images(e).then((e=>{let{rescan_images:a}=e;a.ok?z({key:n,backgroundTask:{status:"pending",percent:0,taskId:a.task_id,statusDescriptions:{pending:W("registry.RescanImages"),resolved:W("registry.RegistryUpdateFinished"),rejected:W("registry.RegistryUpdateFailed")}}}):z({key:n,backgroundTask:{status:"rejected"},duration:1})})).catch((e=>{console.log(e),z({key:n,backgroundTask:{status:"rejected"},duration:1}),e&&e.message&&(globalThis.lablupNotification.text=y.relieve(e.title),globalThis.lablupNotification.detail=e.message,globalThis.lablupNotification.show(!0,e))}))})(n.hostname)}})})})]})}],dataSource:(0,s.tS)(B)}),(0,A.jsx)(j,{containerRegistryFrgmt:G,existingHostnames:f().map(B,(e=>(null===e||void 0===e?void 0:e.hostname)||"")),open:!!G||ae,onOk:e=>{"create"===e?(t(),h.info({key:"registry-added",content:W("registry.RegistrySuccessfullyAdded")})):"modify"===e&&h.info({key:"registry-modified",content:W("registry.RegistrySuccessfullyModified")}),J(null),le(!1)},onCancel:()=>{J(null),le(!1)},centered:!1}),(0,A.jsx)(c.A,{title:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(P.A,{style:{color:X.colorWarning}})," ",W("dialog.warning.CannotBeUndone")]}),okText:W("button.Delete"),okButtonProps:{danger:!0,disabled:ee!==(null===Y||void 0===Y?void 0:Y.hostname)},onOk:()=>{Y?q({variables:{hostname:Y.hostname||""},onCompleted:(e,n)=>{n?(Z(null),h.error({key:"registry-deletion-failed",content:W("dialog.ErrorOccurred")})):(p((()=>{t()})),h.info({key:"registry-deleted",content:W("registry.RegistrySuccessfullyDeleted")}),Z(null))},onError:e=>{h.error({key:"registry-deletion-failed",content:W("dialog.ErrorOccurred")})}}):Z(null)},confirmLoading:U,onCancel:()=>{Z(null)},destroyOnClose:!0,open:!!Y,children:(0,A.jsxs)(R.A,{direction:"column",align:"stretch",gap:"sm",style:{marginTop:X.marginMD},children:[(0,A.jsxs)(E.A.Text,{children:[(0,A.jsx)(E.A.Text,{code:!0,children:null===Y||void 0===Y?void 0:Y.hostname})," ",W("registry.TypeRegistryNameToDelete")]}),(0,A.jsx)(g.A,{children:(0,A.jsx)(g.A.Item,{name:"confirmText",rules:[{required:!0,message:W("registry.HostnameDoesNotMatch"),validator:()=>ee===(null===Y||void 0===Y?void 0:Y.hostname)?Promise.resolve():Promise.reject()}],children:(0,A.jsx)(v.A,{autoComplete:"off",value:ee,onChange:e=>ne(e.target.value)})})})]})})]})};var B=a(55182),O=a(69875),q=a(20782),U=a(29546);const H=e=>{let{onRequestClose:n,selectedRows:a,setInstallingImages:l,...i}=e;const{t:t}=(0,x.Bd)(),r=(0,o.CX)(),{upsertNotification:s}=(0,d.js)(),m=(0,u.b)();if(!i.open)return null;const{imagesToInstall:g,hasInstalledImage:v}=(()=>{let e=!1;return{imagesToInstall:a.filter((n=>(n.installed&&(e=!0),!n.installed))),hasInstalledImage:e}})();return(0,A.jsx)(c.A,{...i,destroyOnClose:!0,maskClosable:!1,onCancel:()=>n(),title:t("environment.CheckImageInstallation"),okText:t("environment.Install"),onOk:()=>{n();const e=g.map((async e=>{var n;const a=(null===e||void 0===e?void 0:e.registry)+"/"+(null===e||void 0===e?void 0:e.name)+":"+(null===e||void 0===e?void 0:e.tag);let l=!1;const i={};null===e||void 0===e||null===(n=e.resource_limits)||void 0===n||n.forEach((e=>{const n=null===e||void 0===e?void 0:e.key;i[n]=null===e||void 0===e?void 0:e.min})),"cuda.device"in i&&" cuda.shares"in i?(l=!0,i.gpu=0,i.fgpu=i["cuda.shares"]):"cuda.device"in i?(i.gpu=i["cuda.device"],l=!0):l=!1,i.mem.endsWith("g")?i.mem=i.mem.replace("g",".5g"):i.mem.endsWith("m")&&(i.mem=Number(i.mem.slice(0,-1))+256+"m"),i.domain=r._config.domainName,i.group_name=r.current_group;const o=await r.get_resource_slots();l&&("cuda.device"in o||"cuda.shares"in o||(delete i.gpu,delete i.fgpu,delete i["cuda.shares"],delete i["cuda.device"])),"cuda.device"in o&&"cuda.shares"in o?"fgpu"in i&&"gpu"in i&&(delete i.gpu,delete i["cuda.device"]):"cuda.device"in o?(delete i.fgpu,delete i["cuda.shares"]):"cuda.shares"in o&&(delete i.gpu,delete i["cuda.device"]),i.enqueueOnly=!0,i.type="batch",i.startupCommand='echo "Image is installed"',s({message:`${t("environment.InstallingImage")}${a}${t("environment.TakesTime")}`,open:!0,duration:2});const d=await globalThis.lablupIndicator.start("indeterminate");d.set(10,t("import.Downloading"));try{return await r.image.install(a,null===e||void 0===e?void 0:e.architecture,i),d.end(1e3),null===e||void 0===e?void 0:e.id}catch(u){return globalThis.lablupNotification.text=m.relieve(u.title),globalThis.lablupNotification.detail=u.message,globalThis.lablupNotification.show(!0,u),d.set(100,t("environment.DescProblemOccurred")),d.end(1e3),null}}));Promise.allSettled(e).then((e=>{const n=e.filter((e=>"fulfilled"===e.status&&null!==e.value)).map((e=>e.value));l(n)}))},children:(0,A.jsxs)(R.A,{direction:"column",gap:"md",align:"start",children:[v?t("environment.InstalledImagesAreExcluded"):null,(0,A.jsx)(R.A,{direction:"column",align:"start",style:{width:"100%"},children:(0,A.jsx)(U.A,{size:"small",dataSource:g.map((e=>`${null===e||void 0===e?void 0:e.registry}/${null===e||void 0===e?void 0:e.name}/${null===e||void 0===e?void 0:e.tag}`)),style:{width:"100%"},renderItem:e=>(0,A.jsx)(U.A.Item,{children:(0,A.jsx)(E.A.Text,{strong:!0,children:e})}),pagination:{pageSize:5,showTotal:e=>t("general.TotalItems",{total:e})}})}),(0,A.jsxs)(E.A.Text,{children:[t("environment.DescSignificantInstallTime"),"\xa0",t("dialog.ask.DoYouWantToProceed")]})]})})};var Q,W=a(69715),X=a(85029);const G=e=>{let{open:n,image:l,onRequestClose:i,...t}=e;const{t:r}=(0,x.Bd)(),s=(0,o.CX)(),d=k.useRef(null),u=m.A.useApp(),{token:p}=L.A.useToken(),[y,h]=(0,b.useMutation)(void 0!==Q?Q:Q=a(36751));if(!l)return null;const j=(()=>{let e=[];if(l.labels){const i=f().findIndex(l.labels,(e=>null!==e&&"ai.backend.service-ports"===(null===e||void 0===e?void 0:e.key)));var n,a;if(-1!==i)e=null===l||void 0===l||null===(n=l.labels[i])||void 0===n||null===(a=n.value)||void 0===a?void 0:a.split(",").map((e=>{const n=e.split(":");return{app:n[0],protocol:n[1],port:Number(n[2])}}))}return e})();return(0,A.jsxs)(c.A,{destroyOnClose:!0,open:n,onOk:()=>{var e;null===(e=d.current)||void 0===e||e.validateFields().then((()=>{var e;const n=null===(e=d.current)||void 0===e?void 0:e.getFieldValue("apps").map((e=>`${e.app}:${e.protocol}:${e.port}`)).join(","),a=f().map(l.labels,(e=>{return e.key.includes("service-ports")?{key:e.key,value:n}:{key:e.key,value:(null===(a=e.value)||void 0===a?void 0:a.toString())||""};var a})),t=()=>y({variables:{target:`${null===l||void 0===l?void 0:l.registry}/${null===l||void 0===l?void 0:l.name}:${null===l||void 0===l?void 0:l.tag}`,architecture:null===l||void 0===l?void 0:l.architecture,props:{labels:a,resource_limits:s.isManagerVersionCompatibleWith("24.03.4.*")?void 0:null}},onCompleted:(e,n)=>{var a,l;if(null!==e&&void 0!==e&&null!==(a=e.modify_image)&&void 0!==a&&a.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=f().map(n,(e=>e.message));for(const n of e)X.Ay.error(n,2.5)}else X.Ay.success(r("environment.DescImagePortsModified")),i(!0);else X.Ay.error(null===e||void 0===e||null===(l=e.modify_image)||void 0===l?void 0:l.msg)},onError:e=>{X.Ay.error(r("dialog.ErrorOccurred"))}});null!==l&&void 0!==l&&l.installed?u.modal.confirm({title:"Image reinstallation required",content:(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(x.x6,{i18nKey:"environment.ModifyImageResourceLimitReinstallRequired"})}),onOk:t,getContainer:()=>document.body,closable:!0}):t()})).catch((e=>{}))},onCancel:()=>i(!1),confirmLoading:h,title:r("environment.ManageApps"),...t,children:[(0,A.jsxs)(R.A,{direction:"row",style:{width:"100%",marginBottom:p.marginXS},children:[(0,A.jsx)(E.A.Text,{strong:!0,style:{width:"32%"},children:r("environment.AppName")}),(0,A.jsx)(E.A.Text,{strong:!0,style:{width:"32%"},children:r("environment.Protocol")}),(0,A.jsx)(E.A.Text,{strong:!0,style:{width:"32%"},children:r("environment.Port")}),(0,A.jsx)(R.A,{})]}),(0,A.jsx)(g.A,{ref:d,layout:"vertical",autoComplete:"off",initialValues:{apps:j},requiredMark:!1,children:(0,A.jsx)(R.A,{direction:"column",children:(0,A.jsx)(g.A.List,{name:"apps",children:(e,n)=>{let{add:a,remove:i}=n;return(0,A.jsxs)(R.A,{direction:"column",style:{width:"100%"},children:[f().map(e,((e,n)=>(0,A.jsx)(g.A.Item,{children:(0,A.jsxs)(R.A,{direction:"row",gap:"xs",children:[(0,A.jsx)(g.A.Item,{...e,name:[e.name,"app"],noStyle:!0,rules:[{required:!0,message:r("environment.AppNameMustNotBeEmpty")}],children:(0,A.jsx)(v.A,{placeholder:r("environment.AppName")})}),(0,A.jsx)(g.A.Item,{...e,name:[e.name,"protocol"],noStyle:!0,rules:[{pattern:/^(http|tcp|pty|preopen)$/,required:!0,message:r("environment.ProtocolMustBeOneOfSupported")}],children:(0,A.jsx)(v.A,{placeholder:r("environment.Protocol")})}),(0,A.jsx)(g.A.Item,{...e,name:[e.name,"port"],noStyle:!0,rules:[{validator:(e,n)=>{const a=f().isUndefined(n)||""===n?NaN:f().toNumber(n);return f().isNaN(a)||a<0||a>=65535?Promise.reject(r("environment.PortMustBeInRange")):[2e3,2001,2002,2003,2200,7681].includes(Number(a))?Promise.reject(r("environment.PortReservedForInternalUse")):Promise.resolve()}},{validator:(e,a)=>{var l;const i=null===(l=d.current)||void 0===l?void 0:l.getFieldValue("apps");return f().isString(a)&&a.length>0&&i.some(((e,l)=>l!==n&&(null===e||void 0===e?void 0:e.port)===a))?Promise.reject(r("environment.PortMustBeUnique")):Promise.resolve()}}],children:(0,A.jsx)(v.A,{placeholder:r("environment.Port")})}),(0,A.jsx)($.Ay,{type:"text",danger:!0,onClick:()=>i(e.name),style:0===n?{width:"10%",marginTop:8}:{width:"10%"},icon:(0,A.jsx)(M.A,{})})]},e.key)}))),(0,A.jsx)($.Ay,{type:"dashed",onClick:()=>a(),block:!0,icon:(0,A.jsx)(I.A,{}),disabled:!l,children:r("button.Add")})]})}})})})]})};var J=a(11899),Y=a(7194),Z=a(87298);const ee=e=>{var n;let{value:a,defaultValue:l,onChange:i,steps:t,showAllMarkLabels:r,...s}=e;const o=t.map((e=>f().isNumber(e)||f().isString(e)?{value:e,label:e.toString()}:e)),[d,u]=(0,Y.A)({value:a,defaultValue:null!==l&&void 0!==l?l:null===(n=o[0])||void 0===n?void 0:n.value,onChange:i}),c=e=>0===e||e===o.length-1,m=f().fromPairs(o.map(((e,n)=>[n,c(n)?e.label:" "])));return(0,A.jsx)(Z.A,{...s,marks:m,value:f().findIndex(o,{value:d}),min:0,tooltip:{formatter(e){var n;if((0,h.isNumber)(e))return null===(n=o[e])||void 0===n?void 0:n.label},...s.tooltip},max:o.length-1,onChange:e=>{var n,a;u(null===(n=o[e])||void 0===n?void 0:n.value,null===(a=o[e])||void 0===a?void 0:a.label)}})};var ne=a(96799);const ae=e=>{var n,a,l,i;let{name:t,min:r,max:s}=e;const{token:o}=L.A.useToken(),{mergedResourceSlots:d}=(0,J.Hv)(),u=e=>{var n,a,l,i,t,r;return{cpu:{label:null===d||void 0===d||null===(n=d.cpu)||void 0===n?void 0:n.description,steps:f().map(["0","1","2","3","4","5","6","7","8"],(e=>{var n;return{value:e,label:`${e} ${null===d||void 0===d||null===(n=d.cpu)||void 0===n?void 0:n.display_unit}`}}))},mem:{label:null===d||void 0===d||null===(a=d.mem)||void 0===a?void 0:a.description,steps:f().map(["64m","128m","256m","512m","1g","2g","4g","8g","16g","32g","64g","128g","256g","512g"],(e=>({value:e,label:`${e.slice(0,-1)} ${f().toUpper(f().last(e))}iB`})))},"cuda.device":{label:null===d||void 0===d||null===(l=d["cuda.device"])||void 0===l?void 0:l.description,steps:f().map(["0","1","2","3","4","5","6","7","8"],(e=>{var n;return{value:e,label:`${e} ${null===d||void 0===d||null===(n=d["cuda.device"])||void 0===n?void 0:n.display_unit}`}}))},"cuda.shares":{label:null===d||void 0===d||null===(i=d["cuda.shares"])||void 0===i?void 0:i.description,steps:f().map(["0","0.1","0.2","0.5","1.0","2.0","4.0","8.0"],(e=>{var n;return{value:e,label:`${e} ${null===d||void 0===d||null===(n=d["cuda.shares"])||void 0===n?void 0:n.display_unit}`}}))},"rocm.device":{label:null===d||void 0===d||null===(t=d["rocm.device"])||void 0===t?void 0:t.description,steps:["0","1","2","3","4","5","6","7","8"]}}[e]||{label:null===d||void 0===d||null===(r=d[e])||void 0===r?void 0:r.description,steps:f().map(["0","1","2","3","4"],(n=>{var a;return{value:n,label:`${n} ${(null===d||void 0===d||null===(a=d[e])||void 0===a?void 0:a.display_unit)||""}`}}))}},c=g.A.useFormInstance(),m=g.A.useWatch(t,c),p=f().find(u(t).steps,(e=>e.value===m||e===m));return(0,A.jsx)(g.A.Item,{label:null!==(n=null===(a=u(t))||void 0===a?void 0:a.label)&&void 0!==n?n:t.toUpperCase(),style:{flex:1},children:(0,A.jsxs)(R.A,{direction:"row",gap:"lg",children:[(0,A.jsx)(v.A,{size:"large",variant:"borderless",readOnly:!0,value:null!==(l=null===p||void 0===p?void 0:p.label)&&void 0!==l?l:p,style:{flex:1,fontSize:o.fontSizeLG},tabIndex:-1}),(0,A.jsx)(ne.A,{type:"vertical",style:{height:40}}),(0,A.jsx)(g.A.Item,{name:t,noStyle:!0,initialValue:r,children:(0,A.jsx)(ee,{style:{flex:5},steps:null===(i=u(t))||void 0===i?void 0:i.steps})})]})})};var le;const ie=e=>{var n;let{image:l,open:i,onRequestClose:t,...r}=e;const s=(0,o.CX)(),{t:d}=(0,x.Bd)(),u=(0,k.useRef)(null),v=m.A.useApp(),[p,y]=(0,b.useMutation)(void 0!==le?le:le=a(28499));return(0,A.jsx)(c.A,{destroyOnClose:!0,open:i,maskClosable:!1,onOk:async()=>{var e;const n=await(null===(e=u.current)||void 0===e?void 0:e.getFieldsValue()),a=Object.entries(n).map((e=>{var n,a,i,t;let[r,o]=e;return{key:r,min:null!==(n=o.toString())&&void 0!==n?n:"0",max:(null!==(a=null===l||void 0===l||null===(i=l.resource_limits)||void 0===i||null===(t=i.find((e=>(null===e||void 0===e?void 0:e.key)===r)))||void 0===t?void 0:t.max)&&void 0!==a?a:s.isManagerVersionCompatibleWith("24.03.4.*"))?void 0:null}})),i=()=>p({variables:{target:`${null===l||void 0===l?void 0:l.registry}/${null===l||void 0===l?void 0:l.name}:${null===l||void 0===l?void 0:l.tag}`,architecture:null===l||void 0===l?void 0:l.architecture,props:{resource_limits:a}},onCompleted:(e,n)=>{var a,l;if(null!==e&&void 0!==e&&null!==(a=e.modify_image)&&void 0!==a&&a.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=f().map(n,(e=>e.message));for(const n of e)X.Ay.error(n,2.5)}else X.Ay.success(d("environment.DescImageResourceModified")),t(!0);else X.Ay.error(null===e||void 0===e||null===(l=e.modify_image)||void 0===l?void 0:l.msg)},onError:e=>{X.Ay.error(d("dialog.ErrorOccurred"))}});null!==l&&void 0!==l&&l.installed?v.modal.confirm({title:"Image reinstallation required",content:(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(x.x6,{i18nKey:"environment.ModifyImageResourceLimitReinstallRequired"})}),onOk:i,getContainer:()=>document.body,closable:!0}):i()},onCancel:()=>t(!1),confirmLoading:y,centered:!0,title:d("environment.ModifyImageResourceLimit"),...r,children:(0,A.jsx)(g.A,{ref:u,layout:"vertical",children:null===l||void 0===l||null===(n=l.resource_limits)||void 0===n?void 0:n.map((e=>{const{key:n,min:a,max:l}=e,i=n.replace(/_/g,".");return(0,A.jsx)(ae,{name:null!==i&&void 0!==i?i:"",min:null!==a&&void 0!==a?a:"",max:null!==l&&void 0!==l?l:""},i)}))})})};var te=a(76604),re=a(30957),se=a(6597),oe=a(40991);const de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H212V212h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm-52 268H612V212h200v200zM464 544H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H212V612h200v200zm452-268H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zm-52 268H612V612h200v200z"}}]},name:"appstore",theme:"outlined"};var ue=a(44548),ce=function(e,n){return k.createElement(ue.A,(0,oe.A)({},e,{ref:n,icon:de}))};const me=k.forwardRef(ce);var ge=a(1499);const ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"};var pe=function(e,n){return k.createElement(ue.A,(0,oe.A)({},e,{ref:n,icon:ve}))};const ye=k.forwardRef(pe);var he,fe=a(44111);const ke=e=>{let{style:n}=e;const{t:l}=(0,x.Bd)(),[i,t]=(0,k.useState)([]),[,{getBaseVersion:r,getBaseImages:d,getBaseImage:u,tagAlias:c,getTags:g}]=(0,o.Gj)(),{token:p}=L.A.useToken(),[y,h]=(0,k.useState)(null),[j,_]=(0,k.useState)(null),[S,C]=(0,k.useState)(!1),[I,M]=(0,o.Tw)("initial-fetch"),[,K]=(0,k.useTransition)(),[P,T]=(0,k.useState)([]),{message:N}=m.A.useApp(),[V,z]=(0,k.useState)(""),[B,U]=(0,k.useState)(!1),[Q,X]=(0,k.useTransition)(),[J,Y]=(0,k.useTransition)(),Z=(0,o.CX)(),ee=null===Z||void 0===Z?void 0:Z.supports("extended-image-info"),{images:ne}=(0,b.useLazyLoadQuery)(void 0!==he?he:he=a(58368),{},{fetchPolicy:"initial-fetch"===I?"store-and-network":"network-only",fetchKey:I}),ae=(0,k.useMemo)((()=>f().sortBy(ne,(e=>null===e||void 0===e?void 0:e.humanized_name))),[ne]),le=(0,s.LY)([{title:l("environment.Status"),dataIndex:"installed",key:"installed",defaultSortOrder:"descend",sorter:(e,n)=>f().toNumber((null===e||void 0===e?void 0:e.installed)||0)-f().toNumber((null===n||void 0===n?void 0:n.installed)||0),render:(e,n)=>null!==n&&void 0!==n&&n.id&&P.includes(n.id)?(0,A.jsx)(D.A,{color:"gold",children:(0,A.jsx)(se.A,{keyword:V,children:l("environment.Installing")})}):null!==n&&void 0!==n&&n.installed?(0,A.jsx)(D.A,{color:"gold",children:(0,A.jsx)(se.A,{keyword:V,children:l("environment.Installed")})}):null},{title:l("environment.FullImagePath"),key:"fullImagePath",render:e=>(0,A.jsx)(E.A.Text,{copyable:{text:(0,s.A_)(e)||""},children:(0,A.jsx)(se.A,{keyword:V,children:(0,s.A_)(e)||""})}),sorter:(e,n)=>(0,s._f)((0,s.A_)(e),(0,s.A_)(n)),width:p.screenXS},{title:l("environment.Registry"),dataIndex:"registry",key:"registry",sorter:(e,n)=>(0,s._f)(null===e||void 0===e?void 0:e.registry,null===n||void 0===n?void 0:n.registry),render:e=>(0,A.jsx)(se.A,{keyword:V,children:e})},{title:l("environment.Architecture"),dataIndex:"architecture",key:"architecture",sorter:(e,n)=>(0,s._f)(null===e||void 0===e?void 0:e.architecture,null===n||void 0===n?void 0:n.architecture),render:e=>(0,A.jsx)(se.A,{keyword:V,children:e})},ee&&{title:l("environment.Namespace"),key:"namespace",dataIndex:"namespace",sorter:(e,n)=>(0,s._f)(null===e||void 0===e?void 0:e.namespace,null===n||void 0===n?void 0:n.namespace),render:e=>(0,A.jsx)(se.A,{keyword:V,children:e})},ee&&{title:l("environment.BaseImageName"),key:"base_image_name",dataIndex:"base_image_name",sorter:(e,n)=>(0,s._f)(null===e||void 0===e?void 0:e.base_image_name,null===n||void 0===n?void 0:n.base_image_name),render:e=>(0,A.jsx)(se.A,{keyword:V,children:c(e)})},ee&&{title:l("environment.Version"),key:"version",dataIndex:"version",sorter:(e,n)=>(0,s._f)(null===e||void 0===e?void 0:e.version,null===n||void 0===n?void 0:n.version),render:e=>(0,A.jsx)(se.A,{keyword:V,children:e})},ee&&{title:l("environment.Tags"),key:"tags",dataIndex:"tags",render:(e,n)=>(0,A.jsx)(R.A,{direction:"row",align:"start",children:f().map(e,(e=>{var a;const l=f().includes(e.key,"customized_"),i=l?null===(a=f().find(null===n||void 0===n?void 0:n.labels,{key:"ai.backend.customized-image.name"}))||void 0===a?void 0:a.value:e.value,t=c(e.key+i);return f().isEqual(t,(0,s.WY)(e.key+i))?(0,A.jsx)(q.A,{highlightKeyword:V,values:[{label:c(e.key),color:l?"cyan":"blue"},{label:null!==i&&void 0!==i?i:"",color:l?"cyan":"blue"}]},e.key):(0,A.jsx)(D.A,{color:l?"cyan":"blue",children:(0,A.jsx)(se.A,{keyword:V,children:t})},e.key)}))})},!ee&&{title:l("environment.Namespace"),key:"name",dataIndex:"name",sorter:(e,n)=>(0,s._f)((0,s.A_)(e),(0,s.A_)(n)),render:e=>(0,A.jsx)(se.A,{keyword:V,children:e})},!ee&&{title:l("environment.Base"),key:"baseimage",dataIndex:"baseimage",sorter:(e,n)=>(0,s._f)(u((0,s.A_)(e)||""),u((0,s.A_)(n)||"")),render:(e,n)=>(0,A.jsx)(se.A,{keyword:V,children:c(u((0,s.A_)(n)||""))})},!ee&&{title:l("environment.Version"),key:"baseversion",dataIndex:"baseversion",sorter:(e,n)=>(0,s._f)(r((0,s.A_)(e)||""),r((0,s.A_)(n)||"")),render:(e,n)=>(0,A.jsx)(se.A,{keyword:V,children:r((0,s.A_)(n)||"")})},!ee&&{title:l("environment.Tags"),key:"tag",dataIndex:"tag",sorter:(e,n)=>(0,s._f)(null===e||void 0===e?void 0:e.tag,null===n||void 0===n?void 0:n.tag),render:(e,n)=>(0,A.jsx)(W.Jj,{tag:e,labels:n.labels,highlightKeyword:V})},{title:l("environment.Digest"),dataIndex:"digest",key:"digest",sorter:(e,n)=>(0,s._f)((null===e||void 0===e?void 0:e.digest)||"",(null===n||void 0===n?void 0:n.digest)||""),render:(e,n)=>(0,A.jsx)(E.A.Text,{ellipsis:{tooltip:!0},style:{maxWidth:200},children:(0,A.jsx)(se.A,{keyword:V,children:n.digest})})},{title:l("environment.ResourceLimit"),dataIndex:"resource_limits",key:"resource_limits",render:(e,n)=>{var a;return(0,A.jsx)(R.A,{direction:"row",gap:"xxs",children:null===n||void 0===n||null===(a=n.resource_limits)||void 0===a?void 0:a.map((e=>(0,A.jsx)(te.A,{type:(null===e||void 0===e?void 0:e.key)||"",value:(null===e||void 0===e?void 0:e.min)||"0",max:(null===e||void 0===e?void 0:e.max)||"Infinity"})))})}},{title:l("general.Control"),key:"control",dataIndex:"control",fixed:"right",render:(e,n)=>(0,A.jsxs)(R.A,{direction:"row",align:"stretch",justify:"center",gap:"xxs",onClick:e=>{e.stopPropagation()},children:[(0,A.jsx)($.Ay,{type:"text",icon:(0,A.jsx)(F.A,{style:{color:p.colorInfo}}),onClick:()=>_(n)}),(0,A.jsx)($.Ay,{type:"text",icon:(0,A.jsx)(me,{style:{color:p.colorInfo}}),onClick:()=>{h(n)}})]})}]),[oe,de]=(0,fe.A)("backendaiwebui.EnvironmentPage.displayedColumnKeys",{defaultValue:le.map((e=>f().toString(e.key)))}),ue=(0,k.useMemo)((()=>null===ae||void 0===ae?void 0:ae.map((e=>({namespace:ee?null===e||void 0===e?void 0:e.namespace:null===e||void 0===e?void 0:e.name,fullName:(0,s.A_)(e)||"",digest:(null===e||void 0===e?void 0:e.digest)||"",baseversion:r((0,s.A_)(e)||""),baseimage:null!==e&&void 0!==e&&e.tag&&null!==e&&void 0!==e&&e.name?d(e.tag,e.name):[],tag:g((null===e||void 0===e?void 0:e.tag)||"",null===e||void 0===e?void 0:e.labels)||[],isCustomized:!(null===e||void 0===e||!e.tag)&&-1!==e.tag.indexOf("customized"),baseImageName:ee?null===e||void 0===e?void 0:e.base_image_name:"",tags:ee?null===e||void 0===e?void 0:e.tags:[],version:ee?null===e||void 0===e?void 0:e.version:""})))),[ae]),ce=(0,k.useMemo)((()=>{if(f().isEmpty(V))return ae;const e=new RegExp(`${f().escapeRegExp(V)}`,"i");return f().filter(ae,((n,a)=>f().some(n,((n,l)=>{if("id"===l)return!1;if(["digest","architecture","registry"].includes(l))return e.test(f().toString(n));const i=ue[a]||{},t=e.test(i.baseversion),r=f().some(i.baseimage,(n=>e.test(n))),s=f().some(i.tag,(n=>e.test(n.key)||e.test(n.value))),o=!!i.isCustomized&&e.test("customized"),d=e.test(i.namespace||""),u=e.test(i.fullName),c=f().some(i.tags,(n=>e.test(n.key)||e.test(n.value))),m=e.test(i.version||""),g=e.test(i.digest);return t||r||s||d||o||u||c||m||g}))))}),[V,ue,ae]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(R.A,{direction:"column",align:"stretch",style:{flex:1,...n},children:[(0,A.jsxs)(R.A,{justify:"end",style:{padding:p.paddingSM},gap:"xs",children:[i.length>0?(0,A.jsx)(E.A.Text,{children:l("general.NSelected",{count:i.length})}):null,(0,A.jsx)(v.A,{allowClear:!0,prefix:(0,A.jsx)(ge.A,{}),placeholder:l("environment.SearchImages"),onChange:e=>{Y((()=>z(e.target.value)))},style:{width:200}}),(0,A.jsx)($.Ay,{icon:(0,A.jsx)(w.A,{}),loading:Q,onClick:()=>{t([]),X((()=>M()))},children:l("button.Refresh")}),(0,A.jsx)($.Ay,{icon:(0,A.jsx)(ye,{}),style:{backgroundColor:p.colorPrimary,color:"white"},onClick:()=>{0!==i.length?i.some((e=>!e.installed))?C(!0):N.error(l("environment.AlreadyInstalledImage")):N.error(l("environment.NoImagesAreSelected"))},children:l("environment.Install")})]}),(0,A.jsx)(O.A,{resizable:!0,rowKey:"id",scroll:{x:"max-content"},pagination:{showTotal:(e,n)=>`${n[0]}-${n[1]} of ${e} items`,pageSizeOptions:["10","20","50"],style:{marginRight:p.marginXS}},dataSource:(0,s.tS)(ce),columns:le.filter((e=>null===oe||void 0===oe?void 0:oe.includes(f().toString(e.key)))),loading:J,rowSelection:{type:"checkbox",onChange:(e,n)=>{t(n)},selectedRowKeys:i.map((e=>e.id))},onRow:e=>({onClick:n=>{i.find((n=>n.id===e.id))?t((n=>n.filter((n=>n.id!==e.id)))):t((n=>[...n,e]))}}),showSorterTooltip:!1,sortDirections:["descend","ascend","descend"]}),(0,A.jsx)(R.A,{justify:"end",style:{padding:p.paddingXXS},children:(0,A.jsx)($.Ay,{type:"text",icon:(0,A.jsx)(F.A,{}),onClick:()=>{U(!0)}})})]}),(0,A.jsx)(ie,{open:!!j,onRequestClose:e=>{_(null),e&&K((()=>{M()}))},image:j}),(0,A.jsx)(G,{open:!!y,onRequestClose:e=>{h(null),e&&K((()=>{M()}))},image:y}),(0,A.jsx)(H,{open:S,onRequestClose:()=>{C(!1)},setInstallingImages:T,selectedRows:i}),(0,A.jsx)(re.A,{open:B,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&de(null===e||void 0===e?void 0:e.selectedColumnKeys),U(!B)},columns:le,displayedColumnKeys:oe||[]})]})};var xe,be,Ae,je=a(40471),_e=a(98038),Se=a(52932),Ce=a(86917);const Re=e=>{var n;let{resourcePresetFrgmt:l,existingResourcePresetNames:i,onRequestClose:t,...r}=e;const{t:o}=(0,x.Bd)(),{message:d}=m.A.useApp(),u=(0,k.useRef)(null),[p]=(0,J.bL)(),{mergedResourceSlots:y}=(0,J.Hv)(),h=(0,b.useFragment)(void 0!==xe?xe:xe=a(69674),l),[j,_]=(0,b.useMutation)(void 0!==be?be:be=a(87941)),[S,C]=(0,b.useMutation)(void 0!==Ae?Ae:Ae=a(10275));return(0,A.jsx)(c.A,{...r,title:o(h?"resourcePreset.ModifyResourcePreset":"resourcePreset.CreateResourcePreset"),onOk:()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.validateFields().then((e=>{var n;let a=f().mapValues(null===e||void 0===e?void 0:e.resource_slots,((e,n)=>{var a;return f().includes(n,"mem")?null===(a=(0,s.Is)(e,"b",0))||void 0===a?void 0:a.numberFixed:e}));a=f().pickBy(a,f().negate(f().isUndefined));const l={resource_slots:JSON.stringify(a||{}),shared_memory:null!==e&&void 0!==e&&e.shared_memory?null===(n=(0,s.Is)(null===e||void 0===e?void 0:e.shared_memory,"b",0))||void 0===n?void 0:n.numberFixed:null};f().isEmpty(h)?j({variables:{name:null===e||void 0===e?void 0:e.name,props:l},onCompleted:(e,n)=>{var a,l;if(null!==e&&void 0!==e&&null!==(a=e.create_resource_preset)&&void 0!==a&&a.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=f().map(n,(e=>e.message));f().forEach(e,(e=>{d.error(e,2.5)})),t(!1)}else d.success(o("resourcePreset.Created")),t(!0);else d.error(null===e||void 0===e||null===(l=e.create_resource_preset)||void 0===l?void 0:l.msg),t(!1)},onError(e){d.error(null===e||void 0===e?void 0:e.message)}}):S({variables:{name:null===e||void 0===e?void 0:e.name,props:l},onCompleted:(e,n)=>{var a,l;if(null!==e&&void 0!==e&&null!==(a=e.modify_resource_preset)&&void 0!==a&&a.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=f().map(n,(e=>null===e||void 0===e?void 0:e.message));f().forEach(e,(e=>{d.error(e,2.5)})),t(!1)}else d.success(o("resourcePreset.Updated")),t(!0);else d.error(null===e||void 0===e||null===(l=e.modify_resource_preset)||void 0===l?void 0:l.msg),t(!1)},onError(e){d.error(null===e||void 0===e?void 0:e.message)}})})).catch((()=>{}))},onCancel:()=>t(!1),destroyOnClose:!0,confirmLoading:_||C,children:(0,A.jsxs)(g.A,{ref:u,layout:"vertical",preserve:!1,initialValues:h?{name:h.name,resource_slots:f().mapValues(JSON.parse((null===h||void 0===h?void 0:h.resource_slots)||"{}"),((e,n)=>{var a;return f().includes(n,"mem")?null===(a=(0,s.Is)(e+"b","g"))||void 0===a?void 0:a.numberUnit:e}))||{},shared_memory:null!==h&&void 0!==h&&h.shared_memory?null===(n=(0,s.Is)((null===h||void 0===h?void 0:h.shared_memory)+"b","g"))||void 0===n?void 0:n.numberUnit:null}:{},children:[(0,A.jsx)(g.A.Item,{label:o("resourcePreset.PresetName"),name:"name",rules:[{required:!0,message:o("resourcePreset.NoPresetName")},{pattern:/^[a-zA-Z0-9._-]*$/,message:o("data.Allowslettersnumbersand-_dot")},{validator:(e,n)=>!h&&null!==i&&void 0!==i&&i.includes(n)?Promise.reject(new Error(o("resourcePreset.PresetNameAlreadyExists"))):Promise.resolve()}],children:(0,A.jsx)(v.A,{disabled:!!h})}),(0,A.jsx)(g.A.Item,{label:o("resourcePreset.ResourcePreset"),children:(0,A.jsxs)(_e.A,{gutter:16,children:[f().map(f().chunk(f().keys(p),2),((e,n)=>(0,A.jsx)(k.Fragment,{children:f().map(e,(e=>{var n,a;return(0,A.jsx)(Se.A,{span:12,style:{alignSelf:"end"},children:(0,A.jsx)(g.A.Item,{label:(null===(n=f().get(y,e))||void 0===n?void 0:n.description)||e,name:["resource_slots",e],rules:[{validator:(n,a)=>a&&f().includes(e,"mem")&&(0,s.Is)(a,"p").number>(0,s.Is)("300p","p").number?Promise.reject(new Error("Memory size should be less than 300 PiB")):Promise.resolve()}],children:f().includes(e,"mem")?(0,A.jsx)(je.A,{}):(0,A.jsx)(Ce.A,{min:"cpu"===e?1:0,step:f().includes(e,".shares")?.1:1,addonAfter:null===(a=f().get(y,e))||void 0===a?void 0:a.display_unit})})},e)}))},n))),(0,A.jsx)(Se.A,{span:12,style:{alignSelf:"end"},children:(0,A.jsx)(g.A.Item,{label:o("resourcePreset.SharedMemory"),name:"shared_memory",dependencies:["resource_slots","mem"],rules:[e=>{let{getFieldValue:n}=e;return{validator(e,a){var l,i,t,r,d,u;return a&&null!==(l=n("resource_slots"))&&void 0!==l&&l.mem&&(null!==(i=null===(t=(0,s.Is)(null===(r=n("resource_slots"))||void 0===r?void 0:r.mem,"b"))||void 0===t?void 0:t.number)&&void 0!==i?i:0)<(null!==(d=null===(u=(0,s.Is)(a,"b"))||void 0===u?void 0:u.number)&&void 0!==d?d:0)?Promise.reject(o("resourcePreset.MemoryShouldBeLargerThanSHMEM")):Promise.resolve()}}}],children:(0,A.jsx)(je.A,{max:"7.999p"})})})]})})]})})};var we,Ie;const Fe=()=>{const{t:e}=(0,x.Bd)(),{token:n}=L.A.useToken(),{modal:l}=m.A.useApp(),[i,t]=(0,k.useTransition)(),[r,d]=(0,o.Tw)("initial-fetch"),[u,c]=(0,k.useState)(),[g,v]=(0,k.useState)(null),[p,y]=(0,k.useState)(!1),{resource_presets:h}=(0,b.useLazyLoadQuery)(void 0!==we?we:we=a(82045),{},{fetchPolicy:"initial-fetch"===r?"store-and-network":"network-only",fetchKey:r}),[j,_]=(0,b.useMutation)(void 0!==Ie?Ie:Ie=a(10791));return(0,A.jsxs)(R.A,{direction:"column",align:"stretch",children:[(0,A.jsx)(R.A,{direction:"row",gap:"xs",justify:"end",wrap:"wrap",style:{padding:n.paddingContentVertical,paddingLeft:n.paddingContentHorizontalSM,paddingRight:n.paddingContentHorizontalSM},children:(0,A.jsxs)(R.A,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:[(0,A.jsx)(T.A,{title:e("button.Refresh"),children:(0,A.jsx)($.Ay,{icon:(0,A.jsx)(w.A,{}),loading:i,onClick:()=>{t((()=>{d()}))}})}),(0,A.jsx)($.Ay,{type:"primary",icon:(0,A.jsx)(I.A,{}),onClick:()=>{y(!0)},children:e("resourcePreset.CreatePreset")})]})}),(0,A.jsx)(N.A,{rowKey:"name",dataSource:(0,s.tS)(h),scroll:{x:"max-content"},pagination:!1,sortDirections:["descend","ascend","descend"],showSorterTooltip:!1,columns:[{title:e("resourcePreset.Name"),dataIndex:"name",sorter:(e,n)=>(0,s._f)(e.name,n.name)},{title:e("resourcePreset.Resources"),dataIndex:"resource_slots",render:e=>(0,A.jsx)(R.A,{gap:"xxs",children:f().isEmpty(e)?"-":f().map(JSON.parse(e),((e,n)=>(0,A.jsx)(te.A,{type:n,value:e},n)))})},{title:e("resourcePreset.SharedMemory"),dataIndex:"shared_memory",render:e=>{var n;return e?null===(n=(0,s.Is)(e+"","g"))||void 0===n?void 0:n.number:"-"},sorter:(e,n)=>e.shared_memory-n.shared_memory},{title:e("general.Control"),key:"control",fixed:"right",render:(a,i)=>(0,A.jsxs)(R.A,{align:"stretch",children:[(0,A.jsx)(T.A,{title:e("button.Edit"),children:(0,A.jsx)($.Ay,{type:"text",size:"large",icon:(0,A.jsx)(F.A,{}),style:{color:n.colorInfo},onClick:()=>{v(i)}})}),(0,A.jsx)(T.A,{title:e("button.Delete"),children:(0,A.jsx)($.Ay,{type:"text",size:"large",icon:(0,A.jsx)(M.A,{style:{color:n.colorError}}),loading:_&&u===(null===i||void 0===i?void 0:i.name)+r,disabled:_&&u!==(null===i||void 0===i?void 0:i.name)+r,onClick:()=>{l.confirm({title:e("resourcePreset.DeleteResourcePreset"),content:(0,A.jsxs)(A.Fragment,{children:[e("resourcePreset.AboutToDeletePreset")," ",(0,A.jsx)(E.A.Text,{strong:!0,children:null===i||void 0===i?void 0:i.name})]}),onOk:()=>{var e;c((null===i||void 0===i?void 0:i.name)+r),j({variables:{name:null!==(e=null===i||void 0===i?void 0:i.name)&&void 0!==e?e:""},onCompleted:()=>{t((()=>{d()}))}})},okText:e("button.Delete"),okType:"primary",okButtonProps:{danger:!0}})}})})]})}]}),(0,A.jsx)(k.Suspense,{fallback:null,children:(0,A.jsx)(Re,{resourcePresetFrgmt:g,open:!!g||p,onRequestClose:e=>{v(null),y(!1),e&&t((()=>{d()}))},existingResourcePresetNames:f().map(h,(e=>null===e||void 0===e?void 0:e.name))})})]})};var Me=a(72269),Ke=a(12121);const Pe=(0,Ke.withDefault)(Ke.StringParam,"image"),Le=()=>{const{t:e}=(0,x.Bd)(),[n,a]=(0,Ke.useQueryParam)("tab",Pe),l=(0,o.CX)(),i=l.supports("container-registry-gql"),t=null===l||void 0===l?void 0:l.isManagerVersionCompatibleWith("24.09.0");return(0,A.jsx)(Me.A,{activeTabKey:n,onTabChange:a,tabList:[{key:"image",label:e("environment.Images")},{key:"preset",label:e("environment.ResourcePresets")},...l.is_superadmin?[{key:"registry",label:e("environment.Registries")}]:[]],styles:{body:{padding:0,paddingTop:1,overflow:"hidden"}},children:(0,A.jsxs)(k.Suspense,{fallback:(0,A.jsx)(B.A,{style:{height:"calc(100vh - 145px)"},spinSize:"large"}),children:["image"===n&&(0,A.jsx)(ke,{}),"preset"===n&&(0,A.jsx)(Fe,{}),"registry"===n?i?t?(0,A.jsx)(r.default,{}):(0,A.jsx)(z,{}):(0,A.jsx)("backend-ai-registry-list",{active:!0}):null]})})}}}]);
//# sourceMappingURL=8824.76a5b4c1.chunk.js.map