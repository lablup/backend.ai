"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[8800],{32371:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AliasedImageDoubleTagsFragment",selections:[{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:e,storageKey:null},{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"tags",plural:!0,selections:e,storageKey:null}],type:"ImageNode",abstractKey:null}}();l.hash="2b63bd76dfdb73053e9561282c86cfaf";const i=l},61233:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],n=[{kind:"Variable",name:"image_id",variableName:"id"}],a=[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],l=[{alias:null,args:n,concreteType:"UntagImageFromRegistry",kind:"LinkedField",name:"untag_image_from_registry",plural:!1,selections:a,storageKey:null},{alias:null,args:n,concreteType:"ForgetImageById",kind:"LinkedField",name:"forget_image_by_id",plural:!1,selections:a,storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"CustomizedImageListForgetAndUntagMutation",selections:l,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"CustomizedImageListForgetAndUntagMutation",selections:l},params:{cacheID:"3d0221c84a9ba4d0ad6b24db69595451",id:null,metadata:{},name:"CustomizedImageListForgetAndUntagMutation",operationKind:"mutation",text:"mutation CustomizedImageListForgetAndUntagMutation(\n  $id: String!\n) {\n  untag_image_from_registry(image_id: $id) {\n    ok\n    msg\n  }\n  forget_image_by_id(image_id: $id) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="834817943f871e95194a113d786f85a0";const i=l},16171:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"humanized_name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"digest",storageKey:null},r=[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],o={alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:r,storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"supported_accelerators",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"namespace",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"base_image_name",storageKey:null},m={alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"tags",plural:!0,selections:r,storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CustomizedImageListQuery",selections:[{alias:null,args:null,concreteType:"ImageNode",kind:"LinkedField",name:"customized_images",plural:!0,selections:[e,n,a,l,i,t,s,o,d,u,g,m,c,{args:null,kind:"FragmentSpread",name:"AliasedImageDoubleTagsFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"CustomizedImageListQuery",selections:[{alias:null,args:null,concreteType:"ImageNode",kind:"LinkedField",name:"customized_images",plural:!0,selections:[e,n,a,l,i,t,s,o,d,u,g,m,c],storageKey:null}]},params:{cacheID:"9d2e928aef36de71b7da3ce796f74e22",id:null,metadata:{},name:"CustomizedImageListQuery",operationKind:"query",text:'query CustomizedImageListQuery {\n  customized_images {\n    id\n    name @deprecatedSince(version: "24.12.0")\n    humanized_name\n    tag\n    registry\n    architecture\n    digest\n    labels {\n      key\n      value\n    }\n    supported_accelerators\n    namespace @since(version: "24.12.0")\n    base_image_name @since(version: "24.12.0")\n    tags @since(version: "24.12.0") {\n      key\n      value\n    }\n    version @since(version: "24.12.0")\n    ...AliasedImageDoubleTagsFragment\n  }\n}\n\nfragment AliasedImageDoubleTagsFragment on ImageNode {\n  labels {\n    key\n    value\n  }\n  tags @since(version: "24.12.0") {\n    key\n    value\n  }\n}\n'}}}();l.hash="0e0ff40aaf7c9d5c859389b31cd6762a";const i=l},3413:(e,n,a)=>{a.d(n,{Ay:()=>k,Jj:()=>p});var l=a(65079),i=a(81751),t=a(34384),s=(a(96520),a(71559)),r=a(36290),o=a(64428),d=a.n(o),u=a(55202),g=a(52426);const m=e=>{let{image:n,...a}=e;n=n||"";const[,{getImageAliasName:l,getBaseVersion:s,tagAlias:r}]=(0,i.Gj)();return(0,g.jsx)(t.A,{values:[{label:r(l(n)),color:"blue"},{label:s(n),color:"green"}],...a})},c=e=>{let{image:n,...a}=e;n=n||"";const[,{getBaseImage:l,tagAlias:t}]=(0,i.Gj)();return d().isEmpty(t(l(n)))?null:(0,g.jsx)(r.A,{color:"green",...a,children:t(l(n))})},v=e=>{let{image:n,...a}=e;n=n||"";const[,{getArchitecture:l,tagAlias:t}]=(0,i.Gj)();return d().isEmpty(t(l(n)))?null:(0,g.jsx)(r.A,{color:"green",...a,children:l(n)})},y=e=>{let{image:n}=e;return n=n||"",(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(m,{image:n}),(0,g.jsx)(c,{image:n}),(0,g.jsx)(v,{image:n})]})},k=u.memo(y),p=e=>{let{tag:n,labels:a,highlightKeyword:o,...m}=e;a=a||[];const[,{getTags:c,tagAlias:v}]=(0,i.Gj)(),y=c(n,a);return(0,g.jsx)(u.Fragment,{...m,children:d().map(y,((e,n)=>{const a="Customized"===e.key,i=v(e.key+e.value);return d().isEqual(i,(0,l.WY)(e.key+e.value))?(0,g.jsx)(t.A,{highlightKeyword:o,values:[{label:v(e.key),color:a?"cyan":"blue"},{label:e.value,color:a?"cyan":"blue"}]},e.key):(0,g.jsx)(r.A,{color:a?"cyan":"blue",children:(0,g.jsx)(s.A,{keyword:o,children:i},n)},e.key)}))})}},68707:(e,n,a)=>{a.d(n,{A:()=>v});var l=a(38053),i=a(58394),t=a(37090),s=a(79837),r=a(294),o=a(36256),d=a(64428),u=a.n(d),g=a(55202),m=a(90635),c=a(52426);const v=e=>{var n;let{open:a,onRequestClose:d,columns:v,hiddenColumnKeys:y,...k}=e;const p=(0,g.useRef)(null),{t:h}=(0,m.Bd)(),{token:x}=t.A.useToken(),b=u().map(v,(e=>{return"string"===typeof e.title?{label:e.title,value:u().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(n=e.title,g.Children.map(n.props.children,(e=>{if("string"===typeof e)return e}))),value:u().toString(e.key)}:{label:void 0,value:u().toString(e.key)};var n}));return(0,c.jsx)(l.A,{title:h("table.SettingTable"),open:a,destroyOnClose:!0,centered:!0,onOk:()=>{var e;null===(e=p.current)||void 0===e||e.validateFields().then((e=>{d(e)})).catch((()=>{}))},onCancel:()=>{d()},...k,children:(0,c.jsxs)(s.A,{ref:p,preserve:!1,initialValues:{selectedColumnKeys:null===(n=u().map(b,"value"))||void 0===n?void 0:n.filter((e=>!u().includes(y,e)))},layout:"vertical",children:[(0,c.jsx)(s.A.Item,{name:"searchInput",label:h("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,c.jsx)(r.A,{prefix:(0,c.jsx)(i.A,{}),style:{marginBottom:x.marginSM},placeholder:h("table.SearchTableColumn")})}),(0,c.jsx)(s.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.searchInput!==n.searchInput,children:e=>{let{getFieldValue:n}=e;const a=n("searchInput")?u().toLower(n("searchInput")):void 0,l=u().map(b,(e=>u().toLower(u().toString(e.label)).includes(a||"")?e:{...e,style:{display:"none"}}));return(0,c.jsx)(s.A.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},rules:[{required:!0,message:h("general.validation.PleaseSelectOptions")}],children:(0,c.jsx)(o.A.Group,{options:l,style:{flexDirection:"column"}})})}})]})})}},92674:(e,n,a)=>{a.d(n,{a:()=>i});var l=a(79678);const i=e=>{const[n,a]=(0,l.q)(`hiddenColumnKeys.${e}`);return[n,a]}},28800:(e,n,a)=>{a.r(n),a.d(n,{default:()=>P});var l,i=a(4335),t=a(96520),s=a(68707),r=a(65079),o=a(81751),d=a(92674),u=a(34384),g=a(36290),m=a(64428),c=a.n(m),v=a(55202),y=a(18139),k=a(52426);const p=e=>{let{imageFrgmt:n,highlightKeyword:i,...s}=e;const d=(0,y.useFragment)(void 0!==l?l:l=a(32371),n),[,{tagAlias:m}]=(0,o.Gj)();return(0,k.jsx)(t.A,{direction:"row",align:"start",gap:"xxs",children:c().map(null===d||void 0===d?void 0:d.tags,(e=>{var n;const a=c().includes(e.key,"customized_"),l=a?null===(n=c().find(null===d||void 0===d?void 0:d.labels,{key:"ai.backend.customized-image.name"}))||void 0===n?void 0:n.value:e.value,t=m(e.key+l);return c().isEqual(t,(0,r.WY)(e.key+l))||a?(0,k.jsx)(u.A,{highlightKeyword:i,values:[{label:m(e.key),color:a?"cyan":s.color},{label:null!==l&&void 0!==l?l:"",color:a?"cyan":s.color}],...s},e.key):(0,k.jsx)(g.A,{color:a?"cyan":s.color,children:t},e.key)}))})};var h,x,b=a(41125),f=a(3413),_=a(71559),A=a(42896),j=a(58394),I=a(24262),K=a(50473),F=a(82844),S=a(37090),C=a(24480),w=a(18959),T=a(39979),z=a(90086),L=a(294),D=a(90635);const B=e=>{var n;let{children:l}=e;const{t:i}=(0,D.Bd)(),{token:u}=S.A.useToken(),{message:g}=C.A.useApp(),m=(0,o.CX)(),B=null!==(n=null===m||void 0===m?void 0:m.supports("extended-image-info"))&&void 0!==n&&n,[N,{toggle:V}]=(0,F.A)(),[M,P]=(0,v.useTransition)(),[q,G]=(0,o.Tw)("initial-fetch"),[R,$]=(0,v.useState)(),[E,Q]=(0,v.useState)(""),[U,O]=(0,v.useTransition)(),[,{getBaseVersion:Y,getBaseImages:W,getBaseImage:J,tagAlias:X,getTags:H}]=(0,o.Gj)(),{customized_images:Z}=(0,y.useLazyLoadQuery)(void 0!==h?h:h=a(16171),{},{fetchPolicy:"initial-fetch"===q?"store-and-network":"network-only",fetchKey:q}),[ee,ne]=(0,y.useMutation)(void 0!==x?x:x=a(61233)),ae=(0,v.useMemo)((()=>c().sortBy(Z,(e=>null===e||void 0===e?void 0:e.humanized_name))),[Z]),le=(0,v.useMemo)((()=>null===ae||void 0===ae?void 0:ae.map((e=>({namespace:B?null===e||void 0===e?void 0:e.namespace:null===e||void 0===e?void 0:e.name,fullName:(0,r.A_)(e)||"",digest:(null===e||void 0===e?void 0:e.digest)||"",baseversion:Y((0,r.A_)(e)||""),baseimage:null!==e&&void 0!==e&&e.tag&&null!==e&&void 0!==e&&e.name?W(e.tag,e.name):[],tag:H((null===e||void 0===e?void 0:e.tag)||"",null===e||void 0===e?void 0:e.labels)||[],isCustomized:!(null===e||void 0===e||!e.tag)&&-1!==e.tag.indexOf("customized"),baseImageName:B?null===e||void 0===e?void 0:e.base_image_name:"",tags:B?null===e||void 0===e?void 0:e.tags:[],version:B?null===e||void 0===e?void 0:e.version:""})))),[ae]),ie=(0,v.useMemo)((()=>{if(c().isEmpty(E))return ae;const e=new RegExp(`${c().escapeRegExp(E)}`,"i");return c().filter(ae,((n,a)=>c().some(n,((n,l)=>{if("id"===l)return!1;if(["digest","architecture","registry"].includes(l))return e.test(c().toString(n));const i=le[a]||{},t=e.test(i.baseversion),s=c().some(i.baseimage,(n=>e.test(n))),r=c().some(i.tag,(n=>e.test(n.key)||e.test(n.value))),o=!!i.isCustomized&&e.test("customized"),d=e.test(i.namespace||""),u=e.test(i.fullName),g=c().some(i.tags,(n=>e.test(n.key)||e.test(n.value))),m=e.test(i.version||""),v=e.test(i.digest);return t||s||r||d||o||u||g||m||v}))))}),[E,le,ae]),te=(0,r.LY)([{title:i("environment.FullImagePath"),key:"fullImagePath",render:e=>(0,k.jsx)(w.A.Text,{copyable:{text:(0,r.A_)(e)||""},children:(0,k.jsx)(_.A,{keyword:E,children:(0,r.A_)(e)||""})}),sorter:(e,n)=>(0,r._f)((0,r.A_)(e),(0,r.A_)(n)),width:u.screenXS},{title:i("environment.Registry"),dataIndex:"registry",key:"registry",sorter:(e,n)=>(0,r._f)(null===e||void 0===e?void 0:e.registry,null===n||void 0===n?void 0:n.registry),render:e=>(0,k.jsx)(_.A,{keyword:E,children:e})},{title:i("environment.Architecture"),dataIndex:"architecture",key:"architecture",sorter:(e,n)=>(0,r._f)(null===e||void 0===e?void 0:e.architecture,null===n||void 0===n?void 0:n.architecture),render:e=>(0,k.jsx)(_.A,{keyword:E,children:e})},B&&{title:i("environment.Namespace"),key:"namespace",dataIndex:"namespace",sorter:(e,n)=>(0,r._f)(null===e||void 0===e?void 0:e.namespace,null===n||void 0===n?void 0:n.namespace),render:e=>(0,k.jsx)(_.A,{keyword:E,children:e})},B&&{title:i("environment.BaseImageName"),key:"base_image_name",dataIndex:"base_image_name",sorter:(e,n)=>(0,r._f)(null===e||void 0===e?void 0:e.base_image_name,null===n||void 0===n?void 0:n.base_image_name),render:e=>(0,k.jsx)(_.A,{keyword:E,children:X(e)})},B&&{title:i("environment.Version"),key:"version",dataIndex:"version",sorter:(e,n)=>(0,r._f)(null===e||void 0===e?void 0:e.version,null===n||void 0===n?void 0:n.version),render:e=>(0,k.jsx)(_.A,{keyword:E,children:e})},B&&{title:i("environment.Tags"),key:"tags",dataIndex:"tags",render:(e,n)=>(0,k.jsx)(p,{imageFrgmt:n,highlightKeyword:E,label:""})},!B&&{title:i("environment.Namespace"),key:"name",dataIndex:"name",sorter:(e,n)=>(0,r._f)((0,r.A_)(e),(0,r.A_)(n)),render:e=>(0,k.jsx)(_.A,{keyword:E,children:e})},!B&&{title:i("environment.Version"),key:"baseversion",dataIndex:"baseversion",sorter:(e,n)=>(0,r._f)(Y((0,r.A_)(e)||""),Y((0,r.A_)(n)||"")),render:(e,n)=>(0,k.jsx)(_.A,{keyword:E,children:Y((0,r.A_)(n)||"")})},!B&&{title:i("environment.Base"),key:"baseimage",dataIndex:"baseimage",sorter:(e,n)=>(0,r._f)(J((0,r.A_)(e)||""),J((0,r.A_)(n)||"")),render:(e,n)=>(0,k.jsx)(_.A,{keyword:E,children:X(J((0,r.A_)(n)||""))})},!B&&{title:i("environment.Tags"),key:"tag",dataIndex:"tag",sorter:(e,n)=>(0,r._f)(null===e||void 0===e?void 0:e.tag,null===n||void 0===n?void 0:n.tag),render:(e,n)=>(0,k.jsx)(f.Jj,{tag:e,labels:null===n||void 0===n?void 0:n.labels,highlightKeyword:E})},{title:i("environment.Digest"),dataIndex:"digest",key:"digest",sorter:(e,n)=>(0,r._f)(null===e||void 0===e?void 0:e.digest,null===n||void 0===n?void 0:n.digest),render:e=>(0,k.jsx)(w.A.Text,{ellipsis:{tooltip:!0},style:{maxWidth:200},children:(0,k.jsx)(_.A,{keyword:E,children:e})})},{title:i("general.Control"),key:"control",fixed:"right",render:(e,n)=>(0,k.jsx)(t.A,{direction:"row",align:"stretch",justify:"center",gap:"xxs",children:(0,k.jsx)(T.A,{title:i("dialog.ask.DoYouWantToProceed"),description:i("dialog.warning.CannotBeUndone"),okType:"danger",okText:i("button.Delete"),onConfirm:()=>{null!==n&&void 0!==n&&n.id&&($(n.id+q),ee({variables:{id:n.id},onCompleted(e,n){var a,l,t,s;if(c().isNil(null===e||void 0===e?void 0:e.forget_image_by_id)||null!==e&&void 0!==e&&null!==(a=e.forget_image_by_id)&&void 0!==a&&a.ok)if(c().isNil(null===e||void 0===e?void 0:e.untag_image_from_registry)||null!==e&&void 0!==e&&null!==(l=e.untag_image_from_registry)&&void 0!==l&&l.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=c().map(n,(e=>e.message));for(const n of e)g.error(n)}else P((()=>{G()})),g.success(i("environment.CustomizedImageSuccessfullyDeleted"));else g.error(null===e||void 0===e||null===(t=e.untag_image_from_registry)||void 0===t?void 0:t.msg);else g.error(null===e||void 0===e||null===(s=e.forget_image_by_id)||void 0===s?void 0:s.msg)},onError(e){g.error(null===e||void 0===e?void 0:e.message)}}))},children:(0,k.jsx)(z.Ay,{type:"text",icon:(0,k.jsx)(A.A,{}),danger:!0,loading:ne&&R===(null===n||void 0===n?void 0:n.id)+q,disabled:ne&&R!==(null===n||void 0===n?void 0:n.id)+q})})})}]),[se,re]=(0,d.a)("CustomizedImageList");return(0,k.jsxs)(t.A,{direction:"column",align:"stretch",children:[(0,k.jsxs)(t.A,{direction:"column",align:"stretch",gap:"sm",children:[(0,k.jsxs)(t.A,{justify:"between",gap:"xs",wrap:"wrap",children:[(0,k.jsx)(L.A,{allowClear:!0,prefix:(0,k.jsx)(j.A,{}),placeholder:i("environment.SearchImages"),onChange:e=>{O((()=>Q(e.target.value)))},style:{width:200}}),(0,k.jsx)(z.Ay,{icon:(0,k.jsx)(I.A,{}),loading:M,onClick:()=>{P((()=>G()))}})]}),(0,k.jsx)(b.A,{neoStyle:!0,size:"small",resizable:!0,loading:U,columns:c().filter(te,(e=>!c().includes(se,c().toString(null===e||void 0===e?void 0:e.key)))),dataSource:(0,r.tS)(ie),rowKey:"id",scroll:{x:"max-content"},pagination:{extraContent:(0,k.jsx)(z.Ay,{type:"text",icon:(0,k.jsx)(K.A,{}),onClick:()=>{V()}})}})]}),(0,k.jsx)(s.A,{open:N,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&re(c().difference(te.map((e=>c().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),V()},columns:te,hiddenColumnKeys:se})]})};var N=a(48648),V=a(47174);const M=(0,V.withDefault)(V.StringParam,"image"),P=()=>{const{t:e}=(0,D.Bd)(),[n,a]=(0,V.useQueryParam)("tab",M),{token:l}=S.A.useToken();return(0,k.jsx)(i.A,{activeTabKey:n,onTabChange:a,tabList:[{key:"image",label:e("environment.Images")}],styles:{body:{padding:`${l.paddingSM}px ${l.paddingLG}px ${l.paddingLG}px ${l.paddingLG}px`}},children:(0,k.jsx)(v.Suspense,{fallback:(0,k.jsx)(N.A,{style:{height:"calc(100vh - 145px)"},spinSize:"large"}),children:"image"===n&&(0,k.jsx)(B,{})})})}}}]);
//# sourceMappingURL=8800.8d7bbea9.chunk.js.map