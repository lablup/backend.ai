"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[312],{99312:(e,a,n)=>{n.r(a),n.d(a,{StorageStatusPanelFallback:()=>q,default:()=>K});var t,i=n(30032),r=n(83468),o=n(29871),l=n(36009),s=n(90139),d=n(50840),c=n(34626),u=n(13279),p=n(76998),g=n(77678),m=n(3606),y=n(23446);const _=e=>{var a,r,l,s,p;let{usageProgressFrgmt:_}=e;const{t:h}=(0,g.Bd)(),{token:k}=d.A.useToken(),v=(0,m.useFragment)(void 0!==t?t:t=n(32895),_),f=parseFloat(null===v||void 0===v||null===(a=v.details)||void 0===a?void 0:a.usage_bytes)||0,b=parseFloat(null===v||void 0===v||null===(r=v.details)||void 0===r?void 0:r.hard_limit_bytes)||0,x=b>0?null===(l=f/b*100)||void 0===l?void 0:l.toFixed(2):0;return(0,y.jsxs)(o.A,{direction:"column",children:[(0,y.jsx)(c.A,{size:[180,15],percent:x,strokeColor:(0,i.yc)(x),status:x>=100?"exception":"normal"}),(0,y.jsxs)(o.A,{direction:"row",gap:k.marginXXS,style:{fontSize:12},children:[(0,y.jsxs)(u.A.Text,{type:"secondary",style:{fontSize:12},children:[h("data.Used"),":"]}),(0,i.wb)(null===v||void 0===v||null===(s=v.details)||void 0===s?void 0:s.usage_bytes)," GB",(0,y.jsx)(u.A.Text,{type:"secondary",style:{fontSize:12},children:" / "}),(0,y.jsxs)(u.A.Text,{type:"secondary",style:{fontSize:12},children:[h("data.Limit"),":"]}),(0,i.wb)(null===v||void 0===v||null===(p=v.details)||void 0===p?void 0:p.hard_limit_bytes)," GB"]})]})};var h,k,v=n(2292),f=n(64283),b=n(20307),x=n(6932),S=n(63214),j=n(29475),w=n(22307),A=n(43309),F=n(45901),P=n.n(F),z=n(91560);const q=()=>{const{t:e}=(0,g.Bd)();return(0,y.jsx)(j.A,{size:"small",title:e("data.StorageStatus"),children:(0,y.jsx)(A.A,{active:!0})})},K=e=>{var a,t;let{fetchKey:A}=e;const{t:F}=(0,g.Bd)(),{token:q}=d.A.useToken(),K=(0,r.CX)(),Q=(0,r.hd)(),[T,L]=(0,p.useState)(),V=(0,p.useDeferredValue)(T),$=(0,p.useDeferredValue)(A),O=e=>P().includes(["delete-ongoing","delete-complete","delete-error"],e),{data:I}=(0,z.useQuery)(["vfolders",{deferredFetchKey:$}],(()=>K.vfolder.list(null===Q||void 0===Q?void 0:Q.id))),C=null===I||void 0===I?void 0:I.filter((e=>e.is_owner&&"user"===e.ownership_type&&!O(e.status))).length,N=null===I||void 0===I?void 0:I.filter((e=>"group"===e.ownership_type&&!O(e.status))).length,B=null===I||void 0===I?void 0:I.filter((e=>!e.is_owner&&"user"===e.ownership_type&&!O(e.status))).length,{keypair:D,user:E}=(0,m.useLazyLoadQuery)(void 0!==h?h:h=n(69689),{domain_name:(0,r.eZ)(),email:null===K||void 0===K?void 0:K.email,access_key:null===K||void 0===K?void 0:K._config.accessKey}),{user_resource_policy:M,keypair_resource_policy:R,project_quota_scope:H,user_quota_scope:U}=(0,m.useLazyLoadQuery)(void 0!==k?k:k=n(80648),{user_RP_name:null===E||void 0===E?void 0:E.resource_policy,keypair_resource_policy_name:null===D||void 0===D?void 0:D.resource_policy,project_quota_scope_id:(0,i.sZ)("project",null===Q||void 0===Q?void 0:Q.id),user_quota_scope_id:(0,i.sZ)("user",(null===E||void 0===E?void 0:E.id)||""),storage_host_name:(null===V||void 0===V?void 0:V.id)||"",skipQuotaScope:void 0===(null===Q||void 0===Q?void 0:Q.id)||void 0===(null===E||void 0===E?void 0:E.id)||!(null!==V&&void 0!==V&&V.id)});let W;W=null!==K&&void 0!==K&&K.supports("max-vfolder-count-in-user-and-project-resource-policy")?(null===M||void 0===M?void 0:M.max_vfolder_count)||0:(null===R||void 0===R?void 0:R.max_vfolder_count)||0;const X=W||0===W?W>0?null===(a=C/W*100)||void 0===a?void 0:a.toFixed(2):0:null,G=[{key:"totalFolders",label:F("data.NumberOfFolders"),children:(0,y.jsxs)(y.Fragment,{children:[X||0===X?(0,y.jsx)(c.A,{size:[200,15],percent:X,strokeColor:(0,i.yc)(X),style:{width:"95%"},status:X>=100?"exception":"normal"}):null,(0,y.jsxs)(o.A,{direction:"row",gap:q.marginXXS,wrap:"wrap",children:[(0,y.jsxs)(u.A.Text,{type:"secondary",children:[F("data.Created"),":"]}),C,W||0===W?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(u.A.Text,{type:"secondary",children:" / "}),(0,y.jsxs)(u.A.Text,{type:"secondary",children:[F("data.Limit"),":"]}),0===W?"\u221e":W]}):null]}),(0,y.jsx)(f.A,{style:{margin:"12px auto"}}),(0,y.jsxs)(o.A,{direction:"row",wrap:"wrap",justify:"between",children:[(0,y.jsxs)(o.A,{gap:q.marginXXS,children:[(0,y.jsxs)(u.A.Text,{type:"secondary",children:[F("data.ProjectFolder"),":"]}),N]}),(0,y.jsxs)(o.A,{gap:q.marginXXS,style:{marginRight:30},children:[(0,y.jsxs)(u.A.Text,{type:"secondary",children:[F("data.Invited"),":"]}),B]})]})]})},{key:"quotaPerStorageVolume",label:(0,y.jsxs)("div",{children:[F("data.QuotaPerStorageVolume"),(0,y.jsx)(b.A,{title:F("data.HostDetails"),children:(0,y.jsx)(x.Ay,{type:"link",icon:(0,y.jsx)(v.A,{})})})]}),children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(o.A,{wrap:"wrap",justify:"between",direction:"row",style:{minWidth:"25vw"},children:[(0,y.jsx)(u.A.Text,{type:"secondary",children:F("data.Host")}),(0,y.jsx)(s.A,{value:null===T||void 0===T?void 0:T.id,onChange:(e,a)=>{L(a)},autoSelectType:"usage",showUsageStatus:!0,showSearch:!0,allowClear:!0})]}),T!==V?(0,y.jsx)(l.A,{style:{minHeight:120}}):null!==T&&void 0!==T&&null!==(t=T.capabilities)&&void 0!==t&&t.includes("quota")?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(o.A,{style:{margin:"15px auto"},justify:"between",wrap:"wrap",children:[(0,y.jsxs)(u.A.Text,{type:"secondary",style:{wordBreak:"keep-all",wordWrap:"break-word"},children:[F("data.Project"),(0,y.jsx)("br",{}),"(",null===Q||void 0===Q?void 0:Q.name,")"]}),(0,y.jsx)(_,{usageProgressFrgmt:H||null})]}),(0,y.jsxs)(o.A,{justify:"between",wrap:"wrap",children:[(0,y.jsxs)(u.A.Text,{type:"secondary",style:{wordBreak:"keep-all",wordWrap:"break-word"},children:[F("data.User"),(0,y.jsx)("br",{}),"(",null===K||void 0===K?void 0:K.email,")"]}),(0,y.jsx)(_,{usageProgressFrgmt:U||null})]})]}):(0,y.jsx)(S.A,{image:S.A.PRESENTED_IMAGE_SIMPLE,description:F("storageHost.QuotaDoesNotSupported"),style:{margin:"25px auto"}})]})},{key:"userQuotaScopeId",label:F("data.userQuotaScopeId"),children:(0,y.jsx)(u.A.Text,{copyable:!0,children:(0,i.sZ)("user",(null===E||void 0===E?void 0:E.id)||"")})}];return(0,y.jsx)(j.A,{size:"small",title:F("data.StorageStatus"),children:(0,y.jsx)(w.A,{bordered:!0,column:{xxl:2,xl:2,lg:2,md:1,sm:1,xs:1},size:"small",items:G})})}},69689:(e,a,n)=>{n.r(a),n.d(a,{default:()=>i});const t=function(){var e={defaultValue:null,kind:"LocalArgument",name:"access_key"},a={defaultValue:null,kind:"LocalArgument",name:"domain_name"},n={defaultValue:null,kind:"LocalArgument",name:"email"},t={kind:"Variable",name:"domain_name",variableName:"domain_name"},i=[{kind:"Variable",name:"access_key",variableName:"access_key"},t],r={alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:[t,{kind:"Variable",name:"email",variableName:"email"}],concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[o,r],storageKey:null};return{fragment:{argumentDefinitions:[e,a,n],kind:"Fragment",metadata:null,name:"StorageStatusPanelKeypairQuery",selections:[{alias:null,args:i,concreteType:"KeyPair",kind:"LinkedField",name:"keypair",plural:!1,selections:[r],storageKey:null},l],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,e],kind:"Operation",name:"StorageStatusPanelKeypairQuery",selections:[{alias:null,args:i,concreteType:"KeyPair",kind:"LinkedField",name:"keypair",plural:!1,selections:[r,o],storageKey:null},l]},params:{cacheID:"95e9a2aff9ba76edfc0781be14e9263f",id:null,metadata:{},name:"StorageStatusPanelKeypairQuery",operationKind:"query",text:'query StorageStatusPanelKeypairQuery(\n  $domain_name: String\n  $email: String\n  $access_key: String\n) {\n  keypair(domain_name: $domain_name, access_key: $access_key) {\n    resource_policy\n    id\n  }\n  user(domain_name: $domain_name, email: $email) {\n    id\n    resource_policy @since(version: "23.09.0")\n  }\n}\n'}}}();t.hash="356fec51b64103fba9f667dba1713774";const i=t},80648:(e,a,n)=>{n.r(a),n.d(a,{default:()=>i});const t=function(){var e={defaultValue:null,kind:"LocalArgument",name:"keypair_resource_policy_name"},a={defaultValue:null,kind:"LocalArgument",name:"project_quota_scope_id"},n={defaultValue:null,kind:"LocalArgument",name:"skipQuotaScope"},t={defaultValue:null,kind:"LocalArgument",name:"storage_host_name"},i={defaultValue:null,kind:"LocalArgument",name:"user_RP_name"},r={defaultValue:null,kind:"LocalArgument",name:"user_quota_scope_id"},o=[{kind:"Variable",name:"name",variableName:"user_RP_name"}],l={alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},s=[l],d={alias:null,args:[{kind:"Variable",name:"name",variableName:"keypair_resource_policy_name"}],concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policy",plural:!1,selections:s,storageKey:null},c={kind:"Variable",name:"storage_host_name",variableName:"storage_host_name"},u=[{kind:"Variable",name:"quota_scope_id",variableName:"project_quota_scope_id"},c],p=[{args:null,kind:"FragmentSpread",name:"UsageProgressFragment_usageFrgmt"}],g=[{kind:"Variable",name:"quota_scope_id",variableName:"user_quota_scope_id"},c],m={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},y=[{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"usage_bytes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null}],storageKey:null},m];return{fragment:{argumentDefinitions:[e,a,n,t,i,r],kind:"Fragment",metadata:null,name:"StorageStatusPanelQuery",selections:[{alias:null,args:o,concreteType:"UserResourcePolicy",kind:"LinkedField",name:"user_resource_policy",plural:!1,selections:s,storageKey:null},d,{condition:"skipQuotaScope",kind:"Condition",passingValue:!1,selections:[{alias:"project_quota_scope",args:u,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:p,storageKey:null},{alias:"user_quota_scope",args:g,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:p,storageKey:null}]}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[i,e,a,r,t,n],kind:"Operation",name:"StorageStatusPanelQuery",selections:[{alias:null,args:o,concreteType:"UserResourcePolicy",kind:"LinkedField",name:"user_resource_policy",plural:!1,selections:[l,m],storageKey:null},d,{condition:"skipQuotaScope",kind:"Condition",passingValue:!1,selections:[{alias:"project_quota_scope",args:u,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:y,storageKey:null},{alias:"user_quota_scope",args:g,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:y,storageKey:null}]}]},params:{cacheID:"05f25e3d87206ea4625cbb9710803f87",id:null,metadata:{},name:"StorageStatusPanelQuery",operationKind:"query",text:'query StorageStatusPanelQuery(\n  $user_RP_name: String\n  $keypair_resource_policy_name: String\n  $project_quota_scope_id: String!\n  $user_quota_scope_id: String!\n  $storage_host_name: String!\n  $skipQuotaScope: Boolean!\n) {\n  user_resource_policy(name: $user_RP_name) @since(version: "23.09.6") {\n    max_vfolder_count\n    id\n  }\n  keypair_resource_policy(name: $keypair_resource_policy_name) @deprecatedSince(version: "23.09.4") {\n    max_vfolder_count\n  }\n  project_quota_scope: quota_scope(quota_scope_id: $project_quota_scope_id, storage_host_name: $storage_host_name) @skip(if: $skipQuotaScope) {\n    ...UsageProgressFragment_usageFrgmt\n    id\n  }\n  user_quota_scope: quota_scope(quota_scope_id: $user_quota_scope_id, storage_host_name: $storage_host_name) @skip(if: $skipQuotaScope) {\n    ...UsageProgressFragment_usageFrgmt\n    id\n  }\n}\n\nfragment UsageProgressFragment_usageFrgmt on QuotaScope {\n  details {\n    usage_bytes\n    hard_limit_bytes\n  }\n}\n'}}}();t.hash="d68618805bf1551f1c28d57c12276539";const i=t},32895:(e,a,n)=>{n.r(a),n.d(a,{default:()=>i});const t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsageProgressFragment_usageFrgmt",selections:[{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"usage_bytes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null}],storageKey:null}],type:"QuotaScope",abstractKey:null,hash:"1ba87b250f2a0161ecee7ba88d54c85c"},i=t},64283:(e,a,n)=>{n.d(a,{A:()=>m});var t=n(76998),i=n(34156),r=n.n(i),o=n(28037),l=n(89213),s=n(64663),d=n(55864),c=n(89514);const u=e=>{const{componentCls:a,sizePaddingEdgeHorizontal:n,colorSplit:t,lineWidth:i,textPaddingInline:r,orientationMargin:o,verticalMarginInline:d}=e;return{[a]:Object.assign(Object.assign({},(0,s.dF)(e)),{borderBlockStart:"".concat((0,l.zA)(i)," solid ").concat(t),"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:d,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:"".concat((0,l.zA)(i)," solid ").concat(t)},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:"".concat((0,l.zA)(e.dividerHorizontalGutterMargin)," 0")},["&-horizontal".concat(a,"-with-text")]:{display:"flex",alignItems:"center",margin:"".concat((0,l.zA)(e.dividerHorizontalWithTextGutterMargin)," 0"),color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:"0 ".concat(t),"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:"".concat((0,l.zA)(i)," solid transparent"),borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},["&-horizontal".concat(a,"-with-text-left")]:{"&::before":{width:"calc(".concat(o," * 100%)")},"&::after":{width:"calc(100% - ".concat(o," * 100%)")}},["&-horizontal".concat(a,"-with-text-right")]:{"&::before":{width:"calc(100% - ".concat(o," * 100%)")},"&::after":{width:"calc(".concat(o," * 100%)")}},["".concat(a,"-inner-text")]:{display:"inline-block",paddingBlock:0,paddingInline:r},"&-dashed":{background:"none",borderColor:t,borderStyle:"dashed",borderWidth:"".concat((0,l.zA)(i)," 0 0")},["&-horizontal".concat(a,"-with-text").concat(a,"-dashed")]:{"&::before, &::after":{borderStyle:"dashed none none"}},["&-vertical".concat(a,"-dashed")]:{borderInlineStartWidth:i,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},["&-plain".concat(a,"-with-text")]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize},["&-horizontal".concat(a,"-with-text-left").concat(a,"-no-default-orientation-margin-left")]:{"&::before":{width:0},"&::after":{width:"100%"},["".concat(a,"-inner-text")]:{paddingInlineStart:n}},["&-horizontal".concat(a,"-with-text-right").concat(a,"-no-default-orientation-margin-right")]:{"&::before":{width:"100%"},"&::after":{width:0},["".concat(a,"-inner-text")]:{paddingInlineEnd:n}}})}},p=(0,d.OF)("Divider",(e=>{const a=(0,c.h1)(e,{dividerHorizontalWithTextGutterMargin:e.margin,dividerHorizontalGutterMargin:e.marginLG,sizePaddingEdgeHorizontal:0});return[u(a)]}),(e=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:e.marginXS})),{unitless:{orientationMargin:!0}});var g=function(e,a){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(e);i<t.length;i++)a.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(n[t[i]]=e[t[i]])}return n};const m=e=>{const{getPrefixCls:a,direction:n,divider:i}=t.useContext(o.QO),{prefixCls:l,type:s="horizontal",orientation:d="center",orientationMargin:c,className:u,rootClassName:m,children:y,dashed:_,plain:h,style:k}=e,v=g(e,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","plain","style"]),f=a("divider",l),[b,x,S]=p(f),j=d.length>0?"-".concat(d):d,w=!!y,A="left"===d&&null!=c,F="right"===d&&null!=c,P=r()(f,null===i||void 0===i?void 0:i.className,x,S,"".concat(f,"-").concat(s),{["".concat(f,"-with-text")]:w,["".concat(f,"-with-text").concat(j)]:w,["".concat(f,"-dashed")]:!!_,["".concat(f,"-plain")]:!!h,["".concat(f,"-rtl")]:"rtl"===n,["".concat(f,"-no-default-orientation-margin-left")]:A,["".concat(f,"-no-default-orientation-margin-right")]:F},u,m),z=t.useMemo((()=>"number"===typeof c?c:/^\d+$/.test(c)?Number(c):c),[c]),q=Object.assign(Object.assign({},A&&{marginLeft:z}),F&&{marginRight:z});return b(t.createElement("div",Object.assign({className:P,style:Object.assign(Object.assign({},null===i||void 0===i?void 0:i.style),k)},v,{role:"separator"}),y&&"vertical"!==s&&t.createElement("span",{className:"".concat(f,"-inner-text"),style:q},y)))}}}]);
//# sourceMappingURL=312.886eb328.chunk.js.map