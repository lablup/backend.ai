"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1584],{1584:(e,n,i)=>{i.r(n),i.d(n,{default:()=>T});const a=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},n={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:null,kind:"LocalArgument",name:"limit"},a={defaultValue:null,kind:"LocalArgument",name:"offset"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},o=[r,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],d={alias:null,args:null,concreteType:"SourceInfo",kind:"LinkedField",name:"registry",plural:!1,selections:o,storageKey:null},c={alias:null,args:null,concreteType:"SourceInfo",kind:"LinkedField",name:"source",plural:!1,selections:o,storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},g={kind:"Literal",name:"orderBy",value:{direction:"DESC",field:"VERSION"}},f=[{kind:"Literal",name:"filter",value:{status:{equals:"PULLING"}}},g],m={alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},A={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},y={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},k={kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null}]},F=[{kind:"Literal",name:"first",value:1},g],R={alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null},L={args:null,kind:"FragmentSpread",name:"BAIImportArtifactModalArtifactRevisionFragment"},S=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},g];return{fragment:{argumentDefinitions:[e,n,i,a],kind:"Fragment",metadata:null,name:"ReservoirArtifactDetailPageQuery",selections:[{alias:null,args:t,concreteType:"Artifact",kind:"LinkedField",name:"artifact",plural:!1,selections:[l,r,{args:null,kind:"FragmentSpread",name:"BAIArtifactTypeTagFragment"},s,d,c,u,{alias:"pullingArtifactRevisions",args:f,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"__ReservoirArtifactDetailPage_pullingArtifactRevisions_connection",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,v,{args:null,kind:"FragmentSpread",name:"BAIPullingArtifactRevisionAlertFragment"},A],storageKey:null},p],storageKey:null},y,k],storageKey:'__ReservoirArtifactDetailPage_pullingArtifactRevisions_connection(filter:{"status":{"equals":"PULLING"}},orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:"latestVersion",args:F,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,R,I,v,L,{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionTableLatestRevisionFragment"}],storageKey:null}],storageKey:null}],storageKey:'revisions(first:1,orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:null,args:S,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,v,{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionTableArtifactRevisionFragment"},L,{args:null,kind:"FragmentSpread",name:"BAIDeleteArtifactRevisionsModalArtifactRevisionFragment"},{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionDeleteButtonFragment"},{args:null,kind:"FragmentSpread",name:"BAIArtifactRevisionDownloadButtonFragment"}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"BAIImportArtifactModalArtifactFragment"},{args:null,kind:"FragmentSpread",name:"BAIDeleteArtifactRevisionsModalArtifactFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,i,e],kind:"Operation",name:"ReservoirArtifactDetailPageQuery",selections:[{alias:null,args:t,concreteType:"Artifact",kind:"LinkedField",name:"artifact",plural:!1,selections:[l,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},s,d,c,u,{alias:"pullingArtifactRevisions",args:f,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,v,I,A],storageKey:null},p],storageKey:null},y,k],storageKey:'revisions(filter:{"status":{"equals":"PULLING"}},orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:"pullingArtifactRevisions",args:f,filters:["filter","orderBy"],handle:"connection",key:"ReservoirArtifactDetailPage_pullingArtifactRevisions",kind:"LinkedHandle",name:"revisions"},{alias:"latestVersion",args:F,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,R,I,v],storageKey:null}],storageKey:null}],storageKey:'revisions(first:1,orderBy:{"direction":"DESC","field":"VERSION"})'},{alias:null,args:S,concreteType:"ArtifactRevisionConnection",kind:"LinkedField",name:"revisions",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ArtifactRevisionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ArtifactRevision",kind:"LinkedField",name:"node",plural:!1,selections:[l,v,I,R,u],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"0d1cbe108f844759d49f2a65d38b28c4",id:null,metadata:{connection:[{count:null,cursor:null,direction:"bidirectional",path:["artifact","pullingArtifactRevisions"]}]},name:"ReservoirArtifactDetailPageQuery",operationKind:"query",text:"query ReservoirArtifactDetailPageQuery(\n  $id: ID!\n  $offset: Int!\n  $limit: Int!\n  $filter: ArtifactRevisionFilter!\n) {\n  artifact(id: $id) {\n    id\n    name\n    ...BAIArtifactTypeTagFragment\n    description\n    registry {\n      name\n      url\n    }\n    source {\n      name\n      url\n    }\n    updatedAt\n    pullingArtifactRevisions: revisions(filter: {status: {equals: PULLING}}, orderBy: {field: VERSION, direction: DESC}) {\n      count\n      edges {\n        node {\n          id\n          status\n          ...BAIPullingArtifactRevisionAlertFragment\n          __typename\n        }\n        cursor\n      }\n      pageInfo {\n        endCursor\n        hasNextPage\n        hasPreviousPage\n        startCursor\n      }\n    }\n    latestVersion: revisions(first: 1, orderBy: {field: VERSION, direction: DESC}) {\n      edges {\n        node {\n          id\n          size\n          version\n          status\n          ...BAIImportArtifactModalArtifactRevisionFragment\n          ...BAIArtifactRevisionTableLatestRevisionFragment\n        }\n      }\n    }\n    revisions(offset: $offset, limit: $limit, orderBy: {field: VERSION, direction: DESC}, filter: $filter) {\n      count\n      edges {\n        node {\n          id\n          status\n          ...BAIArtifactRevisionTableArtifactRevisionFragment\n          ...BAIImportArtifactModalArtifactRevisionFragment\n          ...BAIDeleteArtifactRevisionsModalArtifactRevisionFragment\n          ...BAIArtifactRevisionDeleteButtonFragment\n          ...BAIArtifactRevisionDownloadButtonFragment\n        }\n      }\n    }\n    ...BAIImportArtifactModalArtifactFragment\n    ...BAIDeleteArtifactRevisionsModalArtifactFragment\n  }\n}\n\nfragment BAIArtifactDescriptionsFragment on Artifact {\n  name\n  description\n  source {\n    name\n    url\n  }\n  ...BAIArtifactTypeTagFragment\n}\n\nfragment BAIArtifactRevisionDeleteButtonFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactRevisionDownloadButtonFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactRevisionTableArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n  updatedAt\n  ...BAIArtifactStatusTagFragment\n  ...BAIArtifactRevisionDownloadButtonFragment\n  ...BAIArtifactRevisionDeleteButtonFragment\n}\n\nfragment BAIArtifactRevisionTableLatestRevisionFragment on ArtifactRevision {\n  id\n}\n\nfragment BAIArtifactStatusTagFragment on ArtifactRevision {\n  status\n}\n\nfragment BAIArtifactTypeTagFragment on Artifact {\n  type\n}\n\nfragment BAIDeleteArtifactRevisionsModalArtifactFragment on Artifact {\n  id\n  ...BAIArtifactDescriptionsFragment\n}\n\nfragment BAIDeleteArtifactRevisionsModalArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n}\n\nfragment BAIImportArtifactModalArtifactFragment on Artifact {\n  id\n  name\n  ...BAIArtifactDescriptionsFragment\n}\n\nfragment BAIImportArtifactModalArtifactRevisionFragment on ArtifactRevision {\n  id\n  version\n  size\n  status\n}\n\nfragment BAIPullingArtifactRevisionAlertFragment on ArtifactRevision {\n  id\n  status\n  version\n}\n"}}}();a.hash="84c2e87c5b490db6c7abb4854da057af";const t=a;var l=i(28599),r=i(68144),s=i(46038),o=i(31370),d=i(6534),c=i(91313),u=i(77629),g=i.n(u),f=i(53915),m=i.n(f),v=i(8348),A=i.n(v),p=i(56038),y=i(84100),k=i(81291),F=i(85724),R=i(13819),I=i(84970),L=i(19885),S=i(61774),B=i(30167),b=i(42667),h=i(7960);g().extend(m());const{Title:P,Text:D,Paragraph:x}=l.A,T=()=>{var e,n,i,a;const{token:u}=r.A.useToken(),{t:f}=(0,k.Bd)(),{upsertNotification:m}=(0,B.js)(),{artifactId:v}=(0,R.g)(),[T,E]=(0,L.Tw)(L.eI),[K,N]=(0,y.useState)([]),[C,j]=(0,y.useState)([]),[V,O]=(0,y.useState)([]),[_,M]=(0,b.useQueryParams)({filter:(0,b.withDefault)(b.JsonParam,{})}),w=JSON.stringify(_.filter),{baiPaginationOption:$,tablePaginationOption:z,setTablePaginationOption:G}=(0,S.aW)({current:1,pageSize:10}),U=(0,y.useMemo)((()=>({id:null!==v&&void 0!==v?v:"",offset:$.offset,limit:$.limit,filter:JSON.parse(w||"{}")})),[v,$.limit,$.offset,w]),q=(0,y.useDeferredValue)(U),Q=(0,y.useDeferredValue)(T),{artifact:J}=(0,F.useLazyLoadQuery)(t,q,{fetchKey:Q===L.eI?void 0:Q,fetchPolicy:Q===L.eI?"store-and-network":"network-only"}),Y=null===J||void 0===J||null===(e=J.latestVersion.edges[0])||void 0===e?void 0:e.node,Z=(0,c.f)(null===J||void 0===J?void 0:J.pullingArtifactRevisions.edges.map((e=>null===e||void 0===e?void 0:e.node)));return(0,h.jsxs)("div",{children:[(0,h.jsxs)(c.OO,{align:"center",style:{marginBottom:u.marginLG},justify:"between",children:[(0,h.jsxs)(c.OO,{align:"center",gap:"xs",children:[(0,h.jsx)(P,{level:3,style:{margin:0},children:null===J||void 0===J?void 0:J.name}),J&&(0,h.jsx)(c.bk,{artifactTypeFrgmt:J})]}),(0,h.jsx)(I.A,{value:T,autoUpdateDelay:1e4,loading:Q!==T,onChange:()=>{E()}})]}),Z.length>0&&(0,h.jsx)(c.OO,{direction:"column",gap:"sm",align:"stretch",style:{marginBottom:u.marginMD},children:Z.map((e=>(0,h.jsx)(c.vy,{pullingArtifactRevisionFrgmt:e,onOk:()=>{E()}},e.id)))}),(0,h.jsx)(c.Zu,{title:f("reservoirPage.BasicInformation"),showDivider:!0,extra:(0,h.jsx)(s.Ay,{type:"primary",icon:(0,h.jsx)(p.A,{size:16}),onClick:()=>{Y&&O([Y])},disabled:!Y||"SCANNED"!==Y.status,children:Y?f("reservoirPage.PullLatestVersion",{version:Y.version}):"N/A"}),style:{marginBottom:u.marginMD},children:(0,h.jsxs)(o.A,{column:2,bordered:!0,children:[(0,h.jsx)(o.A.Item,{label:f("reservoirPage.Name"),children:null===J||void 0===J?void 0:J.name}),(0,h.jsx)(o.A.Item,{label:f("reservoirPage.Type"),children:J&&(0,h.jsx)(c.bk,{artifactTypeFrgmt:J})}),(0,h.jsx)(o.A.Item,{label:f("reservoirPage.Size"),children:(0,h.jsx)(c.mQ,{monospace:!0,children:null!==Y&&void 0!==Y&&Y.size?null===(n=(0,c.Gh)(Y.size,"auto"))||void 0===n?void 0:n.displayValue:"N/A"})}),(0,h.jsx)(o.A.Item,{label:f("reservoirPage.Source"),children:null!==J&&void 0!==J&&J.source?(0,h.jsx)(l.A.Link,{href:null!==(i=J.source.url)&&void 0!==i?i:"",target:"_blank",rel:"noopener noreferrer",children:J.source.name||"N/A"}):"N/A"}),(0,h.jsx)(o.A.Item,{label:f("reservoirPage.Registry"),children:(0,h.jsx)(l.A,{children:null!==J&&void 0!==J&&J.registry?`${J.registry.name}(${J.registry.url})`:"N/A"})}),(0,h.jsx)(o.A.Item,{label:f("reservoirPage.LastUpdated"),span:2,children:null!==J&&void 0!==J&&J.updatedAt?g()(null===J||void 0===J?void 0:J.updatedAt).format("lll"):"N/A"}),(0,h.jsx)(o.A.Item,{label:f("reservoirPage.Description"),span:2,children:null!==J&&void 0!==J&&J.description?(0,h.jsx)(x,{children:J.description}):"N/A"})]})}),(0,h.jsx)(c.Zu,{title:f("reservoirPage.VersionList"),showDivider:!0,style:{marginBottom:u.marginMD},styles:{body:{padding:`${u.paddingSM}px ${u.paddingLG}px ${u.paddingLG}px ${u.paddingLG}px`}},children:(0,h.jsxs)(c.OO,{direction:"column",gap:"sm",align:"stretch",children:[(0,h.jsxs)(c.OO,{align:"stretch",justify:"between",children:[(0,h.jsx)(c.tX,{combinationMode:"AND",onChange:e=>{M({filter:null!==e&&void 0!==e?e:{}},"replaceIn")},filterProperties:[{fixedOperator:"equals",propertyLabel:f("reservoirPage.Status"),key:"status",type:"enum",options:[{label:"SCANNED",value:"SCANNED"},{label:"PULLING",value:"PULLING"},{label:"PULLED",value:"PULLED"},{label:"VERIFYING",value:"VERIFYING"},{label:"NEEDS_APPROVAL",value:"NEEDS_APPROVAL"},{label:"FAILED",value:"FAILED"},{label:"AVAILABLE",value:"AVAILABLE"},{label:"REJECTED",value:"REJECTED"}]},{fixedOperator:"contains",propertyLabel:f("reservoirPage.Version"),key:"version",type:"string"},{propertyLabel:f("reservoirPage.ArtifactID"),key:"artifactId",valueMode:"scalar",type:"string"}]}),K.length>0?(0,h.jsxs)(c.OO,{gap:"xs",children:[(0,h.jsxs)(D,{children:[K.length," selected"]}),(0,h.jsx)(d.A,{title:f("reservoirPage.PullSelectedVersions"),children:(0,h.jsx)(c.eM,{revisionsFrgmt:K.flatMap((e=>e.data)),onClick:()=>{J&&O(K.flatMap((e=>e.data)))}})}),(0,h.jsx)(d.A,{title:f("reservoirPage.RemoveSelectedVersions"),children:(0,h.jsx)(c.Ty,{revisionsFrgmt:K.flatMap((e=>e.data)),style:{borderColor:u.colorBorder,backgroundColor:u.colorBgContainer},onClick:()=>{J&&j(K.flatMap((e=>e.data)))}})})]}):null]}),(0,h.jsx)(c.eU,{artifactRevisionFrgmt:(0,c.f)(null===J||void 0===J?void 0:J.revisions.edges.map((e=>e.node))),latestRevisionFrgmt:null===J||void 0===J?void 0:J.latestVersion.edges[0].node,loading:q!==U,onClickDownload:e=>{null===J||void 0===J||J.revisions.edges.forEach((n=>{if(n.node.id===e)return O([n.node])}))},onClickDelete:e=>{null===J||void 0===J||J.revisions.edges.forEach((n=>{if(n.node.id===e)return j([n.node])}))},pagination:{current:z.current,pageSize:z.pageSize,total:null!==(a=null===J||void 0===J?void 0:J.revisions.count)&&void 0!==a?a:0,onChange:(e,n)=>{A().isNumber(e)&&A().isNumber(n)&&G({current:e,pageSize:n})}},onRow:e=>({onClick:n=>{var i;n.stopPropagation();const a=n.target;if(a.closest("button")||a.closest("a"))return;if(!J)return;const t=null===(i=J.revisions.edges.find((n=>n.node.id===e.id)))||void 0===i?void 0:i.node;t&&N((n=>{const i=n.filter((n=>n.id!==e.id));return i.length===n.length?[...n,{id:e.id,data:t}]:i}))}}),rowSelection:{type:"checkbox",onChange:e=>{if(!J)return;const n=J.revisions,i=n.edges.map((e=>e.node.id));N((a=>{const t=a.filter((e=>!i.includes(e.id))),l=n.edges.filter((n=>e.includes(n.node.id))).map((e=>({id:e.node.id,data:e.node})));return t.concat(l)}))},selectedRowKeys:K.map((e=>e.id))}})]})}),(0,h.jsx)(c.VC,{selectedArtifactFrgmt:null!==J&&void 0!==J?J:null,selectedArtifactRevisionFrgmt:V,open:!!J&&!A().isEmpty(V),connectionIds:J?[J.pullingArtifactRevisions.__id]:void 0,onOk:(e,n)=>{O([]),n.forEach((e=>{m({message:f("reservoirPage.PullingArtifact",{name:e.artifact.name,version:e.version}),type:"info",open:!0,duration:0,backgroundTask:{status:"pending",taskId:e.taskId,promise:null,percent:0,onChange:{resolved:(n,i)=>({type:"success",message:f("reservoirPage.SuccessFullyPulledArtifact",{name:e.artifact.name,version:e.version}),showIcon:!0,toText:f("reservoirPage.GoToArtifact"),to:`/reservoir/${e.artifact.id}`}),rejected:(n,i)=>f("reservoirPage.FailedToPullArtifact",{name:e.artifact.name,version:e.version})}}})}))},onCancel:()=>{O([])}}),(0,h.jsx)(c.L$,{selectedArtifactFrgmt:null!==J&&void 0!==J?J:null,selectedArtifactRevisionFrgmt:C,onOk:()=>{j([])},onCancel:()=>{j([])},open:!!J&&!A().isEmpty(C)})]})}}}]);
//# sourceMappingURL=1584.9e966ba2.chunk.js.map