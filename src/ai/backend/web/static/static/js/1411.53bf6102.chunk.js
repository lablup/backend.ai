"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1411],{11411:(e,l,a)=>{a.r(l),a.d(l,{default:()=>I});var i=a(83468),n=a(25339),t=a(87985),o=a(16162),r=a(29871),u=a(41679),d=a(1849),s=a(45901),v=a.n(s),c=a(76998),m=a(23446);const g=e=>{var l;let{value:a,defaultValue:i,onChange:n,steps:t,showAllMarkLabels:o,...r}=e;const c=t.map((e=>v().isNumber(e)||v().isString(e)?{value:e,label:e.toString()}:e)),[g,p]=(0,u.A)({value:a,defaultValue:null!==i&&void 0!==i?i:null===(l=c[0])||void 0===l?void 0:l.value,onChange:n}),b=e=>0===e||e===c.length-1,f=v().fromPairs(c.map(((e,l)=>[l,b(l)?e.label:" "])));return(0,m.jsx)(d.A,{...r,marks:f,value:v().findIndex(c,{value:g}),min:0,tooltip:{formatter(e){var l;if((0,s.isNumber)(e))return null===(l=c[e])||void 0===l?void 0:l.label},...r.tooltip},max:c.length-1,onChange:e=>{var l,a;p(null===(l=c[e])||void 0===l?void 0:l.value,null===(a=c[e])||void 0===a?void 0:a.label)}})};var p=a(50840),b=a(65080),f=a(24377),y=a(64283);const h=e=>{var l,a,i,n;let{name:t,min:u,max:d}=e;const{token:s}=p.A.useToken(),[c]=(0,o.Hv)(),h=e=>{var l,a,i,n,t,o;return{cpu:{label:null===c||void 0===c||null===(l=c.cpu)||void 0===l?void 0:l.description,steps:v().map(["0","1","2","3","4","5","6","7","8"],(e=>{var l;return{value:e,label:`${e} ${null===c||void 0===c||null===(l=c.cpu)||void 0===l?void 0:l.display_unit}`}}))},mem:{label:null===c||void 0===c||null===(a=c.mem)||void 0===a?void 0:a.description,steps:v().map(["64m","128m","256m","512m","1g","2g","4g","8g","16g","32g","64g","128g","256g","512g"],(e=>({value:e,label:`${e.slice(0,-1)} ${v().toUpper(v().last(e))}iB`})))},"cuda.device":{label:null===c||void 0===c||null===(i=c["cuda.device"])||void 0===i?void 0:i.description,steps:v().map(["0","1","2","3","4","5","6","7","8"],(e=>{var l;return{value:e,label:`${e} ${null===c||void 0===c||null===(l=c["cuda.device"])||void 0===l?void 0:l.display_unit}`}}))},"cuda.shares":{label:null===c||void 0===c||null===(n=c["cuda.shares"])||void 0===n?void 0:n.description,steps:v().map(["0","0.1","0.2","0.5","1.0","2.0","4.0","8.0"],(e=>{var l;return{value:e,label:`${e} ${null===c||void 0===c||null===(l=c["cuda.shares"])||void 0===l?void 0:l.display_unit}`}}))},"rocm.device":{label:null===c||void 0===c||null===(t=c["rocm.device"])||void 0===t?void 0:t.description,steps:["0","1","2","3","4","5","6","7","8"]}}[e]||{label:null===c||void 0===c||null===(o=c[e])||void 0===o?void 0:o.description,steps:v().map(["0","1","2","3","4"],(l=>{var a;return{value:l,label:`${l} ${(null===c||void 0===c||null===(a=c[e])||void 0===a?void 0:a.display_unit)||""}`}}))}},k=b.A.useFormInstance(),x=b.A.useWatch(t,k),A=v().find(h(t).steps,(e=>e.value===x||e===x));return(0,m.jsx)(b.A.Item,{label:null!==(l=null===(a=h(t))||void 0===a?void 0:a.label)&&void 0!==l?l:t.toUpperCase(),style:{flex:1},children:(0,m.jsxs)(r.A,{direction:"row",gap:"lg",children:[(0,m.jsx)(f.A,{size:"large",variant:"borderless",readOnly:!0,value:null!==(i=null===A||void 0===A?void 0:A.label)&&void 0!==i?i:A,style:{flex:1,fontSize:s.fontSizeLG},tabIndex:-1}),(0,m.jsx)(y.A,{type:"vertical",style:{height:40}}),(0,m.jsx)(b.A.Item,{name:t,noStyle:!0,initialValue:u,children:(0,m.jsx)(g,{style:{flex:5},steps:null===(n=h(t))||void 0===n?void 0:n.steps})})]})})};var k,x=a(78969),A=a(24717),M=a(77678),$=a(3606);const I=e=>{var l;let{...o}=e;const r=(0,i.CX)(),{t:u}=(0,M.Bd)(),d=(0,c.useRef)(null),s=x.A.useApp(),{parsedValue:{image:g,open:p},dispatchEvent:f}=(0,t.useWebComponentInfo)(),[y,I]=(0,$.useMutation)(void 0!==k?k:k=a(7394));return(0,m.jsx)(n.A,{destroyOnClose:!0,open:p,maskClosable:!1,onOk:async()=>{var e;const l=await(null===(e=d.current)||void 0===e?void 0:e.getFieldsValue()),a=Object.entries(l).map((e=>{var l,a,i,n;let[t,o]=e;return{key:t,min:null!==(l=o.toString())&&void 0!==l?l:"0",max:(null!==(a=null===(i=g.resource_limits)||void 0===i||null===(n=i.find((e=>(null===e||void 0===e?void 0:e.key)===t)))||void 0===n?void 0:n.max)&&void 0!==a?a:r.isManagerVersionCompatibleWith("24.03.4.*"))?void 0:null}})),i=()=>y({variables:{target:`${g.registry}/${g.name}:${g.tag}`,architecture:g.architecture,props:{resource_limits:a}},onCompleted:(e,l)=>{var a,i;if(null!==e&&void 0!==e&&null!==(a=e.modify_image)&&void 0!==a&&a.ok)if(l&&(null===l||void 0===l?void 0:l.length)>0){const e=v().map(l,(e=>e.message));for(const l of e)A.Ay.error(l,2.5)}else A.Ay.success(u("environment.DescImageResourceModified")),f("ok",null);else A.Ay.error(null===e||void 0===e||null===(i=e.modify_image)||void 0===i?void 0:i.msg)},onError:e=>{A.Ay.error(u("dialog.ErrorOccurred"))}});null!==g&&void 0!==g&&g.installed?s.modal.confirm({title:"Image reinstallation required",content:(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(M.x6,{i18nKey:"environment.ModifyImageResourceLimitReinstallRequired"})}),onOk:i,getContainer:()=>document.body,closable:!0}):i()},onCancel:()=>f("cancel",null),confirmLoading:I,centered:!0,title:u("environment.ModifyImageResourceLimit"),...o,children:(0,m.jsx)(b.A,{ref:d,layout:"vertical",children:null===g||void 0===g||null===(l=g.resource_limits)||void 0===l?void 0:l.map((e=>{let{key:l,min:a,max:i}=e;const n=null===l||void 0===l?void 0:l.replace(/_/g,".");return(0,m.jsx)(h,{name:null!==n&&void 0!==n?n:"",min:null!==a&&void 0!==a?a:"",max:null!==i&&void 0!==i?i:""},n)}))})})}},7394:(e,l,a)=>{a.r(l),a.d(l,{default:()=>n});const i=function(){var e={defaultValue:null,kind:"LocalArgument",name:"architecture"},l={defaultValue:null,kind:"LocalArgument",name:"props"},a={defaultValue:null,kind:"LocalArgument",name:"target"},i=[{alias:null,args:[{kind:"Variable",name:"architecture",variableName:"architecture"},{kind:"Variable",name:"props",variableName:"props"},{kind:"Variable",name:"target",variableName:"target"}],concreteType:"ModifyImage",kind:"LinkedField",name:"modify_image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,l,a],kind:"Fragment",metadata:null,name:"ManageImageResourceLimitModalMutation",selections:i,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,e,l],kind:"Operation",name:"ManageImageResourceLimitModalMutation",selections:i},params:{cacheID:"b4c4a5b17c6aa265df64e4d2d6338684",id:null,metadata:{},name:"ManageImageResourceLimitModalMutation",operationKind:"mutation",text:"mutation ManageImageResourceLimitModalMutation(\n  $target: String!\n  $architecture: String\n  $props: ModifyImageInput!\n) {\n  modify_image(target: $target, architecture: $architecture, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();i.hash="491b6e500587a3630195d9025ef76f29";const n=i}}]);
//# sourceMappingURL=1411.53bf6102.chunk.js.map