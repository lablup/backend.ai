"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[437],{41437:function(e,a,n){n.r(a),n.d(a,{StorageStatusPanelFallback:function(){return D},default:function(){return O}});var t,i=n(29439),o=n(43255),r=n(87760),l=n(99277),s=n(46228),d=n(1413),c=n(44925),u=n(19427),p=n(32048),g=n.n(p),m=n(4519),y=n(81748),_=n(87112),f=n(2556),v=["value","onChange","autoSelectDefault"],h=function(e){var a=e.value,n=e.onChange,t=e.autoSelectDefault,i=(0,c.Z)(e,v),o=(0,y.$G)().t,l=(0,r.Dj)(),s=(0,_.useQuery)("vhostInfo",(function(){return l.vfolder.list_hosts()})),p=s.data,h=s.isLoading;return(0,m.useEffect)((function(){t&&!a&&null!==p&&void 0!==p&&p.default&&(null===n||void 0===n||n(null===p||void 0===p?void 0:p.default,(0,d.Z)({id:null===p||void 0===p?void 0:p.default},(null===p||void 0===p?void 0:p.volume_info[null===p||void 0===p?void 0:p.default])||{})))}),[]),(0,f.jsx)(u.Z,(0,d.Z)({filterOption:!1,placeholder:o("data.SelectStorageHost"),loading:h,style:{minWidth:165},value:(null===a||void 0===a?void 0:a.id)||a,onChange:function(e){null===n||void 0===n||n(e,(0,d.Z)({id:e},(null===p||void 0===p?void 0:p.volume_info[e])||{}))},options:g().map(null===p||void 0===p?void 0:p.allowed,(function(e){return{value:e,label:e}}))},i))},k=n(44036),x=n(53562),b=n(28499),S=n(16980),j=function(e){var a,i,r,s,d,c=e.usageProgressFrgmt,u=(0,y.$G)().t,p=k.Z.useToken().token,g=(0,S.useFragment)(void 0!==t?t:t=n(407),c),m=parseFloat(null===g||void 0===g||null===(a=g.details)||void 0===a?void 0:a.usage_bytes)||0,_=parseFloat(null===g||void 0===g||null===(i=g.details)||void 0===i?void 0:i.hard_limit_bytes)||0,v=_>0?null===(r=m/_*100)||void 0===r?void 0:r.toFixed(2):0;return(0,f.jsxs)(l.Z,{direction:"column",children:[(0,f.jsx)(x.Z,{size:[180,15],percent:v,strokeColor:(0,o.lA)(v),status:v>=100?"exception":"normal"}),(0,f.jsxs)(l.Z,{direction:"row",gap:p.marginXXS,style:{fontSize:12},children:[(0,f.jsxs)(b.Z.Text,{type:"secondary",style:{fontSize:12},children:[u("data.Used"),":"]}),(0,o.Uz)(null===g||void 0===g||null===(s=g.details)||void 0===s?void 0:s.usage_bytes)," GB",(0,f.jsx)(b.Z.Text,{type:"secondary",style:{fontSize:12},children:" / "}),(0,f.jsxs)(b.Z.Text,{type:"secondary",style:{fontSize:12},children:[u("data.Limit"),":"]}),(0,o.Uz)(null===g||void 0===g||null===(d=g.details)||void 0===d?void 0:d.hard_limit_bytes)," GB"]})]})},Z=n(87462),w={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 336a48 48 0 1096 0 48 48 0 10-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z"}}]},name:"info-circle",theme:"outlined"},F=n(9491),z=function(e,a){return m.createElement(F.Z,(0,Z.Z)({},e,{ref:a,icon:w}))};var q,P,Q=m.forwardRef(z),K=n(53066),T=n(93448),L=n(83799),$=n(227),V=n(92171),C=n(54473),I=n(97589),D=function(){var e=(0,y.$G)().t;return(0,f.jsx)(K.Z,{size:"small",title:e("data.StorageStatus"),style:{margin:"3px 14px"},children:(0,f.jsx)(I.Z,{active:!0})})},O=function(e){var a,t,d=e.fetchKey,c=(0,y.$G)().t,u=k.Z.useToken().token,p=(0,r.Dj)(),g=(0,r.qh)(),v=(0,m.useState)(),Z=(0,i.Z)(v,2),w=Z[0],F=Z[1],z=(0,m.useDeferredValue)(w),I=(0,m.useDeferredValue)(d),D=(0,_.useQuery)(["vfolders",{deferredFetchKey:I}],(function(){return p.vfolder.list(null===g||void 0===g?void 0:g.id)})).data,O=null===D||void 0===D?void 0:D.filter((function(e){return e.is_owner&&"user"===e.ownership_type})).length,N=null===D||void 0===D?void 0:D.filter((function(e){return"group"===e.ownership_type})).length,E=null===D||void 0===D?void 0:D.filter((function(e){return!e.is_owner&&"user"===e.ownership_type})).length,B=(0,S.useLazyLoadQuery)(void 0!==q?q:q=n(14933),{domain_name:(0,r.tQ)(),email:null===p||void 0===p?void 0:p.email,access_key:null===p||void 0===p?void 0:p._config.accessKey}),M=B.keypair,A=B.user,G=(0,S.useLazyLoadQuery)(void 0!==P?P:P=n(85912),{keypair_resource_policy_name:null===M||void 0===M?void 0:M.resource_policy,project_quota_scope_id:(0,o.VQ)("project",null===g||void 0===g?void 0:g.id),user_quota_scope_id:(0,o.VQ)("user",(null===A||void 0===A?void 0:A.id)||""),storage_host_name:(null===z||void 0===z?void 0:z.id)||"",skipQuotaScope:void 0===(null===g||void 0===g?void 0:g.id)||void 0===(null===A||void 0===A?void 0:A.id)||!(null!==z&&void 0!==z&&z.id)}),W=G.keypair_resource_policy,H=G.project_quota_scope,U=G.user_quota_scope,X=(null===W||void 0===W?void 0:W.max_vfolder_count)||0,R=X>0?null===(a=O/X*100)||void 0===a?void 0:a.toFixed(2):0;return(0,f.jsx)(K.Z,{size:"small",title:c("data.StorageStatus"),style:{margin:"3px 14px"},children:(0,f.jsxs)(T.Z,{bordered:!0,column:{xxl:4,xl:4,lg:2,md:1,sm:1,xs:1},size:"small",children:[(0,f.jsxs)(T.Z.Item,{label:c("data.NumberOfFolders"),children:[(0,f.jsx)(x.Z,{size:[200,15],percent:R,strokeColor:(0,o.lA)(R),style:{width:"95%"},status:R>=100?"exception":"normal"}),(0,f.jsxs)(l.Z,{direction:"row",gap:u.marginXXS,wrap:"wrap",children:[(0,f.jsxs)(b.Z.Text,{type:"secondary",children:[c("data.Created"),":"]}),O,(0,f.jsx)(b.Z.Text,{type:"secondary",children:" / "}),(0,f.jsxs)(b.Z.Text,{type:"secondary",children:[c("data.Limit"),":"]}),0===X?"-":X]}),(0,f.jsx)(L.Z,{style:{margin:"12px auto"}}),(0,f.jsxs)(l.Z,{direction:"row",wrap:"wrap",justify:"between",children:[(0,f.jsxs)(l.Z,{gap:u.marginXXS,children:[(0,f.jsxs)(b.Z.Text,{type:"secondary",children:[c("data.ProjectFolder"),":"]}),N]}),(0,f.jsxs)(l.Z,{gap:u.marginXXS,style:{marginRight:30},children:[(0,f.jsxs)(b.Z.Text,{type:"secondary",children:[c("data.Invited"),":"]}),E]})]})]}),(0,f.jsxs)(T.Z.Item,{label:(0,f.jsxs)("div",{children:[c("data.QuotaPerStorageVolume"),(0,f.jsx)($.Z,{title:c("data.HostDetails"),children:(0,f.jsx)(V.ZP,{type:"link",icon:(0,f.jsx)(Q,{})})})]}),children:[(0,f.jsxs)(l.Z,{wrap:"wrap",justify:"between",direction:"row",style:{minWidth:"25vw"},children:[(0,f.jsx)(b.Z.Text,{type:"secondary",children:c("data.Host")}),(0,f.jsx)(h,{onChange:function(e,a){F(a)},value:w,autoSelectDefault:!0})]}),w!==z?(0,f.jsx)(s.Z,{style:{minHeight:120}}):null!==w&&void 0!==w&&null!==(t=w.capabilities)&&void 0!==t&&t.includes("quota")?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(l.Z,{style:{margin:"15px auto"},justify:"between",wrap:"wrap",children:[(0,f.jsxs)(b.Z.Text,{type:"secondary",style:{wordBreak:"keep-all",wordWrap:"break-word"},children:[c("data.Project"),(0,f.jsx)("br",{}),"(",null===g||void 0===g?void 0:g.name,")"]}),(0,f.jsx)(j,{usageProgressFrgmt:H||null})]}),(0,f.jsxs)(l.Z,{justify:"between",wrap:"wrap",children:[(0,f.jsxs)(b.Z.Text,{type:"secondary",style:{wordBreak:"keep-all",wordWrap:"break-word"},children:[c("data.User"),(0,f.jsx)("br",{}),"(",null===p||void 0===p?void 0:p.email,")"]}),(0,f.jsx)(j,{usageProgressFrgmt:U||null})]})]}):(0,f.jsx)(C.Z,{image:C.Z.PRESENTED_IMAGE_SIMPLE,description:c("storageHost.QuotaDoesNotSupported"),style:{margin:"25px auto"}})]})]})})}},14933:function(e,a,n){n.r(a);var t=function(){var e={defaultValue:null,kind:"LocalArgument",name:"access_key"},a={defaultValue:null,kind:"LocalArgument",name:"domain_name"},n={defaultValue:null,kind:"LocalArgument",name:"email"},t={kind:"Variable",name:"domain_name",variableName:"domain_name"},i=[{kind:"Variable",name:"access_key",variableName:"access_key"},t],o={alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:[t,{kind:"Variable",name:"email",variableName:"email"}],concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[r],storageKey:null};return{fragment:{argumentDefinitions:[e,a,n],kind:"Fragment",metadata:null,name:"StorageStatusPanelKeypairQuery",selections:[{alias:null,args:i,concreteType:"KeyPair",kind:"LinkedField",name:"keypair",plural:!1,selections:[o],storageKey:null},l],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,e],kind:"Operation",name:"StorageStatusPanelKeypairQuery",selections:[{alias:null,args:i,concreteType:"KeyPair",kind:"LinkedField",name:"keypair",plural:!1,selections:[o,r],storageKey:null},l]},params:{cacheID:"a1f1f25b43e259bd9fb61900366ccf39",id:null,metadata:{},name:"StorageStatusPanelKeypairQuery",operationKind:"query",text:"query StorageStatusPanelKeypairQuery(\n  $domain_name: String\n  $email: String\n  $access_key: String\n) {\n  keypair(domain_name: $domain_name, access_key: $access_key) {\n    resource_policy\n    id\n  }\n  user(domain_name: $domain_name, email: $email) {\n    id\n  }\n}\n"}}}();t.hash="9a9b72c6fe6f8094e5c1dcdf895905d8",a.default=t},85912:function(e,a,n){n.r(a);var t=function(){var e={defaultValue:null,kind:"LocalArgument",name:"keypair_resource_policy_name"},a={defaultValue:null,kind:"LocalArgument",name:"project_quota_scope_id"},n={defaultValue:null,kind:"LocalArgument",name:"skipQuotaScope"},t={defaultValue:null,kind:"LocalArgument",name:"storage_host_name"},i={defaultValue:null,kind:"LocalArgument",name:"user_quota_scope_id"},o={alias:null,args:[{kind:"Variable",name:"name",variableName:"keypair_resource_policy_name"}],concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null}],storageKey:null},r={kind:"Variable",name:"storage_host_name",variableName:"storage_host_name"},l=[{kind:"Variable",name:"quota_scope_id",variableName:"project_quota_scope_id"},r],s=[{args:null,kind:"FragmentSpread",name:"UsageProgressFragment_usageFrgmt"}],d=[{kind:"Variable",name:"quota_scope_id",variableName:"user_quota_scope_id"},r],c=[{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"usage_bytes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}];return{fragment:{argumentDefinitions:[e,a,n,t,i],kind:"Fragment",metadata:null,name:"StorageStatusPanelQuery",selections:[o,{condition:"skipQuotaScope",kind:"Condition",passingValue:!1,selections:[{alias:"project_quota_scope",args:l,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:s,storageKey:null},{alias:"user_quota_scope",args:d,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:s,storageKey:null}]}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[e,a,i,t,n],kind:"Operation",name:"StorageStatusPanelQuery",selections:[o,{condition:"skipQuotaScope",kind:"Condition",passingValue:!1,selections:[{alias:"project_quota_scope",args:l,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:c,storageKey:null},{alias:"user_quota_scope",args:d,concreteType:"QuotaScope",kind:"LinkedField",name:"quota_scope",plural:!1,selections:c,storageKey:null}]}]},params:{cacheID:"3b64310d5a3457d887b4bfbfe7167d0d",id:null,metadata:{},name:"StorageStatusPanelQuery",operationKind:"query",text:"query StorageStatusPanelQuery(\n  $keypair_resource_policy_name: String\n  $project_quota_scope_id: String!\n  $user_quota_scope_id: String!\n  $storage_host_name: String!\n  $skipQuotaScope: Boolean!\n) {\n  keypair_resource_policy(name: $keypair_resource_policy_name) {\n    max_vfolder_count\n  }\n  project_quota_scope: quota_scope(quota_scope_id: $project_quota_scope_id, storage_host_name: $storage_host_name) @skip(if: $skipQuotaScope) {\n    ...UsageProgressFragment_usageFrgmt\n    id\n  }\n  user_quota_scope: quota_scope(quota_scope_id: $user_quota_scope_id, storage_host_name: $storage_host_name) @skip(if: $skipQuotaScope) {\n    ...UsageProgressFragment_usageFrgmt\n    id\n  }\n}\n\nfragment UsageProgressFragment_usageFrgmt on QuotaScope {\n  details {\n    usage_bytes\n    hard_limit_bytes\n  }\n}\n"}}}();t.hash="bf52bea1f21e2b4ac3ca5f541bd0d96e",a.default=t},407:function(e,a,n){n.r(a);var t={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsageProgressFragment_usageFrgmt",selections:[{alias:null,args:null,concreteType:"QuotaDetails",kind:"LinkedField",name:"details",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"usage_bytes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hard_limit_bytes",storageKey:null}],storageKey:null}],type:"QuotaScope",abstractKey:null,hash:"1ba87b250f2a0161ecee7ba88d54c85c"};a.default=t},83799:function(e,a,n){n.d(a,{Z:function(){return y}});var t=n(4942),i=n(29439),o=n(4519),r=n(43270),l=n.n(r),s=n(48698),d=n(21480),c=n(70111),u=n(41157),p=function(e){var a,n=e.componentCls,i=e.sizePaddingEdgeHorizontal,o=e.colorSplit,r=e.lineWidth,l=e.textPaddingInline,s=e.orientationMargin,c=e.verticalMarginInline;return(0,t.Z)({},n,Object.assign(Object.assign({},(0,d.Wf)(e)),(a={borderBlockStart:"".concat(r,"px solid ").concat(o),"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:c,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:"".concat(r,"px solid ").concat(o)},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:"".concat(e.dividerHorizontalGutterMargin,"px 0")}},(0,t.Z)(a,"&-horizontal".concat(n,"-with-text"),{display:"flex",alignItems:"center",margin:"".concat(e.dividerHorizontalWithTextGutterMargin,"px 0"),color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:"0 ".concat(o),"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:"".concat(r,"px solid transparent"),borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}}),(0,t.Z)(a,"&-horizontal".concat(n,"-with-text-left"),{"&::before":{width:"".concat(100*s,"%")},"&::after":{width:"".concat(100-100*s,"%")}}),(0,t.Z)(a,"&-horizontal".concat(n,"-with-text-right"),{"&::before":{width:"".concat(100-100*s,"%")},"&::after":{width:"".concat(100*s,"%")}}),(0,t.Z)(a,"".concat(n,"-inner-text"),{display:"inline-block",paddingBlock:0,paddingInline:l}),(0,t.Z)(a,"&-dashed",{background:"none",borderColor:o,borderStyle:"dashed",borderWidth:"".concat(r,"px 0 0")}),(0,t.Z)(a,"&-horizontal".concat(n,"-with-text").concat(n,"-dashed"),{"&::before, &::after":{borderStyle:"dashed none none"}}),(0,t.Z)(a,"&-vertical".concat(n,"-dashed"),{borderInlineStartWidth:r,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0}),(0,t.Z)(a,"&-plain".concat(n,"-with-text"),{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize}),(0,t.Z)(a,"&-horizontal".concat(n,"-with-text-left").concat(n,"-no-default-orientation-margin-left"),(0,t.Z)({"&::before":{width:0},"&::after":{width:"100%"}},"".concat(n,"-inner-text"),{paddingInlineStart:i})),(0,t.Z)(a,"&-horizontal".concat(n,"-with-text-right").concat(n,"-no-default-orientation-margin-right"),(0,t.Z)({"&::before":{width:"100%"},"&::after":{width:0}},"".concat(n,"-inner-text"),{paddingInlineEnd:i})),a)))},g=(0,c.Z)("Divider",(function(e){var a=(0,u.TS)(e,{dividerHorizontalWithTextGutterMargin:e.margin,dividerHorizontalGutterMargin:e.marginLG,sizePaddingEdgeHorizontal:0});return[p(a)]}),(function(e){return{textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:e.marginXS}})),m=function(e,a){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&a.indexOf(t)<0&&(n[t]=e[t]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(t=Object.getOwnPropertySymbols(e);i<t.length;i++)a.indexOf(t[i])<0&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(n[t[i]]=e[t[i]])}return n};var y=function(e){var a,n=o.useContext(s.E_),r=n.getPrefixCls,d=n.direction,c=n.divider,u=e.prefixCls,p=e.type,y=void 0===p?"horizontal":p,_=e.orientation,f=void 0===_?"center":_,v=e.orientationMargin,h=e.className,k=e.rootClassName,x=e.children,b=e.dashed,S=e.plain,j=e.style,Z=m(e,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","plain","style"]),w=r("divider",u),F=g(w),z=(0,i.Z)(F,2),q=z[0],P=z[1],Q=f.length>0?"-".concat(f):f,K=!!x,T="left"===f&&null!=v,L="right"===f&&null!=v,$=l()(w,null===c||void 0===c?void 0:c.className,P,"".concat(w,"-").concat(y),(a={},(0,t.Z)(a,"".concat(w,"-with-text"),K),(0,t.Z)(a,"".concat(w,"-with-text").concat(Q),K),(0,t.Z)(a,"".concat(w,"-dashed"),!!b),(0,t.Z)(a,"".concat(w,"-plain"),!!S),(0,t.Z)(a,"".concat(w,"-rtl"),"rtl"===d),(0,t.Z)(a,"".concat(w,"-no-default-orientation-margin-left"),T),(0,t.Z)(a,"".concat(w,"-no-default-orientation-margin-right"),L),a),h,k),V=o.useMemo((function(){return"number"===typeof v?v:/^\d+$/.test(v)?Number(v):v}),[v]),C=Object.assign(Object.assign({},T&&{marginLeft:V}),L&&{marginRight:V});return q(o.createElement("div",Object.assign({className:$,style:Object.assign(Object.assign({},null===c||void 0===c?void 0:c.style),j)},Z,{role:"separator"}),x&&"vertical"!==y&&o.createElement("span",{className:"".concat(w,"-inner-text"),style:C},x)))}}}]);
//# sourceMappingURL=437.ab7fe7a0.chunk.js.map