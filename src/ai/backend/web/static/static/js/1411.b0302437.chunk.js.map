{"version":3,"file":"static/js/1411.b0302437.chunk.js","mappings":"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","sources":["components/NonLinearSlider.tsx","components/ImageResourceFormItem.tsx","components/ManageImageResourceLimitModal.tsx","components/__generated__/ManageImageResourceLimitModalMutation.graphql.ts"],"sourcesContent":["import useControllableState from '../hooks/useControllableState';\nimport { Slider, SliderSingleProps } from 'antd';\nimport _, { isNumber } from 'lodash';\nimport React from 'react';\n\nexport type StepType =\n  | {\n      value: number | string;\n      label: string;\n    }\n  | number\n  | string;\ninterface NonLinearSliderProps\n  extends Omit<SliderSingleProps, 'value' | 'defaultValue' | 'onChange'> {\n  steps: StepType[];\n  value?: number | string;\n  defaultValue?: number | string;\n  showAllMarkLabels?: boolean;\n  onChange?: (value: number | string, label: string) => void;\n}\nconst NonLinearSlider: React.FC<NonLinearSliderProps> = ({\n  value,\n  defaultValue,\n  onChange,\n  steps,\n  showAllMarkLabels,\n  ...sliderProps\n}) => {\n  const normalizedSteps = steps.map((step) => {\n    if (_.isNumber(step) || _.isString(step)) {\n      return {\n        value: step,\n        label: step.toString(),\n      };\n    }\n    return step;\n  });\n\n  const [controlledValue, setControlledValue] = useControllableState({\n    value,\n    defaultValue: defaultValue ?? normalizedSteps[0]?.value,\n    onChange,\n  });\n\n  const isFirstAndLast = (index: number) =>\n    index === 0 || index === normalizedSteps.length - 1;\n\n  const allMarks = _.fromPairs(\n    normalizedSteps.map((step, index) => [\n      index,\n      isFirstAndLast(index) ? step.label : ' ',\n    ]),\n  );\n  return (\n    <Slider\n      {...sliderProps}\n      marks={allMarks}\n      value={_.findIndex(normalizedSteps, { value: controlledValue })}\n      min={0}\n      tooltip={{\n        formatter(value) {\n          if (isNumber(value)) {\n            return normalizedSteps[value]?.label;\n          }\n        },\n        ...sliderProps.tooltip,\n      }}\n      max={normalizedSteps.length - 1}\n      onChange={(rawValue) => {\n        setControlledValue(\n          normalizedSteps[rawValue]?.value,\n          normalizedSteps[rawValue]?.label,\n        );\n      }}\n    />\n  );\n};\n\nexport default NonLinearSlider;\n","import { useResourceSlotsDetails } from '../hooks/backendai';\nimport Flex from './Flex';\nimport NonLinearSlider from './NonLinearSlider';\nimport { Divider, Form, Input, theme } from 'antd';\nimport _ from 'lodash';\nimport React from 'react';\n\nexport interface imageResourceProps {\n  key: string;\n  min: string | null;\n  max: string | null;\n}\ninterface ImageResourceFormItemProps extends Omit<imageResourceProps, 'key'> {\n  name: string;\n}\n\nconst ImageResourceFormItem: React.FC<ImageResourceFormItemProps> = ({\n  name,\n  min,\n  max,\n}) => {\n  const { token } = theme.useToken();\n\n  const [resourceSlotsDetails] = useResourceSlotsDetails();\n\n  const getResourceInfo = (type: string) => {\n    return (\n      {\n        cpu: {\n          label: resourceSlotsDetails?.cpu?.description,\n          steps: _.map(\n            ['0', '1', '2', '3', '4', '5', '6', '7', '8'],\n            (value) => ({\n              value,\n              label: `${value} ${resourceSlotsDetails?.cpu?.display_unit}`,\n            }),\n          ),\n        },\n        mem: {\n          label: resourceSlotsDetails?.mem?.description,\n          steps: _.map(\n            [\n              '64m',\n              '128m',\n              '256m',\n              '512m',\n              '1g',\n              '2g',\n              '4g',\n              '8g',\n              '16g',\n              '32g',\n              '64g',\n              '128g',\n              '256g',\n              '512g',\n            ],\n            (v) => ({\n              value: v,\n              label: `${v.slice(0, -1)} ${_.toUpper(_.last(v))}iB`,\n            }),\n          ),\n        },\n        'cuda.device': {\n          label: resourceSlotsDetails?.['cuda.device']?.description,\n          steps: _.map(['0', '1', '2', '3', '4', '5', '6', '7', '8'], (v) => ({\n            value: v,\n            label: `${v} ${resourceSlotsDetails?.['cuda.device']?.display_unit}`,\n          })),\n        },\n        'cuda.shares': {\n          label: resourceSlotsDetails?.['cuda.shares']?.description,\n          steps: _.map(\n            ['0', '0.1', '0.2', '0.5', '1.0', '2.0', '4.0', '8.0'],\n            (v) => ({\n              value: v,\n              label: `${v} ${resourceSlotsDetails?.['cuda.shares']?.display_unit}`,\n            }),\n          ),\n        },\n        'rocm.device': {\n          label: resourceSlotsDetails?.['rocm.device']?.description,\n          steps: ['0', '1', '2', '3', '4', '5', '6', '7', '8'],\n        },\n      }[type] || {\n        label: resourceSlotsDetails?.[type]?.description,\n        steps: _.map(['0', '1', '2', '3', '4'], (v) => ({\n          value: v,\n          label: `${v} ${resourceSlotsDetails?.[type]?.display_unit || ''}`,\n        })),\n      }\n    );\n  };\n\n  const formInstance = Form.useFormInstance();\n  const value = Form.useWatch(name, formInstance);\n\n  const stepForValue = _.find(getResourceInfo(name).steps, (step) => {\n    // @ts-ignore\n    return step.value === value || step === value;\n  });\n\n  return (\n    <Form.Item\n      label={getResourceInfo(name)?.label ?? name.toUpperCase()}\n      style={{ flex: 1 }}\n    >\n      <Flex direction=\"row\" gap={'lg'}>\n        <Input\n          size=\"large\"\n          variant=\"borderless\"\n          readOnly\n          // @ts-ignore\n          value={stepForValue?.label ?? stepForValue}\n          style={{ flex: 1, fontSize: token.fontSizeLG }}\n          tabIndex={-1}\n        />\n        <Divider type=\"vertical\" style={{ height: 40 }} />\n        <Form.Item name={name} noStyle initialValue={min}>\n          <NonLinearSlider\n            style={{ flex: 5 }}\n            steps={getResourceInfo(name)?.steps}\n            // onChange={(value) => {}}\n          />\n        </Form.Item>\n      </Flex>\n    </Form.Item>\n  );\n};\n\nexport default ImageResourceFormItem;\n","import { useSuspendedBackendaiClient } from '../hooks';\nimport BAIModal, { BAIModalProps } from './BAIModal';\nimport { useWebComponentInfo } from './DefaultProviders';\nimport ImageResourceFormItem from './ImageResourceFormItem';\nimport {\n  ManageImageResourceLimitModalMutation,\n  ResourceLimitInput,\n} from './__generated__/ManageImageResourceLimitModalMutation.graphql';\nimport { App, Form, FormInstance, message } from 'antd';\nimport graphql from 'babel-plugin-relay/macro';\nimport _ from 'lodash';\nimport React, { useRef } from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\nimport { useMutation } from 'react-relay';\n\n// TODO: This is not 100% same with Image type of GraphQL.\n// This type is modified version based on backend-ai-environment-list.ts\nexport type ImageFromEnvironment = {\n  resource_limits: ResourceLimitInput[];\n  registry: string;\n  name: string;\n  tag: string;\n  architecture: string;\n  installed: boolean;\n  labels: {\n    [key: string]: string;\n  };\n};\nconst ManageImageResourceLimitModal: React.FC<BAIModalProps> = ({\n  ...BAIModalProps\n}) => {\n  const baiClient = useSuspendedBackendaiClient();\n  // Differentiate default max value based on manager version.\n  // The difference between validating a variable type as undefined or none for an unsupplied field value.\n  // [Associated PR links] : https://github.com/lablup/backend.ai/pull/1941\n\n  const { t } = useTranslation();\n  const formRef = useRef<FormInstance>(null);\n  const app = App.useApp();\n\n  const {\n    parsedValue: { image, open },\n    dispatchEvent,\n  } = useWebComponentInfo<{\n    image: ImageFromEnvironment; //TODO: This is not 100% same with Image type, after implementing the image list with a relay query, the type should be changed.\n    open?: boolean;\n  }>();\n\n  const [commitModifyImageInput, isInFlightModifyImageInput] =\n    useMutation<ManageImageResourceLimitModalMutation>(graphql`\n      mutation ManageImageResourceLimitModalMutation(\n        $target: String!\n        $architecture: String\n        $props: ModifyImageInput!\n      ) {\n        modify_image(\n          target: $target\n          architecture: $architecture\n          props: $props\n        ) {\n          ok\n          msg\n        }\n      }\n    `);\n\n  const handleOnclick = async () => {\n    const fieldsValue = await formRef.current?.getFieldsValue();\n    const resource_limits: ResourceLimitInput[] = Object.entries(\n      fieldsValue,\n    ).map(([key, value]: [string, any]) => ({\n      key,\n      min: value.toString() ?? '0',\n      max:\n        image.resource_limits?.find((item) => item?.key === key)?.max ??\n        baiClient.isManagerVersionCompatibleWith('24.03.4.*')\n          ? undefined\n          : null,\n    }));\n\n    const commitRequest = () =>\n      commitModifyImageInput({\n        variables: {\n          target: `${image.registry}/${image.name}:${image.tag}`,\n          architecture: image.architecture,\n          props: {\n            resource_limits,\n          },\n        },\n        onCompleted: (res, errors) => {\n          if (!res?.modify_image?.ok) {\n            message.error(res?.modify_image?.msg);\n            return;\n          }\n          if (errors && errors?.length > 0) {\n            const errorMsgList = _.map(errors, (error) => error.message);\n            for (const error of errorMsgList) {\n              message.error(error, 2.5);\n            }\n          } else {\n            message.success(t('environment.DescImageResourceModified'));\n            dispatchEvent('ok', null);\n          }\n        },\n        onError: (err) => {\n          message.error(t('dialog.ErrorOccurred'));\n        },\n      });\n\n    if (image?.installed) {\n      app.modal.confirm({\n        title: 'Image reinstallation required',\n        content: (\n          <>\n            <Trans\n              i18nKey={'environment.ModifyImageResourceLimitReinstallRequired'}\n            />\n          </>\n        ),\n        onOk: commitRequest,\n        getContainer: () => document.body,\n        closable: true,\n      });\n    } else {\n      commitRequest();\n    }\n  };\n\n  return (\n    <BAIModal\n      destroyOnClose\n      open={open}\n      maskClosable={false}\n      onOk={handleOnclick}\n      onCancel={() => dispatchEvent('cancel', null)}\n      confirmLoading={isInFlightModifyImageInput}\n      centered\n      title={t('environment.ModifyImageResourceLimit')}\n      {...BAIModalProps}\n    >\n      <Form ref={formRef} layout=\"vertical\">\n        {image?.resource_limits?.map(({ key, min, max }) => {\n          // TODO: After implementing the image list with a relay query, the key transformation should not be needed.\n          const keyUsingDot = key?.replace(/_/g, '.');\n          return (\n            <ImageResourceFormItem\n              key={keyUsingDot}\n              name={keyUsingDot ?? ''}\n              min={min ?? ''}\n              max={max ?? ''}\n            />\n          );\n        })}\n      </Form>\n    </BAIModal>\n  );\n};\n\nexport default ManageImageResourceLimitModal;\n","/**\n * @generated SignedSource<<61692df1bc291fc5ce24e4d7baf5e894>>\n * @lightSyntaxTransform\n * @nogrep\n */\n\n/* tslint:disable */\n/* eslint-disable */\n// @ts-nocheck\n\nimport { ConcreteRequest, Mutation } from 'relay-runtime';\nexport type ModifyImageInput = {\n  architecture?: string | null | undefined;\n  digest?: string | null | undefined;\n  image?: string | null | undefined;\n  is_local?: boolean | null | undefined;\n  labels?: ReadonlyArray<KVPairInput | null | undefined> | null | undefined;\n  name?: string | null | undefined;\n  registry?: string | null | undefined;\n  resource_limits?: ReadonlyArray<ResourceLimitInput | null | undefined> | null | undefined;\n  size_bytes?: number | null | undefined;\n  supported_accelerators?: ReadonlyArray<string | null | undefined> | null | undefined;\n  tag?: string | null | undefined;\n  type?: string | null | undefined;\n};\nexport type KVPairInput = {\n  key?: string | null | undefined;\n  value?: string | null | undefined;\n};\nexport type ResourceLimitInput = {\n  key?: string | null | undefined;\n  max?: string | null | undefined;\n  min?: string | null | undefined;\n};\nexport type ManageImageResourceLimitModalMutation$variables = {\n  architecture?: string | null | undefined;\n  props: ModifyImageInput;\n  target: string;\n};\nexport type ManageImageResourceLimitModalMutation$data = {\n  readonly modify_image: {\n    readonly msg: string | null | undefined;\n    readonly ok: boolean | null | undefined;\n  } | null | undefined;\n};\nexport type ManageImageResourceLimitModalMutation = {\n  response: ManageImageResourceLimitModalMutation$data;\n  variables: ManageImageResourceLimitModalMutation$variables;\n};\n\nconst node: ConcreteRequest = (function(){\nvar v0 = {\n  \"defaultValue\": null,\n  \"kind\": \"LocalArgument\",\n  \"name\": \"architecture\"\n},\nv1 = {\n  \"defaultValue\": null,\n  \"kind\": \"LocalArgument\",\n  \"name\": \"props\"\n},\nv2 = {\n  \"defaultValue\": null,\n  \"kind\": \"LocalArgument\",\n  \"name\": \"target\"\n},\nv3 = [\n  {\n    \"alias\": null,\n    \"args\": [\n      {\n        \"kind\": \"Variable\",\n        \"name\": \"architecture\",\n        \"variableName\": \"architecture\"\n      },\n      {\n        \"kind\": \"Variable\",\n        \"name\": \"props\",\n        \"variableName\": \"props\"\n      },\n      {\n        \"kind\": \"Variable\",\n        \"name\": \"target\",\n        \"variableName\": \"target\"\n      }\n    ],\n    \"concreteType\": \"ModifyImage\",\n    \"kind\": \"LinkedField\",\n    \"name\": \"modify_image\",\n    \"plural\": false,\n    \"selections\": [\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"kind\": \"ScalarField\",\n        \"name\": \"ok\",\n        \"storageKey\": null\n      },\n      {\n        \"alias\": null,\n        \"args\": null,\n        \"kind\": \"ScalarField\",\n        \"name\": \"msg\",\n        \"storageKey\": null\n      }\n    ],\n    \"storageKey\": null\n  }\n];\nreturn {\n  \"fragment\": {\n    \"argumentDefinitions\": [\n      (v0/*: any*/),\n      (v1/*: any*/),\n      (v2/*: any*/)\n    ],\n    \"kind\": \"Fragment\",\n    \"metadata\": null,\n    \"name\": \"ManageImageResourceLimitModalMutation\",\n    \"selections\": (v3/*: any*/),\n    \"type\": \"Mutations\",\n    \"abstractKey\": null\n  },\n  \"kind\": \"Request\",\n  \"operation\": {\n    \"argumentDefinitions\": [\n      (v2/*: any*/),\n      (v0/*: any*/),\n      (v1/*: any*/)\n    ],\n    \"kind\": \"Operation\",\n    \"name\": \"ManageImageResourceLimitModalMutation\",\n    \"selections\": (v3/*: any*/)\n  },\n  \"params\": {\n    \"cacheID\": \"b4c4a5b17c6aa265df64e4d2d6338684\",\n    \"id\": null,\n    \"metadata\": {},\n    \"name\": \"ManageImageResourceLimitModalMutation\",\n    \"operationKind\": \"mutation\",\n    \"text\": \"mutation ManageImageResourceLimitModalMutation(\\n  $target: String!\\n  $architecture: String\\n  $props: ModifyImageInput!\\n) {\\n  modify_image(target: $target, architecture: $architecture, props: $props) {\\n    ok\\n    msg\\n  }\\n}\\n\"\n  }\n};\n})();\n\n(node as any).hash = \"491b6e500587a3630195d9025ef76f29\";\n\nexport default node;\n"],"names":["_ref","_normalizedSteps$","value","defaultValue","onChange","steps","showAllMarkLabels","sliderProps","normalizedSteps","map","step","_","label","toString","controlledValue","setControlledValue","useControllableState","isFirstAndLast","index","length","allMarks","_jsx","Slider","marks","min","tooltip","formatter","_normalizedSteps$valu","isNumber","max","rawValue","_normalizedSteps$rawV","_normalizedSteps$rawV2","_getResourceInfo$labe","_getResourceInfo","_stepForValue$label","_getResourceInfo2","name","token","theme","useToken","resourceSlotsDetails","useResourceSlotsDetails","getResourceInfo","type","_resourceSlotsDetails","_resourceSlotsDetails3","_resourceSlotsDetails4","_resourceSlotsDetails6","_resourceSlotsDetails8","_resourceSlotsDetails9","cpu","description","_resourceSlotsDetails2","concat","display_unit","mem","v","slice","_resourceSlotsDetails5","_resourceSlotsDetails7","_resourceSlotsDetails10","formInstance","Form","useFormInstance","useWatch","stepForValue","Item","toUpperCase","style","flex","children","_jsxs","Flex","direction","gap","Input","size","variant","readOnly","fontSize","fontSizeLG","tabIndex","Divider","height","noStyle","initialValue","NonLinearSlider","_image$resource_limit4","BAIModalProps","baiClient","useSuspendedBackendaiClient","t","useTranslation","formRef","useRef","app","App","useApp","parsedValue","image","open","dispatchEvent","useWebComponentInfo","commitModifyImageInput","isInFlightModifyImageInput","useMutation","_ManageImageResourceLimitModalMutation","require","BAIModal","destroyOnClose","maskClosable","onOk","async","_formRef$current","fieldsValue","current","getFieldsValue","resource_limits","Object","entries","_ref2","_value$toString","_image$resource_limit","_image$resource_limit2","_image$resource_limit3","key","find","item","isManagerVersionCompatibleWith","undefined","commitRequest","variables","target","registry","tag","architecture","props","onCompleted","res","errors","_res$modify_image","_res$modify_image2","modify_image","ok","errorMsgList","error","message","success","msg","onError","err","installed","modal","confirm","title","content","_Fragment","Trans","i18nKey","getContainer","document","body","closable","onCancel","confirmLoading","centered","ref","layout","_ref3","keyUsingDot","replace","ImageResourceFormItem","node","v0","v1","v2","v3","hash"],"sourceRoot":""}