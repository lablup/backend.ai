"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[229],{61502:function(n,e,t){t.r(e),t.d(e,{default:function(){return L},useShadowRoot:function(){return _},useWebComponentInfo:function(){return M}});var r=t(29439),i=t(74165),o=t(15861),a=t(1413);function u(n,e){var t=(0,a.Z)({},e);return function(n){for(var e,t=/(\w+)\s@\s*(\w+)\s*\(\s*(\w+)\s*:\s*(\$?\w+)\s*\)/g,i=[];null!==(e=t.exec(n));){var o=e,a=(0,r.Z)(o,5),u=a[0],l=a[1],c=a[2],s=a[3],d=a[4];i.push({fieldName:l,directive:c,argumentName:s,argumentValue:d,originFieldStr:u})}return i}(n).forEach((function(r){if("skipOnClient"===r.directive&&"if"===r.argumentName&&(n=!r.argumentValue||!0!==e[r.argumentValue.substring(1)]&&"true"!==r.argumentValue?n.replace(r.originFieldStr,r.originFieldStr.replace(/@\s*(skipOnClient)\s*\(\s*(\w+)\s*:\s*(\$?\w+)\s*\)/,"")):n.replace(r.originFieldStr,""),r.argumentValue.startsWith("$")&&2===n.split(r.argumentValue).length)){var i=r.argumentValue.substring(1),o=new RegExp(".*".concat(i,".*\n"),"g");n=n.replace(o,""),delete t[r.argumentValue.substring(1)]}})),{query:n,variables:t}}var l=t(41011);l.RelayFeatureFlags.ENABLE_RELAY_RESOLVERS=!0;var c=function(){var n=(0,o.Z)((0,i.Z)().mark((function n(e,t){var r,o,a,l,c,s;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=u(e.text||"",t),l={query:a.query,variables:a.variables},c=null===(r=globalThis.backendaiclient)||void 0===r?void 0:r.newSignedRequest("POST","/admin/gql",l),n.next=5,null===(o=globalThis.backendaiclient)||void 0===o?void 0:o._wrapWithPromise(c,!1,null,1e4,0);case 5:return s=n.sent,n.abrupt("return",s);case 7:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();var s,d=new l.Environment({network:l.Network.create(c,void 0),store:new l.Store(new l.RecordSource)}),f=t(80382),v=t(27340),g=t(27398),m=t(49883),h=t(66670),p=t(64447),b=t(13881),w=t(4519),k=t(81748),y=t(87112),x=t(16980),E=t(51843),Z=t(12674),j=t(2556),C=w.createContext(null),S=w.createContext(null),_=function(){return w.useContext(S)},M=function(){return w.useContext(C)},T=new y.QueryClient({defaultOptions:{queries:{suspense:!0,refetchOnWindowFocus:!1,retry:!1}}});p.ZP.use(k.Db).use(b.Z).init({backend:{loadPath:"/resources/i18n/{{lng}}.json"},lng:(null===globalThis||void 0===globalThis||null===(s=globalThis.backendaioptions)||void 0===s?void 0:s.get("current_language"))||"en",fallbackLng:"en",interpolation:{escapeValue:!1}});var F=function(){var n=(0,Z.s0)();return(0,w.useLayoutEffect)((function(){var e=function(e){var t=e.detail;n(t,{replace:!0})};return document.addEventListener("react-navigate",e),function(){document.removeEventListener("react-navigate",e)}}),[n]),null},L=function(n){var e=n.children,t=n.value,i=n.styles,o=n.shadowRoot,a=n.dispatchEvent,u=(0,w.useMemo)((function(){return(0,v.Df)()}),[]),l=function(){var n,e=(0,w.useState)(null===globalThis||void 0===globalThis||null===(n=globalThis.backendaioptions)||void 0===n?void 0:n.get("current_language")),t=(0,r.Z)(e,2),i=t[0],o=t[1],a=(0,k.$G)().i18n;return(0,w.useEffect)((function(){setTimeout((function(){return null===a||void 0===a?void 0:a.changeLanguage(i)}),0)}),[]),(0,w.useEffect)((function(){var n=function(n){var e,t;o(null===n||void 0===n||null===(e=n.detail)||void 0===e?void 0:e.lang);var r=(null===n||void 0===n||null===(t=n.detail)||void 0===t?void 0:t.lang)||"en";null===a||void 0===a||a.changeLanguage(r)};return window.addEventListener("langChanged",n),function(){return window.removeEventListener("langChanged",n)}}),[a]),[i]}(),c=(0,r.Z)(l,1)[0],s=(0,f.x)(),p=(0,w.useMemo)((function(){return{value:t,dispatchEvent:a,moveTo:function(n){a("moveTo",{path:n})}}}),[t,a]);return(0,j.jsx)(j.Fragment,{children:d&&(0,j.jsx)(x.RelayEnvironmentProvider,{environment:d,children:(0,j.jsxs)(w.StrictMode,{children:[(0,j.jsxs)("style",{children:[i,".anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n.ant-table-wrapper {\n  border-radius: 8px 8px 0 0;\n  overflow: hidden;\n}\n"]}),(0,j.jsx)(y.QueryClientProvider,{client:T,children:(0,j.jsx)(S.Provider,{value:o,children:(0,j.jsx)(C.Provider,{value:p,children:(0,j.jsx)(g.ZP,{getPopupContainer:function(n){return o},locale:"ko"===c?h.Z:m.Z,theme:s,children:(0,j.jsx)(v.V9,{container:o,cache:u,children:(0,j.jsx)(w.Suspense,{fallback:"",children:(0,j.jsxs)(E.VK,{children:[(0,j.jsx)(F,{}),e]})})})})})})})]})})})}},27229:function(n,e,t){t.r(e);var r=t(29439),i=t(87760),o=t(1839),a=t(50164),u=t(61502),l=t(99277),c=t(50708),s=t(67848),d=t(64846),f=t(33405),v=t(30485),g=t(89786),m=t(80220),h=t(43514),p=t(27214),b=t(46734),w=t(3501),k=t(28499),y=t(58834),x=t(4519),E=t(81748),Z=t(2556);e.default=function(){var n=(0,E.$G)().t,e=(0,u.useWebComponentInfo)().dispatchEvent,t=(0,i.Dj)(),j=(0,o.j)(),C=(0,r.Z)(j,1)[0],S=(0,x.useState)(!1),_=(0,r.Z)(S,2),M=_[0],T=_[1],F=b.ZP.useBreakpoint(),L=(0,p.Z)(M,{wait:100,leading:!0,trailing:!1}),B=(0,a.h)("getUserRole",(function(){return t.user.get(C.email,["role"])}),{suspense:!1}).data,I=null===B||void 0===B?void 0:B.user.role,P=[{label:C.username,key:"userFullName",icon:(0,Z.jsx)(c.Z,{}),disabled:!0,style:{color:"#1f1f1f",cursor:"default"}},{label:C.email,key:"userEmail",icon:(0,Z.jsx)(s.Z,{}),disabled:!0,style:{cursor:"default"}},{type:"divider"},{label:I,key:"userRole",icon:(0,Z.jsx)(d.Z,{}),disabled:!0,style:{cursor:"default"}},{type:"divider"},{label:n("webui.menu.AboutBackendAI"),key:"description",icon:(0,Z.jsx)(f.Z,{}),onClick:function(){var n=new CustomEvent("backend-ai-show-splash");document.dispatchEvent(n)}},{label:n("webui.menu.MyAccount"),key:"userProfileSetting",icon:(0,Z.jsx)(v.Z,{}),onClick:function(){e("moveTo",{path:"#userprofile"})}},{label:n("webui.menu.Preferences"),key:"preferences",icon:(0,Z.jsx)(g.Z,{}),onClick:function(){e("moveTo",{path:"/usersettings",params:{tab:"general"}})}},{label:n("webui.menu.LogsErrors"),key:"logs",icon:(0,Z.jsx)(m.Z,{}),onClick:function(){e("moveTo",{path:"/usersettings",params:{tab:"logs"}})}},{label:n("webui.menu.LogOut"),key:"logout",icon:(0,Z.jsx)(h.Z,{}),onClick:function(){var n=new CustomEvent("backend-ai-logout");document.dispatchEvent(n)}}];return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(w.Z,{menu:{items:P},trigger:["click"],open:L,onOpenChange:function(n){return T(n)},children:(0,Z.jsxs)(l.Z,{direction:"row",gap:"sm",style:{cursor:"pointer"},children:[F.md&&(0,Z.jsx)(k.Z.Text,{strong:!0,children:C.username}),(0,Z.jsx)(y.C,{icon:(0,Z.jsx)(c.Z,{})})]})})})}},43255:function(n,e,t){t.d(e,{Cd:function(){return m},Hz:function(){return s},LD:function(){return c},Lc:function(){return a},PZ:function(){return f},Uz:function(){return d},VQ:function(){return v},We:function(){return o},XG:function(){return l},lA:function(){return g},y3:function(){return u}});var r=t(87760),i=t(2556),o=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/(<br\s*\/?>|\n)/;return n.split(e).map((function(n,t){return n.match(e)?(0,i.jsx)("br",{},t):n}))},a=function(n){var e=n.method,t=n.url,r=n.body,i=void 0===r?null:r,o=n.client,a=null===o||void 0===o?void 0:o.newSignedRequest(e,t,i,null);return null===o||void 0===o?void 0:o._wrapWithPromise(a)},u=function(){var n=(0,r.Dj)();return function(e){var t=e.method,r=e.url,i=e.body;return a({method:t,url:r,body:void 0===i?null:i,client:n})}},l=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===n)return"0 Bytes";var t=Math.pow(10,3);e=e<0?0:e;var r=Math.floor(Math.log(Math.round(n))/Math.log(t));return r=r<0?0:r,parseFloat((n/Math.pow(t,r)).toFixed(e))+" "+["Bytes","KB","MB","GB","TB","PB"][r]},c=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n)return 0;"string"===typeof n&&(n=parseInt(n));var r,i,o=Math.pow(2,10);return e=e<0||t?0:e,r=(r=Math.floor(Math.log(Math.round(n))/Math.log(o)))<0?0:r,i=t?["","Ki","Mi","Gi","Ti","Pi","Ei"]:["Bytes","KiB","MiB","GiB","TiB","PiB","EiB"],parseFloat((n/Math.pow(o,r)).toFixed(e))+" "+i[r]};var s=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=Math.pow(10,9);return Math.round(e*n)},d=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return null===n||void 0===n?arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-":n?(n/Math.pow(10,9)).toFixed(e):n};function f(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=["B","K","M","G","T","P","E"],i=n.slice(-1).toUpperCase(),o=parseFloat(n.slice(0,-1)),a=r.indexOf(i);if(-1===a||isNaN(o))throw new Error("Invalid size format");var u=o*Math.pow(1024,a),l=e?r.indexOf(e.toUpperCase()):a,c=u/Math.pow(1024,l),s=c.toFixed(t);return{number:c,numberFixed:s,unit:r[l],numberUnit:"".concat(s).concat(r[l])}}var v=function(n,e){return""===e||void 0===e?"":e.startsWith("".concat(n,":"))?e:"".concat(n,":").concat(e)},g=function(n){return n<70?"rgba(58, 178, 97, 1)":n<90?"rgb(223, 179, 23)":"#ef5350"},m=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r=t+r>n.length?n.length:r,n.substring(0,t)+e.repeat(r)+n.substring(t+r,n.length)}},1839:function(n,e,t){t.d(e,{T:function(){return d},j:function(){return f}});var r=t(1413),i=t(29439),o=t(87760),a=t(43255),u=t(50164),l=t(32048),c=t.n(l),s=t(4519),d=function(){var n=(0,o.Kr)("first"),e=(0,i.Z)(n,2),t=e[0],r=e[1],a=(0,o.Dj)();return[(0,u.h)({queryKey:["useResourceSlots",t],queryFn:function(){return a.get_resource_slots()},staleTime:0}).data,{refresh:function(){return r()}}]},f=function(){var n=(0,o.Dj)(),e=(0,s.useState)({full_name:n.full_name,email:n.email}),t=(0,i.Z)(e,2),l=t[0],d=t[1];(0,s.useEffect)((function(){var e=function(e){if(n.supports("change-user-name")){var t=e.detail;d((function(n){return(0,r.Z)((0,r.Z)({},n),{},{full_name:t})}))}};return document.addEventListener("current-user-info-changed",e),function(){document.removeEventListener("current-user-info-changed",e)}}),[n]);var f=(0,u.Y)({mutationFn:function(e){return n.update_full_name(e.email,e.full_name)}}),v=(0,u.Y)({mutationFn:function(e){return n.update_password(e.old_password,e.new_password,e.new_password2)}});return[(0,r.Z)((0,r.Z)({},l),{},{username:function(){var e=c().trim(l.full_name).length>0?l.full_name:l.email;if(n._config.maskUserInfo){var t=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e)?e.split("@")[0].length-2:e.length-2;e=(0,a.Cd)(e,"*",2,t)}return e}(),isPendingMutation:f.isLoading||v.isLoading}),{updateFullName:function(e,t){f.mutate({full_name:e,email:n.email},{onSuccess:function(){(null===t||void 0===t?void 0:t.onSuccess)&&t.onSuccess(e),document.dispatchEvent(new CustomEvent("current-user-info-changed",{detail:e})),d((function(n){return(0,r.Z)((0,r.Z)({},n),{},{full_name:e})}))},onError:function(n){(null===t||void 0===t?void 0:t.onError)&&t.onError(n)}})},updatePassword:function(n,e){v.mutate(n,{onSuccess:function(){(null===e||void 0===e?void 0:e.onSuccess)&&e.onSuccess(void 0)},onError:function(n){(null===e||void 0===e?void 0:e.onError)&&e.onError(n)}})}}]}},87760:function(n,e,t){t.d(e,{Dj:function(){return s},Kr:function(){return a},M:function(){return c},dS:function(){return d},qh:function(){return l},tQ:function(){return u}});var r=t(29439),i=t(4519),o=t(87112),a=function(n){return function(n){var e=(0,i.useState)(n||(new Date).toISOString()),t=(0,r.Z)(e,2),o=t[0],a=t[1];return[o,function(n){a(n||(new Date).toISOString())}]}(n)},u=function(){return s()._config.domainName},l=function(){var n=s(),e=(0,i.useState)({name:n.current_group,id:n.groupIds[n.current_group]}),t=(0,r.Z)(e,2),o=t[0],a=t[1];return(0,i.useEffect)((function(){var e=function(e){var t=e.detail;a({name:t,id:n.groupIds[t]})};return document.addEventListener("backend-ai-group-changed",e),function(){document.removeEventListener("backend-ai-group-changed",e)}})),o},c=function(n){var e=n.api_endpoint;return(0,i.useMemo)((function(){var n=new globalThis.BackendAIClientConfig("","",e,"SESSION");return new globalThis.BackendAIClient(n,"Backend.AI Console.")}),[e])},s=function(){return(0,o.useQuery)({queryKey:"backendai-client-for-suspense",queryFn:function(){return new Promise((function(n){if("undefined"!==typeof globalThis.backendaiclient&&null!==globalThis.backendaiclient&&!1!==globalThis.backendaiclient.ready)return n(globalThis.backendaiclient);document.addEventListener("backend-ai-connected",(function e(){n(globalThis.backendaiclient),document.removeEventListener("backend-ai-connected",e)}))}))},retry:!1,suspense:!0}).data},d=function(){var n=(0,o.useQuery)({queryKey:"backendai-metadata-for-suspense",queryFn:function(){return fetch("resources/image_metadata.json").then((function(n){return n.json()})).then((function(n){return n}))},suspense:!0,retry:!1}).data,e=function(n){if(!n)return{key:"",tags:[]};var e=n.split("/"),t=(e[2]||e[1]).split(":"),i=(0,r.Z)(t,2);return{key:i[0],tags:i[1].split("-")}};return[n,{getImageAliasName:function(t){var r=e(t).key;return(null===n||void 0===n?void 0:n.imageInfo[r].name)||r},getImageIcon:function(t){var r,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"resources/icons/";if(!t)return"default.png";var a=e(t).key;return o+(void 0!==(null===n||void 0===n||null===(r=n.imageInfo[a])||void 0===r?void 0:r.icon)?null===n||void 0===n||null===(i=n.imageInfo[a])||void 0===i?void 0:i.icon:"default.png")},getImageTags:function(n){},getBaseVersion:function(n){return e(n).tags[0]},getBaseImage:function(n){return e(n).tags[1]},getImageMeta:e}]}},50164:function(n,e,t){t.d(e,{Y:function(){return o},h:function(){return i}});var r=t(87112),i=r.useQuery,o=r.useMutation}}]);
//# sourceMappingURL=229.69683696.chunk.js.map