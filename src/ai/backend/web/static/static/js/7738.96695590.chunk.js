"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[7738],{27738:(t,e,o)=>{o.r(e),o.d(e,{default:()=>d});var n=o(37138),i=o(63590),a=o(66941),r=o(90632),p=o(44032),l=o(7265),s=o(29262),u=o(99118),c=o(26862);const d=()=>{const{t:t}=(0,u.Bd)(),e=(0,s.useRef)(null),{value:o,dispatchEvent:d}=(0,a.useWebComponentInfo)();let _;try{_=JSON.parse(o||"")}catch(E){_={open:!1,totp_registration_token:"",api_endpoint:""}}const{api_endpoint:k,open:v,totp_registration_token:b}=_,m=(0,n.oM)({api_endpoint:k}),{data:f,isSuccess:g,isError:h,mutate:y}=(0,i.ET)({mutationFn:t=>{let{registration_token:e}=t;return m.initialize_totp_anon({registration_token:e})}});(0,s.useEffect)((()=>{v&&y({registration_token:b})}),[v,y,b]);const C=(0,i.ET)({mutationFn:t=>m.activate_totp_anon(t)});return(0,c.jsx)(l.IbE,{title:t("webui.menu.SetupTotp"),maskClosable:!1,confirmLoading:C.isPending,open:v,onCancel:()=>{d("cancel",null)},destroyOnHidden:!0,onOk:()=>{var o;null===(o=e.current)||void 0===o||o.validateFields().then((e=>{C.mutate({otp:e.otp,registration_token:b},{onSuccess:()=>{p.Ay.success(t("totp.TotpSetupCompleted")),d("ok",null)},onError:()=>{p.Ay.error(t("totp.InvalidTotpCode"))}})})).catch((()=>{}))},loading:!g,children:!h&&null!==f&&void 0!==f&&f.totp_uri&&null!==f&&void 0!==f&&f.totp_key?(0,c.jsx)(r.R,{ref:e,totp_uri:null===f||void 0===f?void 0:f.totp_uri,totp_key:null===f||void 0===f?void 0:f.totp_key}):(0,c.jsx)(l.OOm,{children:t("totp.TotpSetupNotAvailable")})})}}}]);
//# sourceMappingURL=7738.96695590.chunk.js.map