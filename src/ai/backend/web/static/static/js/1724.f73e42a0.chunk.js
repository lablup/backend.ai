"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1724],{5621:(e,n,t)=>{t.d(n,{A:()=>c});var l=t(29871),a=t(48713),r=t(45901),i=t.n(r),o=t(76998),s=t(23446);const c=e=>{let n,{values:t=[]}=e;return 0===t.length?null:(n=t[0]&&("string"===typeof t[0]||o.isValidElement(t[0]))?t.map((e=>({label:e,color:"blue"}))):t,(0,s.jsx)(l.A,{direction:"row",children:i().map(n,((e,t)=>(0,s.jsx)(a.A,{style:i().last(n)===e?void 0:{margin:0,marginRight:-1},color:e.color,children:e.label},t)))}))}},55256:(e,n,t)=>{t.d(n,{Ay:()=>b,Kk:()=>y,p3:()=>v,sT:()=>m,vB:()=>g});var l=t(83468),a=t(5621),r=t(29871),i=t(48713),o=t(45901),s=t.n(o),c=t(76998),d=t(23446);const u=e=>{let{image:n,...t}=e;n=n||"";const[,{getImageAliasName:r,getBaseVersion:i,tagAlias:o}]=(0,l.Gj)();return(0,d.jsx)(a.A,{values:[{label:o(r(n)),color:"blue"},{label:i(n),color:"green"}],...t})},g=e=>{let{image:n,...t}=e;n=n||"";const[,{getBaseVersion:a,tagAlias:r}]=(0,l.Gj)();return(0,d.jsx)(i.A,{color:"green",...t,children:r(a(n))})},m=e=>{let{image:n,...t}=e;n=n||"";const[,{getBaseImage:a,tagAlias:r}]=(0,l.Gj)();return(0,d.jsx)(i.A,{color:"green",...t,children:r(a(n))})},p=e=>{let{image:n,...t}=e;n=n||"";const[,{getArchitecture:a,tagAlias:r}]=(0,l.Gj)();return(0,d.jsx)(i.A,{color:"green",...t,children:r(a(n))})},y=e=>{let{image:n,...t}=e;n=n||"";const[,{getImageLang:a,tagAlias:r}]=(0,l.Gj)();return(0,d.jsx)(i.A,{color:"green",...t,children:r(a(n))})},v=e=>{let{image:n,labels:t,...o}=e;n=n||"",t=t||[];const[,{getFilteredRequirementsTags:c,getCustomTag:u,tagAlias:g}]=(0,l.Gj)();return(0,d.jsxs)(r.A,{children:[s().map(c(n),((e,n)=>(0,d.jsx)(i.A,{color:"blue",...o,children:g(e||"")},n))),(0,d.jsx)(a.A,{color:"cyan",values:[{label:"Customized",color:"cyan"},{label:u(t),color:"cyan"}],...o})]})},f=(e,n)=>{let{image:t,style:l={}}=e;return t=t||"",(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(u,{image:t}),(0,d.jsx)(m,{image:t}),(0,d.jsx)(p,{image:t})]})},b=c.memo(f)},34680:(e,n,t)=>{t.d(n,{A:()=>p});var l=t(25339),a=t(62863),r=t(50840),i=t(65080),o=t(24377),s=t(87627),c=t(45901),d=t.n(c),u=t(76998),g=t(77678),m=t(23446);const p=e=>{let{open:n,onRequestClose:t,columns:c,displayedColumnKeys:p,...y}=e;const v=(0,u.useRef)(null),{t:f}=(0,g.Bd)(),{token:b}=r.A.useToken(),x=c.map((e=>{return"string"===typeof e.title?{label:e.title,value:d().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(n=e.title,u.Children.map(n.props.children,(e=>{if("string"===typeof e)return e}))),value:d().toString(e.key)}:{label:void 0,value:d().toString(e.key)};var n}));return(0,m.jsx)(l.A,{title:f("table.SettingTable"),open:n,destroyOnClose:!0,centered:!0,onOk:()=>{var e;null===(e=v.current)||void 0===e||e.validateFields().then((e=>{t(e)})).catch((()=>{}))},onCancel:()=>{t()},...y,children:(0,m.jsxs)(i.A,{ref:v,preserve:!1,initialValues:{selectedColumnKeys:p||x.map((e=>e.value))},layout:"vertical",children:[(0,m.jsx)(i.A.Item,{name:"searchInput",label:f("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,m.jsx)(o.A,{prefix:(0,m.jsx)(a.A,{}),style:{marginBottom:b.marginSM},placeholder:f("table.SearchTableColumn")})}),(0,m.jsx)(i.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.searchInput!==n.searchInput,children:e=>{let{getFieldValue:n}=e;const t=n("searchInput")?d().toLower(n("searchInput")):void 0,l=x.map((e=>d().toLower(d().toString(e.label)).includes(t||"")?e:{...e,style:{display:"none"}}));return(0,m.jsx)(i.A.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},children:(0,m.jsx)(s.A.Group,{options:l,style:{flexDirection:"column"}})})}})]})})}},21724:(e,n,t)=>{t.r(n),t.d(n,{default:()=>O});var l,a,r=t(29871),i=t(36009),o=t(55256),s=t(34680),c=t(30032),d=t(83468),u=t(97041),g=t(63718),m=t(44355),p=t(50840),y=t(78969),v=t(24128),f=t(59065),b=t(6932),x=t(29475),h=t(71537),A=t(45901),k=t.n(A),C=t(76998),j=t(77678),S=t(3606),_=t(23446);const O=e=>{let{children:n}=e;const{t:A}=(0,j.Bd)(),{token:O}=p.A.useToken(),{message:T}=y.A.useApp(),[I,K]=(0,C.useState)(!1),[F]=(0,C.useState)("images"),[P,E]=(0,C.useTransition)(),[w,B]=(0,d.Tw)("initial-fetch"),[N,z]=(0,C.useState)(),[,{getNamespace:$,getImageLang:M,getBaseVersion:V,getBaseImage:D,getCustomTag:L,getFilteredRequirementsTags:R}]=(0,d.Gj)(),{customized_images:q}=(0,S.useLazyLoadQuery)(void 0!==l?l:l=t(38867),{},{fetchPolicy:"initial-fetch"===w?"store-and-network":"network-only",fetchKey:w}),[Q,U]=(0,S.useMutation)(void 0!==a?a:a=t(60681)),X=[{title:A("environment.Registry"),dataIndex:"registry",key:"registry",sorter:(e,n)=>null!==e&&void 0!==e&&e.registry&&null!==n&&void 0!==n&&n.registry?e.registry.localeCompare(n.registry):0},{title:A("environment.Architecture"),dataIndex:"architecture",key:"architecture",sorter:(e,n)=>null!==e&&void 0!==e&&e.architecture&&null!==n&&void 0!==n&&n.architecture?e.architecture.localeCompare(n.architecture):0},{title:A("environment.Namespace"),key:"namespace",sorter:(e,n)=>{const t=$((0,c.A_)(e)||""),l=$((0,c.A_)(n)||"");return t&&l?t.localeCompare(l):0},render:(e,n)=>(0,_.jsx)("span",{children:$((0,c.A_)(n)||"")})},{title:A("environment.Language"),key:"lang",sorter:(e,n)=>{const t=M((0,c.A_)(e)||""),l=M((0,c.A_)(n)||"");return t&&l?t.localeCompare(l):0},render:(e,n)=>(0,_.jsx)(o.Kk,{image:(0,c.A_)(n)||"",color:"green"})},{title:A("environment.Version"),key:"baseversion",sorter:(e,n)=>{const t=V((0,c.A_)(e)||""),l=V((0,c.A_)(n)||"");return t&&l?t.localeCompare(l):0},render:(e,n)=>(0,_.jsx)(o.vB,{image:(0,c.A_)(n)||"",color:"green"})},{title:A("environment.Base"),key:"baseimage",sorter:(e,n)=>{const t=D((0,c.A_)(e)||""),l=D((0,c.A_)(n)||"");return t&&l?t.localeCompare(l):0},render:(e,n)=>(0,_.jsx)(o.sT,{image:(0,c.A_)(n)||""})},{title:A("environment.Constraint"),key:"constraint",sorter:(e,n)=>{const t=e=>{const n=(0,c.A_)(e)||"",t=k().get(e,"labels",[]);return R(n).join("")+"Customized"+L(t)},l=t(e),a=t(n);return l&&a?l.localeCompare(a):0},render:(e,n)=>(0,_.jsx)(o.p3,{image:(0,c.A_)(n)||"",labels:null===n||void 0===n?void 0:n.labels})},{title:A("environment.Digest"),dataIndex:"digest",key:"digest",sorter:(e,n)=>null!==e&&void 0!==e&&e.digest&&null!==n&&void 0!==n&&n.digest?e.digest.localeCompare(n.digest):0},{title:A("general.Control"),key:"control",fixed:"right",render:(e,n)=>(0,_.jsxs)(r.A,{direction:"row",align:"stretch",justify:"center",gap:"xxs",children:[(0,_.jsx)(v.A.Text,{copyable:{text:(0,c.A_)(n)||""},style:{paddingTop:O.paddingXXS,paddingBottom:O.paddingXXS}}),(0,_.jsx)(f.A,{title:A("dialog.ask.DoYouWantToProceed"),description:A("dialog.warning.CannotBeUndone"),okType:"danger",okText:A("button.Delete"),onConfirm:()=>{null!==n&&void 0!==n&&n.id&&(z(n.id+w),Q({variables:{id:n.id},onCompleted(e,n){var t;n?T.error(null===(t=n[0])||void 0===t?void 0:t.message):(E((()=>{B()})),T.success(A("environment.CustomizedImageSuccessfullyDeleted")))},onError(e){T.error(null===e||void 0===e?void 0:e.message)}}))},children:(0,_.jsx)(b.Ay,{type:"text",icon:(0,_.jsx)(u.A,{}),danger:!0,loading:U&&N===(null===n||void 0===n?void 0:n.id)+w,disabled:U&&N!==(null===n||void 0===n?void 0:n.id)+w})})]})}],[G,W]=(0,m.A)("backendaiwebui.MyEnvironmentPage.displayedColumnKeys",{defaultValue:X.map((e=>k().toString(e.key)))});return(0,_.jsxs)(r.A,{direction:"column",align:"stretch",gap:"xs",children:[(0,_.jsx)(r.A,{direction:"column",align:"stretch",children:(0,_.jsx)(x.A,{tabList:[{key:"images",label:A("environment.Images")}],activeTabKey:F,styles:{body:{padding:0,paddingTop:1}},children:(0,_.jsxs)(C.Suspense,{fallback:(0,_.jsx)(i.A,{}),children:[(0,_.jsx)(h.A,{loading:P,columns:X.filter((e=>null===G||void 0===G?void 0:G.includes(k().toString(e.key)))),dataSource:q,rowKey:"id",scroll:{x:"max-content"},pagination:!1}),(0,_.jsx)(r.A,{justify:"end",style:{padding:O.paddingXXS},children:(0,_.jsx)(b.Ay,{type:"text",icon:(0,_.jsx)(g.A,{}),onClick:()=>{K(!0)}})})]})})}),(0,_.jsx)(s.A,{open:I,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&W(null===e||void 0===e?void 0:e.selectedColumnKeys),K(!I)},columns:X,displayedColumnKeys:G||[]})]})}},60681:(e,n,t)=>{t.r(n),t.d(n,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"id"}],n=[{kind:"Variable",name:"image_id",variableName:"id"}],t=[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],l=[{alias:null,args:n,concreteType:"UntagImageFromRegistry",kind:"LinkedField",name:"untag_image_from_registry",plural:!1,selections:t,storageKey:null},{alias:null,args:n,concreteType:"ForgetImageById",kind:"LinkedField",name:"forget_image_by_id",plural:!1,selections:t,storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MyEnvironmentPageForgetAndUntagMutation",selections:l,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MyEnvironmentPageForgetAndUntagMutation",selections:l},params:{cacheID:"5b4f7c5bc899b115592fccdc6efe534d",id:null,metadata:{},name:"MyEnvironmentPageForgetAndUntagMutation",operationKind:"mutation",text:"mutation MyEnvironmentPageForgetAndUntagMutation(\n  $id: String!\n) {\n  untag_image_from_registry(image_id: $id) {\n    ok\n    msg\n  }\n  forget_image_by_id(image_id: $id) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="c32a5d49badf02c6b0693522e8e84c82";const a=l},38867:(e,n,t)=>{t.r(n),t.d(n,{default:()=>a});const l=function(){var e=[{alias:null,args:null,concreteType:"ImageNode",kind:"LinkedField",name:"customized_images",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"humanized_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"digest",storageKey:null},{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supported_accelerators",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MyEnvironmentPageQuery",selections:e,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"MyEnvironmentPageQuery",selections:e},params:{cacheID:"c1773ff683a165a627b1084bb7f99dfc",id:null,metadata:{},name:"MyEnvironmentPageQuery",operationKind:"query",text:"query MyEnvironmentPageQuery {\n  customized_images {\n    id\n    name\n    humanized_name\n    tag\n    registry\n    architecture\n    digest\n    labels {\n      key\n      value\n    }\n    supported_accelerators\n  }\n}\n"}}}();l.hash="239a93f593bbc6b5d31bbe53ca71e10d";const a=l},59065:(e,n,t)=>{t.d(n,{A:()=>S});var l=t(76998),a=t(58736),r=t(34156),i=t.n(r),o=t(23551),s=t(19727),c=t(28037),d=t(20315),u=t(47917),g=t(8357),m=t(6932),p=t(50675),y=t(29457),v=t(41271),f=t(59395),b=t(6132);const x=(0,b.OF)("Popconfirm",(e=>(e=>{const{componentCls:n,iconCls:t,antCls:l,zIndexPopup:a,colorText:r,colorWarning:i,marginXXS:o,marginXS:s,fontSize:c,fontWeightStrong:d,colorTextHeading:u}=e;return{[n]:{zIndex:a,[`&${l}-popover`]:{fontSize:c},[`${n}-message`]:{marginBottom:s,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${n}-message-icon ${t}`]:{color:i,fontSize:c,lineHeight:1,marginInlineEnd:s},[`${n}-title`]:{fontWeight:d,color:u,"&:only-child":{fontWeight:"normal"}},[`${n}-description`]:{marginTop:o,color:r}},[`${n}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:s}}}}})(e)),(e=>{const{zIndexPopupBase:n}=e;return{zIndexPopup:n+60}}),{resetStyle:!1});var h=function(e,n){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&n.indexOf(l)<0&&(t[l]=e[l]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(l=Object.getOwnPropertySymbols(e);a<l.length;a++)n.indexOf(l[a])<0&&Object.prototype.propertyIsEnumerable.call(e,l[a])&&(t[l[a]]=e[l[a]])}return t};const A=e=>{const{prefixCls:n,okButtonProps:t,cancelButtonProps:r,title:i,description:o,cancelText:s,okText:d,okType:f="primary",icon:b=l.createElement(a.A,null),showCancel:x=!0,close:h,onConfirm:A,onCancel:k,onPopupClick:C}=e,{getPrefixCls:j}=l.useContext(c.QO),[S]=(0,y.A)("Popconfirm",v.A.Popconfirm),_=(0,g.b)(i),O=(0,g.b)(o);return l.createElement("div",{className:`${n}-inner-content`,onClick:C},l.createElement("div",{className:`${n}-message`},b&&l.createElement("span",{className:`${n}-message-icon`},b),l.createElement("div",{className:`${n}-message-text`},_&&l.createElement("div",{className:`${n}-title`},_),O&&l.createElement("div",{className:`${n}-description`},O))),l.createElement("div",{className:`${n}-buttons`},x&&l.createElement(m.Ay,Object.assign({onClick:k,size:"small"},r),s||(null===S||void 0===S?void 0:S.cancelText)),l.createElement(u.A,{buttonProps:Object.assign(Object.assign({size:"small"},(0,p.DU)(f)),t),actionFn:A,close:h,prefixCls:j("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},d||(null===S||void 0===S?void 0:S.okText))))},k=e=>{const{prefixCls:n,placement:t,className:a,style:r}=e,o=h(e,["prefixCls","placement","className","style"]),{getPrefixCls:s}=l.useContext(c.QO),d=s("popconfirm",n),[u]=x(d);return u(l.createElement(f.Ay,{placement:t,className:i()(d,a),style:r,content:l.createElement(A,Object.assign({prefixCls:d},o))}))};var C=function(e,n){var t={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&n.indexOf(l)<0&&(t[l]=e[l]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(l=Object.getOwnPropertySymbols(e);a<l.length;a++)n.indexOf(l[a])<0&&Object.prototype.propertyIsEnumerable.call(e,l[a])&&(t[l[a]]=e[l[a]])}return t};const j=l.forwardRef(((e,n)=>{var t,r;const{prefixCls:u,placement:g="top",trigger:m="click",okType:p="primary",icon:y=l.createElement(a.A,null),children:v,overlayClassName:f,onOpenChange:b,onVisibleChange:h}=e,k=C(e,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange"]),{getPrefixCls:j}=l.useContext(c.QO),[S,_]=(0,o.A)(!1,{value:null!==(t=e.open)&&void 0!==t?t:e.visible,defaultValue:null!==(r=e.defaultOpen)&&void 0!==r?r:e.defaultVisible}),O=(e,n)=>{_(e,!0),null===h||void 0===h||h(e),null===b||void 0===b||b(e,n)},T=j("popconfirm",u),I=i()(T,f),[K]=x(T);return K(l.createElement(d.A,Object.assign({},(0,s.A)(k,["title"]),{trigger:m,placement:g,onOpenChange:(n,t)=>{const{disabled:l=!1}=e;l||O(n,t)},open:S,ref:n,overlayClassName:I,content:l.createElement(A,Object.assign({okType:p,icon:y},e,{prefixCls:T,close:e=>{O(!1,e)},onConfirm:n=>{var t;return null===(t=e.onConfirm)||void 0===t?void 0:t.call(void 0,n)},onCancel:n=>{var t;O(!1,n),null===(t=e.onCancel)||void 0===t||t.call(void 0,n)}})),"data-popover-inject":!0}),v))}));j._InternalPanelDoNotUseOrYouWillBeFired=k;const S=j}}]);
//# sourceMappingURL=1724.f73e42a0.chunk.js.map