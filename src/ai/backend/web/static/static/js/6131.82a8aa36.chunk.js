"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[6131],{90003:(n,e,t)=>{t.r(e),t.d(e,{default:()=>l});const i=function(){var n={defaultValue:null,kind:"LocalArgument",name:"endpoint_id"},e={defaultValue:null,kind:"LocalArgument",name:"filter"},t={defaultValue:null,kind:"LocalArgument",name:"limit"},i={defaultValue:null,kind:"LocalArgument",name:"offset"},l={defaultValue:null,kind:"LocalArgument",name:"projectID"},a={defaultValue:null,kind:"LocalArgument",name:"skipEndpoint"},o=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"project",variableName:"projectID"}],r={alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"endpoint_id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},c={args:null,kind:"FragmentSpread",name:"EndpointLLMChatCard_endpoint"},p=[{kind:"Variable",name:"endpoint_id",variableName:"endpoint_id"}],f=[d,u,s,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}];return{fragment:{argumentDefinitions:[n,e,t,i,l,a],kind:"Fragment",metadata:null,name:"EndpointSelectQuery",selections:[{alias:null,args:o,concreteType:"EndpointList",kind:"LinkedField",name:"endpoint_list",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Endpoint",kind:"LinkedField",name:"items",plural:!0,selections:[d,u,s,c],storageKey:null}],storageKey:null},{alias:null,args:p,concreteType:"Endpoint",kind:"LinkedField",name:"endpoint",plural:!1,selections:[d,u,c],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[i,t,l,e,n,a],kind:"Operation",name:"EndpointSelectQuery",selections:[{alias:null,args:o,concreteType:"EndpointList",kind:"LinkedField",name:"endpoint_list",plural:!1,selections:[r,{alias:null,args:null,concreteType:"Endpoint",kind:"LinkedField",name:"items",plural:!0,selections:f,storageKey:null}],storageKey:null},{alias:null,args:p,concreteType:"Endpoint",kind:"LinkedField",name:"endpoint",plural:!1,selections:f,storageKey:null}]},params:{cacheID:"4ed77e0d8d228a82aa36a46316bc28ca",id:null,metadata:{},name:"EndpointSelectQuery",operationKind:"query",text:"query EndpointSelectQuery(\n  $offset: Int!\n  $limit: Int!\n  $projectID: UUID\n  $filter: String\n  $endpoint_id: UUID!\n  $skipEndpoint: Boolean!\n) {\n  endpoint_list(offset: $offset, limit: $limit, project: $projectID, filter: $filter) {\n    total_count\n    items {\n      name\n      endpoint_id\n      url\n      ...EndpointLLMChatCard_endpoint\n      id\n    }\n  }\n  endpoint(endpoint_id: $endpoint_id) @skipOnClient(if: $skipEndpoint) {\n    name\n    endpoint_id\n    ...EndpointLLMChatCard_endpoint\n    id\n  }\n}\n\nfragment EndpointLLMChatCard_endpoint on Endpoint {\n  endpoint_id\n  url\n}\n"}}}();i.hash="bc98e0b499fc7a18b88e87841f5e6e47";const l=i},56131:(n,e,t)=>{t.r(e),t.d(e,{default:()=>R});var i,l=t(72338),a=t(23441),o=t(73e3),r=t(51847),d=t(1581),u=t(46976),s=t.n(u),c=t(53350),p=t(22018),f=t(60598);const m=n=>{let{fetchKey:e,lifecycleStageFilter:l=["created"],loading:o,...u}=n;const m=(0,a.CX)(),[g,y]=(0,r.A)(u),[v,k]=(0,c.useState)(),[h,b]=(0,c.useTransition)(),L=l.map((n=>`lifecycle_stage == "${n}"`)).join(" | "),{endpoint_list:C,endpoint:_}=(0,p.useLazyLoadQuery)(void 0!==i?i:i=t(90003),{limit:10,offset:0,filter:m.supports("endpoint-lifecycle-stage-filter")?[L,v].filter(Boolean).map((n=>`(${n})`)).join(" & "):void 0,endpoint_id:g,skipEndpoint:!g},{fetchKey:e}),E=_?s().map(s().uniqBy(s().concat(null===C||void 0===C?void 0:C.items,_),"endpoint_id"),(n=>({label:null===n||void 0===n?void 0:n.name,value:null===n||void 0===n?void 0:n.endpoint_id,endpoint:n}))):s().map(null===C||void 0===C?void 0:C.items,(n=>({label:null===n||void 0===n?void 0:n.name,value:null===n||void 0===n?void 0:n.endpoint_id,endpoint:n})));return(0,f.jsx)(d.A,{showSearch:!0,onSearch:n=>{b((()=>{k(n&&`name ilike "%${n}%"`)}))},filterOption:!1,loading:h||o,options:E,...u,value:g,onChange:(n,e)=>{var t;y(n,null===(t=s().castArray(e))||void 0===t?void 0:t[0].endpoint)}})};var g,y=t(46735),v=t(59203),k=t(43622),h=t(9571),b=t(24034),L=t(52335),C=t(58325),_=t(21110),E=t(7322),x=t(91788);const S=(0,_.eU)(""),A=(0,_.eU)(),j=(0,_.eU)(void 0),K=n=>{var e,i,l,r;let{basePath:d="v1",closable:u,defaultModelId:_,defaultEndpoint:K,isSynchronous:F,onRequestClose:I,onModelChange:w,...M}=n;const{t:T}=(0,x.Bd)(),{token:D}=h.A.useToken(),[P,$]=(0,a.Tw)("first"),[V,Q]=(0,c.useState)(K||null),R=(0,p.useFragment)(void 0!==g?g:g=t(67646),V),[z,U]=(0,c.useState)(R),[q,O]=(0,E.fp)(S),[N,X]=(0,E.fp)(A),[B,H]=(0,E.fp)(j),{data:W}=(0,o.nj)({queryKey:["models",P,null===R||void 0===R?void 0:R.endpoint_id],queryFn:()=>{var n;return null!==R&&void 0!==R&&R.url?fetch(new URL(d+"/models",null!==(n=null===R||void 0===R?void 0:R.url)&&void 0!==n?n:void 0).toString()).then((n=>n.json())).catch((n=>({data:[]}))):Promise.resolve({data:[]})}}),G=s().map(null===W||void 0===W?void 0:W.data,(n=>({id:n.id,name:n.id}))),J=(0,c.useId)();return(0,f.jsx)(y.A,{...M,baseURL:null!==R&&void 0!==R&&R.url?new URL(d,null!==(e=null===R||void 0===R?void 0:R.url)&&void 0!==e?e:void 0).toString():void 0,models:G,fetchOnClient:!0,leftExtra:(0,f.jsx)(m,{placeholder:T("chatui.SelectEndpoint"),style:{fontWeight:"normal"},fetchKey:P,showSearch:!0,loading:(null===z||void 0===z?void 0:z.endpoint_id)!==(null===R||void 0===R?void 0:R.endpoint_id),onChange:(n,e)=>{U(e),(0,c.startTransition)((()=>{Q(e)}))},value:null===R||void 0===R?void 0:R.endpoint_id,popupMatchSelectWidth:!1}),modelId:_&&s().includes(s().map(null===W||void 0===W?void 0:W.data,"id"),_)?_:null!==(i=null===W||void 0===W||null===(l=W.data)||void 0===l||null===(r=l[0])||void 0===r?void 0:r.id)&&void 0!==i?i:"custom",extra:u?(0,f.jsx)(b.A,{title:T("chatui.DeleteChattingSession"),description:T("chatui.DeleteChattingSessionDescription"),onConfirm:()=>{null===I||void 0===I||I()},okText:T("button.Delete"),okButtonProps:{danger:!0},children:(0,f.jsx)(L.Ay,{icon:(0,f.jsx)(v.A,{}),type:"text",style:{color:D.colorIcon}})}):void 0,allowCustomModel:s().isEmpty(G),alert:s().isEmpty(G)&&(0,f.jsx)(C.A,{type:"warning",showIcon:!0,message:T("chatui.CannotFindModel"),action:(0,f.jsx)(L.Ay,{icon:(0,f.jsx)(k.A,{}),onClick:()=>{$()},children:T("button.Refresh")})}),inputMessage:F?q:void 0,onInputChange:n=>{O(n)},inputAttachment:F?N:void 0,onAttachmentChange:n=>{X(n)},submitKey:(null===B||void 0===B?void 0:B.id)===J||null===B||void 0===B?void 0:B.key,onSubmitChange:()=>{O(""),X([]),F&&H({id:J,key:(new Date).toString()})}})};var F=t(53051),I=t(92509),w=t(51146);const M=function(n){void 0===n&&(n=[]);var e=(0,c.useRef)(-1),t=(0,c.useRef)([]),i=(0,c.useCallback)((function(n){e.current+=1,t.current.splice(n,0,e.current)}),[]),l=(0,I.zs)((0,c.useState)((function(){return n.forEach((function(n,e){i(e)})),n})),2),a=l[0],o=l[1],r=(0,c.useCallback)((function(n){t.current=[],o((function(){return n.forEach((function(n,e){i(e)})),n}))}),[]),d=(0,c.useCallback)((function(n,e){o((function(t){var l=(0,I.fX)([],(0,I.zs)(t),!1);return l.splice(n,0,e),i(n),l}))}),[]),u=(0,c.useCallback)((function(n){return t.current[n]}),[]),s=(0,c.useCallback)((function(n){return t.current.findIndex((function(e){return e===n}))}),[]),p=(0,c.useCallback)((function(n,e){o((function(t){var l=(0,I.fX)([],(0,I.zs)(t),!1);return e.forEach((function(e,t){i(n+t)})),l.splice.apply(l,(0,I.fX)([n,0],(0,I.zs)(e),!1)),l}))}),[]),f=(0,c.useCallback)((function(n,e){o((function(t){var i=(0,I.fX)([],(0,I.zs)(t),!1);return i[n]=e,i}))}),[]),m=(0,c.useCallback)((function(n){o((function(e){var i=(0,I.fX)([],(0,I.zs)(e),!1);i.splice(n,1);try{t.current.splice(n,1)}catch(l){console.error(l)}return i}))}),[]),g=(0,c.useCallback)((function(n){Array.isArray(n)?n.length&&o((function(e){var i=[],l=e.filter((function(e,t){var l=!n.includes(t);return l&&i.push(u(t)),l}));return t.current=i,l})):w.A&&console.error('`indexes` parameter of `batchRemove` function expected to be an array, but got "'.concat(typeof n,'".'))}),[]),y=(0,c.useCallback)((function(n,e){n!==e&&o((function(i){var l=(0,I.fX)([],(0,I.zs)(i),!1),a=l.filter((function(e,t){return t!==n}));a.splice(e,0,l[n]);try{var o=t.current.filter((function(e,t){return t!==n}));o.splice(e,0,t.current[n]),t.current=o}catch(r){console.error(r)}return a}))}),[]),v=(0,c.useCallback)((function(n){o((function(e){return i(e.length),e.concat([n])}))}),[]),k=(0,c.useCallback)((function(){try{t.current=t.current.slice(0,t.current.length-1)}catch(n){console.error(n)}o((function(n){return n.slice(0,n.length-1)}))}),[]),h=(0,c.useCallback)((function(n){o((function(e){return i(0),[n].concat(e)}))}),[]),b=(0,c.useCallback)((function(){try{t.current=t.current.slice(1,t.current.length)}catch(n){console.error(n)}o((function(n){return n.slice(1,n.length)}))}),[]),L=(0,c.useCallback)((function(n){return n.map((function(n,e){return{key:e,item:n}})).sort((function(n,e){return s(n.key)-s(e.key)})).filter((function(n){return!!n.item})).map((function(n){return n.item}))}),[]);return{list:a,insert:d,merge:p,replace:f,remove:m,batchRemove:g,getKey:u,getIndex:s,move:y,push:v,pop:k,unshift:h,shift:b,sortList:L,resetList:r}};var T,D=t(50128),P=t(77109),$=t(20418),V=t(91867),Q=t(32043);const R=n=>{let{...e}=n;const{token:i}=h.A.useToken(),{t:a}=(0,x.Bd)(),{list:o,remove:r,getKey:d,push:u}=M(["0","1"]),[m,g]=(0,c.useState)(!1),[y]=(0,Q.useQueryParam)("endpointId",Q.StringParam),[v]=(0,Q.useQueryParam)("modelId",Q.StringParam),k=!y,{endpoint:b,endpoint_list:C}=(0,p.useLazyLoadQuery)(void 0!==T?T:T=t(52965),{endpointId:y||"",isEmptyEndpointId:k});return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(l.A,{direction:"column",align:"stretch",children:[(0,f.jsxs)(l.A,{direction:"row",justify:"between",wrap:"wrap",gap:"xs",style:{padding:i.paddingContentVertical,paddingLeft:i.paddingContentHorizontalSM,paddingRight:i.paddingContentHorizontalSM},children:[(0,f.jsx)(l.A,{direction:"column",align:"start",children:(0,f.jsx)(D.A.Text,{style:{margin:0,padding:0},children:"LLM Playground"})}),(0,f.jsx)(l.A,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:(0,f.jsxs)(l.A,{gap:"xs",children:[(0,f.jsx)(D.A.Text,{type:"secondary",children:a("chatui.SyncInput")}),(0,f.jsx)(P.A,{value:m,onClick:n=>{g(n)}}),(0,f.jsx)(L.Ay,{onClick:()=>{u((new Date).toString())},icon:(0,f.jsx)(F.A,{})})]})})]}),(0,f.jsx)(l.A,{gap:"xs",direction:"row",style:{margin:i.margin,marginTop:0,overflow:"auto",height:"calc(100vh - 215px)"},align:"stretch",children:s().map(o,((n,e)=>{var t;return(0,f.jsx)(c.Suspense,{fallback:(0,f.jsx)($.A,{bordered:!0,style:{width:"100%",display:"flex",flexDirection:"column"},children:(0,f.jsx)(V.A,{active:!0})}),children:(0,f.jsx)(K,{defaultModelId:0===e&&b&&v?v:void 0,defaultEndpoint:0===e&&b?b:(null===C||void 0===C||null===(t=C.items)||void 0===t?void 0:t[0])||void 0,style:{flex:1},onRequestClose:()=>{r(e)},closable:o.length>1,isSynchronous:m},d(e))},d(e))}))})]})})}},67646:(n,e,t)=>{t.r(e),t.d(e,{default:()=>l});const i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EndpointLLMChatCard_endpoint",selections:[{alias:null,args:null,kind:"ScalarField",name:"endpoint_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],type:"Endpoint",abstractKey:null,hash:"d5fbaab35efda649f9f7847ee51028b6"},l=i},52965:(n,e,t)=>{t.r(e),t.d(e,{default:()=>l});const i=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"endpointId"},{defaultValue:null,kind:"LocalArgument",name:"isEmptyEndpointId"}],e=[{kind:"Variable",name:"endpoint_id",variableName:"endpointId"}],t=[{args:null,kind:"FragmentSpread",name:"EndpointLLMChatCard_endpoint"}],i=[{kind:"Literal",name:"limit",value:1},{kind:"Literal",name:"offset",value:0}],l=[{alias:null,args:null,kind:"ScalarField",name:"endpoint_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"LLMPlaygroundPageQuery",selections:[{alias:null,args:e,concreteType:"Endpoint",kind:"LinkedField",name:"endpoint",plural:!1,selections:t,storageKey:null},{alias:null,args:i,concreteType:"EndpointList",kind:"LinkedField",name:"endpoint_list",plural:!1,selections:[{alias:null,args:null,concreteType:"Endpoint",kind:"LinkedField",name:"items",plural:!0,selections:t,storageKey:null}],storageKey:"endpoint_list(limit:1,offset:0)"}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"LLMPlaygroundPageQuery",selections:[{alias:null,args:e,concreteType:"Endpoint",kind:"LinkedField",name:"endpoint",plural:!1,selections:l,storageKey:null},{alias:null,args:i,concreteType:"EndpointList",kind:"LinkedField",name:"endpoint_list",plural:!1,selections:[{alias:null,args:null,concreteType:"Endpoint",kind:"LinkedField",name:"items",plural:!0,selections:l,storageKey:null}],storageKey:"endpoint_list(limit:1,offset:0)"}]},params:{cacheID:"2666fd687919647b3aaa7f1d6cda6662",id:null,metadata:{},name:"LLMPlaygroundPageQuery",operationKind:"query",text:"query LLMPlaygroundPageQuery(\n  $endpointId: UUID!\n  $isEmptyEndpointId: Boolean!\n) {\n  endpoint(endpoint_id: $endpointId) @skipOnClient(if: $isEmptyEndpointId) {\n    ...EndpointLLMChatCard_endpoint\n    id\n  }\n  endpoint_list(limit: 1, offset: 0) {\n    items {\n      ...EndpointLLMChatCard_endpoint\n      id\n    }\n  }\n}\n\nfragment EndpointLLMChatCard_endpoint on Endpoint {\n  endpoint_id\n  url\n}\n"}}}();i.hash="ebf5c41c874617edc639e99afe6789d2";const l=i},51847:(n,e,t)=>{t.d(e,{A:()=>d});var i=t(92509),l=t(53350),a=t(66413),o=t(7447);const r=function(){var n=(0,i.zs)((0,l.useState)({}),2)[1];return(0,l.useCallback)((function(){return n({})}),[])};const d=function(n,e){void 0===n&&(n={}),void 0===e&&(e={});var t=e.defaultValue,d=e.defaultValuePropName,u=void 0===d?"defaultValue":d,s=e.valuePropName,c=void 0===s?"value":s,p=e.trigger,f=void 0===p?"onChange":p,m=n[c],g=Object.prototype.hasOwnProperty.call(n,c),y=(0,l.useMemo)((function(){return g?m:Object.prototype.hasOwnProperty.call(n,u)?n[u]:t}),[]),v=(0,l.useRef)(y);g&&(v.current=m);var k=r();return[v.current,(0,o.A)((function(e){for(var t=[],l=1;l<arguments.length;l++)t[l-1]=arguments[l];var o=(0,a.Tn)(e)?e(v.current):e;g||(v.current=o,k()),n[f]&&n[f].apply(n,(0,i.fX)([o],(0,i.zs)(t),!1))}))]}}}]);
//# sourceMappingURL=6131.82a8aa36.chunk.js.map