"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[411],{11411:(e,a,l)=>{l.r(a),l.d(a,{default:()=>_});var n=l(83468),i=l(25339),t=l(91412),o=l(16162),r=l(29871),u=l(66464),d=l(51203),s=l(45901),c=l.n(s),m=l(76998),v=l(23446);const p=e=>{var a;let{value:l,defaultValue:n,onChange:i,steps:t,showAllMarkLabels:o,...r}=e;const m=t.map((e=>c().isNumber(e)||c().isString(e)?{value:e,label:e.toString()}:e)),[p,g]=(0,u.A)({value:l,defaultValue:n,onChange:i},{defaultValue:null!==n&&void 0!==n?n:null===(a=m[0])||void 0===a?void 0:a.value}),b=e=>0===e||e===m.length-1,f=c().fromPairs(m.map(((e,a)=>[a,b(a)?e.label:" "])));return(0,v.jsx)(d.A,{...r,marks:f,value:c().findIndex(m,{value:p}),min:0,tooltip:{formatter(e){var a;if((0,s.isNumber)(e))return null===(a=m[e])||void 0===a?void 0:a.label},...r.tooltip},max:m.length-1,onChange:e=>{var a,l;g(null===(a=m[e])||void 0===a?void 0:a.value,null===(l=m[e])||void 0===l?void 0:l.label)}})};var g=l(50840),b=l(65080),f=l(36209),y=l(64283);const h=e=>{var a,l,n,i;let{name:t,min:u,max:d}=e;const{token:s}=g.A.useToken(),[m]=(0,o.Hv)(),h=e=>{var a;return{cpu:{label:null===m||void 0===m?void 0:m.cpu.description,steps:c().map(["0","1","2","3","4","5","6","7","8"],(e=>({value:e,label:"".concat(e," ").concat(null===m||void 0===m?void 0:m.cpu.display_unit)})))},mem:{label:null===m||void 0===m?void 0:m.mem.description,steps:c().map(["64m","128m","256m","512m","1g","2g","4g","8g","16g","32g","64g","128g","256g","512g"],(e=>({value:e,label:"".concat(e.slice(0,-1)," ").concat(c().toUpper(c().last(e)),"iB")})))},"cuda.device":{label:null===m||void 0===m?void 0:m["cuda.device"].description,steps:c().map(["0","1","2","3","4","5","6","7","8"],(e=>({value:e,label:"".concat(e," ").concat(null===m||void 0===m?void 0:m["cuda.device"].display_unit)})))},"cuda.shares":{label:null===m||void 0===m?void 0:m["cuda.shares"].description,steps:c().map(["0","0.1","0.2","0.5","1.0","2.0","4.0","8.0"],(e=>({value:e,label:"".concat(e," ").concat(null===m||void 0===m?void 0:m["cuda.shares"].display_unit)})))},"rocm.device":{label:null===m||void 0===m?void 0:m["rocm.device"].description,steps:["0","1","2","3","4","5","6","7","8"]}}[e]||{label:null===m||void 0===m||null===(a=m[e])||void 0===a?void 0:a.description,steps:c().map(["0","1","2","3","4"],(a=>{var l;return{value:a,label:"".concat(a," ").concat((null===m||void 0===m||null===(l=m[e])||void 0===l?void 0:l.display_unit)||"")}}))}},k=b.A.useFormInstance(),x=b.A.useWatch(t,k),A=c().find(h(t).steps,(e=>e.value===x||e===x));return(0,v.jsx)(b.A.Item,{label:null!==(a=null===(l=h(t))||void 0===l?void 0:l.label)&&void 0!==a?a:t.toUpperCase(),style:{flex:1},children:(0,v.jsxs)(r.A,{direction:"row",gap:"lg",children:[(0,v.jsx)(f.A,{size:"large",variant:"borderless",readOnly:!0,value:null!==(n=null===A||void 0===A?void 0:A.label)&&void 0!==n?n:A,style:{flex:1,fontSize:s.fontSizeLG},tabIndex:-1}),(0,v.jsx)(y.A,{type:"vertical",style:{height:40}}),(0,v.jsx)(b.A.Item,{name:t,noStyle:!0,initialValue:u,children:(0,v.jsx)(p,{style:{flex:5},steps:null===(i=h(t))||void 0===i?void 0:i.steps})})]})})};var k,x=l(12620),A=l(24717),M=l(77678),I=l(3606);const _=e=>{var a;let{...o}=e;const r=(0,n.CX)(),{t:u}=(0,M.Bd)(),d=(0,m.useRef)(null),s=x.A.useApp(),{parsedValue:{image:c,open:p},dispatchEvent:g}=(0,t.useWebComponentInfo)(),[f,y]=(0,I.useMutation)(void 0!==k?k:k=l(7394));return(0,v.jsx)(i.A,{destroyOnClose:!0,open:p,maskClosable:!1,onOk:async()=>{var e;const a=await(null===(e=d.current)||void 0===e?void 0:e.getFieldsValue()),l=Object.entries(a).map((e=>{var a,l,n,i;let[t,o]=e;return{key:t,min:null!==(a=o.toString())&&void 0!==a?a:"0",max:(null!==(l=null===(n=c.resource_limits)||void 0===n||null===(i=n.find((e=>(null===e||void 0===e?void 0:e.key)===t)))||void 0===i?void 0:i.max)&&void 0!==l?l:r.isManagerVersionCompatibleWith("24.03.4.*"))?void 0:null}})),n=()=>f({variables:{target:"".concat(c.registry,"/").concat(c.name,":").concat(c.tag),architecture:c.architecture,props:{resource_limits:l}},onCompleted:(e,a)=>{a?A.Ay.error(u("dialog.ErrorOccurred")):(A.Ay.success(u("environment.DescImageResourceModified")),g("ok",null))},onError:e=>{A.Ay.error(u("dialog.ErrorOccurred"))}});null!==c&&void 0!==c&&c.installed?s.modal.confirm({title:"Image reinstallation required",content:(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(M.x6,{i18nKey:"environment.ModifyImageResourceLimitReinstallRequired"})}),onOk:n,getContainer:()=>document.body,closable:!0}):n()},onCancel:()=>g("cancel",null),confirmLoading:y,centered:!0,title:u("environment.ModifyImageResourceLimit"),...o,children:(0,v.jsx)(b.A,{ref:d,layout:"vertical",children:null===c||void 0===c||null===(a=c.resource_limits)||void 0===a?void 0:a.map((e=>{let{key:a,min:l,max:n}=e;const i=null===a||void 0===a?void 0:a.replace(/_/g,".");return(0,v.jsx)(h,{name:null!==i&&void 0!==i?i:"",min:null!==l&&void 0!==l?l:"",max:null!==n&&void 0!==n?n:""},i)}))})})}},7394:(e,a,l)=>{l.r(a),l.d(a,{default:()=>i});const n=function(){var e={defaultValue:null,kind:"LocalArgument",name:"architecture"},a={defaultValue:null,kind:"LocalArgument",name:"props"},l={defaultValue:null,kind:"LocalArgument",name:"target"},n=[{alias:null,args:[{kind:"Variable",name:"architecture",variableName:"architecture"},{kind:"Variable",name:"props",variableName:"props"},{kind:"Variable",name:"target",variableName:"target"}],concreteType:"ModifyImage",kind:"LinkedField",name:"modify_image",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,a,l],kind:"Fragment",metadata:null,name:"ManageImageResourceLimitModalMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,e,a],kind:"Operation",name:"ManageImageResourceLimitModalMutation",selections:n},params:{cacheID:"b4c4a5b17c6aa265df64e4d2d6338684",id:null,metadata:{},name:"ManageImageResourceLimitModalMutation",operationKind:"mutation",text:"mutation ManageImageResourceLimitModalMutation(\n  $target: String!\n  $architecture: String\n  $props: ModifyImageInput!\n) {\n  modify_image(target: $target, architecture: $architecture, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();n.hash="491b6e500587a3630195d9025ef76f29";const i=n}}]);
//# sourceMappingURL=411.b5fd88d8.chunk.js.map