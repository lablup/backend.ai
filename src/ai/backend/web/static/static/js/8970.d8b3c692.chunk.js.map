{"version":3,"file":"static/js/8970.d8b3c692.chunk.js","mappings":"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","sources":["components/PortSelectFormItem.tsx","__generated__/useStartSessionCreationQuery.graphql.ts","hooks/useStartSession.tsx"],"sourcesContent":["import { useSuspendedBackendaiClient } from '../hooks';\nimport { Form, type FormItemProps, Select, Tag } from 'antd';\nimport { TagProps } from 'antd/lib';\nimport _ from 'lodash';\nimport React from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\n\ninterface Props extends FormItemProps {}\n\nexport interface PortSelectFormValues {\n  ports: string[];\n}\n\nconst MIN_PORT = 1024;\nconst MAX_PORT = 65535;\nconst PortSelectFormItem: React.FC<Props> = ({\n  name = 'ports',\n  ...formItemProps\n}) => {\n  const { t } = useTranslation();\n  const baiClient = useSuspendedBackendaiClient();\n  const form = Form.useFormInstance();\n  return (\n    <Form.Item\n      label={t('session.launcher.PreOpenPortTitle')}\n      name={name}\n      tooltip={<Trans i18nKey=\"session.launcher.DescSetPreOpenPort\" />}\n      extra={t('session.launcher.PreOpenPortRangeGuide')}\n      rules={[\n        () => ({\n          validator(_rule, values) {\n            if (\n              transformPortValuesToNumbers(values).length <=\n              baiClient._config.maxCountForPreopenPorts\n            ) {\n              return Promise.resolve();\n            } else {\n              return Promise.reject(\n                new Error(\n                  t('session.launcher.PreOpenPortMaxCountLimit', {\n                    count: baiClient._config.maxCountForPreopenPorts,\n                  }),\n                ),\n              );\n            }\n          },\n        }),\n        () => ({\n          // To check if the port range is not start <= end\n          validator(_rule, values) {\n            if (\n              _.every(values, (v) => {\n                return parseInt(v).toString() === v || isPortRangeStr(v);\n              })\n            ) {\n              return Promise.resolve();\n            } else {\n              return Promise.reject(\n                new Error(t('session.launcher.InvalidPortFormat')),\n              );\n            }\n          },\n        }),\n        () => ({\n          validator(_rule, values) {\n            const allPorts = transformPortValuesToNumbers(values);\n            if (\n              _.every(allPorts, (port) => {\n                return port >= MIN_PORT && port <= MAX_PORT;\n              })\n            ) {\n              return Promise.resolve();\n            }\n            return Promise.reject(\n              new Error(t('session.launcher.PreOpenPortRange')),\n            );\n          },\n        }),\n        () => ({\n          validator(_rule, values) {\n            // To check if the port is duplicated\n            const allPorts = transformPortValuesToNumbers(values);\n            if (_.uniq(allPorts).length === allPorts.length) {\n              return Promise.resolve();\n            }\n            return Promise.reject(\n              new Error(t('session.launcher.DuplicatedPort')),\n            );\n          },\n        }),\n      ]}\n      {...formItemProps}\n    >\n      <Select\n        mode=\"tags\"\n        tagRender={(props) => {\n          const hasDuplicated =\n            _.filter(\n              transformPortValuesToNumbers(form.getFieldValue(name)),\n              (v) => v === parseInt(props.value),\n            ).length > 1;\n          return (\n            <PortTag\n              inValid={hasDuplicated}\n              closable={props.closable}\n              onClose={props.onClose}\n              onMouseDown={(e) => {\n                e.preventDefault();\n                e.stopPropagation();\n              }}\n              value={props.value}\n            >\n              {props.label}\n            </PortTag>\n          );\n        }}\n        style={{ width: '100%' }}\n        // placeholder={t('session.launcher.PreOpen')}\n        // options={_.map(portGuides, (v, k) => ({\n        //   value: parseInt(k),\n        //   // label: `${k} - ${v}`,\n        // }))}\n        suffixIcon={null}\n        open={false}\n        tokenSeparators={[',', ' ']}\n      />\n    </Form.Item>\n  );\n};\n\ninterface PortTagProps extends TagProps {\n  value: string;\n  inValid?: boolean;\n}\n\nexport const PortTag: React.FC<PortTagProps> = ({\n  inValid,\n  value,\n  ...tagProps\n}) => {\n  return (\n    <Tag\n      color={!inValid && isValidPortStr(value) ? undefined : 'red'}\n      {...tagProps}\n    />\n  );\n};\n\nexport const isValidPortStr = (portStr: string) => {\n  // consider range as valid\n  if (isPortRangeStr(portStr)) {\n    const splitPortRange = portStr.split(':');\n    const [start, end] = splitPortRange.map((v) => parseInt(v));\n    return start >= MIN_PORT && end <= MAX_PORT;\n  } else if (\n    portStr === parseInt(portStr).toString() &&\n    parseInt(portStr) >= MIN_PORT &&\n    parseInt(portStr) <= MAX_PORT\n  ) {\n    return true;\n  }\n  return false;\n};\n\nexport const isPortRangeStr = (portRange: string) => {\n  const splitPortRange = portRange.split(':');\n  if (splitPortRange.length === 2) {\n    const [start, end] = splitPortRange.map((v) => parseInt(v));\n    return start <= end;\n  }\n  return false;\n};\n\nexport const parsePortRangeToNumbers = (portRange: string) => {\n  const [start, end] = portRange.split(':').map((v) => parseInt(v));\n  return _.range(start, end + 1);\n};\n\nexport const transformPortValuesToNumbers = (\n  values: PortSelectFormValues['ports'],\n) => {\n  return _.flatten(\n    _.map(values, (v) =>\n      isPortRangeStr(v) ? parsePortRangeToNumbers(v) : parseInt(v),\n    ),\n  );\n};\n// const portGuides = {\n//   '5432': 'PostgreSQL',\n//   '3306': 'MySQL',\n//   '1521': 'Oracle',\n//   '27017': 'MongoDB',\n//   '6379': 'Redis',\n//   '11211': 'Memcached',\n//   '9200': 'Elasticsearch',\n//   '5601': 'Kibana',\n//   '9600': 'Logstash',\n//   '9042': 'Cassandra',\n//   '2181': 'Zookeeper',\n//   '9092': 'Kafka',\n//   '80': 'HTTP',\n//   '443': 'HTTPS',\n//   '22': 'SSH',\n//   '21': 'FTP',\n//   '25': 'SMTP',\n//   '110': 'POP3',\n//   '143': 'IMAP',\n//   '53': 'DNS',\n//   '389': 'LDAP',\n//   '636': 'LDAPS',\n//   '8080': 'HTTP Alt',\n//   '8443': 'HTTP Alt SSL',\n//   '465': 'SMTP SSL',\n//   '587': 'SMTP TLS',\n//   '993': 'IMAP SSL',\n//   '995': 'POP3 SSL',\n//   '7001': 'WebLogic',\n//   '7002': 'WebLogic SSL',\n//   '4848': 'GlassFish',\n//   '8181': 'GlassFish SSL',\n//   '8081': 'Nginx',\n// };\n\nexport default PortSelectFormItem;\n","/**\n * @generated SignedSource<<a8719cf7c41edd67f87910053877a71b>>\n * @lightSyntaxTransform\n * @nogrep\n */\n\n/* tslint:disable */\n/* eslint-disable */\n// @ts-nocheck\n\nimport { ConcreteRequest } from 'relay-runtime';\nimport { FragmentRefs } from \"relay-runtime\";\nexport type useStartSessionCreationQuery$variables = {\n  id: any;\n};\nexport type useStartSessionCreationQuery$data = {\n  readonly compute_session_node: {\n    readonly \" $fragmentSpreads\": FragmentRefs<\"BAINodeNotificationItemFragment\">;\n  } | null | undefined;\n};\nexport type useStartSessionCreationQuery = {\n  response: useStartSessionCreationQuery$data;\n  variables: useStartSessionCreationQuery$variables;\n};\n\nconst node: ConcreteRequest = (function(){\nvar v0 = [\n  {\n    \"defaultValue\": null,\n    \"kind\": \"LocalArgument\",\n    \"name\": \"id\"\n  }\n],\nv1 = [\n  {\n    \"kind\": \"Variable\",\n    \"name\": \"id\",\n    \"variableName\": \"id\"\n  }\n],\nv2 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"id\",\n  \"storageKey\": null\n},\nv3 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"__typename\",\n  \"storageKey\": null\n},\nv4 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"status\",\n  \"storageKey\": null\n},\nv5 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"name\",\n  \"storageKey\": null\n},\nv6 = {\n  \"alias\": null,\n  \"args\": null,\n  \"kind\": \"ScalarField\",\n  \"name\": \"row_id\",\n  \"storageKey\": null\n};\nreturn {\n  \"fragment\": {\n    \"argumentDefinitions\": (v0/*: any*/),\n    \"kind\": \"Fragment\",\n    \"metadata\": null,\n    \"name\": \"useStartSessionCreationQuery\",\n    \"selections\": [\n      {\n        \"alias\": null,\n        \"args\": (v1/*: any*/),\n        \"concreteType\": \"ComputeSessionNode\",\n        \"kind\": \"LinkedField\",\n        \"name\": \"compute_session_node\",\n        \"plural\": false,\n        \"selections\": [\n          {\n            \"args\": null,\n            \"kind\": \"FragmentSpread\",\n            \"name\": \"BAINodeNotificationItemFragment\"\n          }\n        ],\n        \"storageKey\": null\n      }\n    ],\n    \"type\": \"Query\",\n    \"abstractKey\": null\n  },\n  \"kind\": \"Request\",\n  \"operation\": {\n    \"argumentDefinitions\": (v0/*: any*/),\n    \"kind\": \"Operation\",\n    \"name\": \"useStartSessionCreationQuery\",\n    \"selections\": [\n      {\n        \"alias\": null,\n        \"args\": (v1/*: any*/),\n        \"concreteType\": \"ComputeSessionNode\",\n        \"kind\": \"LinkedField\",\n        \"name\": \"compute_session_node\",\n        \"plural\": false,\n        \"selections\": [\n          (v2/*: any*/),\n          {\n            \"kind\": \"InlineFragment\",\n            \"selections\": [\n              {\n                \"kind\": \"InlineFragment\",\n                \"selections\": [\n                  (v3/*: any*/),\n                  (v4/*: any*/),\n                  (v5/*: any*/),\n                  (v6/*: any*/),\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"type\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"access_key\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"service_ports\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"commit_status\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"user_id\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"scaling_group\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"concreteType\": \"KernelConnection\",\n                    \"kind\": \"LinkedField\",\n                    \"name\": \"kernel_nodes\",\n                    \"plural\": false,\n                    \"selections\": [\n                      {\n                        \"alias\": null,\n                        \"args\": null,\n                        \"concreteType\": \"KernelEdge\",\n                        \"kind\": \"LinkedField\",\n                        \"name\": \"edges\",\n                        \"plural\": true,\n                        \"selections\": [\n                          {\n                            \"alias\": null,\n                            \"args\": null,\n                            \"concreteType\": \"KernelNode\",\n                            \"kind\": \"LinkedField\",\n                            \"name\": \"node\",\n                            \"plural\": false,\n                            \"selections\": [\n                              {\n                                \"alias\": null,\n                                \"args\": null,\n                                \"kind\": \"ScalarField\",\n                                \"name\": \"container_id\",\n                                \"storageKey\": null\n                              },\n                              {\n                                \"alias\": null,\n                                \"args\": null,\n                                \"kind\": \"ScalarField\",\n                                \"name\": \"agent_id\",\n                                \"storageKey\": null\n                              },\n                              (v2/*: any*/),\n                              (v6/*: any*/),\n                              {\n                                \"alias\": null,\n                                \"args\": null,\n                                \"kind\": \"ScalarField\",\n                                \"name\": \"cluster_idx\",\n                                \"storageKey\": null\n                              },\n                              {\n                                \"alias\": null,\n                                \"args\": null,\n                                \"kind\": \"ScalarField\",\n                                \"name\": \"cluster_role\",\n                                \"storageKey\": null\n                              },\n                              {\n                                \"alias\": null,\n                                \"args\": null,\n                                \"kind\": \"ScalarField\",\n                                \"name\": \"cluster_hostname\",\n                                \"storageKey\": null\n                              }\n                            ],\n                            \"storageKey\": null\n                          }\n                        ],\n                        \"storageKey\": null\n                      }\n                    ],\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"vfolder_mounts\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"project_id\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"status_info\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"status_data\",\n                    \"storageKey\": null\n                  },\n                  {\n                    \"alias\": null,\n                    \"args\": null,\n                    \"kind\": \"ScalarField\",\n                    \"name\": \"queue_position\",\n                    \"storageKey\": null\n                  }\n                ],\n                \"type\": \"ComputeSessionNode\",\n                \"abstractKey\": null\n              },\n              {\n                \"kind\": \"InlineFragment\",\n                \"selections\": [\n                  (v3/*: any*/),\n                  (v4/*: any*/),\n                  (v6/*: any*/),\n                  (v5/*: any*/)\n                ],\n                \"type\": \"VirtualFolderNode\",\n                \"abstractKey\": null\n              }\n            ],\n            \"type\": \"Node\",\n            \"abstractKey\": \"__isNode\"\n          }\n        ],\n        \"storageKey\": null\n      }\n    ]\n  },\n  \"params\": {\n    \"cacheID\": \"417a7674ceb139850569e9e2bee0048e\",\n    \"id\": null,\n    \"metadata\": {},\n    \"name\": \"useStartSessionCreationQuery\",\n    \"operationKind\": \"query\",\n    \"text\": \"query useStartSessionCreationQuery(\\n  $id: GlobalIDField!\\n) {\\n  compute_session_node(id: $id) {\\n    ...BAINodeNotificationItemFragment\\n    id\\n  }\\n}\\n\\nfragment AppLaunchConfirmationModalFragment on ComputeSessionNode {\\n  id\\n  row_id\\n  name\\n  ...useBackendAIAppLauncherFragment\\n}\\n\\nfragment AppLauncherModalFragment on ComputeSessionNode {\\n  id\\n  row_id\\n  name\\n  service_ports\\n  access_key\\n  ...useBackendAIAppLauncherFragment\\n  ...SFTPConnectionInfoModalFragment\\n  ...TensorboardPathModalFragment\\n  ...AppLaunchConfirmationModalFragment\\n}\\n\\nfragment BAIComputeSessionNodeNotificationItemFragment on ComputeSessionNode {\\n  row_id\\n  id\\n  name\\n  status\\n  ...SessionActionButtonsFragment\\n  ...SessionStatusTagFragment\\n}\\n\\nfragment BAINodeNotificationItemFragment on Node {\\n  __isNode: __typename\\n  ... on ComputeSessionNode {\\n    __typename\\n    status\\n    name\\n    row_id\\n    ...BAIComputeSessionNodeNotificationItemFragment\\n  }\\n  ... on VirtualFolderNode {\\n    __typename\\n    status\\n    ...BAIVirtualFolderNodeNotificationItemFragment\\n  }\\n  id\\n}\\n\\nfragment BAIVirtualFolderNodeNotificationItemFragment on VirtualFolderNode {\\n  row_id\\n  id\\n  name\\n  status\\n}\\n\\nfragment ContainerCommitModalFragment on ComputeSessionNode {\\n  id\\n  name\\n  row_id\\n}\\n\\nfragment ContainerLogModalFragment on ComputeSessionNode {\\n  id\\n  row_id\\n  name\\n  status\\n  access_key\\n  kernel_nodes {\\n    edges {\\n      node {\\n        id\\n        row_id\\n        container_id\\n        cluster_idx\\n        cluster_role\\n        cluster_hostname\\n      }\\n    }\\n  }\\n}\\n\\nfragment SFTPConnectionInfoModalFragment on ComputeSessionNode {\\n  row_id\\n  vfolder_mounts\\n}\\n\\nfragment SessionActionButtonsFragment on ComputeSessionNode {\\n  id\\n  name\\n  row_id\\n  type\\n  status\\n  access_key\\n  service_ports\\n  commit_status\\n  user_id\\n  ...TerminateSessionModalFragment\\n  ...ContainerLogModalFragment\\n  ...ContainerCommitModalFragment\\n  ...AppLauncherModalFragment\\n  ...SFTPConnectionInfoModalFragment\\n  ...useBackendAIAppLauncherFragment\\n}\\n\\nfragment SessionStatusTagFragment on ComputeSessionNode {\\n  id\\n  status\\n  status_info\\n  status_data\\n  queue_position @since(version: \\\"25.13.0\\\")\\n}\\n\\nfragment TensorboardPathModalFragment on ComputeSessionNode {\\n  id\\n  row_id\\n  name\\n  ...useBackendAIAppLauncherFragment\\n}\\n\\nfragment TerminateSessionModalFragment on ComputeSessionNode {\\n  id\\n  row_id\\n  name\\n  scaling_group\\n  access_key\\n  kernel_nodes {\\n    edges {\\n      node {\\n        container_id\\n        agent_id\\n        id\\n      }\\n    }\\n  }\\n}\\n\\nfragment useBackendAIAppLauncherFragment on ComputeSessionNode {\\n  name\\n  row_id\\n  vfolder_mounts\\n  scaling_group\\n  project_id\\n  service_ports\\n}\\n\"\n  }\n};\n})();\n\n(node as any).hash = \"7a350248b5a833005f531bd8caa3adec\";\n\nexport default node;\n","import { useSuspendedBackendaiClient } from '.';\nimport { useSetBAINotification } from './useBAINotification';\nimport {\n  useCurrentProjectValue,\n  useCurrentResourceGroupState,\n} from './useCurrentProject';\nimport { generateRandomString, toGlobalId } from 'backend.ai-ui';\nimport _ from 'lodash';\nimport { useTranslation } from 'react-i18next';\nimport { fetchQuery, graphql, useRelayEnvironment } from 'react-relay';\nimport { useStartSessionCreationQuery } from 'src/__generated__/useStartSessionCreationQuery.graphql';\nimport { transformPortValuesToNumbers } from 'src/components/PortSelectFormItem';\nimport { RESOURCE_ALLOCATION_INITIAL_FORM_VALUES } from 'src/components/SessionFormItems/ResourceAllocationFormItems';\nimport {\n  SessionLauncherFormValue,\n  SessionResources,\n} from 'src/pages/SessionLauncherPage';\n\n// Type for successful session creation result\ntype SessionCreationSuccess = {\n  kernelId?: string;\n  sessionId: string;\n  sessionName: string;\n  servicePorts: Array<{ name: string }>;\n};\ninterface CreateSessionInfo {\n  kernelName: string;\n  sessionName: string;\n  architecture: string;\n  batchTimeout?: string;\n  resources: SessionResources;\n}\n\nexport const SESSION_LAUNCHER_NOTI_PREFIX = 'session-launcher:';\n\n// Field names that have default values in SessionLauncherFormValue\ntype SessionLauncherDefaultFields =\n  | 'sessionType'\n  | 'allocationPreset'\n  | 'hpcOptimization'\n  | 'batch'\n  | 'envvars'\n  | 'resourceGroup';\n\n// Custom type for environments - mutually exclusive fields\ntype StartSessionEnvironments = {\n  environments:\n    | {\n        version: string;\n        environment?: never;\n        image?: never;\n        manual?: never;\n        customizedTag?: never;\n      }\n    | {\n        version?: never;\n        environment: string;\n        image?: never;\n        manual?: never;\n        customizedTag?: never;\n      }\n    | {\n        version?: never;\n        environment?: never;\n        image?: never;\n        manual: string;\n        customizedTag?: never;\n      };\n};\n\n// Type that makes certain fields optional while keeping others required\nexport type StartSessionValue =\n  // Required fields (environments with only version required)\n  StartSessionEnvironments &\n    // Optional fields from SessionLauncherFormValue\n    Partial<Omit<SessionLauncherFormValue, 'environments'>>;\n\n// Type for minimum required values (all fields except those with defaults are required)\nexport type StartSessionWithDefaultValue = Omit<\n  StartSessionValue,\n  | SessionLauncherDefaultFields\n  | keyof typeof RESOURCE_ALLOCATION_INITIAL_FORM_VALUES\n> &\n  DeepPartial<\n    Pick<\n      StartSessionValue,\n      | SessionLauncherDefaultFields\n      | keyof typeof RESOURCE_ALLOCATION_INITIAL_FORM_VALUES\n    >\n  >;\n\nexport type StartSessionResults = {\n  fulfilled?: PromiseFulfilledResult<SessionCreationSuccess>[];\n  rejected?: PromiseRejectedResult[];\n};\n\nexport const useStartSession = () => {\n  'use memo';\n\n  const { t } = useTranslation();\n  const currentProject = useCurrentProjectValue();\n  const { upsertNotification } = useSetBAINotification();\n\n  const relayEnv = useRelayEnvironment();\n  const baiClient = useSuspendedBackendaiClient();\n  const supportsMountById = baiClient.supports('mount-by-id');\n  const supportBatchTimeout = baiClient?.supports('batch-timeout') ?? false;\n\n  const [currentGlobalResourceGroup] = useCurrentResourceGroupState();\n\n  const defaultFormValues: DeepPartial<SessionLauncherFormValue> = {\n    sessionType: 'interactive',\n    // If you set `allocationPreset` to 'custom', `allocationPreset` is not changed automatically any more.\n    allocationPreset: 'auto-select',\n    hpcOptimization: {\n      autoEnabled: true,\n    },\n    batch: {\n      enabled: false,\n      command: undefined,\n      scheduleDate: undefined,\n      ...(supportBatchTimeout && {\n        timeoutEnabled: false,\n        timeout: undefined,\n        timeoutUnit: 's',\n      }),\n    },\n    envvars: [],\n    // set default_session_environment only if set\n    ...(baiClient._config?.default_session_environment && {\n      environments: normalizeEnvironmentFormat(\n        baiClient._config.default_session_environment,\n      ),\n    }),\n    ..._.omit(RESOURCE_ALLOCATION_INITIAL_FORM_VALUES, ['resource']),\n    resourceGroup: currentGlobalResourceGroup || undefined,\n  };\n\n  const startSessionWithDefault = (\n    minimumValues: StartSessionWithDefaultValue,\n  ) => {\n    const mergedValue = _.merge({}, defaultFormValues, minimumValues);\n    return startSession(mergedValue as SessionLauncherFormValue);\n  };\n  const startSession = async (values: SessionLauncherFormValue) => {\n    // If manual image is selected, use it as kernelName\n    const imageFullName =\n      values.environments.manual || values.environments.version;\n    const [kernelName, architecture] = imageFullName\n      ? imageFullName.split('@')\n      : ['', ''];\n\n    const sessionName = _.isEmpty(values.sessionName)\n      ? generateSessionId()\n      : values.sessionName;\n\n    const sessionInfo: CreateSessionInfo = {\n      // Basic session information\n      sessionName: sessionName,\n      kernelName,\n      architecture,\n      resources: {\n        enqueueOnly: true,\n        // Project and domain settings\n        group_name: values.owner?.enabled\n          ? values.owner.project\n          : currentProject.name,\n        domain: values.owner?.enabled\n          ? values.owner.domainName\n          : baiClient._config.domainName,\n\n        // Session configuration\n        type: values.sessionType,\n        cluster_mode: values.cluster_mode,\n        cluster_size: values.cluster_size,\n        maxWaitSeconds: 15,\n        reuseIfExists: values.reuseIfExists ?? false,\n\n        // Owner settings (optional)\n        // FYI, `config.scaling_group` also changes based on owner settings\n        ...(values.owner?.enabled\n          ? {\n              owner_access_key: values.owner.accesskey,\n            }\n          : {}),\n\n        // Batch mode settings (optional)\n        ...(values.sessionType === 'batch'\n          ? {\n              starts_at: values.batch.enabled\n                ? values.batch.scheduleDate\n                : undefined,\n              startupCommand: values.batch.command,\n            }\n          : {}),\n\n        // Bootstrap script (optional)\n        ...(values.bootstrap_script\n          ? { bootstrap_script: values.bootstrap_script }\n          : {}),\n\n        // Batch timeout configuration (optional)\n        ...(supportBatchTimeout &&\n        values?.batch?.timeoutEnabled &&\n        !_.isUndefined(values?.batch?.timeout)\n          ? {\n              batchTimeout:\n                _.toString(values.batch.timeout) + values?.batch?.timeoutUnit,\n            }\n          : undefined),\n\n        config: {\n          // Resource allocation\n          ...(values?.resource && {\n            resources: {\n              cpu: values?.resource?.cpu,\n              mem: values?.resource?.mem,\n              // Add accelerator only if specified\n              ...(values.resource?.acceleratorType &&\n              values.resource?.accelerator &&\n              values.resource?.accelerator > 0\n                ? {\n                    [values.resource.acceleratorType]:\n                      values.resource.accelerator,\n                  }\n                : undefined),\n            },\n          }),\n          scaling_group: values.owner?.enabled\n            ? values.owner.project\n            : values.resourceGroup,\n          ...(values?.resource && {\n            resource_opts: {\n              shmem: values?.resource?.shmem,\n              // allow_fractional_resource_fragmentation can be added here if needed\n            },\n          }),\n\n          // Storage configuration\n          [supportsMountById ? 'mount_ids' : 'mounts']: values.mount_ids,\n          [supportsMountById ? 'mount_id_map' : 'mount_map']:\n            values.mount_id_map,\n\n          // Environment variables\n          environ: {\n            ..._.fromPairs(values.envvars.map((v) => [v.variable, v.value])),\n            // set hpcOptimization options: \"OMP_NUM_THREADS\", \"OPENBLAS_NUM_THREADS\"\n            ...(values.hpcOptimization.autoEnabled\n              ? {}\n              : _.omit(values.hpcOptimization, 'autoEnabled')),\n          },\n\n          // Networking\n          preopen_ports: transformPortValuesToNumbers(values.ports),\n\n          // Agent selection (optional)\n          ...(baiClient.supports('agent-select') &&\n          !baiClient?._config?.hideAgents &&\n          values.agent !== undefined &&\n          !_.isEqual(_.castArray(values.agent), ['auto'])\n            ? {\n                // Filter out undefined values\n                agent_list: _.chain(values.agent)\n                  .castArray()\n                  .filter((agent): agent is string => !!agent)\n                  .value(),\n              }\n            : undefined),\n        },\n      },\n    };\n    const sessionPromises = _.map(_.range(values.num_of_sessions || 1), (i) => {\n      const formattedSessionName =\n        (values.num_of_sessions || 1) > 1\n          ? `${sessionInfo.sessionName}-${generateRandomString()}-${i}`\n          : sessionInfo.sessionName;\n      return baiClient\n        .createIfNotExists(\n          sessionInfo.kernelName,\n          formattedSessionName,\n          sessionInfo?.resources,\n          undefined,\n          sessionInfo.architecture,\n        )\n        .then(\n          (res: { created: boolean; status: string; sessionId: string }) => {\n            return res;\n          },\n        )\n        .catch((err: any) => {\n          if (err?.message?.includes('The session already exists')) {\n            throw new Error(t('session.launcher.SessionAlreadyExists'));\n          } else {\n            throw err;\n          }\n        });\n    });\n\n    return Promise.allSettled(sessionPromises).then(\n      async (\n        sessionCreations: PromiseSettledResult<SessionCreationSuccess>[],\n      ) => {\n        // Group session creations by their status\n        const results = _.groupBy(\n          sessionCreations,\n          'status',\n        ) as StartSessionResults;\n        return results;\n      },\n    );\n  };\n\n  const upsertSessionNotification = async (\n    successCreations: PromiseFulfilledResult<SessionCreationSuccess>[],\n    upsertNotificationOverrides?: Parameters<typeof upsertNotification>,\n  ) => {\n    const promises = _.map(successCreations, (creation) => {\n      const session = creation.value;\n      return fetchQuery<useStartSessionCreationQuery>(\n        relayEnv,\n        graphql`\n          query useStartSessionCreationQuery($id: GlobalIDField!) {\n            compute_session_node(id: $id) {\n              ...BAINodeNotificationItemFragment\n            }\n          }\n        `,\n        {\n          id: toGlobalId('ComputeSessionNode', session.sessionId),\n        },\n      )\n        .toPromise()\n        .then((queryResult) => {\n          const createdSession = queryResult?.compute_session_node ?? null;\n\n          if (createdSession) {\n            upsertNotification(\n              {\n                key: `${SESSION_LAUNCHER_NOTI_PREFIX}${session.sessionId}`,\n                node: createdSession,\n                open: true,\n                duration: 0,\n                ...upsertNotificationOverrides?.[0],\n              },\n              upsertNotificationOverrides?.[1],\n            );\n          }\n        });\n    });\n    return Promise.allSettled(promises);\n  };\n\n  return {\n    startSession,\n    startSessionWithDefault,\n    defaultFormValues,\n    upsertSessionNotification,\n  };\n};\n\nconst generateSessionId = () => {\n  let text = '';\n  const possible =\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  for (let i = 0; i < 8; i++) {\n    text += possible.charAt(Math.floor(Math.random() * possible.length));\n  }\n  return text + '-session';\n};\n\nconst normalizeEnvironmentFormat = (environment: string) => {\n  if (environment.includes(':')) {\n    return {\n      version: environment,\n    };\n  } else {\n    return {\n      environment: environment,\n    };\n  }\n};\n"],"names":["MIN_PORT","MAX_PORT","PortTag","_ref2","inValid","value","tagProps","_objectWithoutProperties","_excluded2","_jsx","Tag","_objectSpread","color","isValidPortStr","undefined","portStr","isPortRangeStr","splitPortRange","split","start","end","map","v","parseInt","toString","portRange","length","transformPortValuesToNumbers","values","_","parsePortRangeToNumbers","_ref","name","formItemProps","_excluded","t","useTranslation","baiClient","useSuspendedBackendaiClient","form","Form","useFormInstance","Item","label","tooltip","Trans","i18nKey","extra","rules","validator","_rule","_config","maxCountForPreopenPorts","Promise","resolve","reject","Error","count","allPorts","port","children","Select","mode","tagRender","props","hasDuplicated","getFieldValue","closable","onClose","onMouseDown","e","preventDefault","stopPropagation","style","width","suffixIcon","open","tokenSeparators","node","v0","v1","v2","v3","v4","v5","v6","hash","useStartSession","_baiClient$supports","_baiClient$_config","currentProject","useCurrentProjectValue","upsertNotification","useSetBAINotification","relayEnv","useRelayEnvironment","supportsMountById","supports","supportBatchTimeout","currentGlobalResourceGroup","useCurrentResourceGroupState","defaultFormValues","sessionType","allocationPreset","hpcOptimization","autoEnabled","batch","enabled","command","scheduleDate","timeoutEnabled","timeout","timeoutUnit","envvars","default_session_environment","environments","normalizeEnvironmentFormat","RESOURCE_ALLOCATION_INITIAL_FORM_VALUES","resourceGroup","startSession","async","_values$owner","_values$owner2","_values$reuseIfExists","_values$owner3","_values$batch","_values$batch2","_values$batch3","_values$resource","_values$resource2","_values$resource3","_values$resource4","_values$resource5","_values$owner4","_values$resource6","_baiClient$_config2","imageFullName","manual","version","kernelName","architecture","sessionInfo","sessionName","generateSessionId","resources","enqueueOnly","group_name","owner","project","domain","domainName","type","cluster_mode","cluster_size","maxWaitSeconds","reuseIfExists","owner_access_key","accesskey","starts_at","startupCommand","bootstrap_script","batchTimeout","config","resource","cpu","mem","acceleratorType","accelerator","scaling_group","resource_opts","shmem","mount_ids","mount_id_map","environ","variable","preopen_ports","ports","hideAgents","agent","agent_list","castArray","filter","sessionPromises","num_of_sessions","i","formattedSessionName","concat","generateRandomString","createIfNotExists","then","res","catch","err","_err$message","message","includes","allSettled","sessionCreations","startSessionWithDefault","minimumValues","mergedValue","upsertSessionNotification","successCreations","upsertNotificationOverrides","promises","creation","session","fetchQuery","_useStartSessionCreationQuery","id","toGlobalId","sessionId","toPromise","queryResult","_queryResult$compute_","createdSession","compute_session_node","key","duration","text","possible","charAt","Math","floor","random","environment"],"ignoreList":[],"sourceRoot":""}