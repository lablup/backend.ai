"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[8819],{88819:(t,e,i)=>{i.r(e),i.d(e,{default:()=>B});var s=i(21173),a=i(16808),n=i(90840),r=i(75045),o=i(60081),l=i(32967),c=i(88578);const d=t=>{const e=(0,l.CX)();return(0,c.nj)({queryKey:["UsageHistory",e._config._userId,null===t||void 0===t?void 0:t.fetchKey],queryFn:()=>e.resources.user_stats()})};var u=i(33499),p=i(1869),y=i(94558),h=i(1426),x=i(42906);const g=t=>{let{iconProps:e,...i}=t;const{token:s}=p.A.useToken();return(0,x.jsx)(y.A,{...i,children:(0,x.jsx)(u.A,{style:{color:s.colorTextTertiary,cursor:"help"},...e})})};var j=i(91929),m=i(94281),k=i(89762),D=i.n(k),v=i(48602);const A=t=>{let{title:e,tooltipText:i,children:s}=t;return(0,x.jsx)(m.A,{type:"inner",title:(0,x.jsxs)(n.A,{gap:"xxs",children:[e,(0,x.jsx)(g,{title:i})]}),style:{width:"100%"},children:s})},U=t=>{let{data:e,key:i,period:s,targetUnit:a,displayUnit:n,unitType:o,isDarkMode:l}=t;const c=t=>{return"count"===o?t:"byte"===o?null!==(e=null===(i=(0,r.Is)(t.toString()+"B",a))||void 0===i?void 0:i.number)&&void 0!==e?e:0:"decimal"===o?null!==(s=null===(n=(0,r.CE)(t.toString()+"B",a))||void 0===n?void 0:n.number)&&void 0!==s?s:0:t;var e,i,s,n};return{data:e.filter(((t,i)=>e.length-("1D"===s?96:672)<=i)).map((t=>({date:D()(1e3*t.date).format("MMM DD HH:mm"),value:c(t[i].value)}))),xField:"date",yField:"value",axis:{x:{labelAutoHide:!0,tickFilter:(t,e)=>e%("1D"===s?12:48)===0},y:{title:n}},animate:{enter:{type:"growInY"}},theme:l?"dark":"light"}},T=t=>{let{period:e,fetchKey:i}=t;const{t:s}=(0,v.Bd)(),{data:a}=d({fetchKey:i}),{isDarkMode:r}=(0,o.e)();return(0,x.jsxs)(n.A,{direction:"column",align:"start",gap:"md",children:[(0,x.jsx)(A,{title:"Sessions",tooltipText:s("statistics.SessionsDesc"),children:(0,x.jsx)(j.A,{height:200,...U({data:a,key:"num_sessions",period:e,targetUnit:"count",displayUnit:"count",unitType:"count",isDarkMode:r})})}),(0,x.jsx)(A,{title:"CPU",tooltipText:s("statistics.CPUDesc"),children:(0,x.jsx)(j.A,{height:200,...U({data:a,key:"cpu_allocated",period:e,targetUnit:"count",displayUnit:"count",unitType:"count",isDarkMode:r})})}),(0,x.jsx)(A,{title:"Memory",tooltipText:s("statistics.MemoryDesc"),children:(0,x.jsx)(j.A,{height:200,...U({data:a,key:"mem_allocated",period:e,targetUnit:"G",displayUnit:"GiB",unitType:"byte",isDarkMode:r})})}),(0,x.jsx)(A,{title:"GPU",tooltipText:s("statistics.GPUDesc"),children:(0,x.jsx)(j.A,{height:200,...U({data:a,key:"gpu_allocated",period:e,targetUnit:"count",displayUnit:"count",unitType:"count",isDarkMode:r})})}),(0,x.jsx)(A,{title:"IO-Read",tooltipText:s("statistics.IOReadDesc"),children:(0,x.jsx)(j.A,{height:200,...U({data:a,key:"io_read_bytes",period:e,targetUnit:"M",displayUnit:"MiB",unitType:"decimal",isDarkMode:r})})}),(0,x.jsx)(A,{title:"IO-Write",tooltipText:s("statistics.IOWriteDesc"),children:(0,x.jsx)(j.A,{height:200,...U({data:a,key:"io_write_bytes",period:e,targetUnit:"M",displayUnit:"MiB",unitType:"decimal",isDarkMode:r})})})]})};var b=i(37565),M=i(59910),_=i(18695),f=i(47059),w=i(93409);const I=(0,w.withDefault)((0,w.createEnumParam)(["1D","1W"]),"1D"),B=()=>{const[t,e]=(0,w.useQueryParam)("period",I),{t:i}=(0,v.Bd)(),[r,o]=(0,l.Tw)("first"),[c,d]=(0,h.useTransition)();let u=[{label:i("statistics.1Day"),value:"1D"},{label:i("statistics.1Week"),value:"1W"}];return(0,x.jsx)(s.A,{activeTabKey:"usageHistory",title:i("statistics.UsageHistory"),children:(0,x.jsxs)(n.A,{direction:"column",align:"stretch",gap:"md",children:[(0,x.jsx)(b.A,{showIcon:!0,message:i("statistics.UsageHistoryNote"),type:"info"}),(0,x.jsxs)(n.A,{gap:"sm",justify:"between",children:[(0,x.jsx)(M.A.Item,{label:i("statistics.SelectPeriod"),style:{marginBottom:0},children:(0,x.jsx)(_.A,{popupMatchSelectWidth:!1,options:u,value:t,onChange:t=>e(t)})}),(0,x.jsx)(a.A,{loading:c,value:r,onChange:()=>{d((()=>{o()}))}})]}),(0,x.jsx)(h.Suspense,{fallback:(0,x.jsx)(f.A,{active:!0}),children:(0,x.jsx)(T,{period:t||"1D",fetchKey:r})})]})})}}}]);
//# sourceMappingURL=8819.f1ee76d7.chunk.js.map