"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1620,5863],{97759:(e,n,l)=>{l.d(n,{A:()=>t});var i=l(50128),o=l(43403),r=(l(53350),l(71217)),a=l(60598);const s=(0,o.rU)((e=>{let{css:n,token:l}=e;return{hover:n`
    text-decoration: none;
    /* color: ${l.colorLink}; */

    &:hover {
      /* color: ${l.colorLinkHover}; */
      text-decoration: underline;
    }
  `}})),t=e=>{let{type:n,to:l,...o}=e;const{styles:t}=s();return l?(0,a.jsx)(r.N_,{className:"hover"===n?t.hover:void 0,to:l,...o}):(0,a.jsx)(i.A.Link,{className:"hover"===n?t.hover:void 0,onClick:o.onClick,...o})}},91238:(e,n,l)=>{l.d(n,{A:()=>d});var i=l(72338),o=l(96141),r=l(24798),a=l(46976),s=l.n(a),t=l(53350),u=l(60598);const d=e=>{let n,{values:l=[],highlightKeyword:a}=e;return 0===l.length?null:(n=l[0]&&("string"===typeof l[0]||t.isValidElement(l[0]))?l.map((e=>({label:e,color:"blue"}))):l,(0,u.jsx)(i.A,{direction:"row",children:s().map(n,((e,l)=>s().isEmpty(e.label)?null:(0,u.jsx)(r.A,{style:s().last(n)===e?void 0:{margin:0,marginRight:-1},color:e.color,children:s().isUndefined(a)?e.label:(0,u.jsx)(o.A,{keyword:a,children:e.label})},l)))}))}},67999:(e,n,l)=>{l.d(n,{A:()=>v});var i=l(72375),o=l(85730),r=l(41810),a=l(88005),s=l(1581),t=l(50128),u=l(46976),d=l.n(u),c=l(53350),m=l(60598);const v=e=>{var n;let{dynamicSteps:l=[1,2,4,8,16,32,64,128,256,512],units:u=["m","g","t","p"],disableAutoUnit:v=!1,min:g="0m",max:p="300p",roundStep:h,...y}=e;const[f,x]=(0,o.A)(y,{defaultValue:"0g"}),[A,b]=null===f||void 0===f?[null,null]:(0,i.E8)(f),_=(0,r.A)(b),j=b||_||u[0],[k,S]=(0,i.E8)(g),[F,w]=(0,i.E8)(p),N=(0,c.useRef)(null);return(0,c.useEffect)((()=>{if(N.current){const e=e=>{var n;const l=null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value;/^\d+(g|m)$/.test(l)&&x(l)},n=N.current;return null===n||void 0===n||n.addEventListener("input",e),()=>{null===n||void 0===n||n.removeEventListener("input",e)}}}),[N,A,b,x]),(0,m.jsx)(a.A,{ref:N,...y,onBlur:()=>{if(d().isNumber(h)&&h>0){var e,n,l;const i=(null===(e=h.toString().split(".")[1])||void 0===e?void 0:e.length)||0;if(isNaN(Math.round(d().toNumber((null===(n=N.current)||void 0===n?void 0:n.value)||"0")/h)*h))return;x(`${(Math.round(d().toNumber((null===(l=N.current)||void 0===l?void 0:l.value)||"0")/h)*h).toFixed(i)}${j}`)}},value:A,onChange:e=>{x(null===e||void 0===e?e:`${e}${j}`)},max:w===j?F:null===(n=(0,i.Is)(p,j))||void 0===n?void 0:n.number,min:S===j?k:(0,i.Is)(g,j).number,addonAfter:(0,m.jsx)(s.A,{tabIndex:-1,value:j,onChange:e=>{x(`${A}${e}`)},onDropdownVisibleChange:e=>{(e&&null===f||void 0===f)&&x(`0${j}`)},options:d().map(u,(e=>({value:e,label:(0,m.jsx)(t.A.Text,{style:{fontFamily:"'SFMono-Regular',Consolas,'Liberation Mono',Menlo,Courier,monospace"},children:e.toUpperCase()+"iB"})}))),suffixIcon:u.length>1?void 0:null,open:u.length>1&&void 0,style:{cursor:u.length>1?void 0:"default"}}),step:0,onStep:(e,n)=>{const i=d().isNull(A)||d().isUndefined(A)?0:A,o=d().sortedIndex(d().sortBy(l),i);let r;r="up"===n.type?i===l[o]?o+1:o:o-1;const a=u.indexOf(j);if(!v&&r<0)if(0===a)x(`0${j}`);else{const e=l[l.length-1],n=u[a-1];x(`${e}${n}`)}else if(!v&&r>l.length-1)if(a===u.length-1)x(`${i+("up"===n.type?1:-1)}${w}`);else{const e=l[0],n=u[a+1];x(`${e}${n}`)}else if(r>=0&&r<l.length){let e=l[r];S===j&&e<k?e=k:w===j&&e>F&&(e=F),x(`${e}${j}`)}}})}},4101:(e,n,l)=>{l.d(n,{Ay:()=>h,z7:()=>p});var i=l(72338),o=l(67483),r=l(53051),a=l(13170),s=l(83978),t=l(52335),u=l(46976),d=l.n(u),c=l(53350),m=l(91788),v=l(60598);const g=[/AUTH/i,/ACCESS/i,/SECRET/i,/_KEY/i,/PASSWORD/i,/PASSWD/i,/PWD/i,/TOKEN/i,/PRIVATE/i,/CREDENTIAL/i,/JWT/i,/KEYPAIR/i,/CERTIFICATE/i,/SSH/i,/ENCRYPT/i,/SIGNATURE/i,/SALT/i,/PIN/i,/PASSPHRASE/i,/OAUTH/i];function p(e){return d().map(e,(e=>{return e&&(n=e.variable,g.some((e=>e.test(n))))?{...e,value:""}:e;var n}))}const h=e=>{let{formItemProps:n,...l}=e;const u=(0,c.useRef)(null),{t:g}=(0,m.Bd)(),p=a.A.useFormInstance();return(0,v.jsx)(a.A.List,{...l,children:(e,c)=>{let{add:m,remove:h}=c;return(0,v.jsxs)(i.A,{direction:"column",gap:"xs",align:"stretch",children:[e.map(((r,t)=>{let{key:c,name:m,...y}=r;return(0,v.jsxs)(i.A,{direction:"row",align:"baseline",gap:"xs",children:[(0,v.jsx)(a.A.Item,{...y,style:{marginBottom:0,flex:1},name:[m,"variable"],rules:[{required:!0,message:g("session.launcher.EnterEnvironmentVariable")},{pattern:/^[a-zA-Z_][a-zA-Z0-9_]*$/,message:g("session.launcher.EnvironmentVariableNamePatternError")},e=>{let{getFieldValue:n}=e;return{validator(e,i){const o=d().map(n(l.name),(e=>null===e||void 0===e?void 0:e.variable));return!d().isEmpty(i)&&o.length>0&&d().filter(o,(e=>e===i)).length>1?Promise.reject(g("session.launcher.EnvironmentVariableDuplicateName")):Promise.resolve()}}}],...n,children:(0,v.jsx)(s.A,{ref:t===e.length-1?u:null,placeholder:"Variable",onChange:()=>{const n=e.map(((e,n)=>[l.name,n,"variable"]));p.validateFields(n)}})}),(0,v.jsx)(a.A.Item,{...y,name:[m,"value"],style:{marginBottom:0,flex:1},rules:[{required:!0,message:g("session.launcher.EnvironmentVariableValueRequired")}],validateTrigger:["onChange","onBlur"],children:(0,v.jsx)(s.A,{placeholder:"Value"})}),(0,v.jsx)(o.A,{onClick:()=>h(m)})]},c)})),(0,v.jsx)(a.A.Item,{noStyle:!0,children:(0,v.jsx)(t.Ay,{type:"dashed",onClick:()=>{m(),setTimeout((()=>{u.current&&u.current.focus()}),0)},icon:(0,v.jsx)(r.A,{}),block:!0,children:g("session.launcher.AddEnvironmentVariable")})})]})}})}},75863:(e,n,l)=>{l.r(n),l.d(n,{default:()=>t,useFolderExplorerOpener:()=>u});var i=l(53350),o=l(50423),r=l(32043),a=l(60598);const s=i.lazy((()=>Promise.all([l.e(6769),l.e(7699)]).then(l.bind(l,67699)))),t=()=>{const[e,n]=(0,r.useQueryParam)("folder",r.StringParam),l=null===e||void 0===e?void 0:e.replaceAll("-","");return(0,a.jsx)(s,{vfolderID:l||"",open:!!l,onRequestClose:()=>{n(null,"replaceIn")},destroyOnClose:!0})},u=()=>{const[,e]=(0,r.useQueryParam)("folder",r.StringParam),n=(0,o.zy)();return{open:n=>{e(n)},generateFolderPath:e=>{const l=new URLSearchParams(n.search);return l.set("folder",e),{pathname:n.pathname,search:l.toString()}}}}},60828:(e,n,l)=>{l.d(n,{A:()=>S});var i=l(72375),o=l(23441),r=l(23524),a=l(91238),s=l(72338);var t,u=l(90184),d=l(32715),c=l(96141),m=l(13170),v=l(9571),g=l(50128),p=l(1581),h=l(24798),y=l(40056),f=l(83978),x=l(46976),A=l.n(x),b=l(53350),_=l(91788),j=l(22018),k=l(60598);const S=e=>{var n;let{filter:x,showPrivate:S}=e;const F=m.A.useFormInstance(),w=m.A.useWatch("environments",{form:F,preserve:!0}),N=(0,o.CX)(),P=null===N||void 0===N?void 0:N.supports("extended-image-info"),[I,V]=(0,b.useState)(""),[C,K]=(0,b.useState)(""),{t:E}=(0,_.Bd)(),[T,{getBaseVersion:M,getImageMeta:R,tagAlias:L}]=(0,o.Gj)(),{token:q}=v.A.useToken(),{isDarkMode:$}=(0,r.e)(),z=(0,b.useRef)(null),B=(0,b.useRef)(null),O=null!==N&&void 0!==N&&null!==(n=N._config)&&void 0!==n&&n.showNonInstalledImages?{}:{installed:!0},{images:D}=(0,j.useLazyLoadQuery)(void 0!==t?t:t=l(3796),O,{fetchPolicy:"store-and-network"});(0,b.useEffect)((()=>{var e,n,l;if(!A().isEmpty(null===w||void 0===w?void 0:w.manual))return void((w.environment||w.version)&&F.setFieldsValue({environments:{environment:void 0,version:void 0,image:void 0}}));let o,r,a,s,t=null===(e=F.getFieldValue("environments"))||void 0===e?void 0:e.version;var u,d;(t&&t.indexOf("@")<0&&(t+="@x86_64"),t&&A().find(U,(e=>(o=A().find(e.environmentGroups,(e=>(r=A().find(e.images,(e=>(0,i.A_)(e)===t)),!!r))),!!o))),o?(a=o,s=r):F.getFieldValue(["environments","environment"])&&A().find(U,(e=>{var n;return a=A().find(e.environmentGroups,(e=>e.environmentName===F.getFieldValue(["environments","environment"]))),s=null===(n=a)||void 0===n?void 0:n.images[0],!!a})),a&&s)||(a=null===(u=U[0])||void 0===u?void 0:u.environmentGroups[0],s=null===(d=a)||void 0===d?void 0:d.images[0]);const c=null===(n=A().find(null===(l=s)||void 0===l?void 0:l.labels,(e=>null!==e&&"ai.backend.customized-image.name"===(null===e||void 0===e?void 0:e.key))))||void 0===n?void 0:n.value;s?!o&&N._config.allow_manual_image_name_for_session&&t?F.setFieldsValue({environments:{environment:void 0,version:void 0,image:void 0,manual:t,customizedTag:null!==c&&void 0!==c?c:void 0}}):F.setFieldsValue({environments:{environment:a.environmentName,version:(0,i.A_)(s),image:s,customizedTag:null!==c&&void 0!==c?c:void 0}}):N._config.allow_manual_image_name_for_session&&F.setFieldValue(["environments","manual"],t)}),[null===w||void 0===w?void 0:w.version,null===w||void 0===w?void 0:w.manual]);const U=(0,b.useMemo)((()=>A().chain(D).filter((e=>(!!S||!(e=>A().some(null===e||void 0===e?void 0:e.labels,(e=>{var n;return"ai.backend.features"===(null===e||void 0===e?void 0:e.key)&&(null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.split(" ").includes("private"))})))(e))&&(!x||x(e)))).groupBy((e=>{var n;return(null===T||void 0===T||null===(n=T.imageInfo[R((0,i.A_)(e)||"").key])||void 0===n?void 0:n.group)||"Custom Environments"})).map(((e,n)=>({groupName:n,environmentGroups:A().chain(e).groupBy((e=>`${null===e||void 0===e?void 0:e.registry}/${P?null===e||void 0===e?void 0:e.namespace:null===e||void 0===e?void 0:e.name}`)).map(((e,n)=>{var l,o;const r=null===(l=n.split("/"))||void 0===l?void 0:l[2];return{environmentName:n,displayName:r&&(null===T||void 0===T||null===(o=T.imageInfo[r])||void 0===o?void 0:o.name)||A().last(n.split("/")),prefix:A().chain(n).split("/").drop(1).dropRight(1).join("/").value(),images:e.sort(((e,n)=>{var l,o,r,a,s,t;return function(e,n){const l=e.split(".").map(Number),i=n.split(".").map(Number);for(let o=0;o<Math.max(l.length,i.length);o++){const e=l[o]||0,n=i[o]||0;if(e>n)return 1;if(e<n)return-1}return 0}(null!==(l=null===n||void 0===n||null===(o=n.tag)||void 0===o||null===(r=o.split("-"))||void 0===r?void 0:r[0])&&void 0!==l?l:"",null!==(a=null===e||void 0===e||null===(s=e.tag)||void 0===s||null===(t=s.split("-"))||void 0===t?void 0:t[0])&&void 0!==a?a:"")||(0,i._f)(null===e||void 0===e?void 0:e.architecture,null===n||void 0===n?void 0:n.architecture)}))}})).sortBy((e=>e.displayName)).value()}))).sortBy((e=>e.groupName)).value()),[D,T,x,S]),{fullNameMatchedImage:Q}=(0,b.useMemo)((()=>{let e,n;return I.length&&A().chain(U.flatMap((e=>e.environmentGroups)).find((l=>(n=l,e=A().find(l.images,(e=>(0,i.A_)(e)===I)),!!e)))).value(),{fullNameMatchedImage:e,fullNameMatchedImageGroup:n}}),[I,U]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("style",{children:"/* Change the image and tags of the select option when the selection is opened  */\ndiv.image-environment-select-form-item\n  div.ant-select-open\n  span.ant-select-selection-item\n  div\n  img,\ndiv.image-environment-select-form-item\n  div.ant-select-open\n  span.ant-select-selection-item\n  div\n  span.ant-tag {\n  opacity: 0.5;\n}\n\ndiv.image-environment-select-form-item\n  div.ant-select-item-option-content\n  div.tag-wrap-light {\n  /* flex: 1 !important; */\n  flex-wrap: wrap !important;\n}\n\ndiv.image-environment-select-form-item\n  div.ant-select-item-option-content\n  div.tag-wrap-dark {\n  /* flex: 1 !important; */\n  flex-wrap: wrap !important;\n}\n\ndiv.image-environment-select-form-item\n  span.ant-select-selection-item\n  div.tag-wrap-light {\n  overflow: hidden;\n}\n\ndiv.image-environment-select-form-item\n  span.ant-select-selection-item\n  div.tag-wrap-dark {\n  overflow: hidden;\n}\n\ndiv.image-environment-select-form-item\n  span.ant-select-selection-item\n  div.tag-wrap-light::after {\n  content: '';\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 10px; /* Width of the transparent gradient area */\n  background: linear-gradient(\n    to right,\n    rgba(255, 255, 255, 0),\n    rgba(255, 255, 255, 1)\n  );\n}\n\ndiv.image-environment-select-form-item\n  span.ant-select-selection-item\n  div.tag-wrap-dark::after {\n  content: '';\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 10px;\n  background: linear-gradient(\n    to right,\n    rgba(20, 20, 20, 0),\n    rgba(20, 20, 20, 1)\n  );\n}\n"}),(0,k.jsx)(m.A.Item,{className:"image-environment-select-form-item",name:["environments","environment"],label:(0,k.jsxs)(g.A.Text,{copyable:{text:(0,i.A_)(F.getFieldValue(["environments","image"]))},children:[E("session.launcher.Environments")," /"," ",E("session.launcher.Version")]}),rules:[{required:A().isEmpty(null===w||void 0===w?void 0:w.manual)}],style:{marginBottom:10},children:(0,k.jsx)(p.A,{ref:z,showSearch:!0,searchValue:I,onSearch:V,defaultActiveFirstOption:!0,optionFilterProp:"filterValue",onChange:e=>{if(Q)F.setFieldsValue({environments:{environment:(P?null===Q||void 0===Q?void 0:Q.namespace:null===Q||void 0===Q?void 0:Q.name)||"",version:(0,i.A_)(Q),image:Q}});else{const n=U.flatMap((e=>e.environmentGroups)).filter((n=>n.environmentName===e))[0].images[0];F.setFieldsValue({environments:{environment:(P?null===n||void 0===n?void 0:n.namespace:null===n||void 0===n?void 0:n.name)||"",version:(0,i.A_)(n),image:n}})}},disabled:N._config.allow_manual_image_name_for_session&&!A().isEmpty(null===w||void 0===w?void 0:w.manual),children:Q?(0,k.jsx)(p.A.Option,{value:P?null===Q||void 0===Q?void 0:Q.namespace:null===Q||void 0===Q?void 0:Q.name,filterValue:(0,i.A_)(Q),children:(0,k.jsxs)(s.A,{direction:"row",align:"center",gap:"xs",style:{display:"inline-flex"},children:[(0,k.jsx)(u.A,{image:(0,i.A_)(Q)||"",style:{width:15,height:15}}),(0,i.A_)(Q)]})}):A().map(U,(e=>(0,k.jsx)(p.A.OptGroup,{label:e.groupName,children:A().map(e.environmentGroups,(e=>{var n;const l=e.images[0],o=null===T||void 0===T?void 0:T.imageInfo[null===(n=e.environmentName.split("/"))||void 0===n?void 0:n[2]],r=[];let a=null;e.prefix&&!["lablup","cloud","stable"].includes(e.prefix)&&(r.push(e.prefix),a=(0,k.jsx)(h.A,{color:"purple",children:(0,k.jsx)(c.A,{keyword:I,children:e.prefix})}));const t=A().map(null===o||void 0===o?void 0:o.label,(e=>A().isUndefined(e.category)&&e.tag&&e.color?(r.push(e.tag),(0,k.jsx)(h.A,{color:e.color,children:(0,k.jsx)(c.A,{keyword:I,children:e.tag},e.tag)},e.tag)):null));return(0,k.jsx)(p.A.Option,{value:e.environmentName,filterValue:e.displayName+"\t"+r.join("\t"),children:(0,k.jsxs)(s.A,{direction:"row",justify:"between",children:[(0,k.jsxs)(s.A,{direction:"row",align:"center",gap:"xs",children:[(0,k.jsx)(u.A,{image:(0,i.A_)(l)||"",style:{width:15,height:15}}),(0,k.jsx)(c.A,{keyword:I,children:e.displayName})]}),(0,k.jsxs)(s.A,{direction:"row",className:$?"tag-wrap-dark":"tag-wrap-light",style:{marginLeft:q.marginXS,flexShrink:1},children:[a,t]})]})},e.environmentName)}))},e.groupName)))})}),(0,k.jsx)(m.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>{var l,i;return(null===(l=e.environments)||void 0===l?void 0:l.environment)!==(null===(i=n.environments)||void 0===i?void 0:i.environment)},children:e=>{var n;let l,{getFieldValue:o}=e;return A().find(U,(e=>A().find(e.environmentGroups,(e=>{var n;return e.environmentName===(null===(n=o("environments"))||void 0===n?void 0:n.environment)&&(l=e,!0)})))),(0,k.jsx)(m.A.Item,{className:"image-environment-select-form-item",name:["environments","version"],rules:[{required:A().isEmpty(null===w||void 0===w?void 0:w.manual)}],children:(0,k.jsx)(p.A,{ref:B,onChange:e=>{const n=A().find(D,(n=>(0,i.A_)(n)===e));F.setFieldValue(["environments","image"],n)},showSearch:!0,searchValue:C,onSearch:K,optionFilterProp:"filterValue",dropdownRender:e=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(s.A,{style:{fontWeight:q.fontWeightStrong,paddingLeft:q.paddingSM},children:[E("session.launcher.Version"),(0,k.jsx)(y.A,{type:"vertical"}),E("session.launcher.Architecture"),(0,k.jsx)(y.A,{type:"vertical"}),E("session.launcher.Tags")]}),(0,k.jsx)(y.A,{style:{margin:"8px 0"}}),e]}),disabled:N._config.allow_manual_image_name_for_session&&!A().isEmpty(null===w||void 0===w?void 0:w.manual),children:A().map(A().uniqBy(null===(n=l)||void 0===n?void 0:n.images,"id"),(e=>{var n;const[l,o,...r]=(null===e||void 0===e||null===(n=e.tag)||void 0===n?void 0:n.split("-"))||["","",""];let t=null===T||void 0===T?void 0:T.tagAlias[o];if(!t){for(const[e,n]of Object.entries((null===T||void 0===T?void 0:T.tagReplace)||{})){const l=new RegExp(e);l.test(o)&&(t=null===o||void 0===o?void 0:o.replace(l,n))}t||(t=o)}const u=[],m=A().chain(r).filter((e=>!e.startsWith("customized_"))).map(((e,n)=>(0,k.jsx)(a.A,{values:A().split((null===T||void 0===T?void 0:T.tagAlias[e])||e,":").map((e=>(u.push(e),{label:e,highlightKeyword:C})))},n))).value(),v=null===e||void 0===e?void 0:e.labels;if(v){const e=A().findIndex(v,(e=>null!==e&&"ai.backend.customized-image.name"===(null===e||void 0===e?void 0:e.key)));if(e&&v[e]){var g;const n=(null===(g=v[e])||void 0===g?void 0:g.value)||"";u.push("Customized"),u.push(n),m.push((0,k.jsx)(a.A,{highlightKeyword:C,values:[{label:"Customized",color:"cyan"},{label:null!==n&&void 0!==n?n:"",color:"cyan"}]},m.length+1))}}return(0,k.jsx)(p.A.Option,{value:(0,i.A_)(e),filterValue:[l,t,null===e||void 0===e?void 0:e.architecture,...u].join("\t"),children:P?(0,k.jsxs)(s.A,{direction:"row",children:[(0,k.jsx)(c.A,{keyword:C,children:null===e||void 0===e?void 0:e.version}),(0,k.jsx)(y.A,{type:"vertical"}),(0,k.jsx)(c.A,{keyword:C,children:null===e||void 0===e?void 0:e.architecture}),(0,k.jsx)(y.A,{type:"vertical"}),(0,k.jsx)(s.A,{direction:"row",align:"start",children:A().map(null===e||void 0===e?void 0:e.tags,(n=>{var l;const o=A().includes(n.key,"customized_"),r=o?null===(l=A().find(null===e||void 0===e?void 0:e.labels,{key:"ai.backend.customized-image.name"}))||void 0===l?void 0:l.value:n.value,s=L(n.key+r);return A().isEqual(s,(0,i.WY)(n.key+r))?(0,k.jsx)(a.A,{highlightKeyword:C,values:[{label:L(n.key),color:o?"cyan":"blue"},{label:null!==r&&void 0!==r?r:"",color:o?"cyan":"blue"}]},n.key):(0,k.jsx)(h.A,{color:o?"cyan":"blue",children:(0,k.jsx)(c.A,{keyword:C,children:s})},n.key)}))})]}):(0,k.jsx)(s.A,{direction:"row",justify:"between",children:(0,k.jsxs)(s.A,{direction:"row",children:[(0,k.jsx)(c.A,{keyword:C,children:M((0,i.A_)(e)||"")}),(0,k.jsx)(y.A,{type:"vertical"}),(0,k.jsx)(c.A,{keyword:C,children:null===e||void 0===e?void 0:e.architecture}),(0,k.jsx)(y.A,{type:"vertical"}),(0,k.jsx)(d.Jj,{tag:(null===e||void 0===e?void 0:e.tag)||"",highlightKeyword:C,labels:null===e||void 0===e?void 0:e.labels})]})})},null===e||void 0===e?void 0:e.id)}))})})}}),(0,k.jsx)(m.A.Item,{label:E("session.launcher.ManualImageName"),name:["environments","manual"],style:{display:N._config.allow_manual_image_name_for_session?"block":"none"},children:(0,k.jsx)(f.A,{allowClear:!0,onChange:e=>{A().isEmpty(e)||F.setFieldsValue({environments:{environment:void 0,version:void 0,image:void 0}})}})}),(0,k.jsx)(m.A.Item,{noStyle:!0,hidden:!0,name:["environments","image"],children:(0,k.jsx)(f.A,{})})]})}},90184:(e,n,l)=>{l.d(n,{A:()=>s});var i=l(23441),o=l(53350),r=l(60598);const a=e=>{let{image:n,style:l={},alt:o=""}=e;const[,{getImageIcon:a}]=(0,i.Gj)();return(0,r.jsx)("img",{src:a(n),style:{width:"1em",height:"1em",...l},alt:o})},s=o.memo(a)},32715:(e,n,l)=>{l.d(n,{Ay:()=>h,Jj:()=>y});var i=l(72375),o=l(23441),r=l(91238),a=(l(72338),l(96141)),s=l(24798),t=l(46976),u=l.n(t),d=l(53350),c=l(60598);const m=e=>{let{image:n,...l}=e;n=n||"";const[,{getImageAliasName:i,getBaseVersion:a,tagAlias:s}]=(0,o.Gj)();return(0,c.jsx)(r.A,{values:[{label:s(i(n)),color:"blue"},{label:a(n),color:"green"}],...l})},v=e=>{let{image:n,...l}=e;n=n||"";const[,{getBaseImage:i,tagAlias:r}]=(0,o.Gj)();return u().isEmpty(r(i(n)))?null:(0,c.jsx)(s.A,{color:"green",...l,children:r(i(n))})},g=e=>{let{image:n,...l}=e;n=n||"";const[,{getArchitecture:i,tagAlias:r}]=(0,o.Gj)();return u().isEmpty(r(i(n)))?null:(0,c.jsx)(s.A,{color:"green",...l,children:i(n)})},p=e=>{let{image:n}=e;return n=n||"",(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(m,{image:n}),(0,c.jsx)(v,{image:n}),(0,c.jsx)(g,{image:n})]})},h=d.memo(p),y=e=>{let{tag:n,labels:l,highlightKeyword:t,...d}=e;l=l||[];const[,{getTags:m,tagAlias:v}]=(0,o.Gj)(),g=m(n,l);return(0,c.jsx)(c.Fragment,{children:u().map(g,((e,n)=>{const l="Customized"===e.key,o=v(e.key+e.value);return u().isEqual(o,(0,i.WY)(e.key+e.value))?(0,c.jsx)(r.A,{highlightKeyword:t,values:[{label:v(e.key),color:l?"cyan":"blue"},{label:e.value,color:l?"cyan":"blue"}]},e.key):(0,c.jsx)(s.A,{color:l?"cyan":"blue",children:(0,c.jsx)(a.A,{keyword:t,children:o},n)},e.key)}))})}},63515:(e,n,l)=>{l.d(n,{A:()=>m});var i=l(23441),o=l(85730),r=l(72338),a=l(88005),s=l(11255),t=l(46976),u=l.n(t),d=l(53350),c=l(60598);const m=e=>{let{min:n,max:l,step:t,disabled:m,inputNumberProps:v,sliderProps:g,allowNegative:p,...h}=e;const[y,f]=(0,o.A)(h),x=d.useRef(null);(0,d.useEffect)((()=>{p||1===t&&y%1!==0&&f(u().max([Math.round(y),n]))}),[t]);const[A,b]=(0,i.Tw)("first");return(0,d.useEffect)((()=>{p||setTimeout((()=>{b(y)}),0)}),[]),(0,c.jsxs)(r.A,{direction:"row",gap:"md",children:[(0,c.jsx)(r.A,{style:{flex:2,minWidth:190},align:"stretch",direction:"column",children:(0,c.jsx)(a.A,{ref:x,max:l,min:n,step:null!==t&&void 0!==t?t:void 0,disabled:m,value:y,onChange:f,onBlur:()=>{if(u().isNumber(t)&&t>0){var e,i,o;if(u().isNumber(l)&&l<u().toNumber((null===(e=x.current)||void 0===e?void 0:e.value)||"0"))return;const r=(null===(i=t.toString().split(".")[1])||void 0===i?void 0:i.length)||0;f(u().max([u().toNumber((Math.round(u().toNumber((null===(o=x.current)||void 0===o?void 0:o.value)||"0")/t)*t).toFixed(r)),n]))}},...v},A)}),(0,c.jsx)(r.A,{direction:"column",align:"stretch",style:{flex:3},children:(0,c.jsx)(s.A,{max:l,min:n,step:t,disabled:m,value:y,onChange:e=>{void 0!==n&&e<n||f(e)},...g,marks:u().omitBy(null===g||void 0===g?void 0:g.marks,((e,n)=>!!u().isNumber(l)&&u().parseInt(n)>l))})})]})}},7208:(e,n,l)=>{l.d(n,{t2:()=>X,jh:()=>J,Ay:()=>ne});var i=l(72375),o=l(23441),r=l(7971),a=l(6742),s=l(81530),t=l(68098),u=l(73e3),d=l(46976),c=l.n(d),m=l(53350);const v=/^max([A-Za-z0-9]+)PerContainer$/,g=e=>{var n,l,a,t,d,g,h,y,f,x,A,b,_,j,k,S,F,w,N,P,I;let{currentImage:V,currentResourceGroup:C="",currentProjectName:K,ignorePerContainerConfig:E=!1}=e;const T=(0,o.CX)(),[M]=(0,r.bL)(),R=c().omit(M,["cpu","mem","shmem"]),{resourceGroups:L}=(0,s.Bk)(),{data:q,refetch:$,isRefetching:z}=(0,u.nj)({queryKey:["check-presets",K,C],queryFn:()=>C&&c().some(L,(e=>e.name===C))?T.resourcePreset.check({group:K,scaling_group:C}).catch((()=>{})):null,staleTime:1e3}),B=(null===(n=c().find(null===V||void 0===V?void 0:V.resource_limits,(e=>"mem"===(null===e||void 0===e?void 0:e.key))))||void 0===n?void 0:n.min)||"0g",O={cpu:c().isEmpty(null===q||void 0===q||null===(l=q.scaling_groups[C])||void 0===l||null===(a=l.using)||void 0===a?void 0:a.cpu)||c().isEmpty(null===q||void 0===q||null===(t=q.scaling_groups[C])||void 0===t||null===(d=t.remaining)||void 0===d?void 0:d.cpu)?void 0:c().toNumber(null===q||void 0===q||null===(g=q.scaling_groups[C])||void 0===g?void 0:g.using.cpu)+c().toNumber(null===q||void 0===q||null===(h=q.scaling_groups[C])||void 0===h?void 0:h.remaining.cpu),mem:c().isEmpty(null===q||void 0===q||null===(y=q.scaling_groups[C])||void 0===y||null===(f=y.using)||void 0===f?void 0:f.mem)||c().isEmpty(null===q||void 0===q||null===(x=q.scaling_groups[C])||void 0===x||null===(A=x.remaining)||void 0===A?void 0:A.mem)?void 0:(null===(b=(0,i.Is)(c().toNumber(null===q||void 0===q||null===(_=q.scaling_groups[C])||void 0===_?void 0:_.using.mem)+c().toNumber(null===q||void 0===q||null===(j=q.scaling_groups[C])||void 0===j?void 0:j.remaining.mem)+"b","g",2))||void 0===b?void 0:b.numberFixed)+"g",accelerators:c().reduce(R,((e,n,l)=>{var i,o,r,a,s,t;return e[l]=c().isEmpty(null===q||void 0===q||null===(i=q.scaling_groups[C])||void 0===i||null===(o=i.using)||void 0===o?void 0:o[l])||c().isEmpty(null===q||void 0===q||null===(r=q.scaling_groups[C])||void 0===r||null===(a=r.remaining)||void 0===a?void 0:a[l])?void 0:c().toNumber(null===q||void 0===q||null===(s=q.scaling_groups[C])||void 0===s?void 0:s.using[l])+c().toNumber(null===q||void 0===q||null===(t=q.scaling_groups[C])||void 0===t?void 0:t.remaining[l]),e}),{})},D=(0,m.useMemo)((()=>c().omitBy(T._config,((e,n)=>!v.test(n)))),[T._config]);return[{resourceGroupResourceSize:O,resourceLimits:{cpu:void 0===(null===M||void 0===M?void 0:M.cpu)?void 0:{min:c().max([c().toNumber((null===(k=c().find(null===V||void 0===V?void 0:V.resource_limits,(e=>"cpu"===(null===e||void 0===e?void 0:e.key))))||void 0===k?void 0:k.min)||"0")]),max:c().min([E?void 0:T._config.maxCPUCoresPerContainer,p(null===q||void 0===q?void 0:q.keypair_limits.cpu),p(null===q||void 0===q?void 0:q.group_limits.cpu)])},mem:void 0===(null===M||void 0===M?void 0:M.mem)?void 0:{min:(0,i.sL)(c().max([null===(S=(0,i.Is)(B,"b"))||void 0===S?void 0:S.number,null===(F=(0,i.Is)(X,"b"))||void 0===F?void 0:F.number,0])+"b",X),max:c().min([E?void 0:T._config.maxMemoryPerContainer,p(null===q||void 0===q?void 0:q.keypair_limits.mem)&&(null===(w=(0,i.Is)(p(null===q||void 0===q?void 0:q.keypair_limits.mem)+"","g"))||void 0===w?void 0:w.number),p(null===q||void 0===q?void 0:q.group_limits.mem)&&(null===(N=(0,i.Is)(p(null===q||void 0===q?void 0:q.group_limits.mem)+"","g"))||void 0===N?void 0:N.number)])+"g"},accelerators:c().reduce(R,((e,n,l)=>{var i,o,r;const a=null!==(i=c().find(D,((e,n)=>((e,n)=>{const l=e.match(v);if(l){const e=l[1].toLowerCase(),i=n.replaceAll(/[.-]/g,"").toLowerCase();return e===i||e===i+"s"}return!1})(n,l))))&&void 0!==i?i:T._config["cuda.device"];return e[l]={min:parseInt((null===(o=c().filter(null===V||void 0===V?void 0:V.resource_limits,(e=>(null===e||void 0===e?void 0:e.key)===l)))||void 0===o||null===(r=o[0])||void 0===r?void 0:r.min)||"0"),max:c().min([a||8,p(null===q||void 0===q?void 0:q.keypair_limits[l]),p(null===q||void 0===q?void 0:q.group_limits[l])])},e}),{})},remaining:{accelerators:c().reduce(R,((e,n,l)=>{var i;return e[l]=null!==(i=c().min([c().toNumber(null===q||void 0===q?void 0:q.keypair_remaining[l]),c().toNumber(null===q||void 0===q?void 0:q.group_remaining[l]),c().toNumber(null===q||void 0===q?void 0:q.scaling_group_remaining[l])]))&&void 0!==i?i:Number.MAX_SAFE_INTEGER,e}),{}),cpu:null!==(P=c().min([p(null===q||void 0===q?void 0:q.keypair_remaining.cpu),p(null===q||void 0===q?void 0:q.group_remaining.cpu),p(null===q||void 0===q?void 0:q.scaling_group_remaining.cpu)]))&&void 0!==P?P:Number.MAX_SAFE_INTEGER,mem:null!==(I=c().min([p(null===q||void 0===q?void 0:q.keypair_remaining.mem),p(null===q||void 0===q?void 0:q.group_remaining.mem),p(null===q||void 0===q?void 0:q.scaling_group_remaining.mem)]))&&void 0!==I?I:Number.MAX_SAFE_INTEGER},currentImageMinM:B,isRefetching:z,checkPresetInfo:q},{refetch:$}]},p=e=>void 0===e||"Infinity"===e||"NaN"===e?void 0:c().toNumber(e);var h,y=l(54690),f=l(72338),x=l(42388),A=l(51847),b=l(1581),_=l(91788),j=l(22018),k=l(60598);const S=e=>{let{fetchKey:n,resourceGroup:i,...o}=e;const{t:r}=(0,_.Bd)(),[a,s]=(0,A.A)(o),{baiPaginationOption:t}=(0,y.w4)({current:1,pageSize:20}),{agent_summary_list:u}=(0,j.useLazyLoadQuery)(void 0!==h?h:h=l(38059),{limit:t.limit,offset:t.offset,status:"ALIVE",filter:"schedulable is true",scaling_group:i},{fetchPolicy:"network-only",fetchKey:n}),d=c().map(null===u||void 0===u?void 0:u.items,(e=>{var n,l;const i=JSON.parse(null!==(n=null===e||void 0===e?void 0:e.available_slots)&&void 0!==n?n:"{}"),o=JSON.parse(null!==(l=null===e||void 0===e?void 0:e.occupied_slots)&&void 0!==l?l:"{}"),r=c().chain(i).mapValues(((e,n)=>{var l,i;return n.endsWith(".shares")?parseFloat(e)-parseFloat(null!==(l=o[n])&&void 0!==l?l:0):parseInt(e)-parseInt(null!==(i=o[n])&&void 0!==i?i:0)})).value();return{label:(0,k.jsxs)(f.A,{direction:"row",justify:"between",children:[null===e||void 0===e?void 0:e.id,(0,k.jsx)(f.A,{direction:"row",gap:"xxs",children:c().map(r,((e,n)=>(0,k.jsx)(x.A,{type:n,value:e.toString(),hideTooltip:!0},n)))})]}),value:null===e||void 0===e?void 0:e.id}}));return(0,k.jsx)(b.A,{onChange:(e,n)=>{s(e,n)},...o,value:a,options:[{label:r("session.launcher.AutoSelect"),value:"auto"},...d]})};var F=l(22407),w=l(85730),N=l(67999),P=l(9571),I=l(11255);const V=e=>{let{min:n="0m",max:l="32g",warn:r,units:a=["m","g"],extraMarks:s,hideSlider:t,step:u=.05,...d}=e;const[v,g]=(0,w.A)(d,{defaultValue:"0g"}),{token:p}=P.A.useToken(),h=(0,m.useMemo)((()=>(0,i.Is)(n,"g",2)),[n]),y=(0,m.useMemo)((()=>(0,i.Is)(l,"g",2)),[l]),x=(0,m.useMemo)((()=>(0,i.Is)(v||"0g","g",2)),[v]),[A,b]=(0,o.Tw)("first");(0,m.useEffect)((()=>{setTimeout((()=>{b(null===v||void 0===v?void 0:v.toString())}),0)}),[]);const _=c().isNumber(null===h||void 0===h?void 0:h.number)&&c().isNumber(null===y||void 0===y?void 0:y.number)&&(null===h||void 0===h?void 0:h.number)>(null===y||void 0===y?void 0:y.number);return(0,k.jsxs)(f.A,{direction:"row",gap:"md",children:[(0,k.jsx)(f.A,{style:{flex:2,minWidth:190},direction:"column",align:"stretch",children:(0,m.createElement)(N.A,{...d,key:A,min:n,max:l,units:a,value:v,onChange:e=>{g(e)},style:{minWidth:130},roundStep:u,changeOnBlur:!_})}),(0,k.jsx)(f.A,{direction:"column",align:"stretch",style:{flex:3,...t&&{visibility:"hidden",height:0}},children:(0,k.jsx)(f.A,{direction:"column",align:"stretch",children:(0,k.jsx)(I.A,{max:null===y||void 0===y?void 0:y.number,styles:{track:r&&{backgroundColor:(0,i.Mh)(r,v||"0b")<0?p.colorWarning:void 0}||void 0,rail:{}},step:u,value:_?0:null===x||void 0===x?void 0:x.number,disabled:_,tooltip:{formatter:_?null:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e<1?`${(1024*e).toFixed(2)} MiB`:`${e.toFixed(2)} GiB`}},onChange:e=>{null!==h&&void 0!==h&&h.number&&h.number>e?g(n):g(e<1?1024*e+"m":`${e}g`)},marks:(j={...h&&c().isNumber(null===h||void 0===h?void 0:h.number)&&{[h.number]:{style:{color:p.colorTextSecondary},label:0===h.number?h.number:h.number>=1?h.number+"g":1024*h.number+"m"}},...c().omitBy(s,((e,n)=>!!c().isNumber(null===y||void 0===y?void 0:y.number)&&c().parseInt(n)>(null===y||void 0===y?void 0:y.number))),...(null===y||void 0===y?void 0:y.number)&&{[y.number]:{style:{color:p.colorTextSecondary},label:0===y.number?y.number:y.number>=1?y.number+"g":1024*y.number+"m"}}},c().omitBy({...j},((e,n)=>{const l=parseFloat(n);return h&&y&&((null===h||void 0===h?void 0:h.number)>l||(null===y||void 0===y?void 0:y.number)<l)})))})})})]});var j};var C,K=l(63515),E=l(87258),T=l(53787),M=l(38639),R=l(42175),L=l(82919);const q=e=>{let{allocatablePresetNames:n,showCustom:a,showMinimumRequired:s,...t}=e;const[u,d]=(0,o.Tw)("first"),{run:v}=(0,R.A)(d,{wait:3e3,trailing:!1,leading:!0}),[g]=(0,r.bL)(),{t:p}=(0,_.Bd)(),{token:h}=P.A.useToken(),[y,A]=(0,m.useTransition)(),[S,F]=(0,w.A)(t),{resource_presets:N}=(0,j.useLazyLoadQuery)(void 0!==C?C:C=l(2993),{},{fetchKey:u,fetchPolicy:"first"===u?"store-and-network":"network-only"});return(0,k.jsx)(b.A,{loading:y,options:[...a?[{value:"custom",label:(0,k.jsxs)(f.A,{gap:"xs",style:{display:"inline-flex"},children:[(0,k.jsx)(T.A,{})," ",p("session.launcher.CustomAllocation")]}),selectedLabel:p("session.launcher.CustomAllocation")}]:[],...s?[{value:"minimum-required",label:(0,k.jsxs)(f.A,{gap:"xs",children:[p("session.launcher.MiniumAllocation"),(0,k.jsx)(L.A,{title:p("session.launcher.MiniumAllocationTooltip"),children:(0,k.jsx)(M.A,{style:{color:h.colorTextSecondary}})})]}),selectedLabel:p("session.launcher.MiniumAllocation")}]:[],{label:"Preset",options:c().map(N,((e,l)=>{const i=JSON.parse((null===e||void 0===e?void 0:e.resource_slots)||"{}"),o=n?!n.includes((null===e||void 0===e?void 0:e.name)||""):void 0;return{value:null===e||void 0===e?void 0:e.name,label:(0,k.jsxs)(f.A,{direction:"row",justify:"between",gap:"xs",children:[null===e||void 0===e?void 0:e.name,(0,k.jsx)(f.A,{direction:"row",gap:"xxs",style:{},children:c().map(c().omitBy(i,((e,n)=>c().isEmpty(g[n]))),((e,n)=>(0,k.jsx)(x.A,{type:n,value:e,hideTooltip:!0},n)))})]}),preset:e,disabled:o}})).sort(((e,n)=>e.disabled===n.disabled?0:e.disabled?1:-1)).sort(((e,n)=>(0,i._f)(e.value,n.value)))}],showSearch:!0,...t,value:S,onChange:F,optionLabelProp:c().includes(["custom","minimum-required"],S)?"selectedLabel":"label",onDropdownVisibleChange:e=>{t.onDropdownVisibleChange&&t.onDropdownVisibleChange(e),e&&A((()=>{v()}))}})};var $=l(43622),z=l(89840),B=l(13170),O=l(20418),D=l(77109),U=l(52335),Q=l(40056),G=l(92351),W=l(56625),H=l(58668);const X="64m",J={resource:{cpu:0,mem:"0g",shmem:"0g",accelerator:0},num_of_sessions:1,cluster_mode:"single-node",cluster_size:1,enabledAutomaticShmem:!0,agent:"auto"},Y=(e,n)=>e>=n,Z=e=>{let{enableAgentSelect:n=!1,enableNumOfSessions:l,enableResourcePresets:u,forceImageMinValues:d=!1,showRemainingWarning:v=!1}=e;const p=B.A.useFormInstance(),{t:h}=(0,_.Bd)(),{token:y}=P.A.useToken(),x=(0,o.CX)(),[{keypairResourcePolicy:A,sessionLimitAndRemaining:b}]=(0,a.y)(),[j,w]=(0,o.Tw)("first"),[N,I]=(0,m.useTransition)(),C=(0,s.hd)(),T=B.A.useWatch(["resourceGroup"],{form:p,preserve:!0})||p.getFieldValue("resourceGroup"),M=B.A.useWatch(["environments","image"],{form:p,preserve:!0}),R=B.A.useWatch(["allocationPreset"],{form:p,preserve:!0}),L=B.A.useWatch(["environments","manual"],{form:p,preserve:!0}),[{currentImageMinM:z,remaining:J,resourceLimits:Z,checkPresetInfo:ne}]=g({currentProjectName:C.name,currentResourceGroup:T||void 0,currentImage:M}),{mergedResourceSlots:ie,resourceSlotsInRG:oe}=(0,r.Hv)(T||void 0),re=oe?c().omitBy(oe,((e,n)=>{var l,i;return!!["cpu","mem","shmem"].includes(n)||(null===(l=Z.accelerators[n])||void 0===l||!l.max||0===(null===(i=Z.accelerators[n])||void 0===i?void 0:i.max))})):void 0,ae=(0,m.useMemo)((()=>M?c().filter(null===M||void 0===M?void 0:M.resource_limits,(e=>!!e&&!c().includes(["cpu","mem","shmem"],e.key))):void 0),[M]),se=!c().isUndefined(re)&&c().isEmpty(re)||ae&&0===ae.length&&c().isEmpty(L);(0,m.useEffect)((()=>{se&&p.setFieldsValue({resource:{accelerator:0}})}),[se,p]);const te={min:1,max:b.max,remaining:b.remaining},ue=(0,m.useMemo)((()=>le(null===ne||void 0===ne?void 0:ne.presets,Z,M)),[null===ne||void 0===ne?void 0:ne.presets,Z,M]),de=(0,t.E)((()=>{const e=p.getFieldValue(["resource","acceleratorType"]),n=null!==re&&void 0!==re&&re[e]?e:c().keys(re)[0];p.setFieldsValue({resource:{acceleratorType:n||e}})})),ce=(0,t.E)((e=>{var n,l,o,r,a,s;const t={cpu:null===(n=Z.cpu)||void 0===n?void 0:n.min,mem:(null===(l=(0,i.Is)(((null===(o=(0,i.Is)(null===(r=Z.shmem)||void 0===r?void 0:r.min,"m"))||void 0===o?void 0:o.number)||0)+((null===(a=(0,i.Is)(null===(s=Z.mem)||void 0===s?void 0:s.min,"m"))||void 0===a?void 0:a.number)||0)+"m","g"))||void 0===l?void 0:l.number)+"g"};if(ae&&ae.length>0)if(c().find(ae,(e=>(null===e||void 0===e?void 0:e.key)===p.getFieldValue(["resource","acceleratorType"])))){var u;t.acceleratorType=p.getFieldValue(["resource","acceleratorType"]),t.accelerator=null===(u=Z.accelerators[p.getFieldValue(["resource","acceleratorType"])])||void 0===u?void 0:u.min}else{var m;const e=null===(m=c().filter(ae,(e=>c().keys(oe).includes(null===e||void 0===e?void 0:e.key)))[0])||void 0===m?void 0:m.key;var v;if(e)t.accelerator=null===(v=Z.accelerators[e])||void 0===v?void 0:v.min,t.acceleratorType=e}else t.accelerator=0;d||e||(["cpu","accelerator"].forEach((e=>{const n=t[e];c().isNumber(n)&&n<p.getFieldValue(["resource",e])&&delete t[e]})),["mem","shmem"].forEach((e=>{const n=t[e];c().isString(n)&&(0,i.Mh)(n,p.getFieldValue(["resource",e]))<0&&delete t[e]}))),p.setFieldsValue({resource:{...t}}),M&&ae&&0===ae.length&&p.setFieldValue(["resource","accelerator"],0),p.getFieldValue("enabledAutomaticShmem")&&ve(p.getFieldValue(["resource","mem"])||"0g"),p.validateFields(["resource"],{recursive:!0}).catch((()=>{}))})),me=(0,t.E)((e=>{var n,l;const o=c().find(null===ne||void 0===ne?void 0:ne.presets,(n=>n.name===e)),r=c().pick(null===o||void 0===o?void 0:o.resource_slots,c().keys(oe)),a=null===(n=(0,i.Is)(((null===r||void 0===r?void 0:r.mem)||0)+"b","g",2))||void 0===n?void 0:n.numberUnit,s=c().omit(r,["cpu","mem","shmem"]),t=c().find(c().keys(re),(e=>void 0!==s[e]));let u={accelerator:0};t&&(u={acceleratorType:t,accelerator:Number(s[t]||0)}),p.setFieldsValue({resource:{...u,mem:a,shmem:null===(l=(0,i.Is)(((null===o||void 0===o?void 0:o.shared_memory)||0)+"b","g",2))||void 0===l?void 0:l.numberUnit,cpu:parseInt((null===r||void 0===r?void 0:r.cpu)||"0")||0}}),ve(a||"0g"),p.validateFields(["resource"],{recursive:!0}).catch((()=>{}))})),ve=e=>{(0,i.Mh)(e,"4g")>=0&&(0,i.Mh)(e,(0,i.sL)(z,"1g")||"0b")>=0&&(0,i.Mh)("1g",X)>0?p.setFieldValue(["resource","shmem"],"1g"):p.setFieldValue(["resource","shmem"],X)};return(0,m.useEffect)((()=>{if("auto-select"!==R||c().isUndefined(oe))de();else{if(c().includes(["custom","minimum-required"],p.getFieldValue("allocationPreset")));else if(ue.includes(p.getFieldValue("allocationPreset")));else if(u&&ue[0]){const e=c().sortBy(ue)[0];p.setFieldsValue({allocationPreset:e}),me(e)}else p.setFieldsValue({allocationPreset:"custom"});de(),p.validateFields(["resource"],{recursive:!0}).catch((()=>{}))}}),[R,ue,oe,p,u,de,me]),(0,m.useEffect)((()=>{"minimum-required"===R&&ce(!0)}),[M,R,ce]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(B.A.Item,{name:"resourceGroup",label:h("session.ResourceGroup"),rules:[{required:!0}],children:(0,k.jsx)(E.A,{projectName:C.name,showSearch:!0})}),u?(0,k.jsx)(B.A.Item,{label:h("resourcePreset.ResourcePresets"),name:"allocationPreset",required:!0,style:{marginBottom:y.marginXS},children:(0,k.jsx)(q,{showCustom:x._config.allowCustomResourceAllocation,showMinimumRequired:x._config.allowCustomResourceAllocation,onChange:(e,n)=>{switch(e){case"custom":break;case"minimum-required":p.setFieldValue("enabledAutomaticShmem",!0);break;default:p.setFieldValue("enabledAutomaticShmem",!0),me(e)}},allocatablePresetNames:ue})}):null,(0,k.jsx)(O.A,{style:{marginBottom:y.margin,display:x._config.allowCustomResourceAllocation?"block":"none"},children:(0,k.jsx)(B.A.Item,{shouldUpdate:(e,n)=>e.allocationPreset!==n.allocationPreset,noStyle:!0,children:e=>{var n,l,o,r,a,s,t,u,d,m,g,x;let{getFieldValue:A}=e;return(0,k.jsxs)(k.Fragment,{children:[(null===oe||void 0===oe?void 0:oe.cpu)&&(0,k.jsx)(B.A.Item,{name:["resource","cpu"],label:(null===ie||void 0===ie||null===(n=ie.cpu)||void 0===n?void 0:n.human_readable_name)||"CPU",tooltip:{placement:"right",title:(0,k.jsx)(_.x6,{i18nKey:"session.launcher.DescCPU"})},required:!0,rules:[{required:!0},{type:"number",min:null===(l=Z.cpu)||void 0===l?void 0:l.min},{type:"number",max:null===(o=Z.cpu)||void 0===o?void 0:o.max},{warningOnly:!0,validator:async(e,n)=>{var l,i,o,r;return c().isNumber(null===(l=Z.cpu)||void 0===l?void 0:l.min)&&c().isNumber(null===(i=Z.cpu)||void 0===i?void 0:i.max)&&Y(null===(o=Z.cpu)||void 0===o?void 0:o.min,null===(r=Z.cpu)||void 0===r?void 0:r.max)?Promise.reject(h("session.launcher.InsufficientAllocationOfResourcesWarning")):v&&c().isNumber(J.cpu)&&n>J.cpu?Promise.reject(h("session.launcher.EnqueueComputeSessionWarning")):Promise.resolve()}}],children:(0,k.jsx)(K.A,{inputNumberProps:{addonAfter:(null===ie||void 0===ie||null===(r=ie.cpu)||void 0===r?void 0:r.display_unit)||h("session.launcher.Core")},sliderProps:{marks:{...J.cpu?{[J.cpu]:{label:(0,k.jsx)(ee,{})}}:{},...null!==(a=Z.cpu)&&void 0!==a&&a.min?{[null===(s=Z.cpu)||void 0===s?void 0:s.min]:null===(t=Z.cpu)||void 0===t?void 0:t.min}:{},...null!==(u=Z.cpu)&&void 0!==u&&u.max?{[null===(d=Z.cpu)||void 0===d?void 0:d.max]:{style:{color:y.colorTextSecondary},label:null===(m=Z.cpu)||void 0===m?void 0:m.max}}:{}}},min:null===(g=Z.cpu)||void 0===g?void 0:g.min,max:null===(x=Z.cpu)||void 0===x?void 0:x.max,step:1,onChange:()=>{p.setFieldValue("allocationPreset","custom")}})}),(null===oe||void 0===oe?void 0:oe.mem)&&(0,k.jsxs)(B.A.Item,{label:h("session.launcher.Memory"),tooltip:{placement:"right",props:{onClick:e=>e.preventDefault()},title:(0,k.jsx)(f.A,{direction:"column",onClick:e=>e.preventDefault(),children:(0,k.jsx)(_.x6,{i18nKey:"session.launcher.DescMemory"})})},required:!0,children:[(0,k.jsx)(B.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.resource.shmem!==n.resource.shmem,children:()=>{var e,n,l;return(0,k.jsx)(B.A.Item,{name:["resource","mem"],noStyle:!0,rules:[{required:!0},{validator:async(e,n)=>{var l,o,r;return c().isString(n)&&null!==(l=Z.mem)&&void 0!==l&&l.max&&(0,i.Mh)(n,null===(o=Z.mem)||void 0===o?void 0:o.max)>0?Promise.reject(h("general.MaxValueNotification",{name:h("session.launcher.Memory"),max:c().toUpper((null===(r=Z.mem)||void 0===r?void 0:r.max)||"0g")+"iB"})):Promise.resolve()}},{validator:async(e,n)=>{var l,o,r;return!c().isElement(n)&&null!==(l=Z.mem)&&void 0!==l&&l.min&&(0,i.Mh)(n,(null===(o=Z.mem)||void 0===o?void 0:o.min)||"0g")<0?Promise.reject(h("session.launcher.MinMemory",{size:c().toUpper((null===(r=Z.mem)||void 0===r?void 0:r.min)||"0g")})):Promise.resolve()}},{warningOnly:!0,validator:async(e,n)=>{var l,o;return(0,i.Mh)(null===(l=Z.mem)||void 0===l?void 0:l.min,null===(o=Z.mem)||void 0===o?void 0:o.max)>0?Promise.reject(h("session.launcher.InsufficientAllocationOfResourcesWarning")):v&&!c().isElement(n)&&Z.mem&&(0,i.Mh)(n,J.mem+"b")>0?Promise.reject(h("session.launcher.EnqueueComputeSessionWarning")):Promise.resolve()}}],children:(0,k.jsx)(V,{max:null===(e=Z.mem)||void 0===e?void 0:e.max,min:null===(n=Z.mem)||void 0===n?void 0:n.min,addonBefore:"MEM",extraMarks:{...J.mem?{[null===(l=(0,i.Is)(J.mem+"b","g",3))||void 0===l?void 0:l.numberFixed]:{label:(0,k.jsx)(ee,{})}}:{}},onChange:e=>{e&&p.getFieldValue("enabledAutomaticShmem")&&(ve(e),p.setFieldValue("allocationPreset","custom"))}})})}}),(0,k.jsxs)(f.A,{direction:"column",gap:"xxs",align:"start",children:[(0,k.jsxs)(f.A,{direction:"row",gap:"xs",children:[h("session.launcher.EnableAutomaticMiniumShmem")," ",(0,k.jsx)(B.A.Item,{noStyle:!0,name:"enabledAutomaticShmem",valuePropName:"checked",children:(0,k.jsx)(D.A,{size:"small",onChange:e=>{e&&ve(p.getFieldValue(["resource","mem"])||"0g"),p.setFieldValue("allocationPreset","custom")}})})]}),(0,k.jsx)(B.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.resource.mem!==n.resource.mem||e.enabledAutomaticShmem!==n.enabledAutomaticShmem,children:()=>{var e;return(0,k.jsx)(B.A.Item,{noStyle:!0,name:["resource","shmem"],hidden:p.getFieldValue("enabledAutomaticShmem"),tooltip:(0,k.jsx)(_.x6,{i18nKey:"session.launcher.DescSharedMemory"}),dependencies:[["resource","mem"]],rules:[{required:!0},{},{validator:async(e,n)=>{var l,o;if(c().isEmpty(null===(l=A("resource"))||void 0===l?void 0:l.mem)||c().isEmpty(n)||(0,i.Mh)(null===(o=A("resource"))||void 0===o?void 0:o.mem,n)>=0)return Promise.resolve();throw h("resourcePreset.SHMEMShouldBeSmallerThanMemory")}}],children:(0,k.jsx)(V,{min:null===(e=Z.shmem)||void 0===e?void 0:e.min,addonBefore:"SHM",max:p.getFieldValue(["resource","mem"])||"0g",hideSlider:!0,onChange:()=>{p.setFieldValue("allocationPreset","custom")}})})}})]})]}),(0,k.jsx)(B.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>{var l,i;return(null===(l=e.resource)||void 0===l?void 0:l.acceleratorType)!==(null===(i=n.resource)||void 0===i?void 0:i.acceleratorType)||e.cluster_size!==n.cluster_size},children:e=>{var n,l,i,o,r,a;let{getFieldValue:s}=e;const t=s(["resource","acceleratorType"]);return(0,k.jsx)(B.A.Item,{name:["resource","accelerator"],label:h("session.launcher.AIAccelerator"),tooltip:{placement:"right",title:(0,k.jsx)(_.x6,{i18nKey:"session.launcher.DescAIAccelerator"})},rules:[{required:ae&&ae.length>0},{type:"number",min:(null===(n=Z.accelerators[t])||void 0===n?void 0:n.min)||0,max:null===(l=Z.accelerators[t])||void 0===l?void 0:l.max},{validator:async(e,n)=>c().endsWith(t,"shares")&&p.getFieldValue("cluster_size")>=2&&n%1!==0?Promise.reject(h("session.launcher.OnlyAllowsDiscreteNumberByClusterSize")):Promise.resolve()},{warningOnly:!0,validator:async(e,n)=>{var l,i,o,r;return c().isNumber(null===(l=Z.accelerators[t])||void 0===l?void 0:l.min)&&c().isNumber(null===(i=Z.accelerators[t])||void 0===i?void 0:i.max)&&Y(null===(o=Z.accelerators[t])||void 0===o?void 0:o.min,null===(r=Z.accelerators[t])||void 0===r?void 0:r.max)?Promise.reject(h("session.launcher.InsufficientAllocationOfResourcesWarning")):v&&c().isNumber(J.accelerators[t])&&n>J.accelerators[t]?Promise.reject(h("session.launcher.EnqueueComputeSessionWarning")):Promise.resolve()}}],children:(0,k.jsx)(K.A,{sliderProps:{marks:{0:0,...J.accelerators[t]?{[J.accelerators[t]]:{label:(0,k.jsx)(ee,{})}}:{},...c().isNumber(null===(i=Z.accelerators[t])||void 0===i?void 0:i.max)?{[null===(o=Z.accelerators[t])||void 0===o?void 0:o.max]:null===(r=Z.accelerators[t])||void 0===r?void 0:r.max}:{}},tooltip:{formatter:function(){var e;return`${arguments.length>0&&void 0!==arguments[0]?arguments[0]:0} ${(null===ie||void 0===ie||null===(e=ie[t])||void 0===e?void 0:e.display_unit)||""}`},open:!se&&void 0}},disabled:se,min:0,max:null===(a=Z.accelerators[t])||void 0===a?void 0:a.max,step:c().endsWith(t,"shares")&&p.getFieldValue("cluster_size")<2?.1:1,onChange:()=>{p.setFieldValue("allocationPreset","custom")},inputNumberProps:{addonAfter:(0,k.jsx)(B.A.Item,{noStyle:!0,name:["resource","acceleratorType"],initialValue:c().keys(re)[0],hidden:se,children:(0,k.jsx)(F.A,{autoSelectOption:!0,tabIndex:-1,suffixIcon:c().size(re)>1?void 0:null,popupMatchSelectWidth:!1,options:c().map(re,((e,n)=>{var l;return{value:n,label:(null===ie||void 0===ie||null===(l=ie[n])||void 0===l?void 0:l.display_unit)||"UNIT",disabled:ae&&ae.length>0&&!c().find(ae,(e=>(null===e||void 0===e?void 0:e.key)===n))}}))})})}})})}})]})}})}),l?(0,k.jsx)(O.A,{style:{marginBottom:y.margin},children:(0,k.jsx)(B.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.cluster_size!==n.cluster_size,children:()=>(0,k.jsx)(B.A.Item,{name:["num_of_sessions"],label:h("webui.menu.Sessions"),tooltip:(0,k.jsx)(_.x6,{i18nKey:"session.launcher.DescSession"}),required:!0,rules:[{required:!0},{warningOnly:!0,validator:async(e,n)=>v&&te&&n>te.remaining?Promise.reject(h("session.launcher.EnqueueComputeSessionWarning")):Promise.resolve()}],children:(0,k.jsx)(K.A,{inputNumberProps:{addonAfter:"#"},disabled:p.getFieldValue("cluster_size")>1,sliderProps:{marks:{[null===te||void 0===te?void 0:te.min]:null===te||void 0===te?void 0:te.min,...null!==te&&void 0!==te&&te.remaining?{[null===te||void 0===te?void 0:te.remaining]:{label:(0,k.jsx)(ee,{})}}:{},[null===te||void 0===te?void 0:te.max]:null===te||void 0===te?void 0:te.max}},min:null===te||void 0===te?void 0:te.min,max:null===te||void 0===te?void 0:te.max})})})}):null,n&&(0,k.jsx)(B.A.Item,{label:h("session.launcher.SelectAgent"),required:!0,tooltip:(0,k.jsx)(_.x6,{i18nKey:"session.launcher.DescSelectAgent"}),children:(0,k.jsxs)(f.A,{gap:"xs",children:[(0,k.jsx)(m.Suspense,{children:(0,k.jsx)(B.A.Item,{required:!0,noStyle:!0,style:{flex:1},name:"agent",children:(0,k.jsx)(S,{resourceGroup:T,fetchKey:j,onChange:(e,n)=>{"auto"!==e&&p.setFieldsValue({cluster_mode:"single-node",cluster_size:1})}})})}),(0,k.jsx)(B.A.Item,{noStyle:!0,children:(0,k.jsx)(U.Ay,{loading:N,onClick:()=>{I((()=>w()))},icon:(0,k.jsx)($.A,{})})})]})}),x.supports("multi-container")&&(0,k.jsx)(B.A.Item,{label:h("session.launcher.ClusterMode"),tooltip:(0,k.jsxs)(f.A,{direction:"column",align:"start",children:[h("session.launcher.SingleNode"),(0,k.jsx)(_.x6,{i18nKey:"session.launcher.DescSingleNode"}),(0,k.jsx)(Q.A,{style:{backgroundColor:y.colorBorder}}),h("session.launcher.MultiNode"),(0,k.jsx)(_.x6,{i18nKey:"session.launcher.DescMultiNode"})]}),required:!0,dependencies:["agent"],children:e=>{let{getFieldValue:n}=e;return(0,k.jsx)(O.A,{style:{marginBottom:y.margin},children:(0,k.jsxs)(G.A,{gutter:y.marginMD,children:[(0,k.jsx)(W.A,{xs:24,children:(0,k.jsx)(B.A.Item,{name:"cluster_mode",required:!0,children:(0,k.jsxs)(H.Ay.Group,{onChange:e=>{p.validateFields().catch((()=>{}))},disabled:"auto"!==n("agent"),children:[(0,k.jsx)(H.Ay.Button,{value:"single-node",children:h("session.launcher.SingleNode")}),(0,k.jsx)(H.Ay.Button,{value:"multi-node",children:h("session.launcher.MultiNode")})]})})}),(0,k.jsx)(W.A,{xs:24,children:(0,k.jsx)(B.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.cluster_mode!==n.cluster_mode,children:()=>{var e;const l=c().min([null===(e=Z.cpu)||void 0===e?void 0:e.max,A.max_containers_per_session]),i="single-node"===p.getFieldValue("cluster_mode")?h("session.launcher.Container"):h("session.launcher.Node");return(0,k.jsx)(B.A.Item,{name:"cluster_size",label:h("session.launcher.ClusterSize"),required:!0,rules:[{warningOnly:!0,validator:async(e,n)=>{if(v){const e=c().min([J.cpu,A.max_containers_per_session]);if(c().isNumber(e)&&n>e)return Promise.reject(h("session.launcher.EnqueueComputeSessionWarning"))}return Promise.resolve()}}],children:(0,k.jsx)(K.A,{min:1,step:1,max:c().isNumber(l)?l:void 0,disabled:1===l||"auto"!==n("agent"),sliderProps:{marks:{1:"1",...J.cpu?{[J.cpu]:{label:(0,k.jsx)(ee,{})}}:{},...c().isNumber(l)?{[l]:l}:{}},tooltip:{formatter:function(){return`${arguments.length>0&&void 0!==arguments[0]?arguments[0]:0} ${i}`}}},inputNumberProps:{addonAfter:i},onChange:e=>{e>1&&p.setFieldValue("num_of_sessions",1)}})})}})})]})})}})]})},ee=()=>{const{token:e}=P.A.useToken();return(0,k.jsx)(f.A,{style:{position:"absolute",top:-24,transform:"translateX(-50%)",color:e.colorSuccess,opacity:.5},children:(0,k.jsx)(z.A,{})})},ne=m.memo(Z),le=(e,n,l)=>{const o=c().filter(null===l||void 0===l?void 0:l.resource_limits,(e=>!!e&&!c().includes(["cpu","mem","shmem"],e.key))),r=c().filter(e,(e=>c().every(e.resource_slots,((l,o)=>{if("mem"===o){var r,a,s;return!!("string"!==typeof(null===(r=n[o])||void 0===r?void 0:r.max))||"string"===typeof e.resource_slots[o]&&"string"===typeof(null===(a=n[o])||void 0===a?void 0:a.max)&&(0,i.Mh)(e.resource_slots[o],null===(s=n[o])||void 0===s?void 0:s.max)<=0}if("shmem"===o)return!0;if("cpu"===o){var t,u;return!!c().isNaN(c().toNumber(null===(t=n[o])||void 0===t?void 0:t.max))||(c().toNumber(e.resource_slots[o])||0)<=c().toNumber(null===(u=n[o])||void 0===u?void 0:u.max)}var d,m;return!!c().isNaN(c().toNumber(null===(d=n.accelerators[o])||void 0===d?void 0:d.max))||(c().toNumber(e.resource_slots[o])||0)<=c().toNumber(null===(m=n.accelerators[o])||void 0===m?void 0:m.max)})))).map((e=>e.name)),a=c().filter(e,(e=>{const n=c().omitBy(e.resource_slots,((e,n)=>{if(["mem","cpu","shmem"].includes(n))return!0}));return 0===o.length?!!c().isEmpty(n):o&&c().some(o,(e=>(null===e||void 0===e?void 0:e.key)&&n[null===e||void 0===e?void 0:e.key]&&c().toNumber(n[null===e||void 0===e?void 0:e.key])>=c().toNumber(null===e||void 0===e?void 0:e.min)))})).map((e=>e.name));return 0===o.length?r:c().intersection(r,a)}},87258:(e,n,l)=>{l.d(n,{A:()=>v});var i=l(72375),o=l(23441),r=l(73e3),a=l(85730),s=l(96141),t=l(1581),u=l(46976),d=l.n(u),c=l(53350),m=l(60598);const v=e=>{let{projectName:n,autoSelectDefault:l,filter:u,searchValue:v,onSearch:g,loading:p,...h}=e;const y=(0,i.QE)(),[f]=(0,o.Tw)("first"),[x,A]=(0,a.A)({value:v,onChange:g}),[b,_]=(0,a.A)(h),[j,k]=(0,c.useTransition)(),[S,F]=(0,c.useState)(),w=c.useCallback((function(e){for(var n=arguments.length,l=new Array(n>1?n-1:0),i=1;i<n;i++)l[i-1]=arguments[i];F(e),k((()=>{_(e,...l)}))}),[k,_]),{data:N}=(0,r.nj)({queryKey:["ResourceGroupSelectQuery",n],queryFn:()=>{const e=new URLSearchParams;return e.set("group",n),Promise.all([y({method:"GET",url:`/scaling-groups?${e.toString()}`}),y({method:"GET",url:"/folders/_/hosts"})])},staleTime:0,fetchKey:f}),P=d().flatMap(null===N||void 0===N?void 0:N[1].volume_info,(e=>{var n;return null!==(n=null===e||void 0===e?void 0:e.sftp_scaling_groups)&&void 0!==n?n:[]})),I=d().filter(null===N||void 0===N?void 0:N[0].scaling_groups,(e=>!d().includes(P,e.name)&&(!u||u(e.name))));(0,c.useEffect)((()=>{b&&!d().some(I,(e=>e.name===b))&&w(void 0)}),[I,b,w]);const V=d().find(I,(e=>"default"===e.name))||I[0],C=V?{label:V.name,value:V.name}:void 0;(0,c.useEffect)((()=>{l&&C&&C.value!==h.value&&w(C.value,C)}),[l]);const K=h.showSearch?{onSearch:A,searchValue:x,showSearch:!0}:{};return(0,m.jsx)(t.A,{defaultActiveFirstOption:!0,...K,defaultValue:l?C:void 0,loading:p||j,disabled:j,options:d().map(I,(e=>({value:e.name,label:e.name}))),optionRender:e=>{var n;return(0,m.jsx)(s.A,{keyword:x,children:null===(n=e.data.value)||void 0===n?void 0:n.toString()})},...h,value:j?S:b,onChange:w})}},42388:(e,n,l)=>{l.d(n,{A:()=>f,s:()=>y});var i=l(72375),o=l(7971),r=l(81530),a=l(72338),s=l(9571),t=l(50128),u=l(82919),d=l(46976),c=l.n(d),m=l(64054),v=l(53350),g=l(60598);const p=e=>{var n,l;let{type:u,value:d,extra:m,opts:v,hideTooltip:p=!1,max:h}=e;const{token:f}=s.A.useToken(),x=(0,r.Nw)(),{mergedResourceSlots:A}=(0,o.Hv)(x||void 0),b=e=>{var n,l,o;return null!==A&&void 0!==A&&null!==(n=A[u])&&void 0!==n&&n.number_format.binary?Number(null===(l=(0,i.Is)(e,"g",3,!0))||void 0===l?void 0:l.numberFixed).toString():((null===A||void 0===A||null===(o=A[u])||void 0===o?void 0:o.number_format.round_length)||0)>0?parseFloat(e).toFixed(2):e};return(0,g.jsxs)(a.A,{direction:"row",gap:"xxs",children:[null!==A&&void 0!==A&&A[u]?(0,g.jsx)(y,{type:u,showTooltip:!p}):u,(0,g.jsxs)(t.A.Text,{children:[b(d),c().isUndefined(h)?null:"Infinity"===h?"~\u221e":`~${b(h)}`]}),(0,g.jsx)(t.A.Text,{type:"secondary",children:(null===A||void 0===A||null===(n=A[u])||void 0===n?void 0:n.display_unit)||""}),"mem"===u&&null!==v&&void 0!==v&&v.shmem&&(null===v||void 0===v?void 0:v.shmem)>0?(0,g.jsxs)(t.A.Text,{type:"secondary",style:{fontSize:f.fontSizeSM},children:["(SHM:"," ",null===(l=(0,i.Is)(v.shmem+"b","g",2,!0))||void 0===l?void 0:l.numberFixed,"GiB)"]}):null,m]})},h=e=>{let{size:n=16,children:l}=e;return(0,g.jsx)("mwc-icon",{style:{"--mdc-icon-size":`${n+2}px`,width:n,height:n},children:l})},y=e=>{var n,l;let{type:i,size:r=16,showIcon:s=!0,showUnit:t=!0,showTooltip:d=!0,...c}=e;const v={cpu:(0,g.jsx)(h,{size:r,children:"developer_board"}),mem:(0,g.jsx)(h,{size:r,children:"memory"}),"cuda.device":"/resources/icons/file_type_cuda.svg","cuda.shares":"/resources/icons/file_type_cuda.svg","rocm.device":"/resources/icons/rocm.svg","tpu.device":(0,g.jsx)(h,{size:r,children:"view_module"}),"ipu.device":(0,g.jsx)(h,{size:r,children:"view_module"}),"atom.device":"/resources/icons/rebel.svg","atom-plus.device":"/resources/icons/rebel.svg","gaudi2.device":"/resources/icons/gaudi.svg","warboy.device":"/resources/icons/furiosa.svg","rngd.device":"/resources/icons/furiosa.svg","hyperaccel-lpu.device":"/resources/icons/npu_generic.svg"},p=null!==(n=v[i])&&void 0!==n?n:(0,g.jsx)(m.A,{}),{mergedResourceSlots:y}=(0,o.Hv)(),f="string"===typeof p?(0,g.jsx)("img",{...c,style:{height:r,alignSelf:"center",...c.style||{}},src:v[i]||"",alt:i}):(0,g.jsx)(a.A,{style:{width:16,height:16},children:p||i});return d?(0,g.jsx)(u.A,{title:(null===(l=y[i])||void 0===l?void 0:l.description)||i,children:f}):(0,g.jsx)(a.A,{style:{pointerEvents:"none"},children:f})},f=v.memo(p)},19528:(e,n,l)=>{l.d(n,{A:()=>O});var i,o=l(72375),r=l(23441),a=l(6742),s=l(73e3),t=l(85730),u=l(81530),d=l(68098),c=l(97759),m=l(10345),v=l(72338),g=l(10144),p=l(75863),h=l(96141),y=l(91238),f=l(46976),x=l.n(f),A=l(53350),b=l(22018),_=l(60598);const j=e=>{let{vFolderFrgmt:n=null,permission:o}=e;const r=(0,b.useFragment)(void 0!==i?i:i=l(13182),n),a=x().chain({r:"green",w:"blue",d:"red"}).map(((e,n)=>{if(((e,n)=>!(null===e||void 0===e||!e.includes(n))||!(null===e||void 0===e||!e.includes("w")||"r"!==n))((null===r||void 0===r?void 0:r.permission)||o,n))return{label:n.toUpperCase(),color:e}})).compact().value();return(0,_.jsx)(y.A,{values:a})};var k,S=l(30351),F=l(11504),w=l(43622),N=l(13170),P=l(50128),I=l(82919),V=l(83978),C=l(52335),K=l(37826),E=l(8227),T=l(24798),M=l(78502),R=l.n(M),L=l(85202),q=l(91788);const $=/^[a-zA-Z0-9_/.-]*$/,z="/home/work/",B=e=>{let{filter:n,showAliasInput:i=!1,selectedRowKeys:y=[],onChangeSelectedRowKeys:f,aliasBasePath:M=z,aliasMap:B,onChangeAliasMap:O,rowKey:D="name",onChangeAutoMountedFolders:U,showAutoMountedFoldersSection:Q,...G}=e;const{generateFolderPath:W}=(0,p.useFolderExplorerOpener)(),H=A.useMemo((()=>e=>e&&e[D]),[D]),[X,J]=(0,A.useState)(!1),[Y,Z]=(0,t.A)({value:y,onChange:f},{defaultValue:[]}),[ee,ne]=(0,t.A)({value:B,onChange:O},{defaultValue:{}}),le=(0,r.CX)(),[ie]=(0,a.x)(null===le||void 0===le?void 0:le._config.accessKey),[oe]=N.A.useForm();(0,A.useEffect)((()=>{ee&&(oe.setFieldsValue(x().mapValues(ee,(e=>e.startsWith(M)?e.slice(M.length):e))),oe.validateFields())}),[ee,oe,M]);const{t:re}=(0,q.Bd)(),ae=(0,o.QE)(),se=(0,u.hd)(),[te,ue]=(0,r.Tw)("first"),[de,ce]=(0,A.useTransition)(),{data:me}=(0,s.nj)({queryKey:["VFolderSelectQuery",te,se.id],queryFn:()=>{const e=new URLSearchParams;return e.set("group_id",se.id),ae({method:"GET",url:`/folders?${e.toString()}`})},staleTime:1e3}),{domain:ve,group:ge,keypair_resource_policy:pe}=(0,b.useLazyLoadQuery)(void 0!==k?k:k=l(37449),{domain_name:le._config.domainName,group_id:se.id,keypair_resource_policy_name:(null===ie||void 0===ie?void 0:ie.resource_policy)||""},{fetchPolicy:"store-and-network",fetchKey:te}),he=(0,A.useMemo)((()=>{const e=JSON.parse((null===ve||void 0===ve?void 0:ve.allowed_vfolder_hosts)||"{}"),n=JSON.parse((null===ge||void 0===ge?void 0:ge.allowed_vfolder_hosts)||"{}"),l=JSON.parse((null===pe||void 0===pe?void 0:pe.allowed_vfolder_hosts)||"{}"),i=x().merge({},e,n,l),o=Object.keys(i).filter((e=>i[e].includes("mount-in-session")));return null===me||void 0===me?void 0:me.filter((e=>o.includes(e.host)))}),[ve,ge,pe,me]),ye=(0,A.useMemo)((()=>x().chain(he).filter((e=>{var n;return"ready"===e.status&&(null===(n=e.name)||void 0===n?void 0:n.startsWith("."))})).map((e=>e.name)).value()),[he]);(0,A.useEffect)((()=>{x().isFunction(U)&&U(ye)}),[ye]);const[fe,xe]=(0,A.useState)(""),Ae=x().chain(he).filter((e=>!n||n(e))).filter((e=>!!Y.includes(H(e))||(!fe||e.name.includes(fe)))).value(),be=(0,A.useCallback)(((e,n)=>void 0===n||""===n?`${M}${e}`:n.startsWith("/")?n:`${M}${n}`),[M]),_e=(0,d.E)((()=>{ne(x().mapValues(x().pickBy(oe.getFieldsValue({strict:!1}),(e=>!!e)),((e,n)=>be(n,e)))),oe.validateFields().catch((()=>{}))}));(0,A.useEffect)((()=>{_e()}),[JSON.stringify(Y),_e]);const je=(0,m.useShadowRoot)(),ke=[{title:(0,_.jsxs)(v.A,{direction:"row",gap:"xxs",children:[(0,_.jsx)(P.A.Text,{children:re("data.folders.Name")}),i&&(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(P.A.Text,{type:"secondary",style:{fontWeight:"normal"},children:["(",re("session.launcher.FolderAlias")," ",(0,_.jsx)(I.A,{title:(0,_.jsx)(q.x6,{i18nKey:"session.launcher.DescFolderAlias"}),getPopupContainer:()=>je,children:(0,_.jsx)(S.A,{})}),")"]})})]}),dataIndex:"name",sorter:(e,n)=>e.name.localeCompare(n.name),render:(e,n)=>{const l=Y.includes(H(n));return(0,_.jsxs)(v.A,{direction:"column",align:"start",gap:"xxs",style:i&&l?{display:"inline-flex",height:70,width:"100%"}:{maxWidth:200},children:[(0,_.jsx)(c.A,{type:"hover",to:W(n.id),children:(0,_.jsx)(h.A,{keyword:fe,children:e})}),i&&l&&(0,_.jsx)(N.A.Item,{noStyle:!0,shouldUpdate:(e,l)=>e[H(n)]!==l[H(n)],children:()=>{const e=x()(Y).reduce(((e,n)=>(e[n]=(null===ee||void 0===ee?void 0:ee[n])||be(n,void 0),e)),{});return(0,_.jsx)(N.A.Item,{name:H(n),rules:[{type:"string",pattern:$,message:re("session.launcher.FolderAliasInvalid")},{type:"string",validator:async(l,i)=>i&&x().some(e,((e,l)=>l!==H(n)&&e===be(H(n),i)))?Promise.reject(re("session.launcher.FolderAliasOverlapping")):Promise.resolve()},{type:"string",validator:async(e,l)=>{const i=be(H(n),l);return l&&x().map(ye,(e=>be("",e))).includes(i)?Promise.reject(re("session.launcher.FolderAliasOverlappingToAutoMount")):Promise.resolve()}}],extra:be(n.name,oe.getFieldValue(H(n))),children:(0,_.jsx)(V.A,{onClick:e=>{e.stopPropagation()},placeholder:re("session.launcher.FolderAlias"),allowClear:!0,onChange:()=>{_e()}})})}})]})}},{title:re("data.UsageMode"),dataIndex:"usage_mode",sorter:(e,n)=>e.usage_mode.localeCompare(n.usage_mode)},{title:re("data.Host"),dataIndex:"host"},{title:re("data.Type"),dataIndex:"type",sorter:(e,n)=>e.type.localeCompare(n.type),render:(e,n)=>(0,_.jsxs)(v.A,{direction:"column",children:["user"===n.type?(0,_.jsx)(F.A,{title:"User"}):(0,_.jsx)("div",{children:"Group"}),"group"===n.type&&`(${n.group_name})`]})},{title:re("data.Permission"),dataIndex:"permission",sorter:(e,n)=>e.permission.localeCompare(n.permission),render:(e,n)=>(0,_.jsx)(j,{permission:n.permission})},{title:re("data.Created"),dataIndex:"created_at",sorter:(e,n)=>e.created_at.localeCompare(n.created_at),render:(e,n)=>R()(e).format("L"),defaultSortOrder:"descend"}];return(0,_.jsxs)(v.A,{direction:"column",align:"stretch",gap:"xs",children:[(0,_.jsxs)(v.A,{direction:"row",gap:"xs",justify:"between",children:[(0,_.jsx)(V.A,{value:fe,onChange:e=>xe(e.target.value),allowClear:!0,placeholder:re("data.SearchByName")}),(0,_.jsx)(I.A,{title:re("button.Refresh"),children:(0,_.jsx)(C.Ay,{loading:de,icon:(0,_.jsx)(w.A,{}),onClick:()=>{ce((()=>{ue()}))}})}),(0,_.jsx)(I.A,{title:re("data.CreateANewStorageFolder"),children:(0,_.jsx)(C.Ay,{icon:(0,_.jsx)(L.A,{}),type:"primary",ghost:!0,onClick:()=>{J(!0)}})})]}),(0,_.jsx)(N.A,{form:oe,component:!1,preserve:!1,children:(0,_.jsx)(K.A,{scroll:{x:"max-content"},rowKey:H,rowSelection:{selectedRowKeys:Y,onChange:e=>{Z(e),_e()}},showSorterTooltip:!1,columns:ke,dataSource:Ae,onRow:(e,n)=>({onClick:n=>{var l;const i=n.target;null!==i&&void 0!==i&&null!==(l=i.classList)&&void 0!==l&&l.contains("ant-table-selection-column")&&(n.stopPropagation(),Y.includes(H(e))?Z(Y.filter((n=>n!==H(e)))):Z([...Y,H(e)]))}}),sortDirections:["ascend","descend"],...G})}),Q&&ye.length>0?(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(E.A,{size:"small",children:(0,_.jsx)(E.A.Item,{label:re("data.AutomountFolders"),children:x().map(ye,(e=>(0,_.jsx)(T.A,{children:e},e)))})})}):null,(0,_.jsx)(g.A,{open:X,onRequestClose:e=>{J(!1),e&&ce((()=>{ue(),Z((n=>[...n,e[D]]))}))}})]})},O=e=>{let{filter:n,rowKey:l="name",tableProps:i,...o}=e;const r=N.A.useFormInstance(),{t:a}=(0,q.Bd)();return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(N.A.Item,{hidden:!0,name:"vfoldersAliasMap",rules:[{validator(e,n){const l=x().chain(r.getFieldValue("mounts")).reduce(((e,l)=>(e[l]=n[l]||"/home/work/"+l,e)),{}).values().value();return x().uniq(l).length!==l.length?Promise.reject(a("session.launcher.FolderAliasOverlapping")):x().some(l,(e=>!$.test(e)))?Promise.reject(a("session.launcher.FolderAliasInvalid")):x().some(r.getFieldValue("autoMountedFolderNames"),(e=>l.includes(z+e)))?Promise.reject(a("session.launcher.FolderAliasOverlappingToAutoMount")):Promise.resolve()}}],children:(0,_.jsx)(V.A,{})}),(0,_.jsx)(N.A.Item,{hidden:!0,name:"autoMountedFolderNames"}),(0,_.jsx)(N.A.Item,{name:"mounts",...o,valuePropName:"selectedRowKeys",trigger:"onChangeSelectedRowKeys",children:(0,_.jsx)(B,{rowKey:l,showAliasInput:!0,aliasMap:r.getFieldValue("vfoldersAliasMap"),onChangeAliasMap:e=>{r.setFieldValue("vfoldersAliasMap",e),r.validateFields(["vfoldersAliasMap"])},pagination:!1,filter:n,showAutoMountedFoldersSection:!0,onChangeAutoMountedFolders:e=>{r.setFieldValue("autoMountedFolderNames",e)},...i})})]})}},38059:(e,n,l)=>{l.r(n),l.d(n,{default:()=>o});const i=function(){var e={defaultValue:null,kind:"LocalArgument",name:"filter"},n={defaultValue:null,kind:"LocalArgument",name:"limit"},l={defaultValue:null,kind:"LocalArgument",name:"offset"},i={defaultValue:null,kind:"LocalArgument",name:"scaling_group"},o={defaultValue:null,kind:"LocalArgument",name:"status"},r=[{alias:null,args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"limit",variableName:"limit"},{kind:"Variable",name:"offset",variableName:"offset"},{kind:"Variable",name:"scaling_group",variableName:"scaling_group"},{kind:"Variable",name:"status",variableName:"status"}],concreteType:"AgentSummaryList",kind:"LinkedField",name:"agent_summary_list",plural:!1,selections:[{alias:null,args:null,concreteType:"AgentSummary",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"schedulable",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"available_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"occupied_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[e,n,l,i,o],kind:"Fragment",metadata:null,name:"AgentSelectQuery",selections:r,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,o,e,i],kind:"Operation",name:"AgentSelectQuery",selections:r},params:{cacheID:"57b0881c2a4e4ba1bdeceb88d9ec41bd",id:null,metadata:{},name:"AgentSelectQuery",operationKind:"query",text:"query AgentSelectQuery(\n  $limit: Int!\n  $offset: Int!\n  $status: String\n  $filter: String\n  $scaling_group: String\n) {\n  agent_summary_list(limit: $limit, offset: $offset, status: $status, filter: $filter, scaling_group: $scaling_group) {\n    items {\n      id\n      status\n      schedulable\n      available_slots\n      occupied_slots\n      architecture\n    }\n    total_count\n  }\n}\n"}}}();i.hash="a3558359a8ee951a4caa89c783133e85";const o=i},3796:(e,n,l)=>{l.r(n),l.d(n,{default:()=>o});const i=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"installed"}],n={alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},l=[n,{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],i=[{alias:null,args:[{kind:"Variable",name:"is_installed",variableName:"installed"}],concreteType:"Image",kind:"LinkedField",name:"images",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"humanized_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"registry",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"architecture",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"digest",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"installed",storageKey:null},{alias:null,args:null,concreteType:"ResourceLimit",kind:"LinkedField",name:"resource_limits",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"min",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"labels",plural:!0,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namespace",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base_image_name",storageKey:null},{alias:null,args:null,concreteType:"KVPair",kind:"LinkedField",name:"tags",plural:!0,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"version",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ImageEnvironmentSelectFormItemsQuery",selections:i,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ImageEnvironmentSelectFormItemsQuery",selections:i},params:{cacheID:"9ff1339a66b7da77df70de956e3c7dd8",id:null,metadata:{},name:"ImageEnvironmentSelectFormItemsQuery",operationKind:"query",text:'query ImageEnvironmentSelectFormItemsQuery(\n  $installed: Boolean\n) {\n  images(is_installed: $installed) {\n    id\n    name @deprecatedSince(version: "24.12.0")\n    humanized_name\n    tag\n    registry\n    architecture\n    digest\n    installed\n    resource_limits {\n      key\n      min\n      max\n    }\n    labels {\n      key\n      value\n    }\n    namespace @since(version: "24.12.0")\n    base_image_name @since(version: "24.12.0")\n    tags @since(version: "24.12.0") {\n      key\n      value\n    }\n    version @since(version: "24.12.0")\n  }\n}\n'}}}();i.hash="40b2d995106300fffb0c3a5d66103d38";const o=i},2993:(e,n,l)=>{l.r(n),l.d(n,{default:()=>o});const i=function(){var e=[{alias:null,args:null,concreteType:"ResourcePreset",kind:"LinkedField",name:"resource_presets",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shared_memory",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResourcePresetSelectQuery",selections:e,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ResourcePresetSelectQuery",selections:e},params:{cacheID:"bd89430b9924d926a1b8e91191746b4f",id:null,metadata:{},name:"ResourcePresetSelectQuery",operationKind:"query",text:"query ResourcePresetSelectQuery {\n  resource_presets {\n    name\n    resource_slots\n    shared_memory\n  }\n}\n"}}}();i.hash="9841642e96d89476c2848bfb093ed9c5";const o=i},13182:(e,n,l)=>{l.r(n),l.d(n,{default:()=>o});const i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VFolderPermissionTag_VFolder",selections:[{alias:null,args:null,kind:"ScalarField",name:"permission",storageKey:null}],type:"VirtualFolder",abstractKey:null,hash:"d3b0f85629ac8c6f45ef363938f66067"},o=i},37449:(e,n,l)=>{l.r(n),l.d(n,{default:()=>o});const i=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"domain_name"},{defaultValue:null,kind:"LocalArgument",name:"group_id"},{defaultValue:null,kind:"LocalArgument",name:"keypair_resource_policy_name"}],n=[{alias:null,args:null,kind:"ScalarField",name:"allowed_vfolder_hosts",storageKey:null}],l=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"domain_name"}],concreteType:"Domain",kind:"LinkedField",name:"domain",plural:!1,selections:n,storageKey:null},{alias:null,args:[{kind:"Variable",name:"domain_name",variableName:"domain_name"},{kind:"Variable",name:"id",variableName:"group_id"}],concreteType:"Group",kind:"LinkedField",name:"group",plural:!1,selections:n,storageKey:null},{alias:null,args:[{kind:"Variable",name:"name",variableName:"keypair_resource_policy_name"}],concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policy",plural:!1,selections:n,storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"VFolderTableProjectQuery",selections:l,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"VFolderTableProjectQuery",selections:l},params:{cacheID:"2c2ce905afd89e93c6d761f22ed59f3d",id:null,metadata:{},name:"VFolderTableProjectQuery",operationKind:"query",text:"query VFolderTableProjectQuery(\n  $domain_name: String!\n  $group_id: UUID!\n  $keypair_resource_policy_name: String!\n) {\n  domain(name: $domain_name) {\n    allowed_vfolder_hosts\n  }\n  group(id: $group_id, domain_name: $domain_name) {\n    allowed_vfolder_hosts\n  }\n  keypair_resource_policy(name: $keypair_resource_policy_name) {\n    allowed_vfolder_hosts\n  }\n}\n"}}}();i.hash="ccdbaa52a63c2ea005423e7c541eff80";const o=i},13765:(e,n,l)=>{l.d(n,{o2:()=>i,tu:()=>r,zf:()=>o});const i=1e6,o=1e6,r=2147483647},65509:(e,n,l)=>{l.r(n),l.d(n,{default:()=>o});const i=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"accessKey"}],n=[{alias:null,args:[{kind:"Variable",name:"access_key",variableName:"accessKey"}],concreteType:"KeyPair",kind:"LinkedField",name:"keypair",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"resource_policy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"concurrency_used",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"hooksUsingRelay_KeyPairQuery",selections:n,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"hooksUsingRelay_KeyPairQuery",selections:n},params:{cacheID:"1f8fc324e9907111de581f5cd2dc3640",id:null,metadata:{},name:"hooksUsingRelay_KeyPairQuery",operationKind:"query",text:"query hooksUsingRelay_KeyPairQuery(\n  $accessKey: String!\n) {\n  keypair(access_key: $accessKey) {\n    id\n    resource_policy\n    concurrency_used\n  }\n}\n"}}}();i.hash="d8f5c91f0fc46a3366f57566ab688d81";const o=i},54107:(e,n,l)=>{l.r(n),l.d(n,{default:()=>o});const i=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"max_containers_per_session",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_concurrent_sessions",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"hooksUsingRelay_KeyPairResourcePolicyQuery",selections:n,type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"hooksUsingRelay_KeyPairResourcePolicyQuery",selections:n},params:{cacheID:"ad7039c1935637fe3f3841f0ea8bf347",id:null,metadata:{},name:"hooksUsingRelay_KeyPairResourcePolicyQuery",operationKind:"query",text:"query hooksUsingRelay_KeyPairResourcePolicyQuery(\n  $name: String!\n) {\n  keypair_resource_policy(name: $name) {\n    max_containers_per_session\n    max_concurrent_sessions\n  }\n}\n"}}}();i.hash="f3f7364c63aefe9b03111b584c48c103";const o=i},6742:(e,n,l)=>{l.d(n,{x:()=>c,y:()=>m});var i,o,r=l(23441),a=l(13765),s=l(46976),t=l.n(s),u=l(53350),d=l(22018);const c=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fetchPolicy:"store-and-network"};const[o,a]=(0,r.Tw)("first"),{keypair:s}=(0,d.useLazyLoadQuery)(void 0!==i?i:i=l(65509),{accessKey:e},{...n,fetchKey:o+n.fetchKey});return[s,{refresh:(0,u.useCallback)((()=>{a()}),[a])}]},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fetchPolicy:"store-and-network"};const[n,i]=(0,r.Tw)("first"),s=(0,r.CX)(),[m]=c(null===s||void 0===s?void 0:s._config.accessKey),{keypair_resource_policy:v}=(0,d.useLazyLoadQuery)(void 0!==o?o:o=l(54107),{name:(null===m||void 0===m?void 0:m.resource_policy)||""},{...e,fetchKey:n+e.fetchKey}),g=(0,u.useCallback)((()=>{i()}),[i]);return[{keypairResourcePolicy:v||{},keypair:m||{},sessionLimitAndRemaining:{max:t().min([(v||{}).max_concurrent_sessions||a.zf,3]),remaining:((v||{}).max_concurrent_sessions||3)-((m||{}).concurrency_used||0)}},{refresh:g}]}},54690:(e,n,l)=>{l.d(n,{w4:()=>a});var i=l(46976),o=l.n(i),r=l(53350);l(22018),l(32043);const a=e=>{const[n,l]=(0,r.useState)(e);return{baiPaginationOption:{limit:n.pageSize,first:n.pageSize,offset:n.current>1?(n.current-1)*n.pageSize:0},tablePaginationOption:{pageSize:n.pageSize,current:n.current},setTablePaginationOption:e=>{o().isEqual(e,n)||l((n=>({...n,...e})))}}}}}]);
//# sourceMappingURL=1620.7af2c5a0.chunk.js.map