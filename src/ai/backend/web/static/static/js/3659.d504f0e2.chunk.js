"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[3659],{9018:(e,t,i)=>{i.d(t,{A:()=>c});var a=i(91726),n=i(1004),r=i(11753),s=i(43128),o=i.n(s),l=i(66845);const d=(0,r.rU)((e=>{let{css:t,token:i}=e;return{board:t`
      .bai_board_placeholder {
        border-radius: var(--token-borderRadius) !important;
      }
      .bai_board_placeholder--active {
        background-color: var(--token-colorSplit) !important ;
      }
      .bai_board_placeholder--hover {
        background-color: var(--token-colorPrimaryHover) !important ;
        // FIXME: global token doesn't exist, so opacity fits color
        opacity: 0.3;
      }
      .bai_board_handle button span {
        color: ${i.colorTextQuaternary} !important;
        padding-left: 5px !important;
      }
      .bai_board_header {
        padding: 0 !important;
        padding-top: ${i.padding-1}px !important;
      }
      .bai_board_resizer button span {
        color: ${i.colorTextQuaternary} !important;
      }
      .bai_board_container-override
        > div:first-child
        > div:nth-child(2)
        > div:first-child {
        padding: 0 !important;
      }
    `,disableResize:t`
      .bai_board_resizer {
        display: none !important;
      }
    `,disableMove:t`
      .bai_board_handle {
        display: none !important;
      }
      .bai_board_header {
        display: none !important;
      }
    `,boardItems:t`
      & > div:first-child {
        border-radius: var(--token-borderRadius) !important;
        background-color: var(--token-colorBgContainer) !important;
        border: 1px solid ${i.colorBorderSecondary} !important;
      }

      & > div:first-child > div:first-child > div:first-child {
        margin-bottom: var(--token-margin);
        background-color: var(--token-colorBgContainer) !important;
        position: absolute;
        z-index: 1;
      }
    `,disableBorder:t`
      & > div:first-child {
        border: none !important;
      }
    `}})),c=e=>{let{items:t,resizable:i=!1,movable:r=!1,bordered:s=!1,...c}=e;const{styles:u}=d();return(0,l.jsx)(a.A,{className:o()(u.board,!r&&u.disableMove,!i&&u.disableResize),empty:!0,renderItem:e=>{var t;return(0,l.jsx)(n.A,{className:o()(u.boardItems,!s&&u.disableBorder),i18nStrings:{dragHandleAriaLabel:"",dragHandleAriaDescription:"",resizeHandleAriaLabel:"",resizeHandleAriaDescription:""},...e,children:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.content},e.id)},items:t,i18nStrings:(()=>{const e=(e,t,i)=>[e,t.length>0?`Conflicts with ${t.map((e=>e.data.title)).join(", ")}.`:"",i.length>0?`Disturbed ${i.length} items.`:""].filter(Boolean).join(" ");return{liveAnnouncementDndStarted:e=>"resize"===e?"Resizing":"Dragging",liveAnnouncementDndItemReordered:t=>{const i=`column ${t.placement.x+1}`,a=`row ${t.placement.y+1}`;return e(`Item moved to ${"horizontal"===t.direction?i:a}.`,t.conflicts,t.disturbed)},liveAnnouncementDndItemResized:t=>{const i=t.isMinimalColumnsReached?" (minimal)":"",a=t.isMinimalRowsReached?" (minimal)":"",n="horizontal"===t.direction?`columns ${t.placement.width}${i}`:`rows ${t.placement.height}${a}`;return e(`Item resized to ${n}.`,t.conflicts,t.disturbed)},liveAnnouncementDndItemInserted:t=>{const i=`column ${t.placement.x+1}`,a=`row ${t.placement.y+1}`;return e(`Item inserted to ${i}, ${a}.`,t.conflicts,t.disturbed)},liveAnnouncementDndCommitted:e=>`${e} committed`,liveAnnouncementDndDiscarded:e=>`${e} discarded`,liveAnnouncementItemRemoved:t=>e(`Removed item ${t.item.data.title}.`,[],t.disturbed),navigationAriaLabel:"Board navigation",navigationAriaDescription:"Click on non-empty item to move focus over",navigationItemAriaLabel:e=>e?e.data.title:"Empty"}})(),...c})}},43659:(e,t,i)=>{i.r(t),i.d(t,{default:()=>re});var a=i(43224),n=i(92882),r=i(11271),s=i(28380);const o=e=>{const t=(0,a.CX)();return(0,s.nj)({queryKey:["UsageHistory",t._config._userId,null===e||void 0===e?void 0:e.fetchKey],queryFn:()=>t.resources.user_stats()})};var l=i(76324),d=i(41736),c=i(77264),u=i(11753),m=i(45045),p=i(70127),v=i.n(p),y=i(51569),h=i(66845);const g=(0,u.rU)((e=>{let{css:t,token:i}=e;return{graphCard:t`
    .g2-tooltip {
      background-color: ${i.colorBgSpotlight} !important;
      border: none !important;
    }
    .g2-tooltip-title {
      color: ${i.colorTextLightSolid} !important;
    }
    .g2-tooltip-list-item-name {
      color: ${i.colorTextLightSolid} !important;
    }
    .g2-tooltip-list-item-value {
      color: ${i.colorTextLightSolid} !important;
    }
  `}})),b=e=>{let{title:t,tooltipText:i,children:a}=e;return(0,h.jsx)(c.A,{type:"inner",title:(0,h.jsxs)(m.OO,{gap:"xxs",children:[t,i?(0,h.jsx)(l.A,{title:i}):null]}),style:{width:"100%"},children:a})},_=e=>{let{data:t,key:i,period:a,targetUnit:r,displayUnit:s,unitType:o,isDarkMode:l}=e;const d=e=>{return"count"===o?e:"byte"===o?null!==(t=null===(i=(0,n.mv)(e,r))||void 0===i?void 0:i.number)&&void 0!==t?t:0:"decimal"===o?null!==(a=null===(s=(0,n.Gh)(e,r))||void 0===s?void 0:s.number)&&void 0!==a?a:0:e;var t,i,a,s};return{data:t.filter(((e,i)=>t.length-("1D"===a?96:672)<=i)).map((e=>({date:v()(1e3*e.date).format("MMM DD HH:mm"),value:d(e[i].value)}))),xField:"date",yField:"value",axis:{x:{labelAutoHide:!0,tickFilter:(e,t)=>t%("1D"===a?12:48)===0},y:{title:s}},animate:{enter:{type:"growInY"}},theme:l?"dark":"light"}},x=e=>{let{period:t,fetchKey:i}=e;const{t:n}=(0,y.Bd)(),{data:s}=o({fetchKey:i}),{isDarkMode:l}=(0,r.e)(),{styles:c}=g(),u=(0,a.CX)();return(0,h.jsxs)(m.OO,{className:c.graphCard,direction:"column",align:"start",gap:"md",children:[(0,h.jsx)(b,{title:"Sessions",tooltipText:n("statistics.SessionsDesc"),children:(0,h.jsx)(d.A,{height:200,..._({data:s,key:"num_sessions",period:t,targetUnit:"count",displayUnit:"count",unitType:"count",isDarkMode:l})})}),(0,h.jsx)(b,{title:"CPU",tooltipText:n("statistics.CPUDesc"),children:(0,h.jsx)(d.A,{height:200,..._({data:s,key:"cpu_allocated",period:t,targetUnit:"count",displayUnit:"count",unitType:"count",isDarkMode:l})})}),(0,h.jsx)(b,{title:"Memory",tooltipText:n("statistics.MemoryDesc"),children:(0,h.jsx)(d.A,{height:200,..._({data:s,key:"mem_allocated",period:t,targetUnit:"g",displayUnit:"GiB",unitType:"byte",isDarkMode:l})})}),(0,h.jsx)(b,{title:"GPU",tooltipText:n("statistics.GPUDesc"),children:(0,h.jsx)(d.A,{height:200,..._({data:s,key:"gpu_allocated",period:t,targetUnit:"count",displayUnit:"count",unitType:"count",isDarkMode:l})})}),null!==u&&void 0!==u&&u.supports("user-metrics")?null:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(b,{title:"IO-Read",tooltipText:n("statistics.IOReadDesc"),children:(0,h.jsx)(d.A,{height:200,..._({data:s,key:"io_read_bytes",period:t,targetUnit:"m",displayUnit:"MiB",unitType:"decimal",isDarkMode:l})})}),(0,h.jsx)(b,{title:"IO-Write",tooltipText:n("statistics.IOWriteDesc"),children:(0,h.jsx)(d.A,{height:200,..._({data:s,key:"io_write_bytes",period:t,targetUnit:"m",displayUnit:"MiB",unitType:"decimal",isDarkMode:l})})})]})]})};var f=i(54575),k=i(40370),D=i(89881),j=i(78890),A=i(21481),M=i(7927);const S=(0,M.withDefault)((0,M.createEnumParam)(["1D","1W"]),"1D"),U=()=>{const[e,t]=(0,M.useQueryParam)("period",S),{t:i}=(0,y.Bd)(),[n,r]=(0,a.Tw)("first"),[s,o]=(0,A.useTransition)(),l=[{label:i("statistics.1Day"),value:"1D"},{label:i("statistics.1Week"),value:"1W"}];return(0,h.jsxs)(m.OO,{direction:"column",align:"stretch",gap:"md",children:[(0,h.jsx)(f.A,{showIcon:!0,message:i("statistics.UsageHistoryNote"),type:"info"}),(0,h.jsxs)(m.OO,{gap:"sm",justify:"between",children:[(0,h.jsx)(k.A.Item,{label:i("statistics.SelectPeriod"),style:{marginBottom:0},children:(0,h.jsx)(D.A,{popupMatchSelectWidth:!1,options:l,value:e,onChange:e=>t(e)})}),(0,h.jsx)(m.u8,{loading:s,value:n,onChange:()=>{o((()=>{r()}))}})]}),(0,h.jsx)(A.Suspense,{fallback:(0,h.jsx)(j.A,{active:!0}),children:(0,h.jsx)(x,{period:e||"1D",fetchKey:n})})]})},w=function(){var e=[{alias:null,args:null,concreteType:"ContainerUtilizationMetricMetadata",kind:"LinkedField",name:"container_utilization_metric_metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"metric_names",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserSessionsMetricsQuery",selections:e,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserSessionsMetricsQuery",selections:e},params:{cacheID:"21560ceabb06c90e8704f9796db735f7",id:null,metadata:{},name:"UserSessionsMetricsQuery",operationKind:"query",text:"query UserSessionsMetricsQuery {\n  container_utilization_metric_metadata {\n    metric_names\n  }\n}\n"}}}();w.hash="9d7023ac80a345ed8f9823d881a345a4";const $=w;var T=i(23054),I=i(497),L=i(9018);const z=function(){var e={defaultValue:null,kind:"LocalArgument",name:"capacityProps"},t={defaultValue:null,kind:"LocalArgument",name:"currentProps"},i={defaultValue:null,kind:"LocalArgument",name:"user_id"},a={kind:"Variable",name:"user_id",variableName:"user_id"},n=[{alias:null,args:null,kind:"ScalarField",name:"user_id",storageKey:null},{alias:null,args:null,concreteType:"ContainerUtilizationMetric",kind:"LinkedField",name:"metrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"metric_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value_type",storageKey:null},{alias:null,args:null,concreteType:"MetricResultValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"avg_value",storageKey:null}],storageKey:null}],r=[{alias:"capacity_metric",args:[{kind:"Variable",name:"props",variableName:"capacityProps"},a],concreteType:"UserUtilizationMetric",kind:"LinkedField",name:"user_utilization_metric",plural:!1,selections:n,storageKey:null},{alias:"current_metric",args:[{kind:"Variable",name:"props",variableName:"currentProps"},a],concreteType:"UserUtilizationMetric",kind:"LinkedField",name:"user_utilization_metric",plural:!1,selections:n,storageKey:null}];return{fragment:{argumentDefinitions:[e,t,i],kind:"Fragment",metadata:null,name:"SessionMetricGraphQuery",selections:r,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[i,e,t],kind:"Operation",name:"SessionMetricGraphQuery",selections:r},params:{cacheID:"aa2a1000ef4410eaa2da853eabbdf0d6",id:null,metadata:{},name:"SessionMetricGraphQuery",operationKind:"query",text:"query SessionMetricGraphQuery(\n  $user_id: UUID!\n  $capacityProps: UserUtilizationMetricQueryInput!\n  $currentProps: UserUtilizationMetricQueryInput!\n) {\n  capacity_metric: user_utilization_metric(user_id: $user_id, props: $capacityProps) {\n    user_id\n    metrics {\n      metric_name\n      value_type\n      values {\n        timestamp\n        value\n      }\n      max_value\n      avg_value\n    }\n  }\n  current_metric: user_utilization_metric(user_id: $user_id, props: $currentProps) {\n    user_id\n    metrics {\n      metric_name\n      value_type\n      values {\n        timestamp\n        value\n      }\n      max_value\n      avg_value\n    }\n  }\n}\n"}}}();z.hash="88c8725f744a307e05f63cff149489f0";const P=z;var C=i(234),K=i(8334),R=i(14373),N=i(43749),O=i.n(N),B=i(69775),F=i(91887),G=i(50760),E=i(25845),Q=i(38774),H=i(90885),W=i(40640),q=i(87655),Y=i(8848),V=i(36321);const X=(0,u.rU)((e=>{let{css:t,token:i}=e;return{recharts:t`
    .recharts-label {
      fill: ${i.colorTextDescription};
    }
    .recharts-cartesian-axis-line {
      stroke: ${i.colorBorder};
    }
    .recharts-cartesian-axis-tick-line {
      stroke: ${i.colorBorder};
    }
    .recharts-cartesian-axis-tick-value {
      fill: ${i.colorTextDescription};
    }
    .recharts-default-tooltip {
      background-color: ${i.colorBgSpotlight} !important;
      border: none !important;
      color: ${i.colorTextLightSolid} !important;
    }
  `}})),Z=e=>{var t,i,a,n,r,s,o,d;let{queryProps:{startDate:c,endDate:u,metricName:p,userId:v,dayDiff:y},fetchKey:g,tooltip:b}=e;const{token:_}=C.A.useToken(),{styles:x}=X(),{mergedResourceSlots:f}=(0,T.Hv)(),{capacity_metric:k,current_metric:D}=(0,B.useLazyLoadQuery)(P,{user_id:v,capacityProps:{metric_name:p,start:c,end:u,step:y<7?"5m":y<30?"1h":"1d",value_type:"capacity"},currentProps:{metric_name:p,start:c,end:u,step:y<7?"5m":y<30?"1h":"1d",value_type:"current"}},{fetchPolicy:"store-and-network",fetchKey:g}),j={cpu_util:e=>O().toNumber(e)/10},M=J(null!==(t=null===k||void 0===k?void 0:k.metrics)&&void 0!==t?t:[],null!==(i=null===D||void 0===D?void 0:D.metrics)&&void 0!==i?i:[],c,u,y<7?"5m":y<30?"1h":"1d",null!==(a=j[p])&&void 0!==a?a:void 0),S=(0,A.useMemo)((()=>{var e;const[t]=O().split(p,"_");return null!==(e=O().find(O().keys(f),(e=>O().startsWith(e,t))))&&void 0!==e?e:""}),[f,p]),U=null===(n=f[S])||void 0===n?void 0:n.description;return(0,h.jsxs)(m.OO,{direction:"column",align:"stretch",gap:"sm",style:{height:"100%",overflow:"hidden"},children:[(0,h.jsxs)(m.OO,{align:"center",style:{height:56,marginLeft:52},gap:"xs",children:[(0,h.jsx)(K.A.Text,{style:{fontSize:_.fontSizeHeading5},strong:!0,children:(()=>{const[,...e]=O().split(p,"_"),t=O().startCase(e.join(" "));return U?`${U} ${t}`:O().includes(p.toLowerCase(),"io")?`${O().startCase(p.replaceAll("io","IO").replaceAll("_"," "))}`:`${O().startCase(p.replaceAll("_"," "))}`})()}),b?(0,h.jsx)(l.A,{title:b}):null]}),O().isEmpty(null===k||void 0===k?void 0:k.metrics)&&O().isEmpty(null===D||void 0===D?void 0:D.metrics)?(0,h.jsx)(R.A,{image:R.A.PRESENTED_IMAGE_SIMPLE,style:{height:"100%",alignContent:"center"}}):(0,h.jsx)(F.u,{style:{paddingRight:_.marginXL},children:(0,h.jsxs)(G.b,{data:M,className:x.recharts,children:[(0,h.jsx)(E.d,{strokeDasharray:"3 3"}),(0,h.jsx)(Q.W,{dataKey:"timestamp",minTickGap:_.marginMD}),(0,h.jsx)(H.h,{domain:[0,"dataMax"]}),(0,h.jsx)(W.m,{formatter:e=>`${e}${ee(void 0,p).numberUnit}`}),(0,h.jsx)(q.s,{}),(0,h.jsx)(Y.e,{y:ee(null===D||void 0===D||null===(r=D.metrics)||void 0===r||null===(s=r[0])||void 0===s?void 0:s.avg_value,null===D||void 0===D||null===(o=D.metrics)||void 0===o||null===(d=o[0])||void 0===d?void 0:d.metric_name).number,label:"Avg Used",stroke:_.red,strokeWidth:.6,strokeDasharray:"6 6"}),(0,h.jsx)(V.N,{type:"monotone",dataKey:"capacity",stroke:_.colorSuccess,dot:{r:0},strokeWidth:2}),(0,h.jsx)(V.N,{type:"monotone",dataKey:"used",stroke:_.colorPrimary,strokeWidth:2,dot:{r:0}})]})})]})},J=(e,t,i,a,n,r)=>{var s,o,l,d;const c=O().zip((null===(s=e[0])||void 0===s?void 0:s.values)||Array(null===(o=t[0])||void 0===o||null===(l=o.values)||void 0===l?void 0:l.length).fill(0),null===(d=t[0])||void 0===d?void 0:d.values).map((e=>{let[t,i]=e;return{timestamp:null===i||void 0===i?void 0:i.timestamp,capacity:r?r(null===t||void 0===t?void 0:t.value):null===t||void 0===t?void 0:t.value,used:r?r(null===i||void 0===i?void 0:i.value):null===i||void 0===i?void 0:i.value}})),u=n.slice(-1),m=parseInt(n.slice(0,-1),10)*{s:1,m:60,h:3600,d:86400}[u],p=[];for(let g=Number(i);g<Number(a);g+=m){var y,h;const e=g,i=O().find(c,(t=>t.timestamp===e));p.push({timestamp:v()(1e3*e).format("lll"),capacity:ee(null===i||void 0===i?void 0:i.capacity,null===(y=t[0])||void 0===y?void 0:y.metric_name).number,used:ee(null===i||void 0===i?void 0:i.used,null===(h=t[0])||void 0===h?void 0:h.metric_name).number})}return p},ee=(e,t)=>{let i,a;if(!t)return{number:i,numberUnit:a};if(O().includes(t.toLowerCase(),"util"))i=Number((0,n.Z1)(null!==e&&void 0!==e?e:0,1)),a="%";else if(O().includes(t.toLowerCase(),"used"))i=Number((Number(e)/1e3).toFixed(1)),a="s";else{var r,s;const o=["io","net"],l=O().some(o,(e=>O().includes(O().toLower(t),e)));i=O().toNumber(l?null===(r=(0,n.Gh)(null!==e&&void 0!==e?e:"0","g"))||void 0===r?void 0:r.numberFixed:null===(s=(0,n.mv)(null!==e&&void 0!==e?e:"0","g"))||void 0===s?void 0:s.numberFixed),a=l?"GB":"GiB"}return O().includes(O().toLower(t),"net")&&(a="GB/s"),i=e?i:void 0,{number:i,numberUnit:a}};var te=i(91439);const ie=()=>{const{t:e}=(0,y.Bd)(),{token:t}=C.A.useToken(),{RangePicker:i}=te.A,[r,s]=(0,a.Tw)("first"),[o,l]=(0,A.useTransition)(),[d,c]=(0,M.useQueryParam)("startDate",(0,M.withDefault)(M.StringParam,v()().format("YYYY-MM-DD 00:00:00"))),[u,p]=(0,M.useQueryParam)("endDate",(0,M.withDefault)(M.StringParam,v()().format("YYYY-MM-DD 23:59:59"))),g=(0,T.U6)(),b=v()(u).diff(v()(d),"day"),{container_utilization_metric_metadata:_}=(0,B.useLazyLoadQuery)($,{},{fetchKey:r,fetchPolicy:"store-and-network"}),x=(0,A.useMemo)((()=>{const e=(null===_||void 0===_?void 0:_.metric_names)||[],{cpuUtil:t,memory:i,acceleratorGroups:a,rest:n}=O().reduce(e,((e,t)=>{if(!t||"cpu_used"===t||"io_scratch_size"===t)return e;if("cpu_util"===t)e.cpuUtil.push(t);else if("mem"===t)e.memory.push(t);else if(!t.endsWith("_util")&&!t.endsWith("_mem")||O().startsWith(t,"cpu")||O().startsWith(t,"mem"))e.rest.push(t);else{const i=t.split("_").slice(0,-1).join("_");e.acceleratorGroups[i]||(e.acceleratorGroups[i]=[]),e.acceleratorGroups[i].push(t)}return e}),{cpuUtil:[],memory:[],acceleratorGroups:{},rest:[]});return[...t,...i,...O().flatMap(O().values(a),(e=>O().sortBy(e,(e=>e.endsWith("_util")?0:1)))),...O().sortBy(n,(e=>e.startsWith("net")?0:1))]}),[null===_||void 0===_?void 0:_.metric_names]),[k,D]=(0,A.useState)(window.innerWidth);(0,A.useEffect)((()=>{const e=()=>{D(window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const[S,U]=(0,I.q)("session_metrics_board_items"),w={cpu_util:(0,n.y1)(e("statistics.description.CPUUtilization")),net_rx:(0,n.y1)(e("statistics.description.NetworkRx")),net_tx:(0,n.y1)(e("statistics.description.NetworkTx"))},z=(0,A.useMemo)((()=>{const e=O().map(x,(e=>{var i,a;return{id:e,rowSpan:3,columnSpan:k>2160?3:2,data:{content:(0,h.jsx)(A.Suspense,{fallback:(0,h.jsx)(j.A,{active:!0,style:{padding:`0px ${t.marginMD}px`}}),children:(0,h.jsx)(Z,{queryProps:{startDate:v()(d).unix().toString(),endDate:v()(u).unix().toString(),metricName:e,userId:null!==(i=null===(a=g[0])||void 0===a?void 0:a.uuid)&&void 0!==i?i:"",dayDiff:b},fetchKey:r,tooltip:w[e]||void 0},e)})}}}));if(S){const t=O().map(S,(t=>{const i=O().find(e,(e=>e.id===t.id));return i?{...t,data:i.data}:null}));return(0,m.YM)(t)}return e}),[x,d,u,r,b,k]),[P,K]=(0,A.useState)(z);return(0,A.useEffect)((()=>{K(z)}),[z]),(0,h.jsxs)(m.OO,{direction:"column",align:"stretch",gap:"md",children:[(0,h.jsxs)(m.OO,{align:"stretch",justify:"between",children:[(0,h.jsx)(i,{allowClear:!1,showTime:{format:"HH:mm"},maxDate:v()(),onChange:(e,t)=>{let[i,a]=t;l((()=>{c(i),p(a)}))},defaultValue:[v()(d),v()(u)],presets:[{label:e("statistics.timeRange.Today"),value:[v()().startOf("day"),v()().endOf("day")]},{label:e("statistics.timeRange.LastHour"),value:[v()().subtract(1,"hour"),v()().subtract(1,"second")]},{label:e("statistics.timeRange.Last3Hours"),value:[v()().subtract(3,"hours"),v()().subtract(1,"second")]},{label:e("statistics.timeRange.Last12Hours"),value:[v()().subtract(12,"hours"),v()().subtract(1,"second")]},{label:e("statistics.timeRange.LastDay"),value:[v()().subtract(1,"day"),v()().subtract(1,"second")]},{label:e("statistics.timeRange.Last7Days"),value:[v()().subtract(7,"days"),v()().subtract(1,"second")]}]}),(0,h.jsx)(m.u8,{loading:o,value:r,onChange:()=>{l((()=>{s()}))}})]}),b>30&&(0,h.jsx)(f.A,{showIcon:!0,message:e("statistics.prometheus.DataMissingInLowUsageDesc")}),O().isEmpty(x)?(0,h.jsx)(R.A,{image:R.A.PRESENTED_IMAGE_SIMPLE,description:e("statistics.prometheus.NoMetricsToDisplay")}):(0,h.jsx)(L.A,{movable:!0,resizable:!0,bordered:!0,items:P,onItemsChange:e=>{let i=[...e.detail.items];if(e.detail.resizedItem){const a=e.detail.resizedItem.id;i=i.map((e=>{if(e.id===a){const a=z.find((t=>t.id===e.id));var i,n;if(a)return{...e,data:{...a.data,content:(0,h.jsx)(A.Suspense,{fallback:(0,h.jsx)(j.A,{active:!0,style:{padding:`0px ${t.marginMD}px`}}),children:(0,h.jsx)(Z,{queryProps:{startDate:v()(d).unix().toString(),endDate:v()(u).unix().toString(),metricName:e.id,userId:null!==(i=null===(n=g[0])||void 0===n?void 0:n.uuid)&&void 0!==i?i:"",dayDiff:b},fetchKey:r,tooltip:w[e.id]||void 0},`${e.id}-${Date.now()}`)})}}}return e}))}K(i),U(O().map(i,(e=>O().omit(e,"data"))))}})]})};var ae=i(75182);const ne=(0,M.withDefault)(M.StringParam,"allocation-history"),re=()=>{const{t:e}=(0,y.Bd)(),t=(0,a.CX)(),{token:i}=C.A.useToken(),[n,r]=(0,M.useQueryParam)("tab",ne,{updateType:"replace"});return(0,h.jsxs)(m.Zu,{activeTabKey:n,onTabChange:e=>r(e),tabList:(0,m.YM)([{key:"allocation-history",tab:e("webui.menu.UsageHistory")},(null===t||void 0===t?void 0:t.supports("user-metrics"))&&{key:"user-session-history",tab:e("webui.menu.UserSessionHistory")}]),styles:{body:{overflow:"hidden"}},children:["allocation-history"===n?(0,h.jsx)(ae.A,{children:(0,h.jsx)(A.Suspense,{fallback:(0,h.jsx)(j.A,{active:!0,style:{padding:i.paddingContentVerticalLG}}),children:(0,h.jsx)(U,{})})}):null,"user-session-history"===n?(0,h.jsx)(ae.A,{children:(0,h.jsx)(A.Suspense,{fallback:(0,h.jsx)(j.A,{active:!0,style:{padding:i.paddingContentVerticalLG}}),children:(0,h.jsx)(ie,{})})}):null]})}}}]);
//# sourceMappingURL=3659.d504f0e2.chunk.js.map