"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[8454],{96090:(e,n,o)=>{o.d(n,{A:()=>p});var l=o(30032),i=o(41679),a=o(83642),r=o(329),t=o(78074),s=o(24128),c=o(45901),u=o.n(c),d=o(76998),m=o(23446);const p=e=>{let{dynamicSteps:n=[1,2,4,8,16,32,64,128,256,512],units:o=["m","g","t","p"],disableAutoUnit:c=!1,min:p="0m",max:y="300p",roundStep:v,..._}=e;const[g,x]=(0,i.A)(_,{defaultValue:"0g"}),[f,k]=null===g||void 0===g?[null,null]:(0,l.E8)(g),h=(0,a.A)(k),j=k||h||o[0],[P,b]=(0,l.E8)(p),[S,A]=(0,l.E8)(y),C=(0,d.useRef)(null);return(0,d.useEffect)((()=>{if(C.current){const e=e=>{var n;const o=null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.value;/^\d+(g|m)$/.test(o)&&x(o)},n=C.current;return null===n||void 0===n||n.addEventListener("input",e),()=>{null===n||void 0===n||n.removeEventListener("input",e)}}}),[C,f,k,x]),(0,m.jsx)(r.A,{ref:C,..._,onBlur:()=>{if(u().isNumber(v)&&v>0){var e,n,o;const l=(null===(e=v.toString().split(".")[1])||void 0===e?void 0:e.length)||0;if(isNaN(Math.round(u().toNumber((null===(n=C.current)||void 0===n?void 0:n.value)||"0")/v)*v))return;x(`${(Math.round(u().toNumber((null===(o=C.current)||void 0===o?void 0:o.value)||"0")/v)*v).toFixed(l)}${j}`)}},value:f,onChange:e=>{x(null===e||void 0===e?e:`${e}${j}`)},max:A===j?S:(0,l.Js)(y,j).number,min:b===j?P:(0,l.Js)(p,j).number,addonAfter:(0,m.jsx)(t.A,{tabIndex:-1,value:j,onChange:e=>{x(`${f}${e}`)},onDropdownVisibleChange:e=>{(e&&null===g||void 0===g)&&x(`0${j}`)},options:u().map(o,(e=>({value:e,label:(0,m.jsx)(s.A.Text,{style:{fontFamily:"'SFMono-Regular',Consolas,'Liberation Mono',Menlo,Courier,monospace"},children:e.toUpperCase()+"iB"})}))),suffixIcon:o.length>1?void 0:null,open:o.length>1&&void 0,style:{cursor:o.length>1?void 0:"default"}}),step:0,onStep:(e,l)=>{const i=u().isNull(f)||u().isUndefined(f)?0:f,a=u().sortedIndex(u().sortBy(n),i);let r;r="up"===l.type?i===n[a]?a+1:a:a-1;const t=o.indexOf(j);if(!c&&r<0)if(0===t)x(`0${j}`);else{const e=n[n.length-1],l=o[t-1];x(`${e}${l}`)}else if(!c&&r>n.length-1)if(t===o.length-1)x(`${i+("up"===l.type?1:-1)}${A}`);else{const e=n[0],l=o[t+1];x(`${e}${l}`)}else if(r>=0&&r<n.length){let e=n[r];b===j&&e<P?e=P:A===j&&e>S&&(e=S),x(`${e}${j}`)}}})}},8469:(e,n,o)=>{o.d(n,{Ay:()=>v,s5:()=>y,uJ:()=>m});var l=o(30032),i=o(16162),a=o(96495),r=o(29871),t=o(50840),s=o(24128),c=o(20307),u=(o(76998),o(77678)),d=o(23446);const m={"cuda.device":"GPU","cuda.shares":"FGPU","rocm.device":"GPU","tpu.device":"TPU","ipu.device":"IPU","atom.device":"ATOM","atom-plus.device":"ATOM+","warboy.device":"Warboy","hyperaccel-lpu.device":"Hyperaccel LPU"},p=e=>{let{size:n=16,children:o}=e;return(0,d.jsx)("mwc-icon",{style:{"--mdc-icon-size":`${n+2}px`,width:n,height:n},children:o})},y=e=>{var n,o,l;let{type:i,size:a=16,showIcon:t=!0,showUnit:s=!0,showTooltip:m=!0,...y}=e;const{t:v}=(0,u.Bd)(),_={cpu:[(0,d.jsx)(p,{size:a,children:"developer_board"}),v("session.core")],mem:[(0,d.jsx)(p,{size:a,children:"memory"}),"GiB"],"cuda.device":["/resources/icons/file_type_cuda.svg","GPU"],"cuda.shares":["/resources/icons/file_type_cuda.svg","FGPU"],"rocm.device":["/resources/icons/rocm.svg","GPU"],"tpu.device":[(0,d.jsx)(p,{size:a,children:"view_module"}),"TPU"],"ipu.device":[(0,d.jsx)(p,{size:a,children:"view_module"}),"IPU"],"atom.device":["/resources/icons/rebel.svg","ATOM"],"atom-plus.device":["/resources/icons/rebel.svg","ATOM+"],"warboy.device":["/resources/icons/furiosa.svg","Warboy"],"hyperaccel-lpu.device":["/resources/icons/npu_generic.svg","Hyperaccel LPU"]},g="string"===typeof(null===(n=_[i])||void 0===n?void 0:n[0])?(0,d.jsx)("img",{...y,style:{height:a,alignSelf:"center",...y.style||{}},src:(null===(o=_[i])||void 0===o?void 0:o[0])||"",alt:i}):(0,d.jsx)(r.A,{style:{width:16,height:16},children:(null===(l=_[i])||void 0===l?void 0:l[0])||i});return m?(0,d.jsx)(c.A,{title:i,children:g}):(0,d.jsx)(r.A,{style:{pointerEvents:"none"},children:g})},v=e=>{var n,o,c,u,m;let{type:p,value:v,extra:_,opts:g,hideTooltip:x=!1}=e;const{token:f}=t.A.useToken(),k=(0,a.Nw)(),[h]=(0,i.Hv)(k||void 0);return(0,d.jsxs)(r.A,{direction:"row",gap:"xxs",children:[null!==h&&void 0!==h&&h[p]?(0,d.jsx)(y,{type:p,showTooltip:!x}):p,(0,d.jsx)(s.A.Text,{children:null!==h&&void 0!==h&&null!==(n=h[p])&&void 0!==n&&n.number_format.binary?Number(null===(o=(0,l.Js)(v,"g",3,!0))||void 0===o?void 0:o.numberFixed).toString():((null===h||void 0===h||null===(c=h[p])||void 0===c?void 0:c.number_format.round_length)||0)>0?parseFloat(v).toFixed(2):v}),(0,d.jsx)(s.A.Text,{type:"secondary",children:(null===h||void 0===h||null===(u=h[p])||void 0===u?void 0:u.display_unit)||""}),"mem"===p&&null!==g&&void 0!==g&&g.shmem&&(null===g||void 0===g?void 0:g.shmem)>0?(0,d.jsxs)(s.A.Text,{type:"secondary",style:{fontSize:f.fontSizeSM},children:["(SHM: ",null===(m=(0,l.Js)(g.shmem+"b","g",2,!0))||void 0===m?void 0:m.numberFixed,"GiB)"]}):null,_]})}},34680:(e,n,o)=>{o.d(n,{A:()=>y});var l=o(25339),i=o(62863),a=o(50840),r=o(65080),t=o(24377),s=o(87627),c=o(45901),u=o.n(c),d=o(76998),m=o(77678),p=o(23446);const y=e=>{let{open:n,onRequestClose:o,columns:c,displayedColumnKeys:y,...v}=e;const _=(0,d.useRef)(null),{t:g}=(0,m.Bd)(),{token:x}=a.A.useToken(),f=c.map((e=>{return"string"===typeof e.title?{label:e.title,value:u().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(n=e.title,d.Children.map(n.props.children,(e=>{if("string"===typeof e)return e}))),value:u().toString(e.key)}:{label:void 0,value:u().toString(e.key)};var n}));return(0,p.jsx)(l.A,{title:g("table.SettingTable"),open:n,destroyOnClose:!0,centered:!0,onOk:()=>{var e;null===(e=_.current)||void 0===e||e.validateFields().then((e=>{o(e)})).catch((()=>{}))},onCancel:()=>{o()},...v,children:(0,p.jsxs)(r.A,{ref:_,preserve:!1,initialValues:{selectedColumnKeys:y||f.map((e=>e.value))},layout:"vertical",children:[(0,p.jsx)(r.A.Item,{name:"searchInput",label:g("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,p.jsx)(t.A,{prefix:(0,p.jsx)(i.A,{}),style:{marginBottom:x.marginSM},placeholder:g("table.SearchTableColumn")})}),(0,p.jsx)(r.A.Item,{noStyle:!0,shouldUpdate:(e,n)=>e.searchInput!==n.searchInput,children:e=>{let{getFieldValue:n}=e;const o=n("searchInput")?u().toLower(n("searchInput")):void 0,l=f.map((e=>u().toLower(u().toString(e.label)).includes(o||"")?e:{...e,style:{display:"none"}}));return(0,p.jsx)(r.A.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},children:(0,p.jsx)(s.A.Group,{options:l,style:{flexDirection:"column"}})})}})]})})}},69647:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"DeleteKeyPairResourcePolicy",kind:"LinkedField",name:"delete_keypair_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairResourcePolicyListMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairResourcePolicyListMutation",selections:n},params:{cacheID:"fe182323e364c317f26c7193239af22b",id:null,metadata:{},name:"KeypairResourcePolicyListMutation",operationKind:"mutation",text:"mutation KeypairResourcePolicyListMutation(\n  $name: String!\n) {\n  delete_keypair_resource_policy(name: $name) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="5771729a12a204d27a9cdf5ad31e707f";const i=l},44988:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"total_resource_slots",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"max_session_lifetime",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"max_concurrent_sessions",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"max_containers_per_session",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"idle_timeout",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"allowed_vfolder_hosts",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"KeypairResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policies",plural:!0,selections:[e,n,o,l,i,a,r,{args:null,kind:"FragmentSpread",name:"KeypairResourcePolicySettingModalFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"KeypairResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policies",plural:!0,selections:[e,n,o,l,i,a,r,{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null}],storageKey:null}]},params:{cacheID:"05cd0ba2e87295be2064be1b38441faf",id:null,metadata:{},name:"KeypairResourcePolicyListQuery",operationKind:"query",text:'query KeypairResourcePolicyListQuery {\n  keypair_resource_policies {\n    name\n    total_resource_slots\n    max_session_lifetime\n    max_concurrent_sessions\n    max_containers_per_session\n    idle_timeout\n    allowed_vfolder_hosts\n    ...KeypairResourcePolicySettingModalFragment\n  }\n}\n\nfragment KeypairResourcePolicySettingModalFragment on KeyPairResourcePolicy {\n  name\n  total_resource_slots\n  max_session_lifetime\n  max_concurrent_sessions\n  max_containers_per_session\n  idle_timeout\n  allowed_vfolder_hosts\n  max_vfolder_count @deprecatedSince(version: "23.09.4")\n}\n'}}}();l.hash="86e382131325a58294cf015618b4920b";const i=l},32018:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateKeyPairResourcePolicy",kind:"LinkedField",name:"create_keypair_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairResourcePolicySettingModalCreateMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairResourcePolicySettingModalCreateMutation",selections:n},params:{cacheID:"b52e3e869ccfabb393fb45a48074767e",id:null,metadata:{},name:"KeypairResourcePolicySettingModalCreateMutation",operationKind:"mutation",text:"mutation KeypairResourcePolicySettingModalCreateMutation(\n  $name: String!\n  $props: CreateKeyPairResourcePolicyInput!\n) {\n  create_keypair_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="7c4c5be505f02fa76e7b4db73a1f4b14";const i=l},67941:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"KeypairResourcePolicySettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total_resource_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_session_lifetime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_concurrent_sessions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_containers_per_session",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"idle_timeout",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowed_vfolder_hosts",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null}],type:"KeyPairResourcePolicy",abstractKey:null,hash:"57d4c7b215e0e5dda0632124129e0895"},i=l},91932:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyKeyPairResourcePolicy",kind:"LinkedField",name:"modify_keypair_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairResourcePolicySettingModalModifyMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairResourcePolicySettingModalModifyMutation",selections:n},params:{cacheID:"72be648e07857dd6923d7c81f3f19948",id:null,metadata:{},name:"KeypairResourcePolicySettingModalModifyMutation",operationKind:"mutation",text:"mutation KeypairResourcePolicySettingModalModifyMutation(\n  $name: String!\n  $props: ModifyKeyPairResourcePolicyInput!\n) {\n  modify_keypair_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="8c99c8be8781f93fed817a67c86ea966";const i=l},55321:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"DeleteProjectResourcePolicy",kind:"LinkedField",name:"delete_project_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ProjectResourcePolicyListMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ProjectResourcePolicyListMutation",selections:n},params:{cacheID:"9f1218faa2207eff18f5a145f12f87ac",id:null,metadata:{},name:"ProjectResourcePolicyListMutation",operationKind:"mutation",text:"mutation ProjectResourcePolicyListMutation(\n  $name: String!\n) {\n  delete_project_resource_policy(name: $name) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="2c5a20c6c463174bbfc726a27cdfdcac";const i=l},47862:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"ProjectResourcePolicy",kind:"LinkedField",name:"project_resource_policies",plural:!0,selections:[e,n,o,l,i,{args:null,kind:"FragmentSpread",name:"ProjectResourcePolicySettingModalFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ProjectResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"ProjectResourcePolicy",kind:"LinkedField",name:"project_resource_policies",plural:!0,selections:[e,n,o,l,i],storageKey:null}]},params:{cacheID:"fd82efe8df4f63e44d1ce560cebbb87a",id:null,metadata:{},name:"ProjectResourcePolicyListQuery",operationKind:"query",text:'query ProjectResourcePolicyListQuery {\n  project_resource_policies {\n    id\n    name\n    created_at\n    max_vfolder_count @since(version: "23.09.6")\n    max_quota_scope_size @since(version: "23.09.2")\n    ...ProjectResourcePolicySettingModalFragment\n  }\n}\n\nfragment ProjectResourcePolicySettingModalFragment on ProjectResourcePolicy {\n  id\n  name\n  created_at\n  max_vfolder_count @since(version: "23.09.6")\n  max_quota_scope_size @since(version: "23.09.2")\n}\n'}}}();l.hash="1fd938a952e68149bec403bde264acd6";const i=l},29360:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateProjectResourcePolicy",kind:"LinkedField",name:"create_project_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ProjectResourcePolicySettingModalCreateMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ProjectResourcePolicySettingModalCreateMutation",selections:n},params:{cacheID:"b94d7a4b8e8341df4e396784abba4203",id:null,metadata:{},name:"ProjectResourcePolicySettingModalCreateMutation",operationKind:"mutation",text:"mutation ProjectResourcePolicySettingModalCreateMutation(\n  $name: String!\n  $props: CreateProjectResourcePolicyInput!\n) {\n  create_project_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="c0683608e8a527146563ba5bd9fcad33";const i=l},94019:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectResourcePolicySettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null}],type:"ProjectResourcePolicy",abstractKey:null,hash:"e65e818d16e9d0b54c0ad10641a38504"},i=l},68458:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyProjectResourcePolicy",kind:"LinkedField",name:"modify_project_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ProjectResourcePolicySettingModalModifyMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ProjectResourcePolicySettingModalModifyMutation",selections:n},params:{cacheID:"aedc4eab77206f7ab189ccd3f2d938b3",id:null,metadata:{},name:"ProjectResourcePolicySettingModalModifyMutation",operationKind:"mutation",text:"mutation ProjectResourcePolicySettingModalModifyMutation(\n  $name: String!\n  $props: ModifyProjectResourcePolicyInput!\n) {\n  modify_project_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="3cd62195489eba58dd9693f1fc9df8ff";const i=l},61989:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"DeleteUserResourcePolicy",kind:"LinkedField",name:"delete_user_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserResourcePolicyListMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserResourcePolicyListMutation",selections:n},params:{cacheID:"7be7fa4bc2e6ce7666489318e415d769",id:null,metadata:{},name:"UserResourcePolicyListMutation",operationKind:"mutation",text:"mutation UserResourcePolicyListMutation(\n  $name: String!\n) {\n  delete_user_resource_policy(name: $name) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="5b565e4db37c96850ac85a92cd4e0290";const i=l},55242:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"max_session_count_per_model_session",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"max_customized_image_count",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"UserResourcePolicy",kind:"LinkedField",name:"user_resource_policies",plural:!0,selections:[e,n,o,l,i,a,r,{args:null,kind:"FragmentSpread",name:"UserResourcePolicySettingModalFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"UserResourcePolicy",kind:"LinkedField",name:"user_resource_policies",plural:!0,selections:[e,n,o,l,i,a,r],storageKey:null}]},params:{cacheID:"00b0583474f74c417b06d53115787d3b",id:null,metadata:{},name:"UserResourcePolicyListQuery",operationKind:"query",text:'query UserResourcePolicyListQuery {\n  user_resource_policies {\n    id\n    name\n    created_at\n    max_vfolder_count @since(version: "23.09.6")\n    max_session_count_per_model_session @since(version: "23.09.10")\n    max_quota_scope_size @since(version: "23.09.2")\n    max_customized_image_count @since(version: "24.03.0")\n    ...UserResourcePolicySettingModalFragment\n  }\n}\n\nfragment UserResourcePolicySettingModalFragment on UserResourcePolicy {\n  id\n  name\n  max_vfolder_count @since(version: "23.09.6")\n  max_session_count_per_model_session @since(version: "23.09.10")\n  max_quota_scope_size @since(version: "23.09.2")\n  max_customized_image_count @since(version: "24.03.0")\n}\n'}}}();l.hash="be57da0a1c15efb970cb1e828500e6dc";const i=l},14908:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateUserResourcePolicy",kind:"LinkedField",name:"create_user_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserResourcePolicySettingModalCreateMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserResourcePolicySettingModalCreateMutation",selections:n},params:{cacheID:"129c4a570d8ae1a075d9aa9261094c48",id:null,metadata:{},name:"UserResourcePolicySettingModalCreateMutation",operationKind:"mutation",text:"mutation UserResourcePolicySettingModalCreateMutation(\n  $name: String!\n  $props: CreateUserResourcePolicyInput!\n) {\n  create_user_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="9c00928ca86d4779838243df247257aa";const i=l},4935:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserResourcePolicySettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_session_count_per_model_session",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_customized_image_count",storageKey:null}],type:"UserResourcePolicy",abstractKey:null,hash:"d93790c2b9fef92baa6999ce770cd9da"},i=l},97662:(e,n,o)=>{o.r(n),o.d(n,{default:()=>i});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],n=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyUserResourcePolicy",kind:"LinkedField",name:"modify_user_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserResourcePolicySettingModalModifyMutation",selections:n,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserResourcePolicySettingModalModifyMutation",selections:n},params:{cacheID:"f33ed379f4871e357183803b340a938a",id:null,metadata:{},name:"UserResourcePolicySettingModalModifyMutation",operationKind:"mutation",text:"mutation UserResourcePolicySettingModalModifyMutation(\n  $name: String!\n  $props: ModifyUserResourcePolicyInput!\n) {\n  modify_user_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="d50cbcfb63bfd30da81fea8968bb6436";const i=l},48454:(e,n,o)=>{o.r(n),o.d(n,{default:()=>fe});var l=o(36009),i=o(30032),a=o(45901),r=o.n(a);function t(e){return null===e||void 0===e?"":"number"===typeof e||"boolean"===typeof e?String(e):`"${(e=r().isString(e)?e:JSON.stringify(e)).replace(/"/g,'""')}"`}const s=(e,n,o)=>{const l=((e,n)=>{const o=r().map(e,(e=>r().omit(e,"__fragments","__fragmentOwner","__id"))),l=r().keys(o[0]),i=r().map(o,(e=>r().map(e,((e,o)=>{var l;return null!==n&&void 0!==n&&n[o]&&(null===(l=n[o])||void 0===l?void 0:l.call(n,e))||e})))),a=i.map((e=>e.map(t).join(","))).join("\n");return[l.map(t).join(","),a].join("\n")})(e,o);((e,n)=>{const o=URL.createObjectURL(e),l=document.createElement("a");l.href=o,l.download=n,l.click(),URL.revokeObjectURL(o)})(new Blob([l],{type:"text/csv"}),`${n}.csv`)};var c=o(83468),u=o(29871),d=o(16162),m=o(78074),p=o(76998),y=o(23446);const v=e=>{let{...n}=e;const o=(0,d._V)();return(0,y.jsx)(m.A,{...n,children:r().map(o,(e=>(0,y.jsx)(m.A.Option,{value:e,children:e},e)))})};var _=o(25339),g=o(96090),x=o(65080),f=o(87627),k=o(77678);const h=e=>{let{name:n,unlimitedValue:o,children:l,...i}=e;const{t:a}=(0,k.Bd)(),[r,t]=(0,p.useState)(!1),s=x.A.useFormInstance();(0,p.useEffect)((()=>{const e=s.getFieldValue(n);t(e===o)}),[s,n,o]);const c=p.isValidElement(l)?(0,p.cloneElement)(l,{disabled:r}):l,d=r&&p.isValidElement(l)?(0,p.cloneElement)(l,{value:void 0,disabled:r}):void 0;return(0,y.jsxs)(u.A,{direction:"column",align:"start",children:[(0,y.jsx)(x.A.Item,{style:{margin:0},name:n,hidden:r,...i,children:c}),r?(0,y.jsx)(x.A.Item,{style:{margin:0},...i,children:d}):null,(0,y.jsx)(f.A,{checked:r,onChange:e=>{const l=e.target.checked;t(l),l?s.setFieldValue(n,o):s.resetFields([n])},children:a("resourcePolicy.Unlimited")})]})};var j,P,b,S=o(78969),A=o(24377),C=o(29475),R=o(7518),M=o(9788),K=o(329),F=o(3606);const w=1e6,L=1e6,q=e=>{var n,l,a,t,s,u,m;let{existingPolicyNames:f,keypairResourcePolicyFrgmt:q=null,onRequestClose:z,...I}=e;const{t:T}=(0,k.Bd)(),{message:V}=S.A.useApp(),O=(0,p.useRef)(null),[N]=(0,d.Hv)(),U=(0,c.CX)(),D=null===U||void 0===U?void 0:U.supports("deprecated-max-vfolder-count-in-keypair-resource-policy"),$=(0,F.useFragment)(void 0!==j?j:j=o(67941),q),[E,B]=(0,F.useMutation)(void 0!==P?P:P=o(32018)),[H,Q]=(0,F.useMutation)(void 0!==b?b:b=o(91932)),J=(0,p.useMemo)((()=>{const e=JSON.parse((null===$||void 0===$?void 0:$.total_resource_slots)||"{}");var n;null!==e&&void 0!==e&&e.mem&&(e.mem=null===(n=(0,i.Js)((null===e||void 0===e?void 0:e.mem)+"b","g",2,!0))||void 0===n?void 0:n.numberUnit);let o={};return null===$&&(o={max_session_lifetime:0,max_concurrent_sessions:L,max_containers_per_session:w,idle_timeout:0}),{parsedTotalResourceSlots:e,allowedVfolderHostNames:r().keys(JSON.parse((null===$||void 0===$?void 0:$.allowed_vfolder_hosts)||"{}")),...o,...$}}),[$,null===$||void 0===$?void 0:$.total_resource_slots,null===$||void 0===$?void 0:$.allowed_vfolder_hosts]);return(0,y.jsx)(_.A,{title:T(null===$?"resourcePolicy.CreateResourcePolicy":"resourcePolicy.UpdateResourcePolicy"),onOk:()=>{var e;return null===O||void 0===O||null===(e=O.current)||void 0===e?void 0:e.validateFields().then((e=>{let n=r().mapValues(null===e||void 0===e?void 0:e.parsedTotalResourceSlots,((e,n)=>{var o;return"mem"===n?null===(o=(0,i.Js)(e,"b",0))||void 0===o?void 0:o.numberFixed:e}));n=r().pickBy(n,r().negate(r().isUndefined));const o=$?JSON.parse($.allowed_vfolder_hosts||"{}"):{},l=r().fromPairs(r().map(e.allowedVfolderHostNames,(e=>[e,r().get(o,e,[])]))),a={default_for_unspecified:"UNLIMITED",total_resource_slots:JSON.stringify(n||"{}"),max_session_lifetime:null===e||void 0===e?void 0:e.max_session_lifetime,max_concurrent_sessions:null===e||void 0===e?void 0:e.max_concurrent_sessions,max_containers_per_session:null===e||void 0===e?void 0:e.max_containers_per_session,idle_timeout:null===e||void 0===e?void 0:e.idle_timeout,allowed_vfolder_hosts:JSON.stringify(l||"{}")};D||(a.max_vfolder_count=null===e||void 0===e?void 0:e.max_vfolder_count),null===$?E({variables:{name:null===e||void 0===e?void 0:e.name,props:a},onCompleted:(e,n)=>{var o,l;if(null===e||void 0===e||null===(o=e.create_keypair_resource_policy)||void 0===o||!o.ok)return V.error(null===e||void 0===e||null===(l=e.create_keypair_resource_policy)||void 0===l?void 0:l.msg),void z();if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=r().map(n,(e=>e.message));for(const n of e)V.error(n,2.5);z()}else V.success(T("resourcePolicy.SuccessfullyCreated")),z(!0)},onError(e){V.error(e.message)}}):H({variables:{name:null===e||void 0===e?void 0:e.name,props:a},onCompleted:(e,n)=>{var o,l;if(null===e||void 0===e||null===(o=e.modify_keypair_resource_policy)||void 0===o||!o.ok)return V.error(null===e||void 0===e||null===(l=e.modify_keypair_resource_policy)||void 0===l?void 0:l.msg),void z();if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=r().map(n,(e=>e.message));for(const n of e)V.error(n,2.5);z()}else V.success(T("resourcePolicy.SuccessfullyUpdated")),z(!0)},onError(e){V.error(e.message)}})})).catch((()=>{}))},onCancel:()=>z(),destroyOnClose:!0,confirmLoading:B||Q,...I,children:(0,y.jsxs)(x.A,{ref:O,layout:"vertical",requiredMark:"optional",initialValues:J,preserve:!1,children:[(0,y.jsx)(x.A.Item,{label:T("resourcePolicy.Name"),name:"name",required:!0,rules:[{required:!0,message:T("data.explorer.ValueRequired")},{max:64},{validator:(e,n)=>!$&&null!==f&&void 0!==f&&f.includes(n)?Promise.reject(T("resourcePolicy.ResourcePolicyNameAlreadyExists")):Promise.resolve()}],children:(0,y.jsx)(A.A,{disabled:!!$})}),(0,y.jsx)(x.A.Item,{label:T("resourcePolicy.ResourcePolicy"),required:!0,children:(0,y.jsxs)(C.A,{children:[(0,y.jsxs)(R.A,{gutter:16,children:[(0,y.jsx)(M.A,{span:12,children:(0,y.jsx)(h,{name:["parsedTotalResourceSlots","cpu"],unlimitedValue:void 0,label:null===N||void 0===N||null===(n=N.cpu)||void 0===n?void 0:n.description,children:(0,y.jsx)(K.A,{min:0,max:512,addonAfter:null===N||void 0===N||null===(l=N.cpu)||void 0===l?void 0:l.display_unit})})}),(0,y.jsx)(M.A,{span:12,children:(0,y.jsx)(h,{name:["parsedTotalResourceSlots","mem"],unlimitedValue:void 0,label:null===N||void 0===N||null===(a=N.mem)||void 0===a?void 0:a.description,children:(0,y.jsx)(g.A,{})})})]}),(0,y.jsxs)(R.A,{gutter:16,align:"bottom",children:[(0,y.jsx)(M.A,{span:12,children:(0,y.jsx)(h,{name:["parsedTotalResourceSlots","cuda.device"],unlimitedValue:void 0,label:null===N||void 0===N||null===(t=N["cuda.device"])||void 0===t?void 0:t.description,children:(0,y.jsx)(K.A,{min:0,max:64,addonAfter:null===N||void 0===N||null===(s=N["cuda.device"])||void 0===s?void 0:s.display_unit})})}),(0,y.jsx)(M.A,{span:12,children:(0,y.jsx)(h,{name:["parsedTotalResourceSlots","cuda.shares"],unlimitedValue:void 0,label:null===N||void 0===N||null===(u=N["cuda.shares"])||void 0===u?void 0:u.description,children:(0,y.jsx)(K.A,{min:0,max:256,step:.1,addonAfter:null===N||void 0===N||null===(m=N["cuda.shares"])||void 0===m?void 0:m.display_unit})})})]})]})}),(0,y.jsx)(x.A.Item,{label:T("resourcePolicy.Sessions"),required:!0,children:(0,y.jsxs)(C.A,{children:[(0,y.jsxs)(R.A,{gutter:16,children:[(0,y.jsx)(M.A,{span:12,children:(0,y.jsx)(h,{name:"max_containers_per_session",unlimitedValue:L,label:T("resourcePolicy.ContainerPerSession"),children:(0,y.jsx)(K.A,{min:0,max:100,style:{width:"100%"}})})}),(0,y.jsx)(M.A,{span:12,children:(0,y.jsx)(h,{name:"max_session_lifetime",unlimitedValue:0,label:T("resourcePolicy.MaxSessionLifetime"),children:(0,y.jsx)(K.A,{min:0,max:100,style:{width:"100%"}})})})]}),(0,y.jsxs)(R.A,{gutter:16,children:[(0,y.jsx)(M.A,{span:12,children:(0,y.jsx)(h,{name:"max_concurrent_sessions",unlimitedValue:w,label:T("resourcePolicy.ConcurrentJobs"),children:(0,y.jsx)(K.A,{min:0,max:100,style:{width:"100%"}})})}),(0,y.jsx)(M.A,{span:12,children:(0,y.jsx)(h,{name:"idle_timeout",unlimitedValue:0,label:T("resourcePolicy.IdleTimeoutSec"),children:(0,y.jsx)(K.A,{min:0,max:15552e3,style:{width:"100%"}})})})]})]})}),(0,y.jsx)(x.A.Item,{label:T("resourcePolicy.Folders"),required:!0,children:(0,y.jsxs)(C.A,{children:[(0,y.jsx)(x.A.Item,{label:T("resourcePolicy.AllowedHosts"),name:"allowedVfolderHostNames",children:(0,y.jsx)(v,{mode:"multiple"})}),D?void 0:(0,y.jsx)(x.A.Item,{label:T("credential.Max#"),name:"max_vfolder_count",children:(0,y.jsx)(K.A,{min:0,max:50})})]})})]})})};var z,I,T=o(8469),V=o(34680),O=o(63718),N=o(97041),U=o(51749),D=o(93792),$=o(5336),E=o(44355),B=o(50840),H=o(48713),Q=o(6932),J=o(59065),X=o(74650),G=o(42923),W=o(71537);const Y=e=>{var n;const{token:l}=B.A.useToken(),{t:a}=(0,k.Bd)(),{message:t}=S.A.useApp(),[d,m]=(0,c.Tw)("initial-fetch"),[v,_]=(0,p.useTransition)(),[g,x]=(0,p.useState)(!1),[f,h]=(0,p.useState)(!1),[j,P]=(0,p.useState)(),[b,A]=(0,p.useState)(),C=(0,c.CX)(),R=null!==(n=null===C||void 0===C?void 0:C.supports("fine-grained-storage-permissions"))&&void 0!==n&&n,{keypair_resource_policies:M}=(0,F.useLazyLoadQuery)(void 0!==z?z:z=o(44988),{},{fetchPolicy:"initial-fetch"===d?"store-and-network":"network-only",fetchKey:d}),[K,Y]=(0,F.useMutation)(void 0!==I?I:I=o(69647)),Z=[{title:a("resourcePolicy.Name"),dataIndex:"name",key:"name",fixed:"left",sorter:(e,n)=>(0,i._f)(null===e||void 0===e?void 0:e.name,null===n||void 0===n?void 0:n.name)},{title:a("resourcePolicy.Resources"),dataIndex:"total_resource_slots",key:"total_resource_slots",render:(e,n)=>(0,y.jsx)(u.A,{gap:"xxs",children:r().isEmpty(JSON.parse((null===n||void 0===n?void 0:n.total_resource_slots)||"{}"))?"-":r().map(JSON.parse(null===n||void 0===n?void 0:n.total_resource_slots),((e,n)=>(0,y.jsx)(T.Ay,{type:n,value:r().toString(e)},n)))})},{title:a("resourcePolicy.Concurrency"),dataIndex:"max_concurrent_sessions",key:"max_concurrent_sessions",sorter:(e,n)=>null!==e&&void 0!==e&&e.max_concurrent_sessions&&null!==n&&void 0!==n&&n.max_concurrent_sessions?e.max_concurrent_sessions-n.max_concurrent_sessions:1,render:e=>e===L?"\u221e":e},{title:a("resourcePolicy.ClusterSize"),dataIndex:"max_containers_per_session",key:"max_containers_per_session",sorter:(e,n)=>null!==e&&void 0!==e&&e.max_containers_per_session&&null!==n&&void 0!==n&&n.max_containers_per_session?e.max_containers_per_session-n.max_containers_per_session:1,render:e=>e===w?"\u221e":e},{title:a("resourcePolicy.IdleTimeout"),dataIndex:"idle_timeout",key:"idle_timeout",sorter:(e,n)=>null!==e&&void 0!==e&&e.idle_timeout&&null!==n&&void 0!==n&&n.idle_timeout?e.idle_timeout-n.idle_timeout:1,render:e=>e||"\u221e"},{title:a("session.MaxSessionLifetime"),dataIndex:"max_session_lifetime",key:"max_session_lifetime",sorter:(e,n)=>(0,i.Oe)(null===e||void 0===e?void 0:e.max_session_lifetime,null===n||void 0===n?void 0:n.max_session_lifetime,0),render:e=>e||"\u221e"},{title:a("resourcePolicy.StorageNodes"),dataIndex:"allowed_vfolder_hosts",key:"allowed_vfolder_hosts",render:(e,n)=>{const o=R?r().keys(JSON.parse((null===n||void 0===n?void 0:n.allowed_vfolder_hosts)||"{}")):JSON.parse((null===n||void 0===n?void 0:n.allowed_vfolder_hosts)||"{}");return(0,y.jsx)(y.Fragment,{children:r().map(o,(e=>(0,y.jsx)(H.A,{children:e},e)))})}},{title:a("general.Control"),key:"control",fixed:"right",render:(e,n)=>(0,y.jsxs)(u.A,{direction:"row",align:"stretch",children:[(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(O.A,{}),style:{color:l.colorInfo},onClick:()=>{A(n)}}),(0,y.jsx)(J.A,{title:a("dialog.ask.DoYouWantToProceed"),description:a("dialog.warning.CannotBeUndone"),okType:"danger",okText:a("button.Delete"),onConfirm:()=>{null!==n&&void 0!==n&&n.name&&(P(n.name+d),K({variables:{name:n.name},onCompleted:(e,n)=>{var o,l;if(null!==e&&void 0!==e&&null!==(o=e.delete_keypair_resource_policy)&&void 0!==o&&o.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=r().map(n,(e=>e.message));for(const n of e)t.error(n,2.5)}else _((()=>m())),t.success(a("resourcePolicy.SuccessfullyDeleted"));else t.error(null===e||void 0===e||null===(l=e.delete_keypair_resource_policy)||void 0===l?void 0:l.msg)},onError(e){t.error(null===e||void 0===e?void 0:e.message)}}))},children:(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(N.A,{style:{color:l.colorError}}),loading:Y&&j===(null===n||void 0===n?void 0:n.name)+d,disabled:Y&&j!==(null===n||void 0===n?void 0:n.name)+d})})]})}],[ee,ne]=(0,E.A)("backendaiwebui.KeypairResourcePolicyList.displayedColumnKeys",{defaultValue:Z.map((e=>r().toString(e.key)))});return(0,y.jsxs)(u.A,{direction:"column",align:"stretch",children:[(0,y.jsxs)(u.A,{direction:"row",justify:"between",wrap:"wrap",gap:"xs",style:{padding:l.paddingContentVertical,paddingLeft:l.paddingContentHorizontalSM,paddingRight:l.paddingContentHorizontalSM},children:[(0,y.jsx)(u.A,{direction:"column",align:"start",children:(0,y.jsx)(X.A,{menu:{items:[{key:"exportCSV",label:a("resourcePolicy.ExportCSV"),onClick:()=>{(()=>{if(!M)return void t.error(a("resourcePolicy.NoDataToExport"));const e=r().without(ee,"control"),n=r().map(M,(n=>r().pick(n,e.map((e=>e)))));s(n,"keypair_resource_policies",{total_resource_slots:e=>r().isEmpty(e)?"-":JSON.stringify(e),max_concurrent_sessions:e=>e===L?"-":e,max_containers_per_session:e=>e===w?"-":e,idle_timeout:e=>e||"-",max_session_lifetime:e=>e||"-",allowed_vfolder_hosts:e=>r().isEmpty(e)?"-":r().keys(JSON.parse(e)).join(", ")})})()}}]},children:(0,y.jsx)(Q.Ay,{type:"link",style:{padding:0},onClick:e=>e.preventDefault(),children:(0,y.jsxs)(G.A,{style:{color:l.colorLinkHover},children:[a("resourcePolicy.Tools"),(0,y.jsx)(U.A,{})]})})})}),(0,y.jsx)(u.A,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:(0,y.jsxs)(u.A,{gap:"xs",children:[(0,y.jsx)(Q.Ay,{icon:(0,y.jsx)(D.A,{}),loading:v,onClick:()=>{_((()=>m()))}}),(0,y.jsx)(Q.Ay,{type:"primary",icon:(0,y.jsx)($.A,{}),onClick:()=>{h(!0)},children:a("button.Create")})]})})]}),(0,y.jsx)(W.A,{columns:Z.filter((e=>null===ee||void 0===ee?void 0:ee.includes(r().toString(e.key)))),dataSource:M,rowKey:"name",scroll:{x:"max-content"},pagination:!1,showSorterTooltip:!1}),(0,y.jsx)(u.A,{justify:"end",style:{padding:l.paddingXXS},children:(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(O.A,{}),onClick:()=>{x(!0)}})}),(0,y.jsx)(V.A,{open:g,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&ne(null===e||void 0===e?void 0:e.selectedColumnKeys),x(!1)},columns:Z,displayedColumnKeys:ee||[]}),(0,y.jsx)(q,{existingPolicyNames:r().map(M,(e=>(null===e||void 0===e?void 0:e.name)||"")),open:!!b||f,keypairResourcePolicyFrgmt:b||null,onRequestClose:e=>{A(null),h(!1),e&&_((()=>{m()}))}})]})};var Z,ee,ne,oe=o(65557);const le=e=>{let{existingPolicyNames:n,projectResourcePolicyFrgmt:l=null,onRequestClose:a,...t}=e;const{t:s}=(0,k.Bd)(),{token:d}=B.A.useToken(),{message:m}=S.A.useApp(),v=(0,p.useRef)(null),g=(0,c.CX)(),f=null===g||void 0===g?void 0:g.supports("max-vfolder-count-in-user-and-project-resource-policy"),j=null===g||void 0===g?void 0:g.supports("max-quota-scope-size"),P=(0,F.useFragment)(void 0!==Z?Z:Z=o(94019),l),[b,C]=(0,F.useMutation)(void 0!==ee?ee:ee=o(29360)),[R,M]=(0,F.useMutation)(void 0!==ne?ne:ne=o(68458)),w=(0,p.useMemo)((()=>{let e={};null===P&&(e={max_vfolder_count:0,max_quota_scope_size:-1});let n=null===P||void 0===P?void 0:P.max_quota_scope_size;return n=r().isUndefined(n)||-1===n?-1:(0,i.wb)(n),{...e,...P,max_quota_scope_size:n}}),[P,null===P||void 0===P?void 0:P.max_vfolder_count,null===P||void 0===P?void 0:P.max_quota_scope_size]);return(0,y.jsxs)(_.A,{title:s(null===P?"resourcePolicy.CreateResourcePolicy":"resourcePolicy.UpdateResourcePolicy"),onOk:e=>{var n;return null===v||void 0===v||null===(n=v.current)||void 0===n?void 0:n.validateFields().then((e=>{const n={max_vfolder_count:(null===e||void 0===e?void 0:e.max_vfolder_count)||0,max_quota_scope_size:-1===(null===e||void 0===e?void 0:e.max_quota_scope_size)?-1:(0,i._S)(null===e||void 0===e?void 0:e.max_quota_scope_size)};f||delete n.max_vfolder_count,j||delete n.max_quota_scope_size,null===P?b({variables:{name:null===e||void 0===e?void 0:e.name,props:n},onCompleted(e,n){var o,l;null===e||void 0===e||null===(o=e.create_project_resource_policy)||void 0===o||!o.ok||n?(m.error(null===e||void 0===e||null===(l=e.create_project_resource_policy)||void 0===l?void 0:l.msg),a()):(m.success(s("storageHost.ResourcePolicySuccessfullyUpdated")),a(!0))},onError(e){m.error(null===e||void 0===e?void 0:e.message)}}):R({variables:{name:null===e||void 0===e?void 0:e.name,props:n},onCompleted(e,n){var o,l;null===e||void 0===e||null===(o=e.modify_project_resource_policy)||void 0===o||!o.ok||n?(m.error(null===e||void 0===e||null===(l=e.modify_project_resource_policy)||void 0===l?void 0:l.msg),a()):(m.success(s("storageHost.ResourcePolicySuccessfullyUpdated")),a(!0))},onError(e){m.error(null===e||void 0===e?void 0:e.message)}})})).catch((()=>{}))},onCancel:()=>a(),destroyOnClose:!0,confirmLoading:C||M,...t,children:[(0,y.jsx)(oe.A,{message:s("storageHost.BeCarefulToSetProjectResourcePolicy"),type:"warning",showIcon:!0,style:{marginBottom:d.marginMD}}),(0,y.jsxs)(x.A,{ref:v,layout:"vertical",requiredMark:"optional",initialValues:w,preserve:!1,children:[(0,y.jsx)(x.A.Item,{label:s("resourcePolicy.Name"),name:"name",required:!0,rules:[{required:!0,message:s("data.explorer.ValueRequired")},{max:255},{validator:(e,o)=>!P&&null!==n&&void 0!==n&&n.includes(o)?Promise.reject(s("resourcePolicy.ResourcePolicyNameAlreadyExists")):Promise.resolve()}],children:(0,y.jsx)(A.A,{disabled:!!P})}),(0,y.jsxs)(u.A,{direction:"column",align:"stretch",gap:"md",style:{marginBottom:d.marginMD},children:[f?(0,y.jsx)(h,{name:"max_vfolder_count",unlimitedValue:0,label:s("resourcePolicy.MaxFolderCount"),style:{width:"100%",margin:0},children:(0,y.jsx)(K.A,{min:0,style:{width:"100%"}})}):null,j?(0,y.jsx)(h,{name:"max_quota_scope_size",unlimitedValue:-1,label:s("storageHost.MaxFolderSize"),style:{width:"100%",margin:0},children:(0,y.jsx)(K.A,{min:0,addonAfter:"GB",style:{width:"100%"}})}):null]})]})]})};var ie,ae,re=o(24717),te=o(14455),se=o.n(te);const ce=()=>{const{token:e}=B.A.useToken(),{t:n}=(0,k.Bd)(),[l,a]=(0,p.useTransition)(),[t,d]=(0,c.Tw)("initial-fetch"),[m,v]=(0,p.useState)(!1),[_,g]=(0,p.useState)(!1),[x,f]=(0,p.useState)(),[h,j]=(0,p.useState)(),P=(0,c.CX)(),b=null===P||void 0===P?void 0:P.supports("max-vfolder-count-in-user-and-project-resource-policy"),S=null===P||void 0===P?void 0:P.supports("max-quota-scope-size"),{project_resource_policies:A}=(0,F.useLazyLoadQuery)(void 0!==ie?ie:ie=o(47862),{},{fetchPolicy:"initial-fetch"===t?"store-and-network":"network-only",fetchKey:t}),[C,R]=(0,F.useMutation)(void 0!==ae?ae:ae=o(55321)),M=(0,i.LY)([{title:n("resourcePolicy.Name"),dataIndex:"name",key:"name",fixed:"left",sorter:(e,n)=>(0,i._f)(null===e||void 0===e?void 0:e.name,null===n||void 0===n?void 0:n.name)},b&&{title:n("resourcePolicy.MaxVFolderCount"),dataIndex:"max_vfolder_count",key:"max_vfolder_count",render:e=>0===r().toNumber(e)?"\u221e":e,sorter:(e,n)=>(0,i.Oe)(null===e||void 0===e?void 0:e.max_vfolder_count,null===n||void 0===n?void 0:n.max_vfolder_count,0)},S&&{title:n("resourcePolicy.MaxQuotaScopeSize"),dataIndex:"max_quota_scope_size",key:"max_quota_scope_size",render:e=>-1===e?"\u221e":(0,i.wb)(e),sorter:(e,n)=>(0,i.Oe)(null===e||void 0===e?void 0:e.max_quota_scope_size,null===n||void 0===n?void 0:n.max_quota_scope_size,-1)},{title:"ID",dataIndex:"id",key:"id",sorter:(e,n)=>(0,i._f)(null===e||void 0===e?void 0:e.id,null===n||void 0===n?void 0:n.id)},{title:n("resourcePolicy.CreatedAt"),dataIndex:"created_at",key:"created_at",render:e=>se()(e).format("lll"),sorter:(e,n)=>(0,i._f)(null===e||void 0===e?void 0:e.created_at,null===n||void 0===n?void 0:n.created_at)},{title:n("general.Control"),fixed:"right",key:"control",render:(o,l)=>(0,y.jsxs)(u.A,{direction:"row",align:"stretch",children:[(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(O.A,{}),style:{color:e.colorInfo},onClick:()=>{j(l)}}),(0,y.jsx)(J.A,{title:n("dialog.ask.DoYouWantToProceed"),description:n("dialog.warning.CannotBeUndone"),okType:"danger",okText:n("button.Delete"),onConfirm:()=>{null!==l&&void 0!==l&&l.name&&(f(l.name+t),C({variables:{name:l.name},onCompleted:(e,o)=>{var l,i;if(null!==e&&void 0!==e&&null!==(l=e.delete_project_resource_policy)&&void 0!==l&&l.ok)if(o&&(null===o||void 0===o?void 0:o.length)>0){const e=r().map(o,(e=>e.message));for(const n of e)re.Ay.error(n,2.5)}else a((()=>d())),re.Ay.success(n("resourcePolicy.SuccessfullyDeleted"));else re.Ay.error(null===e||void 0===e||null===(i=e.delete_project_resource_policy)||void 0===i?void 0:i.msg)},onError(e){re.Ay.error(null===e||void 0===e?void 0:e.message)}}))},children:(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(N.A,{style:{color:e.colorError}}),loading:R&&x===(null===l||void 0===l?void 0:l.name)+t,disabled:R&&x!==(null===l||void 0===l?void 0:l.name)+t})})]})}]),[K,w]=(0,E.A)("backendaiwebui.ProjectResourcePolicyList.displayedColumnKeys",{defaultValue:M.map((e=>r().toString(e.key)))});return(0,y.jsxs)(u.A,{direction:"column",align:"stretch",children:[(0,y.jsxs)(u.A,{direction:"row",justify:"between",wrap:"wrap",gap:"xs",style:{padding:e.paddingContentVertical,paddingLeft:e.paddingContentHorizontalSM,paddingRight:e.paddingContentHorizontalSM},children:[(0,y.jsx)(u.A,{direction:"column",align:"start",children:(0,y.jsx)(X.A,{menu:{items:[{key:"exportCSV",label:n("resourcePolicy.ExportCSV"),onClick:()=>{(()=>{if(!A)return void re.Ay.error(n("resourcePolicy.NoDataToExport"));const e=r().without(K,"control"),o=r().map(A,(n=>r().pick(n,e.map((e=>e)))));s(o,"project_resource_polices",{max_vfolder_count:e=>0===r().toNumber(e)?"-":e,max_quota_scope_size:e=>-1===e?"-":(0,i.wb)(e)})})()}}]},children:(0,y.jsx)(Q.Ay,{type:"link",style:{padding:0},onClick:e=>e.preventDefault(),children:(0,y.jsxs)(G.A,{style:{color:e.colorLinkHover},children:[n("resourcePolicy.Tools"),(0,y.jsx)(U.A,{})]})})})}),(0,y.jsx)(u.A,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:(0,y.jsxs)(u.A,{gap:"xs",children:[(0,y.jsx)(Q.Ay,{icon:(0,y.jsx)(D.A,{}),loading:l,onClick:()=>{a((()=>d()))}}),(0,y.jsx)(Q.Ay,{type:"primary",icon:(0,y.jsx)($.A,{}),onClick:()=>{v(!0)},children:n("button.Create")})]})})]}),(0,y.jsx)(W.A,{rowKey:"id",showSorterTooltip:!1,columns:r().filter(M,(e=>null===K||void 0===K?void 0:K.includes(r().toString(e.key)))),dataSource:A,scroll:{x:"max-content"},pagination:!1}),(0,y.jsx)(u.A,{justify:"end",style:{padding:e.paddingXXS},children:(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(O.A,{}),onClick:()=>{g(!0)}})}),(0,y.jsx)(V.A,{open:_,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&w(null===e||void 0===e?void 0:e.selectedColumnKeys),g(!1)},columns:M,displayedColumnKeys:K||[]}),(0,y.jsx)(le,{existingPolicyNames:r().map(A,"name"),open:!!h||m,projectResourcePolicyFrgmt:h||null,onRequestClose:e=>{e&&a((()=>d())),j(null),v(!1)}})]})};var ue,de,me;const pe=e=>{let{existingPolicyNames:n,userResourcePolicyFrgmt:l=null,onRequestClose:a,...t}=e;const{t:s}=(0,k.Bd)(),{token:d}=B.A.useToken(),{message:m}=S.A.useApp(),v=(0,p.useRef)(null),g=(0,c.CX)(),f=null===g||void 0===g?void 0:g.supports("max-vfolder-count-in-user-and-project-resource-policy"),j=null===g||void 0===g?void 0:g.supports("max-quota-scope-size"),P=null===g||void 0===g?void 0:g.supports("max-session-count-per-model-session"),b=null===g||void 0===g?void 0:g.supports("max-customized-image-count"),C=(0,F.useFragment)(void 0!==ue?ue:ue=o(4935),l),[R,M]=(0,F.useMutation)(void 0!==de?de:de=o(14908)),[w,L]=(0,F.useMutation)(void 0!==me?me:me=o(97662)),q=(0,p.useMemo)((()=>{let e={};null===C&&(e={max_vfolder_count:0,max_quota_scope_size:-1});let n=null===C||void 0===C?void 0:C.max_quota_scope_size;return n=r().isUndefined(n)||-1===n?-1:(0,i.wb)(n),{...e,...C,max_quota_scope_size:n}}),[C,null===C||void 0===C?void 0:C.max_vfolder_count,null===C||void 0===C?void 0:C.max_quota_scope_size]);return(0,y.jsxs)(_.A,{title:s(null===C?"resourcePolicy.CreateResourcePolicy":"resourcePolicy.UpdateResourcePolicy"),onOk:e=>{var n;return null===v||void 0===v||null===(n=v.current)||void 0===n?void 0:n.validateFields().then((e=>{const n={max_vfolder_count:(null===e||void 0===e?void 0:e.max_vfolder_count)||0,max_quota_scope_size:-1===(null===e||void 0===e?void 0:e.max_quota_scope_size)?-1:(0,i._S)(null===e||void 0===e?void 0:e.max_quota_scope_size),max_session_count_per_model_session:null===e||void 0===e?void 0:e.max_session_count_per_model_session,max_customized_image_count:null===e||void 0===e?void 0:e.max_customized_image_count};f||delete n.max_vfolder_count,j||delete n.max_quota_scope_size,P||delete n.max_session_count_per_model_session,b||delete n.max_customized_image_count,null===C?R({variables:{name:null===e||void 0===e?void 0:e.name,props:n},onCompleted(e,n){var o,l;null===e||void 0===e||null===(o=e.create_user_resource_policy)||void 0===o||!o.ok||n?(m.error(null===e||void 0===e||null===(l=e.create_user_resource_policy)||void 0===l?void 0:l.msg),a()):(m.success(s("storageHost.ResourcePolicySuccessfullyUpdated")),a(!0))},onError(e){m.error(null===e||void 0===e?void 0:e.message)}}):w({variables:{name:null===e||void 0===e?void 0:e.name,props:n},onCompleted(e,n){var o,l;null===e||void 0===e||null===(o=e.modify_user_resource_policy)||void 0===o||!o.ok||n?(m.error(null===e||void 0===e||null===(l=e.modify_user_resource_policy)||void 0===l?void 0:l.msg),a()):(m.success(s("storageHost.ResourcePolicySuccessfullyUpdated")),a(!0))},onError(e){m.error(null===e||void 0===e?void 0:e.message)}})})).catch((()=>{}))},onCancel:()=>a(),destroyOnClose:!0,confirmLoading:M||L,...t,children:[(0,y.jsx)(oe.A,{message:s("storageHost.BeCarefulToSetUserResourcePolicy"),type:"warning",showIcon:!0,style:{marginBottom:d.marginMD}}),(0,y.jsxs)(x.A,{ref:v,layout:"vertical",requiredMark:"optional",initialValues:q,preserve:!1,children:[(0,y.jsx)(x.A.Item,{label:s("resourcePolicy.Name"),name:"name",required:!0,rules:[{required:!0,message:s("data.explorer.ValueRequired")},{max:255},{validator:(e,o)=>!C&&null!==n&&void 0!==n&&n.includes(o)?Promise.reject(s("resourcePolicy.ResourcePolicyNameAlreadyExists")):Promise.resolve()}],children:(0,y.jsx)(A.A,{disabled:!!C})}),(0,y.jsxs)(u.A,{direction:"column",align:"stretch",gap:"md",style:{marginBottom:d.marginMD},children:[f?(0,y.jsx)(h,{name:"max_vfolder_count",unlimitedValue:0,label:s("resourcePolicy.MaxFolderCount"),style:{width:"100%",margin:0},children:(0,y.jsx)(K.A,{min:0,style:{width:"100%"}})}):null,j?(0,y.jsx)(h,{name:"max_quota_scope_size",unlimitedValue:-1,label:s("storageHost.MaxFolderSize"),style:{width:"100%",margin:0},children:(0,y.jsx)(K.A,{min:0,addonAfter:"GB",style:{width:"100%"}})}):null]}),P?(0,y.jsx)(x.A.Item,{name:"max_session_count_per_model_session",label:s("resourcePolicy.MaxSessionCountPerModelSession"),rules:[{required:!0,message:s("data.explorer.ValueRequired")}],children:(0,y.jsx)(K.A,{min:0,style:{width:"100%"}})}):null,b?(0,y.jsx)(x.A.Item,{name:"max_customized_image_count",label:s("resourcePolicy.MaxCustomizedImageCount"),rules:[{required:!0,message:s("data.explorer.ValueRequired")}],children:(0,y.jsx)(K.A,{min:0,style:{width:"100%"}})}):null]})]})};var ye,ve;const _e=()=>{const{token:e}=B.A.useToken(),{t:n}=(0,k.Bd)(),{message:l}=S.A.useApp(),[a,t]=(0,p.useTransition)(),[d,m]=(0,c.Tw)("initial-fetch"),[v,_]=(0,p.useState)(!1),[g,x]=(0,p.useState)(!1),[f,h]=(0,p.useState)(),[j,P]=(0,p.useState)(),b=(0,c.CX)(),A=null===b||void 0===b?void 0:b.supports("max-vfolder-count-in-user-and-project-resource-policy"),C=null===b||void 0===b?void 0:b.supports("max-quota-scope-size"),R=null===b||void 0===b?void 0:b.supports("max-session-count-per-model-session"),M=null===b||void 0===b?void 0:b.supports("max-customized-image-count"),{user_resource_policies:K}=(0,F.useLazyLoadQuery)(void 0!==ye?ye:ye=o(55242),{},{fetchPolicy:"initial-fetch"===d?"store-and-network":"network-only",fetchKey:d}),[w,L]=(0,F.useMutation)(void 0!==ve?ve:ve=o(61989)),q=(0,i.LY)([{title:n("resourcePolicy.Name"),dataIndex:"name",key:"name",fixed:"left",sorter:(e,n)=>(0,i._f)(null===e||void 0===e?void 0:e.name,null===n||void 0===n?void 0:n.name)},A&&{title:n("resourcePolicy.MaxVFolderCount"),dataIndex:"max_vfolder_count",key:"max_vfolder_count",render:e=>0===r().toNumber(e)?"\u221e":e,sorter:(e,n)=>(0,i.Oe)(null===e||void 0===e?void 0:e.max_vfolder_count,null===n||void 0===n?void 0:n.max_vfolder_count,0)},R&&{title:n("resourcePolicy.MaxSessionCountPerModelSession"),dataIndex:"max_session_count_per_model_session",key:"max_session_count_per_model_session",sorter:(e,n)=>{var o,l;return(null!==(o=null===e||void 0===e?void 0:e.max_session_count_per_model_session)&&void 0!==o?o:0)-(null!==(l=null===n||void 0===n?void 0:n.max_session_count_per_model_session)&&void 0!==l?l:0)}},C&&{title:n("resourcePolicy.MaxQuotaScopeSize"),dataIndex:"max_quota_scope_size",key:"max_quota_scope_size",render:e=>-1===e?"\u221e":(0,i.wb)(e),sorter:(e,n)=>(0,i.Oe)(null===e||void 0===e?void 0:e.max_quota_scope_size,null===n||void 0===n?void 0:n.max_quota_scope_size,-1)},M&&{title:n("resourcePolicy.MaxCustomizedImageCount"),key:"max_customized_image_count",dataIndex:"max_customized_image_count",sorter:(e,n)=>{var o,l;return(null!==(o=null===e||void 0===e?void 0:e.max_customized_image_count)&&void 0!==o?o:0)-(null!==(l=null===n||void 0===n?void 0:n.max_customized_image_count)&&void 0!==l?l:0)}},{title:"ID",dataIndex:"id",key:"id",sorter:(e,n)=>(0,i._f)(null===e||void 0===e?void 0:e.id,null===n||void 0===n?void 0:n.id)},{title:n("resourcePolicy.CreatedAt"),dataIndex:"created_at",key:"created_at",render:e=>se()(e).format("lll"),sorter:(e,n)=>(0,i._f)(null===e||void 0===e?void 0:e.created_at,null===n||void 0===n?void 0:n.created_at)},{title:n("general.Control"),fixed:"right",key:"control",render:(o,i)=>(0,y.jsxs)(u.A,{direction:"row",align:"stretch",children:[(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(O.A,{}),style:{color:e.colorInfo},onClick:()=>{P(i)}}),(0,y.jsx)(J.A,{title:n("dialog.ask.DoYouWantToProceed"),description:n("dialog.warning.CannotBeUndone"),okType:"danger",okText:n("button.Delete"),onConfirm:()=>{null!==i&&void 0!==i&&i.name&&(h(i.name+d),w({variables:{name:i.name},onCompleted:(e,o)=>{var i,a;if(null!==e&&void 0!==e&&null!==(i=e.delete_user_resource_policy)&&void 0!==i&&i.ok)if(o&&o.length>0){const e=o.map((e=>e.message));for(const n of e)l.error(n,2.5)}else t((()=>m())),l.success(n("resourcePolicy.SuccessfullyDeleted"));else l.error(null===e||void 0===e||null===(a=e.delete_user_resource_policy)||void 0===a?void 0:a.msg)},onError(e){l.error(null===e||void 0===e?void 0:e.message)}}))},children:(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(N.A,{style:{color:e.colorError}}),loading:L&&f===(null===i||void 0===i?void 0:i.name)+d,disabled:L&&f!==(null===i||void 0===i?void 0:i.name)+d})})]})}]),[z,I]=(0,E.A)("backendaiwebui.UserResourcePolicyList.displayedColumnKeys",{defaultValue:q.map((e=>r().toString(e.key)))});return(0,y.jsxs)(u.A,{direction:"column",align:"stretch",children:[(0,y.jsxs)(u.A,{direction:"row",justify:"between",wrap:"wrap",gap:"xs",style:{padding:e.paddingContentVertical,paddingLeft:e.paddingContentHorizontalSM,paddingRight:e.paddingContentHorizontalSM},children:[(0,y.jsx)(u.A,{direction:"column",align:"start",children:(0,y.jsx)(X.A,{menu:{items:[{key:"exportCSV",label:n("resourcePolicy.ExportCSV"),onClick:()=>{(()=>{if(!K||!z)return void l.error(n("resourcePolicy.NoDataToExport"));const e=r().without(z,"control"),o=r().map(K,(n=>r().pick(n,e.map((e=>e)))));s(o,"user-resource-policies",{max_vfolder_count:e=>0===r().toNumber(e)?"-":e,max_quota_scope_size:e=>-1===e?"-":(0,i.wb)(e)})})()}}]},children:(0,y.jsx)(Q.Ay,{type:"link",style:{padding:0},onClick:e=>e.preventDefault(),children:(0,y.jsxs)(G.A,{style:{color:e.colorLinkHover},children:[n("resourcePolicy.Tools"),(0,y.jsx)(U.A,{})]})})})}),(0,y.jsx)(u.A,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:(0,y.jsxs)(u.A,{gap:"xs",children:[(0,y.jsx)(Q.Ay,{icon:(0,y.jsx)(D.A,{}),loading:a,onClick:()=>{t((()=>m()))}}),(0,y.jsx)(Q.Ay,{type:"primary",icon:(0,y.jsx)($.A,{}),onClick:()=>{_(!0)},children:n("button.Create")})]})})]}),(0,y.jsx)(W.A,{rowKey:"id",showSorterTooltip:!1,columns:r().filter(q,(e=>null===z||void 0===z?void 0:z.includes(r().toString(e.key)))),dataSource:K,scroll:{x:"max-content"},pagination:!1}),(0,y.jsx)(u.A,{justify:"end",style:{padding:e.paddingXXS},children:(0,y.jsx)(Q.Ay,{type:"text",icon:(0,y.jsx)(O.A,{}),onClick:()=>{x(!0)}})}),(0,y.jsx)(V.A,{open:g,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&I(null===e||void 0===e?void 0:e.selectedColumnKeys),x(!1)},columns:q,displayedColumnKeys:z||[]}),(0,y.jsx)(pe,{existingPolicyNames:r().map(K,"name"),open:!!j||v,userResourcePolicyFrgmt:j||null,onRequestClose:e=>{e&&t((()=>m())),P(null),_(!1)}})]})};var ge=o(58346);const xe=(0,ge.withDefault)(ge.StringParam,"keypair"),fe=()=>{const{t:e}=(0,k.Bd)(),[n]=(0,ge.useQueryParam)("tab",xe),o=(0,c.f0)(),a=(0,c.CX)(),r=null===a||void 0===a?void 0:a.supports("configure-user-resource-policy");return(0,y.jsx)(C.A,{activeTabKey:n,onTabChange:e=>{o({pathname:"/resource-policy",search:`?tab=${e}`},{params:{tab:e}})},tabList:(0,i.LY)([{key:"keypair",label:e("resourcePolicy.Keypair")},r&&{key:"user",label:e("resourcePolicy.User")},{key:"project",label:e("resourcePolicy.Project")}]),styles:{body:{padding:0,paddingTop:1,overflow:"hidden"}},children:(0,y.jsxs)(p.Suspense,{fallback:(0,y.jsx)(l.A,{}),children:["keypair"===n&&(0,y.jsx)(Y,{}),"user"===n&&(0,y.jsx)(_e,{}),"project"===n&&(0,y.jsx)(ce,{})]})})}},59065:(e,n,o)=>{o.d(n,{A:()=>S});var l=o(76998),i=o(58736),a=o(34156),r=o.n(a),t=o(23551),s=o(19727),c=o(28037),u=o(20315),d=o(47917),m=o(8357),p=o(6932),y=o(50675),v=o(29457),_=o(41271),g=o(59395),x=o(6132);const f=(0,x.OF)("Popconfirm",(e=>(e=>{const{componentCls:n,iconCls:o,antCls:l,zIndexPopup:i,colorText:a,colorWarning:r,marginXXS:t,marginXS:s,fontSize:c,fontWeightStrong:u,colorTextHeading:d}=e;return{[n]:{zIndex:i,[`&${l}-popover`]:{fontSize:c},[`${n}-message`]:{marginBottom:s,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${n}-message-icon ${o}`]:{color:r,fontSize:c,lineHeight:1,marginInlineEnd:s},[`${n}-title`]:{fontWeight:u,color:d,"&:only-child":{fontWeight:"normal"}},[`${n}-description`]:{marginTop:t,color:a}},[`${n}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:s}}}}})(e)),(e=>{const{zIndexPopupBase:n}=e;return{zIndexPopup:n+60}}),{resetStyle:!1});var k=function(e,n){var o={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&n.indexOf(l)<0&&(o[l]=e[l]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(l=Object.getOwnPropertySymbols(e);i<l.length;i++)n.indexOf(l[i])<0&&Object.prototype.propertyIsEnumerable.call(e,l[i])&&(o[l[i]]=e[l[i]])}return o};const h=e=>{const{prefixCls:n,okButtonProps:o,cancelButtonProps:a,title:r,description:t,cancelText:s,okText:u,okType:g="primary",icon:x=l.createElement(i.A,null),showCancel:f=!0,close:k,onConfirm:h,onCancel:j,onPopupClick:P}=e,{getPrefixCls:b}=l.useContext(c.QO),[S]=(0,v.A)("Popconfirm",_.A.Popconfirm),A=(0,m.b)(r),C=(0,m.b)(t);return l.createElement("div",{className:`${n}-inner-content`,onClick:P},l.createElement("div",{className:`${n}-message`},x&&l.createElement("span",{className:`${n}-message-icon`},x),l.createElement("div",{className:`${n}-message-text`},A&&l.createElement("div",{className:`${n}-title`},A),C&&l.createElement("div",{className:`${n}-description`},C))),l.createElement("div",{className:`${n}-buttons`},f&&l.createElement(p.Ay,Object.assign({onClick:j,size:"small"},a),s||(null===S||void 0===S?void 0:S.cancelText)),l.createElement(d.A,{buttonProps:Object.assign(Object.assign({size:"small"},(0,y.DU)(g)),o),actionFn:h,close:k,prefixCls:b("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},u||(null===S||void 0===S?void 0:S.okText))))},j=e=>{const{prefixCls:n,placement:o,className:i,style:a}=e,t=k(e,["prefixCls","placement","className","style"]),{getPrefixCls:s}=l.useContext(c.QO),u=s("popconfirm",n),[d]=f(u);return d(l.createElement(g.Ay,{placement:o,className:r()(u,i),style:a,content:l.createElement(h,Object.assign({prefixCls:u},t))}))};var P=function(e,n){var o={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&n.indexOf(l)<0&&(o[l]=e[l]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(l=Object.getOwnPropertySymbols(e);i<l.length;i++)n.indexOf(l[i])<0&&Object.prototype.propertyIsEnumerable.call(e,l[i])&&(o[l[i]]=e[l[i]])}return o};const b=l.forwardRef(((e,n)=>{var o,a;const{prefixCls:d,placement:m="top",trigger:p="click",okType:y="primary",icon:v=l.createElement(i.A,null),children:_,overlayClassName:g,onOpenChange:x,onVisibleChange:k}=e,j=P(e,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange"]),{getPrefixCls:b}=l.useContext(c.QO),[S,A]=(0,t.A)(!1,{value:null!==(o=e.open)&&void 0!==o?o:e.visible,defaultValue:null!==(a=e.defaultOpen)&&void 0!==a?a:e.defaultVisible}),C=(e,n)=>{A(e,!0),null===k||void 0===k||k(e),null===x||void 0===x||x(e,n)},R=b("popconfirm",d),M=r()(R,g),[K]=f(R);return K(l.createElement(u.A,Object.assign({},(0,s.A)(j,["title"]),{trigger:p,placement:m,onOpenChange:(n,o)=>{const{disabled:l=!1}=e;l||C(n,o)},open:S,ref:n,overlayClassName:M,content:l.createElement(h,Object.assign({okType:y,icon:v},e,{prefixCls:R,close:e=>{C(!1,e)},onConfirm:n=>{var o;return null===(o=e.onConfirm)||void 0===o?void 0:o.call(void 0,n)},onCancel:n=>{var o;C(!1,n),null===(o=e.onCancel)||void 0===o||o.call(void 0,n)}})),"data-popover-inject":!0}),_))}));b._InternalPanelDoNotUseOrYouWillBeFired=j;const S=b}}]);
//# sourceMappingURL=8454.2aee9da9.chunk.js.map