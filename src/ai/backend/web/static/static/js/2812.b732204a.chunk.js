"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[2812],{39667:(e,o,n)=>{n.d(o,{A:()=>p});var l=n(58452),a=n(80310),i=n(59571),r=n(91564),t=n(86187),s=n(34132),u=n(27484),c=n.n(u),d=n(1426),m=n(9976),y=n(42906);const p=e=>{var o;let{open:n,onRequestClose:u,columns:p,hiddenColumnKeys:_,...g}=e;const v=(0,d.useRef)(null),{t:x}=(0,m.Bd)(),{token:f}=i.A.useToken(),k=c().map(p,(e=>{return"string"===typeof e.title?{label:e.title,value:c().toString(e.key)}:"object"===typeof e.title&&"props"in e.title?{label:(o=e.title,d.Children.map(o.props.children,(e=>{if("string"===typeof e)return e}))),value:c().toString(e.key)}:{label:void 0,value:c().toString(e.key)};var o}));return(0,y.jsx)(l.A,{title:x("table.SettingTable"),open:n,destroyOnClose:!0,centered:!0,onOk:()=>{var e;null===(e=v.current)||void 0===e||e.validateFields().then((e=>{u(e)})).catch((()=>{}))},onCancel:()=>{u()},...g,children:(0,y.jsxs)(r.A,{ref:v,preserve:!1,initialValues:{selectedColumnKeys:null===(o=c().map(k,"value"))||void 0===o?void 0:o.filter((e=>!c().includes(_,e)))},layout:"vertical",children:[(0,y.jsx)(r.A.Item,{name:"searchInput",label:x("table.SelectColumnToDisplay"),style:{marginBottom:0},children:(0,y.jsx)(t.A,{prefix:(0,y.jsx)(a.A,{}),style:{marginBottom:f.marginSM},placeholder:x("table.SearchTableColumn")})}),(0,y.jsx)(r.A.Item,{noStyle:!0,shouldUpdate:(e,o)=>e.searchInput!==o.searchInput,children:e=>{let{getFieldValue:o}=e;const n=o("searchInput")?c().toLower(o("searchInput")):void 0,l=c().map(k,(e=>c().toLower(c().toString(e.label)).includes(n||"")?e:{...e,style:{display:"none"}}));return(0,y.jsx)(r.A.Item,{name:"selectedColumnKeys",style:{height:220,overflowY:"auto"},children:(0,y.jsx)(s.A.Group,{options:l,style:{flexDirection:"column"}})})}})]})})}},77156:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"DeleteKeyPairResourcePolicy",kind:"LinkedField",name:"delete_keypair_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairResourcePolicyListMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairResourcePolicyListMutation",selections:o},params:{cacheID:"fe182323e364c317f26c7193239af22b",id:null,metadata:{},name:"KeypairResourcePolicyListMutation",operationKind:"mutation",text:"mutation KeypairResourcePolicyListMutation(\n  $name: String!\n) {\n  delete_keypair_resource_policy(name: $name) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="5771729a12a204d27a9cdf5ad31e707f";const a=l},59545:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"total_resource_slots",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"max_session_lifetime",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"max_concurrent_sessions",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"max_containers_per_session",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"idle_timeout",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"allowed_vfolder_hosts",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"KeypairResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policies",plural:!0,selections:[e,o,n,l,a,i,r,{args:null,kind:"FragmentSpread",name:"KeypairResourcePolicySettingModalFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"KeypairResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"KeyPairResourcePolicy",kind:"LinkedField",name:"keypair_resource_policies",plural:!0,selections:[e,o,n,l,a,i,r,{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null}],storageKey:null}]},params:{cacheID:"05cd0ba2e87295be2064be1b38441faf",id:null,metadata:{},name:"KeypairResourcePolicyListQuery",operationKind:"query",text:'query KeypairResourcePolicyListQuery {\n  keypair_resource_policies {\n    name\n    total_resource_slots\n    max_session_lifetime\n    max_concurrent_sessions\n    max_containers_per_session\n    idle_timeout\n    allowed_vfolder_hosts\n    ...KeypairResourcePolicySettingModalFragment\n  }\n}\n\nfragment KeypairResourcePolicySettingModalFragment on KeyPairResourcePolicy {\n  name\n  total_resource_slots\n  max_session_lifetime\n  max_concurrent_sessions\n  max_containers_per_session\n  idle_timeout\n  allowed_vfolder_hosts\n  max_vfolder_count @deprecatedSince(version: "23.09.4")\n}\n'}}}();l.hash="86e382131325a58294cf015618b4920b";const a=l},84953:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateKeyPairResourcePolicy",kind:"LinkedField",name:"create_keypair_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairResourcePolicySettingModalCreateMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairResourcePolicySettingModalCreateMutation",selections:o},params:{cacheID:"b52e3e869ccfabb393fb45a48074767e",id:null,metadata:{},name:"KeypairResourcePolicySettingModalCreateMutation",operationKind:"mutation",text:"mutation KeypairResourcePolicySettingModalCreateMutation(\n  $name: String!\n  $props: CreateKeyPairResourcePolicyInput!\n) {\n  create_keypair_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="7c4c5be505f02fa76e7b4db73a1f4b14";const a=l},55990:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"KeypairResourcePolicySettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total_resource_slots",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_session_lifetime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_concurrent_sessions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_containers_per_session",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"idle_timeout",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowed_vfolder_hosts",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null}],type:"KeyPairResourcePolicy",abstractKey:null,hash:"57d4c7b215e0e5dda0632124129e0895"},a=l},79068:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyKeyPairResourcePolicy",kind:"LinkedField",name:"modify_keypair_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"KeypairResourcePolicySettingModalModifyMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"KeypairResourcePolicySettingModalModifyMutation",selections:o},params:{cacheID:"72be648e07857dd6923d7c81f3f19948",id:null,metadata:{},name:"KeypairResourcePolicySettingModalModifyMutation",operationKind:"mutation",text:"mutation KeypairResourcePolicySettingModalModifyMutation(\n  $name: String!\n  $props: ModifyKeyPairResourcePolicyInput!\n) {\n  modify_keypair_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="8c99c8be8781f93fed817a67c86ea966";const a=l},41870:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"DeleteProjectResourcePolicy",kind:"LinkedField",name:"delete_project_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ProjectResourcePolicyListMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ProjectResourcePolicyListMutation",selections:o},params:{cacheID:"9f1218faa2207eff18f5a145f12f87ac",id:null,metadata:{},name:"ProjectResourcePolicyListMutation",operationKind:"mutation",text:"mutation ProjectResourcePolicyListMutation(\n  $name: String!\n) {\n  delete_project_resource_policy(name: $name) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="2c5a20c6c463174bbfc726a27cdfdcac";const a=l},78211:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"max_network_count",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"ProjectResourcePolicy",kind:"LinkedField",name:"project_resource_policies",plural:!0,selections:[e,o,n,l,a,i,{args:null,kind:"FragmentSpread",name:"ProjectResourcePolicySettingModalFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ProjectResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"ProjectResourcePolicy",kind:"LinkedField",name:"project_resource_policies",plural:!0,selections:[e,o,n,l,a,i],storageKey:null}]},params:{cacheID:"6aea9773e50cdfa81562c7a8322c8faa",id:null,metadata:{},name:"ProjectResourcePolicyListQuery",operationKind:"query",text:'query ProjectResourcePolicyListQuery {\n  project_resource_policies {\n    id\n    name\n    created_at\n    max_vfolder_count @since(version: "23.09.6")\n    max_quota_scope_size @since(version: "23.09.2")\n    max_network_count @since(version: "24.12.0")\n    ...ProjectResourcePolicySettingModalFragment\n  }\n}\n\nfragment ProjectResourcePolicySettingModalFragment on ProjectResourcePolicy {\n  id\n  name\n  created_at\n  max_vfolder_count @since(version: "23.09.6")\n  max_quota_scope_size @since(version: "23.09.2")\n  max_network_count @since(version: "24.12.0")\n}\n'}}}();l.hash="4c7451b05822ee2f8c5e2c8d35ed57db";const a=l},91247:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateProjectResourcePolicy",kind:"LinkedField",name:"create_project_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ProjectResourcePolicySettingModalCreateMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ProjectResourcePolicySettingModalCreateMutation",selections:o},params:{cacheID:"b94d7a4b8e8341df4e396784abba4203",id:null,metadata:{},name:"ProjectResourcePolicySettingModalCreateMutation",operationKind:"mutation",text:"mutation ProjectResourcePolicySettingModalCreateMutation(\n  $name: String!\n  $props: CreateProjectResourcePolicyInput!\n) {\n  create_project_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="c0683608e8a527146563ba5bd9fcad33";const a=l},78212:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectResourcePolicySettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_network_count",storageKey:null}],type:"ProjectResourcePolicy",abstractKey:null,hash:"949f6a93198024700bf15197f3b613f0"},a=l},81453:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyProjectResourcePolicy",kind:"LinkedField",name:"modify_project_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"ProjectResourcePolicySettingModalModifyMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"ProjectResourcePolicySettingModalModifyMutation",selections:o},params:{cacheID:"aedc4eab77206f7ab189ccd3f2d938b3",id:null,metadata:{},name:"ProjectResourcePolicySettingModalModifyMutation",operationKind:"mutation",text:"mutation ProjectResourcePolicySettingModalModifyMutation(\n  $name: String!\n  $props: ModifyProjectResourcePolicyInput!\n) {\n  modify_project_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="3cd62195489eba58dd9693f1fc9df8ff";const a=l},60656:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"}],concreteType:"DeleteUserResourcePolicy",kind:"LinkedField",name:"delete_user_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserResourcePolicyListMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserResourcePolicyListMutation",selections:o},params:{cacheID:"7be7fa4bc2e6ce7666489318e415d769",id:null,metadata:{},name:"UserResourcePolicyListMutation",operationKind:"mutation",text:"mutation UserResourcePolicyListMutation(\n  $name: String!\n) {\n  delete_user_resource_policy(name: $name) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="5b565e4db37c96850ac85a92cd4e0290";const a=l},90413:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"created_at",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"max_session_count_per_model_session",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"max_customized_image_count",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"UserResourcePolicy",kind:"LinkedField",name:"user_resource_policies",plural:!0,selections:[e,o,n,l,a,i,r,{args:null,kind:"FragmentSpread",name:"UserResourcePolicySettingModalFragment"}],storageKey:null}],type:"Queries",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserResourcePolicyListQuery",selections:[{alias:null,args:null,concreteType:"UserResourcePolicy",kind:"LinkedField",name:"user_resource_policies",plural:!0,selections:[e,o,n,l,a,i,r],storageKey:null}]},params:{cacheID:"00b0583474f74c417b06d53115787d3b",id:null,metadata:{},name:"UserResourcePolicyListQuery",operationKind:"query",text:'query UserResourcePolicyListQuery {\n  user_resource_policies {\n    id\n    name\n    created_at\n    max_vfolder_count @since(version: "23.09.6")\n    max_session_count_per_model_session @since(version: "23.09.10")\n    max_quota_scope_size @since(version: "23.09.2")\n    max_customized_image_count @since(version: "24.03.0")\n    ...UserResourcePolicySettingModalFragment\n  }\n}\n\nfragment UserResourcePolicySettingModalFragment on UserResourcePolicy {\n  id\n  name\n  max_vfolder_count @since(version: "23.09.6")\n  max_session_count_per_model_session @since(version: "23.09.10")\n  max_quota_scope_size @since(version: "23.09.2")\n  max_customized_image_count @since(version: "24.03.0")\n}\n'}}}();l.hash="be57da0a1c15efb970cb1e828500e6dc";const a=l},12565:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"CreateUserResourcePolicy",kind:"LinkedField",name:"create_user_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserResourcePolicySettingModalCreateMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserResourcePolicySettingModalCreateMutation",selections:o},params:{cacheID:"129c4a570d8ae1a075d9aa9261094c48",id:null,metadata:{},name:"UserResourcePolicySettingModalCreateMutation",operationKind:"mutation",text:"mutation UserResourcePolicySettingModalCreateMutation(\n  $name: String!\n  $props: CreateUserResourcePolicyInput!\n) {\n  create_user_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="9c00928ca86d4779838243df247257aa";const a=l},17402:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserResourcePolicySettingModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_vfolder_count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_session_count_per_model_session",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_quota_scope_size",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max_customized_image_count",storageKey:null}],type:"UserResourcePolicy",abstractKey:null,hash:"d93790c2b9fef92baa6999ce770cd9da"},a=l},96083:(e,o,n)=>{n.r(o),n.d(o,{default:()=>a});const l=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"name"},{defaultValue:null,kind:"LocalArgument",name:"props"}],o=[{alias:null,args:[{kind:"Variable",name:"name",variableName:"name"},{kind:"Variable",name:"props",variableName:"props"}],concreteType:"ModifyUserResourcePolicy",kind:"LinkedField",name:"modify_user_resource_policy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"ok",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"msg",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"UserResourcePolicySettingModalModifyMutation",selections:o,type:"Mutations",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"UserResourcePolicySettingModalModifyMutation",selections:o},params:{cacheID:"f33ed379f4871e357183803b340a938a",id:null,metadata:{},name:"UserResourcePolicySettingModalModifyMutation",operationKind:"mutation",text:"mutation UserResourcePolicySettingModalModifyMutation(\n  $name: String!\n  $props: ModifyUserResourcePolicyInput!\n) {\n  modify_user_resource_policy(name: $name, props: $props) {\n    ok\n    msg\n  }\n}\n"}}}();l.hash="d50cbcfb63bfd30da81fea8968bb6436";const a=l},60696:(e,o,n)=>{n.d(o,{RM:()=>t,WN:()=>r});var l=n(27484),a=n.n(l);function i(e){return null===e||void 0===e?"":"number"===typeof e||"boolean"===typeof e?String(e):`"${(e=a().isString(e)?e:JSON.stringify(e)).replace(/"/g,'""')}"`}const r=(e,o)=>{const n=URL.createObjectURL(e),l=document.createElement("a");l.href=n,l.download=o,l.click(),URL.revokeObjectURL(n)},t=(e,o,n)=>{const l=((e,o)=>{const n=a().map(e,(e=>a().omit(e,"__fragments","__fragmentOwner","__id"))),l=a().keys(n[0]),r=a().map(n,(e=>a().map(e,((e,n)=>{var l;return null!==o&&void 0!==o&&o[n]&&(null===(l=o[n])||void 0===l?void 0:l.call(o,e))||e})))).map((e=>e.map(i).join(","))).join("\n");return[l.map(i).join(","),r].join("\n")})(e,n),t=new Blob([l],{type:"text/csv"});r(t,`${o}.csv`)}},50738:(e,o,n)=>{n.d(o,{a:()=>a});var l=n(46606);const a=e=>{const[o,n]=(0,l.q)(`hiddenColumnKeys.${e}`);return[o,n]}},431:(e,o,n)=>{n.r(o),n.d(o,{default:()=>xe});var l=n(48248),a=n(75045),i=n(86387),r=n(60696),t=n(32967),s=n(50738),u=n(90840),c=n(88653),d=n(88961),m=n(27484),y=n.n(m),p=n(1426),_=n(42906);const g=e=>{let{...o}=e;const n=(0,c._V)();return(0,_.jsx)(d.A,{...o,children:y().map(n,(e=>(0,_.jsx)(d.A.Option,{value:e,children:e},e)))})};var v=n(58452),x=n(15161),f=n(91564),k=n(34132),P=n(9976);const h=e=>{let{name:o,unlimitedValue:n,children:l,...a}=e;const{t:i}=(0,P.Bd)(),[r,t]=(0,p.useState)(!1),s=f.A.useFormInstance();(0,p.useEffect)((()=>{const e=s.getFieldValue(o);t(e===n)}),[s,o,n]);const c=(0,p.isValidElement)(l)?(0,p.cloneElement)(l,{disabled:r}):l,d=r&&(0,p.isValidElement)(l)?(0,p.cloneElement)(l,{value:null,disabled:r}):null;return(0,_.jsxs)(u.A,{direction:"column",align:"start",children:[(0,_.jsx)(f.A.Item,{style:{margin:0},name:o,hidden:r,...a,children:c}),r?(0,_.jsx)(f.A.Item,{style:{margin:0},...a,children:d}):null,(0,_.jsx)(k.A,{checked:r,onChange:e=>{const l=e.target.checked;t(l),l?s.setFieldValue(o,n):s.resetFields([o])},children:i("resourcePolicy.Unlimited")})]})};var j,S,b,A=n(59571),R=n(73552),C=n(86187),M=n(14287),K=n(76880),F=n(46098),w=n(44389),L=n(18347);const q=e=>{let{existingPolicyNames:o,keypairResourcePolicyFrgmt:l=null,onRequestClose:r,...s}=e;const{t:u}=(0,P.Bd)(),{token:d}=A.A.useToken(),{message:m}=R.A.useApp(),k=(0,p.useRef)(null),[q]=(0,c.bL)(),{mergedResourceSlots:I}=(0,c.Hv)(),z=(0,t.CX)(),V=null===z||void 0===z?void 0:z.supports("deprecated-max-vfolder-count-in-keypair-resource-policy"),D=(0,L.useFragment)(void 0!==j?j:j=n(55990),l),[T,N]=(0,L.useMutation)(void 0!==S?S:S=n(84953)),[U,E]=(0,L.useMutation)(void 0!==b?b:b=n(79068)),O=(0,p.useMemo)((()=>{const e=JSON.parse((null===D||void 0===D?void 0:D.total_resource_slots)||"{}");var o;null!==e&&void 0!==e&&e.mem&&(e.mem=null===(o=(0,a.Is)((null===e||void 0===e?void 0:e.mem)+"b","g",2,!0))||void 0===o?void 0:o.numberUnit);let n={};return null===D&&(n={max_session_lifetime:0,max_concurrent_sessions:i.zf,max_containers_per_session:i.o2,idle_timeout:0}),{parsedTotalResourceSlots:e,allowedVfolderHostNames:y().keys(JSON.parse((null===D||void 0===D?void 0:D.allowed_vfolder_hosts)||"{}")),...n,...D}}),[D,null===D||void 0===D?void 0:D.total_resource_slots,null===D||void 0===D?void 0:D.allowed_vfolder_hosts]);return(0,_.jsx)(v.A,{title:u(null===D?"resourcePolicy.CreateResourcePolicy":"resourcePolicy.UpdateResourcePolicy"),onOk:()=>{var e;return null===k||void 0===k||null===(e=k.current)||void 0===e?void 0:e.validateFields().then((e=>{let o=y().mapValues(null===e||void 0===e?void 0:e.parsedTotalResourceSlots,((e,o)=>{var n;return y().includes(o,"mem")?null===(n=(0,a.Is)(e,"b",0))||void 0===n?void 0:n.numberFixed:e}));o=y().pickBy(o,y().negate(y().isUndefined));const n=D?JSON.parse(D.allowed_vfolder_hosts||"{}"):{},l=y().fromPairs(y().map(e.allowedVfolderHostNames,(e=>[e,y().get(n,e,[])]))),i={default_for_unspecified:"UNLIMITED",total_resource_slots:JSON.stringify(o||"{}"),max_session_lifetime:null===e||void 0===e?void 0:e.max_session_lifetime,max_concurrent_sessions:null===e||void 0===e?void 0:e.max_concurrent_sessions,max_containers_per_session:null===e||void 0===e?void 0:e.max_containers_per_session,idle_timeout:null===e||void 0===e?void 0:e.idle_timeout,allowed_vfolder_hosts:JSON.stringify(l||"{}")};V||(i.max_vfolder_count=null===e||void 0===e?void 0:e.max_vfolder_count),null===D?T({variables:{name:null===e||void 0===e?void 0:e.name,props:i},onCompleted:(e,o)=>{var n,l;return null!==e&&void 0!==e&&null!==(n=e.create_keypair_resource_policy)&&void 0!==n&&n.ok||null===(l=e.create_keypair_resource_policy)||void 0===l||!l.msg?o&&o.length>0?(o.forEach((e=>m.error(e.message,2.5))),void r(!1)):(m.success(u("resourcePolicy.SuccessfullyCreated")),void r(!0)):(m.error(e.create_keypair_resource_policy.msg),void r(!1))},onError(e){m.error((null===e||void 0===e?void 0:e.message)||u("resourcePolicy.CannotCreateResourcePolicy"))}}):U({variables:{name:null===e||void 0===e?void 0:e.name,props:i},onCompleted:(e,o)=>{var n,l;return null!==e&&void 0!==e&&null!==(n=e.modify_keypair_resource_policy)&&void 0!==n&&n.ok||null===(l=e.modify_keypair_resource_policy)||void 0===l||!l.msg?o&&o.length>0?(o.forEach((e=>m.error(e.message,2.5))),void r(!1)):(m.success(u("resourcePolicy.SuccessfullyUpdated")),void r(!0)):(m.error(e.modify_keypair_resource_policy.msg),void r(!1))},onError(e){m.error((null===e||void 0===e?void 0:e.message)||u("resourcePolicy.CannotUpdateResourcePolicy"))}})})).catch((()=>{}))},onCancel:()=>r(),destroyOnClose:!0,confirmLoading:N||E,...s,children:(0,_.jsxs)(f.A,{ref:k,layout:"vertical",requiredMark:"optional",initialValues:O,preserve:!1,children:[(0,_.jsx)(f.A.Item,{label:u("resourcePolicy.Name"),name:"name",required:!0,rules:[{required:!0,message:u("data.explorer.ValueRequired")},{max:64},{validator:(e,n)=>!D&&null!==o&&void 0!==o&&o.includes(n)?Promise.reject(u("resourcePolicy.ResourcePolicyNameAlreadyExists")):Promise.resolve()}],children:(0,_.jsx)(C.A,{disabled:!!D})}),(0,_.jsx)(f.A.Item,{label:u("resourcePolicy.ResourcePolicy"),required:!0,children:(0,_.jsx)(M.A,{styles:{body:{paddingBottom:0}},children:y().chain(q).keys().chunk(2).map(((e,o)=>(0,_.jsx)(K.A,{gutter:[16,16],children:y().map(e,(e=>{var o,n;return(0,_.jsx)(F.A,{span:12,style:{alignSelf:"end",marginBottom:d.marginLG},children:(0,_.jsx)(h,{unlimitedValue:void 0,label:(null===(o=y().get(I,e))||void 0===o?void 0:o.description)||e,name:["parsedTotalResourceSlots",e],rules:[{validator:(o,n)=>y().includes(e,"mem")&&n&&(0,a.Is)(n,"p").number>(0,a.Is)("300p","p").number?Promise.reject(new Error(u("resourcePolicy.MemorySizeExceedsLimit"))):Promise.resolve()}],children:y().includes(e,"mem")?(0,_.jsx)(x.A,{}):(0,_.jsx)(w.A,{min:0,max:i.d7,step:y().includes(e,".shares")?.1:1,addonAfter:null===(n=y().get(I,e))||void 0===n?void 0:n.display_unit})})},e)}))},o))).value()})}),(0,_.jsx)(f.A.Item,{label:u("resourcePolicy.Sessions"),required:!0,children:(0,_.jsxs)(M.A,{styles:{body:{paddingBottom:0}},children:[(0,_.jsxs)(K.A,{gutter:16,children:[(0,_.jsx)(F.A,{span:12,style:{alignSelf:"end",marginBottom:d.marginLG},children:(0,_.jsx)(h,{name:"max_containers_per_session",unlimitedValue:i.zf,label:u("resourcePolicy.ContainerPerSession"),children:(0,_.jsx)(w.A,{min:0,max:100,style:{width:"100%"}})})}),(0,_.jsx)(F.A,{span:12,style:{alignSelf:"end",marginBottom:d.marginLG},children:(0,_.jsx)(h,{name:"max_session_lifetime",unlimitedValue:0,label:u("resourcePolicy.MaxSessionLifetime"),children:(0,_.jsx)(w.A,{min:0,max:100,style:{width:"100%"}})})})]}),(0,_.jsxs)(K.A,{gutter:16,children:[(0,_.jsx)(F.A,{span:12,style:{alignSelf:"end",marginBottom:d.marginLG},children:(0,_.jsx)(h,{name:"max_concurrent_sessions",unlimitedValue:i.o2,label:u("resourcePolicy.ConcurrentJobs"),children:(0,_.jsx)(w.A,{min:0,max:100,style:{width:"100%"}})})}),(0,_.jsx)(F.A,{span:12,style:{alignSelf:"end",marginBottom:d.marginLG},children:(0,_.jsx)(h,{name:"idle_timeout",unlimitedValue:0,label:u("resourcePolicy.IdleTimeoutSec"),children:(0,_.jsx)(w.A,{min:0,max:15552e3,style:{width:"100%"}})})})]})]})}),(0,_.jsx)(f.A.Item,{label:u("resourcePolicy.Folders"),required:!0,children:(0,_.jsxs)(M.A,{children:[(0,_.jsx)(f.A.Item,{label:u("resourcePolicy.AllowedHosts"),name:"allowedVfolderHostNames",children:(0,_.jsx)(g,{mode:"multiple"})}),V?void 0:(0,_.jsx)(f.A.Item,{label:u("credential.Max#"),name:"max_vfolder_count",children:(0,_.jsx)(w.A,{min:0,max:50})})]})})]})})};var I,z,V=n(4525),D=n(39667),T=n(59706),N=n(46841),U=n(41735),E=n(45554),O=n(39651),$=n(67884),B=n(20447),H=n(64181),Q=n(10878),X=n(20818),J=n(77036),G=n(19384);const Y=e=>{var o;const{token:l}=A.A.useToken(),{t:c}=(0,P.Bd)(),{message:d}=R.A.useApp(),[m,g]=(0,t.Tw)("initial-fetch"),[v,x]=(0,p.useTransition)(),[f,{toggle:k}]=(0,$.A)(),[h,j]=(0,p.useState)(!1),[S,b]=(0,p.useState)(),[C,M]=(0,p.useState)(),K=(0,t.CX)(),F=null!==(o=null===K||void 0===K?void 0:K.supports("fine-grained-storage-permissions"))&&void 0!==o&&o,{keypair_resource_policies:w}=(0,L.useLazyLoadQuery)(void 0!==I?I:I=n(59545),{},{fetchPolicy:"initial-fetch"===m?"store-and-network":"network-only",fetchKey:m}),[Y,W]=(0,L.useMutation)(void 0!==z?z:z=n(77156)),Z=[{title:c("resourcePolicy.Name"),dataIndex:"name",key:"name",fixed:"left",sorter:(e,o)=>(0,a._f)(null===e||void 0===e?void 0:e.name,null===o||void 0===o?void 0:o.name)},{title:c("resourcePolicy.Resources"),dataIndex:"total_resource_slots",key:"total_resource_slots",render:(e,o)=>(0,_.jsx)(u.A,{gap:"xxs",children:y().isEmpty(JSON.parse((null===o||void 0===o?void 0:o.total_resource_slots)||"{}"))?"-":y().map(JSON.parse((null===o||void 0===o?void 0:o.total_resource_slots)||"{}"),((e,o)=>(0,_.jsx)(V.A,{type:o,value:y().toString(e)},o)))})},{title:c("resourcePolicy.Concurrency"),dataIndex:"max_concurrent_sessions",key:"max_concurrent_sessions",sorter:(e,o)=>null!==e&&void 0!==e&&e.max_concurrent_sessions&&null!==o&&void 0!==o&&o.max_concurrent_sessions?e.max_concurrent_sessions-o.max_concurrent_sessions:1,render:e=>e===i.zf?"\u221e":e},{title:c("resourcePolicy.ClusterSize"),dataIndex:"max_containers_per_session",key:"max_containers_per_session",sorter:(e,o)=>null!==e&&void 0!==e&&e.max_containers_per_session&&null!==o&&void 0!==o&&o.max_containers_per_session?e.max_containers_per_session-o.max_containers_per_session:1,render:e=>e===i.o2?"\u221e":e},{title:c("resourcePolicy.IdleTimeout"),dataIndex:"idle_timeout",key:"idle_timeout",sorter:(e,o)=>null!==e&&void 0!==e&&e.idle_timeout&&null!==o&&void 0!==o&&o.idle_timeout?e.idle_timeout-o.idle_timeout:1,render:e=>e||"\u221e"},{title:c("session.MaxSessionLifetime"),dataIndex:"max_session_lifetime",key:"max_session_lifetime",sorter:(e,o)=>(0,a.Oe)(null===e||void 0===e?void 0:e.max_session_lifetime,null===o||void 0===o?void 0:o.max_session_lifetime,0),render:e=>e||"\u221e"},{title:c("resourcePolicy.StorageNodes"),dataIndex:"allowed_vfolder_hosts",key:"allowed_vfolder_hosts",render:(e,o)=>{const n=F?y().keys(JSON.parse((null===o||void 0===o?void 0:o.allowed_vfolder_hosts)||"{}")):JSON.parse((null===o||void 0===o?void 0:o.allowed_vfolder_hosts)||"{}");return(0,_.jsx)(_.Fragment,{children:y().map(n,(e=>(0,_.jsx)(B.A,{children:e},e)))})}},{title:c("general.Control"),key:"control",fixed:"right",render:(e,o)=>(0,_.jsxs)(u.A,{direction:"row",align:"stretch",children:[(0,_.jsx)(H.Ay,{type:"text",size:"large",icon:(0,_.jsx)(T.A,{}),style:{color:l.colorInfo},onClick:()=>{M(o)}}),(0,_.jsx)(Q.A,{title:c("dialog.ask.DoYouWantToProceed"),description:c("dialog.warning.CannotBeUndone"),okType:"danger",okText:c("button.Delete"),onConfirm:()=>{null!==o&&void 0!==o&&o.name&&(b(o.name+m),Y({variables:{name:o.name},onCompleted:(e,o)=>{var n,l;if(null!==e&&void 0!==e&&null!==(n=e.delete_keypair_resource_policy)&&void 0!==n&&n.ok)if(o&&(null===o||void 0===o?void 0:o.length)>0){const e=y().map(o,(e=>e.message));for(const o of e)d.error(o,2.5)}else x((()=>g())),d.success(c("resourcePolicy.SuccessfullyDeleted"));else d.error(null===e||void 0===e||null===(l=e.delete_keypair_resource_policy)||void 0===l?void 0:l.msg)},onError(e){d.error(null===e||void 0===e?void 0:e.message)}}))},children:(0,_.jsx)(H.Ay,{type:"text",size:"large",icon:(0,_.jsx)(N.A,{style:{color:l.colorError}}),loading:W&&S===(null===o||void 0===o?void 0:o.name)+m,disabled:W&&S!==(null===o||void 0===o?void 0:o.name)+m})})]})}],[ee,oe]=(0,s.a)("KeypairResourcePolicyList");return(0,_.jsxs)(u.A,{direction:"column",align:"stretch",children:[(0,_.jsxs)(u.A,{direction:"row",justify:"between",wrap:"wrap",gap:"xs",style:{padding:l.paddingContentVertical,paddingLeft:l.paddingContentHorizontalSM,paddingRight:l.paddingContentHorizontalSM},children:[(0,_.jsx)(u.A,{direction:"column",align:"start",children:(0,_.jsx)(X.A,{menu:{items:[{key:"exportCSV",label:c("resourcePolicy.ExportCSV"),onClick:()=>{(()=>{if(!w)return void d.error(c("resourcePolicy.NoDataToExport"));const e=y().without(y().map(Z,(e=>y().toString(e.key))),"control"),o=y().map(w,(o=>y().pick(o,e.map((e=>e)))));(0,r.RM)(o,"keypair_resource_policies",{total_resource_slots:e=>y().isEmpty(e)?"-":JSON.stringify(e),max_concurrent_sessions:e=>e===i.zf?"-":e,max_containers_per_session:e=>e===i.o2?"-":e,idle_timeout:e=>e||"-",max_session_lifetime:e=>e||"-",allowed_vfolder_hosts:e=>y().isEmpty(e)?"-":y().keys(JSON.parse(e)).join(", ")})})()}}]},children:(0,_.jsx)(H.Ay,{type:"link",style:{padding:0},onClick:e=>e.preventDefault(),children:(0,_.jsxs)(J.A,{style:{color:l.colorLinkHover},children:[c("resourcePolicy.Tools"),(0,_.jsx)(U.A,{})]})})})}),(0,_.jsx)(u.A,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:(0,_.jsxs)(u.A,{gap:"xs",children:[(0,_.jsx)(H.Ay,{icon:(0,_.jsx)(E.A,{}),loading:v,onClick:()=>{x((()=>g()))}}),(0,_.jsx)(H.Ay,{type:"primary",icon:(0,_.jsx)(O.A,{}),onClick:()=>{j(!0)},children:c("button.Create")})]})})]}),(0,_.jsx)(G.A,{columns:y().filter(Z,(e=>!y().includes(ee,y().toString(null===e||void 0===e?void 0:e.key)))),dataSource:w,rowKey:"name",scroll:{x:"max-content"},pagination:!1,showSorterTooltip:!1}),(0,_.jsx)(u.A,{justify:"end",style:{padding:l.paddingXXS},children:(0,_.jsx)(H.Ay,{type:"text",icon:(0,_.jsx)(T.A,{}),onClick:()=>{k()}})}),(0,_.jsx)(D.A,{open:f,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&oe(y().difference(Z.map((e=>y().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),k()},columns:Z,hiddenColumnKeys:ee}),(0,_.jsx)(p.Suspense,{children:(0,_.jsx)(q,{existingPolicyNames:y().map(w,(e=>(null===e||void 0===e?void 0:e.name)||"")),open:!!C||h,keypairResourcePolicyFrgmt:C||null,onRequestClose:e=>{M(null),j(!1),e&&x((()=>{g()}))}})})]})};var W,Z,ee,oe=n(4800);const ne=e=>{let{existingPolicyNames:o,projectResourcePolicyFrgmt:l=null,onRequestClose:r,...s}=e;const{t:c}=(0,P.Bd)(),{token:d}=A.A.useToken(),{message:m}=R.A.useApp(),g=(0,p.useRef)(null),x=(0,t.CX)(),k=null===x||void 0===x?void 0:x.supports("max-vfolder-count-in-user-and-project-resource-policy"),j=null===x||void 0===x?void 0:x.supports("max-quota-scope-size"),S=null===x||void 0===x?void 0:x.supports("max_network_count"),b=(0,L.useFragment)(void 0!==W?W:W=n(78212),l),[M,K]=(0,L.useMutation)(void 0!==Z?Z:Z=n(91247)),[F,q]=(0,L.useMutation)(void 0!==ee?ee:ee=n(81453)),I=(0,p.useMemo)((()=>{let e={};null===b&&(e={max_vfolder_count:0,max_quota_scope_size:-1,max_network_count:-1});let o=null===b||void 0===b?void 0:b.max_quota_scope_size;return o=y().isUndefined(o)||-1===o?-1:(0,a.wb)(o),{...e,...b,max_quota_scope_size:o}}),[b,null===b||void 0===b?void 0:b.max_vfolder_count,null===b||void 0===b?void 0:b.max_quota_scope_size]);return(0,_.jsxs)(v.A,{title:c(null===b?"resourcePolicy.CreateResourcePolicy":"resourcePolicy.UpdateResourcePolicy"),onOk:e=>{var o;return null===g||void 0===g||null===(o=g.current)||void 0===o?void 0:o.validateFields().then((e=>{const o={max_vfolder_count:(null===e||void 0===e?void 0:e.max_vfolder_count)||0,max_quota_scope_size:-1===(null===e||void 0===e?void 0:e.max_quota_scope_size)?-1:(0,a._S)(null===e||void 0===e?void 0:e.max_quota_scope_size),max_network_count:(null===e||void 0===e?void 0:e.max_network_count)||-1};k||delete o.max_vfolder_count,j||delete o.max_quota_scope_size,S||delete o.max_network_count,null===b?M({variables:{name:null===e||void 0===e?void 0:e.name,props:o},onCompleted(e,o){var n,l;null===e||void 0===e||null===(n=e.create_project_resource_policy)||void 0===n||!n.ok||o?(m.error((null===e||void 0===e||null===(l=e.create_project_resource_policy)||void 0===l?void 0:l.msg)||c("resourcePolicy.CannotCreateResourcePolicy")),r()):(m.success(c("storageHost.ResourcePolicySuccessfullyUpdated")),r(!0))},onError(e){m.error((null===e||void 0===e?void 0:e.message)||c("resourcePolicy.CannotCreateResourcePolicy"))}}):F({variables:{name:null===e||void 0===e?void 0:e.name,props:o},onCompleted(e,o){var n,l;null===e||void 0===e||null===(n=e.modify_project_resource_policy)||void 0===n||!n.ok||o?(m.error((null===e||void 0===e||null===(l=e.modify_project_resource_policy)||void 0===l?void 0:l.msg)||c("resourcePolicy.CannotUpdateResourcePolicy")),r()):(m.success(c("storageHost.ResourcePolicySuccessfullyUpdated")),r(!0))},onError(e){m.error((null===e||void 0===e?void 0:e.message)||c("resourcePolicy.CannotUpdateResourcePolicy"))}})})).catch((()=>{}))},onCancel:()=>r(),destroyOnClose:!0,confirmLoading:K||q,...s,children:[(0,_.jsx)(oe.A,{message:c("storageHost.BeCarefulToSetProjectResourcePolicy"),type:"warning",showIcon:!0,style:{marginBottom:d.marginMD}}),(0,_.jsxs)(f.A,{ref:g,layout:"vertical",requiredMark:"optional",initialValues:I,preserve:!1,children:[(0,_.jsx)(f.A.Item,{label:c("resourcePolicy.Name"),name:"name",required:!0,rules:[{required:!0,message:c("data.explorer.ValueRequired")},{max:255},{validator:(e,n)=>!b&&null!==o&&void 0!==o&&o.includes(n)?Promise.reject(c("resourcePolicy.ResourcePolicyNameAlreadyExists")):Promise.resolve()}],children:(0,_.jsx)(C.A,{disabled:!!b})}),(0,_.jsxs)(u.A,{direction:"column",align:"stretch",gap:"md",style:{marginBottom:d.marginMD},children:[k?(0,_.jsx)(h,{name:"max_vfolder_count",unlimitedValue:0,label:c("resourcePolicy.MaxFolderCount"),style:{width:"100%",margin:0},children:(0,_.jsx)(w.A,{min:0,max:i.tu,style:{width:"100%"}})}):null,j?(0,_.jsx)(h,{name:"max_quota_scope_size",unlimitedValue:-1,label:c("storageHost.MaxFolderSize"),style:{width:"100%",margin:0},children:(0,_.jsx)(w.A,{min:0,max:Math.floor(Number.MAX_SAFE_INTEGER/Math.pow(10,9)),addonAfter:"GB",style:{width:"100%"}})}):null,S?(0,_.jsx)(h,{name:"max_network_count",unlimitedValue:-1,label:c("resourcePolicy.MaxNetworkCount"),style:{width:"100%",margin:0},children:(0,_.jsx)(w.A,{min:0,max:i.tu,style:{width:"100%"}})}):null]})]})]})};var le,ae,ie=n(86359),re=n(89762),te=n.n(re);const se=()=>{const{token:e}=A.A.useToken(),{t:o}=(0,P.Bd)(),[l,i]=(0,p.useTransition)(),[c,d]=(0,t.Tw)("initial-fetch"),[m,g]=(0,p.useState)(!1),[v,{toggle:x}]=(0,$.A)(),[f,k]=(0,p.useState)(),[h,j]=(0,p.useState)(),S=(0,t.CX)(),b=null===S||void 0===S?void 0:S.supports("max-vfolder-count-in-user-and-project-resource-policy"),R=null===S||void 0===S?void 0:S.supports("max-quota-scope-size"),C=null===S||void 0===S?void 0:S.supports("max_network_count"),{project_resource_policies:M}=(0,L.useLazyLoadQuery)(void 0!==le?le:le=n(78211),{},{fetchPolicy:"initial-fetch"===c?"store-and-network":"network-only",fetchKey:c}),[K,F]=(0,L.useMutation)(void 0!==ae?ae:ae=n(41870)),w=(0,a.LY)([{title:o("resourcePolicy.Name"),dataIndex:"name",key:"name",fixed:"left",sorter:(e,o)=>(0,a._f)(null===e||void 0===e?void 0:e.name,null===o||void 0===o?void 0:o.name)},b?{title:o("resourcePolicy.MaxVFolderCount"),dataIndex:"max_vfolder_count",key:"max_vfolder_count",render:e=>0===y().toNumber(e)?"\u221e":e,sorter:(e,o)=>(0,a.Oe)(null===e||void 0===e?void 0:e.max_vfolder_count,null===o||void 0===o?void 0:o.max_vfolder_count,0)}:{},R?{title:o("resourcePolicy.MaxQuotaScopeSize"),dataIndex:"max_quota_scope_size",key:"max_quota_scope_size",render:e=>-1===e?"\u221e":(0,a.wb)(e),sorter:(e,o)=>(0,a.Oe)(null===e||void 0===e?void 0:e.max_quota_scope_size,null===o||void 0===o?void 0:o.max_quota_scope_size,-1)}:{},C?{title:o("resourcePolicy.MaxNetworkCount"),dataIndex:"max_network_count",key:"max_network_count",render:e=>-1===e?"\u221e":e,sorter:(e,o)=>!0}:{},{title:"ID",dataIndex:"id",key:"id",sorter:(e,o)=>(0,a._f)(null===e||void 0===e?void 0:e.id,null===o||void 0===o?void 0:o.id)},{title:o("resourcePolicy.CreatedAt"),dataIndex:"created_at",key:"created_at",render:e=>te()(e).format("lll"),sorter:(e,o)=>(0,a._f)(null===e||void 0===e?void 0:e.created_at,null===o||void 0===o?void 0:o.created_at)},{title:o("general.Control"),fixed:"right",key:"control",render:(n,l)=>(0,_.jsxs)(u.A,{direction:"row",align:"stretch",children:[(0,_.jsx)(H.Ay,{type:"text",icon:(0,_.jsx)(T.A,{}),style:{color:e.colorInfo},onClick:()=>{j(l)}}),(0,_.jsx)(Q.A,{title:o("dialog.ask.DoYouWantToProceed"),description:o("dialog.warning.CannotBeUndone"),okType:"danger",okText:o("button.Delete"),onConfirm:()=>{null!==l&&void 0!==l&&l.name&&(k(l.name+c),K({variables:{name:l.name},onCompleted:(e,n)=>{var l,a;if(null!==e&&void 0!==e&&null!==(l=e.delete_project_resource_policy)&&void 0!==l&&l.ok)if(n&&(null===n||void 0===n?void 0:n.length)>0){const e=y().map(n,(e=>e.message));for(const o of e)ie.Ay.error(o,2.5)}else i((()=>d())),ie.Ay.success(o("resourcePolicy.SuccessfullyDeleted"));else ie.Ay.error(null===e||void 0===e||null===(a=e.delete_project_resource_policy)||void 0===a?void 0:a.msg)},onError(e){ie.Ay.error(null===e||void 0===e?void 0:e.message)}}))},children:(0,_.jsx)(H.Ay,{type:"text",icon:(0,_.jsx)(N.A,{style:{color:e.colorError}}),loading:F&&f===(null===l||void 0===l?void 0:l.name)+c,disabled:F&&f!==(null===l||void 0===l?void 0:l.name)+c})})]})}]),[q,I]=(0,s.a)("ProjectResourcePolicyList");return(0,_.jsxs)(u.A,{direction:"column",align:"stretch",children:[(0,_.jsxs)(u.A,{direction:"row",justify:"between",wrap:"wrap",gap:"xs",style:{padding:e.paddingContentVertical,paddingLeft:e.paddingContentHorizontalSM,paddingRight:e.paddingContentHorizontalSM},children:[(0,_.jsx)(u.A,{direction:"column",align:"start",children:(0,_.jsx)(X.A,{menu:{items:[{key:"exportCSV",label:o("resourcePolicy.ExportCSV"),onClick:()=>{(()=>{if(!M)return void ie.Ay.error(o("resourcePolicy.NoDataToExport"));const e=y().without(y().map(w,(e=>y().toString(e.key))),"control"),n=y().map(M,(o=>y().pick(o,e.map((e=>e)))));(0,r.RM)(n,"project_resource_polices",{max_vfolder_count:e=>0===y().toNumber(e)?"-":e,max_quota_scope_size:e=>-1===e?"-":(0,a.wb)(e)})})()}}]},children:(0,_.jsx)(H.Ay,{type:"link",style:{padding:0},onClick:e=>e.preventDefault(),children:(0,_.jsxs)(J.A,{style:{color:e.colorLinkHover},children:[o("resourcePolicy.Tools"),(0,_.jsx)(U.A,{})]})})})}),(0,_.jsx)(u.A,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:(0,_.jsxs)(u.A,{gap:"xs",children:[(0,_.jsx)(H.Ay,{icon:(0,_.jsx)(E.A,{}),loading:l,onClick:()=>{i((()=>d()))}}),(0,_.jsx)(H.Ay,{type:"primary",icon:(0,_.jsx)(O.A,{}),onClick:()=>{g(!0)},children:o("button.Create")})]})})]}),(0,_.jsx)(G.A,{rowKey:"id",showSorterTooltip:!1,columns:y().filter(w,(e=>!y().includes(q,y().toString(null===e||void 0===e?void 0:e.key)))),dataSource:(0,a.tS)(M),scroll:{x:"max-content"},pagination:!1}),(0,_.jsx)(u.A,{justify:"end",style:{padding:e.paddingXXS},children:(0,_.jsx)(H.Ay,{type:"text",icon:(0,_.jsx)(T.A,{}),onClick:()=>{x()}})}),(0,_.jsx)(D.A,{open:v,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&I(y().difference(w.map((e=>y().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),x()},columns:w,hiddenColumnKeys:q}),(0,_.jsx)(ne,{existingPolicyNames:y().map(M,"name"),open:!!h||m,projectResourcePolicyFrgmt:h||null,onRequestClose:e=>{e&&i((()=>d())),j(null),g(!1)}})]})};var ue,ce,de;const me=e=>{let{existingPolicyNames:o,userResourcePolicyFrgmt:l=null,onRequestClose:r,...s}=e;const{t:c}=(0,P.Bd)(),{token:d}=A.A.useToken(),{message:m}=R.A.useApp(),g=(0,p.useRef)(null),x=(0,t.CX)(),k=null===x||void 0===x?void 0:x.supports("max-vfolder-count-in-user-and-project-resource-policy"),j=null===x||void 0===x?void 0:x.supports("max-quota-scope-size"),S=null===x||void 0===x?void 0:x.supports("max-session-count-per-model-session"),b=null===x||void 0===x?void 0:x.supports("max-customized-image-count"),M=(0,L.useFragment)(void 0!==ue?ue:ue=n(17402),l),[K,F]=(0,L.useMutation)(void 0!==ce?ce:ce=n(12565)),[q,I]=(0,L.useMutation)(void 0!==de?de:de=n(96083)),z=(0,p.useMemo)((()=>{let e={};null===M&&(e={max_vfolder_count:0,max_quota_scope_size:-1});let o=null===M||void 0===M?void 0:M.max_quota_scope_size;return o=y().isUndefined(o)||-1===o?-1:(0,a.wb)(o),{...e,...M,max_quota_scope_size:o}}),[M,null===M||void 0===M?void 0:M.max_vfolder_count,null===M||void 0===M?void 0:M.max_quota_scope_size]);return(0,_.jsxs)(v.A,{title:c(null===M?"resourcePolicy.CreateResourcePolicy":"resourcePolicy.UpdateResourcePolicy"),onOk:e=>{var o;return null===g||void 0===g||null===(o=g.current)||void 0===o?void 0:o.validateFields().then((e=>{const o={max_vfolder_count:(null===e||void 0===e?void 0:e.max_vfolder_count)||0,max_quota_scope_size:-1===(null===e||void 0===e?void 0:e.max_quota_scope_size)?-1:(0,a._S)(null===e||void 0===e?void 0:e.max_quota_scope_size),max_session_count_per_model_session:null===e||void 0===e?void 0:e.max_session_count_per_model_session,max_customized_image_count:null===e||void 0===e?void 0:e.max_customized_image_count};k||delete o.max_vfolder_count,j||delete o.max_quota_scope_size,S||delete o.max_session_count_per_model_session,b||delete o.max_customized_image_count,null===M?K({variables:{name:null===e||void 0===e?void 0:e.name,props:o},onCompleted(e,o){var n,l;null===e||void 0===e||null===(n=e.create_user_resource_policy)||void 0===n||!n.ok||o?(m.error((null===e||void 0===e||null===(l=e.create_user_resource_policy)||void 0===l?void 0:l.msg)||c("resourcePolicy.CannotCreateResourcePolicy")),r()):(m.success(c("storageHost.ResourcePolicySuccessfullyUpdated")),r(!0))},onError(e){m.error((null===e||void 0===e?void 0:e.message)||c("resourcePolicy.CannotCreateResourcePolicy"))}}):q({variables:{name:null===e||void 0===e?void 0:e.name,props:o},onCompleted(e,o){var n,l;null===e||void 0===e||null===(n=e.modify_user_resource_policy)||void 0===n||!n.ok||o?(m.error((null===e||void 0===e||null===(l=e.modify_user_resource_policy)||void 0===l?void 0:l.msg)||c("resourcePolicy.CannotUpdateResourcePolicy")),r()):(m.success(c("storageHost.ResourcePolicySuccessfullyUpdated")),r(!0))},onError(e){m.error((null===e||void 0===e?void 0:e.message)||c("resourcePolicy.CannotUpdateResourcePolicy"))}})})).catch((()=>{}))},onCancel:()=>r(),destroyOnClose:!0,confirmLoading:F||I,...s,children:[(0,_.jsx)(oe.A,{message:c("storageHost.BeCarefulToSetUserResourcePolicy"),type:"warning",showIcon:!0,style:{marginBottom:d.marginMD}}),(0,_.jsxs)(f.A,{ref:g,layout:"vertical",requiredMark:"optional",initialValues:z,preserve:!1,children:[(0,_.jsx)(f.A.Item,{label:c("resourcePolicy.Name"),name:"name",required:!0,rules:[{required:!0,message:c("data.explorer.ValueRequired")},{max:255},{validator:(e,n)=>!M&&null!==o&&void 0!==o&&o.includes(n)?Promise.reject(c("resourcePolicy.ResourcePolicyNameAlreadyExists")):Promise.resolve()}],children:(0,_.jsx)(C.A,{disabled:!!M})}),(0,_.jsxs)(u.A,{direction:"column",align:"stretch",gap:"md",style:{marginBottom:d.marginMD},children:[k?(0,_.jsx)(h,{name:"max_vfolder_count",unlimitedValue:0,label:c("resourcePolicy.MaxFolderCount"),style:{width:"100%",margin:0},children:(0,_.jsx)(w.A,{min:0,max:i.tu,style:{width:"100%"}})}):null,j?(0,_.jsx)(h,{name:"max_quota_scope_size",unlimitedValue:-1,label:c("storageHost.MaxFolderSize"),style:{width:"100%",margin:0},children:(0,_.jsx)(w.A,{min:0,max:Math.floor(Number.MAX_SAFE_INTEGER/Math.pow(10,9)),addonAfter:"GB",style:{width:"100%"}})}):null]}),S?(0,_.jsx)(f.A.Item,{name:"max_session_count_per_model_session",label:c("resourcePolicy.MaxSessionCountPerModelSession"),rules:[{required:!0,message:c("data.explorer.ValueRequired")}],children:(0,_.jsx)(w.A,{min:0,max:i.tu,style:{width:"100%"}})}):null,b?(0,_.jsx)(f.A.Item,{name:"max_customized_image_count",label:c("resourcePolicy.MaxCustomizedImageCount"),rules:[{required:!0,message:c("data.explorer.ValueRequired")}],children:(0,_.jsx)(w.A,{min:0,max:i.tu,style:{width:"100%"}})}):null]})]})};var ye,pe;const _e=()=>{const{token:e}=A.A.useToken(),{t:o}=(0,P.Bd)(),{message:l}=R.A.useApp(),[i,c]=(0,p.useTransition)(),[d,m]=(0,t.Tw)("initial-fetch"),[g,v]=(0,p.useState)(!1),[x,{toggle:f}]=(0,$.A)(),[k,h]=(0,p.useState)(),[j,S]=(0,p.useState)(),b=(0,t.CX)(),C=null===b||void 0===b?void 0:b.supports("max-vfolder-count-in-user-and-project-resource-policy"),M=null===b||void 0===b?void 0:b.supports("max-quota-scope-size"),K=null===b||void 0===b?void 0:b.supports("max-session-count-per-model-session"),F=null===b||void 0===b?void 0:b.supports("max-customized-image-count"),{user_resource_policies:w}=(0,L.useLazyLoadQuery)(void 0!==ye?ye:ye=n(90413),{},{fetchPolicy:"initial-fetch"===d?"store-and-network":"network-only",fetchKey:d}),[q,I]=(0,L.useMutation)(void 0!==pe?pe:pe=n(60656)),z=(0,a.LY)([{title:o("resourcePolicy.Name"),dataIndex:"name",key:"name",fixed:"left",sorter:(e,o)=>(0,a._f)(null===e||void 0===e?void 0:e.name,null===o||void 0===o?void 0:o.name)},C&&{title:o("resourcePolicy.MaxVFolderCount"),dataIndex:"max_vfolder_count",key:"max_vfolder_count",render:e=>0===y().toNumber(e)?"\u221e":e,sorter:(e,o)=>(0,a.Oe)(null===e||void 0===e?void 0:e.max_vfolder_count,null===o||void 0===o?void 0:o.max_vfolder_count,0)},K&&{title:o("resourcePolicy.MaxSessionCountPerModelSession"),dataIndex:"max_session_count_per_model_session",key:"max_session_count_per_model_session",sorter:(e,o)=>{var n,l;return(null!==(n=null===e||void 0===e?void 0:e.max_session_count_per_model_session)&&void 0!==n?n:0)-(null!==(l=null===o||void 0===o?void 0:o.max_session_count_per_model_session)&&void 0!==l?l:0)}},M&&{title:o("resourcePolicy.MaxQuotaScopeSize"),dataIndex:"max_quota_scope_size",key:"max_quota_scope_size",render:e=>-1===e?"\u221e":(0,a.wb)(e),sorter:(e,o)=>(0,a.Oe)(null===e||void 0===e?void 0:e.max_quota_scope_size,null===o||void 0===o?void 0:o.max_quota_scope_size,-1)},F&&{title:o("resourcePolicy.MaxCustomizedImageCount"),key:"max_customized_image_count",dataIndex:"max_customized_image_count",sorter:(e,o)=>{var n,l;return(null!==(n=null===e||void 0===e?void 0:e.max_customized_image_count)&&void 0!==n?n:0)-(null!==(l=null===o||void 0===o?void 0:o.max_customized_image_count)&&void 0!==l?l:0)}},{title:"ID",dataIndex:"id",key:"id",sorter:(e,o)=>(0,a._f)(null===e||void 0===e?void 0:e.id,null===o||void 0===o?void 0:o.id)},{title:o("resourcePolicy.CreatedAt"),dataIndex:"created_at",key:"created_at",render:e=>te()(e).format("lll"),sorter:(e,o)=>(0,a._f)(null===e||void 0===e?void 0:e.created_at,null===o||void 0===o?void 0:o.created_at)},{title:o("general.Control"),fixed:"right",key:"control",render:(n,a)=>(0,_.jsxs)(u.A,{direction:"row",align:"stretch",children:[(0,_.jsx)(H.Ay,{type:"text",icon:(0,_.jsx)(T.A,{}),style:{color:e.colorInfo},onClick:()=>{S(a)}}),(0,_.jsx)(Q.A,{title:o("dialog.ask.DoYouWantToProceed"),description:o("dialog.warning.CannotBeUndone"),okType:"danger",okText:o("button.Delete"),onConfirm:()=>{null!==a&&void 0!==a&&a.name&&(h(a.name+d),q({variables:{name:a.name},onCompleted:(e,n)=>{var a,i;if(null!==e&&void 0!==e&&null!==(a=e.delete_user_resource_policy)&&void 0!==a&&a.ok)if(n&&n.length>0){const e=n.map((e=>e.message));for(const o of e)l.error(o,2.5)}else c((()=>m())),l.success(o("resourcePolicy.SuccessfullyDeleted"));else l.error(null===e||void 0===e||null===(i=e.delete_user_resource_policy)||void 0===i?void 0:i.msg)},onError(e){l.error(null===e||void 0===e?void 0:e.message)}}))},children:(0,_.jsx)(H.Ay,{type:"text",icon:(0,_.jsx)(N.A,{style:{color:e.colorError}}),loading:I&&k===(null===a||void 0===a?void 0:a.name)+d,disabled:I&&k!==(null===a||void 0===a?void 0:a.name)+d})})]})}]),[V,B]=(0,s.a)("UserResourcePolicyList");return(0,_.jsxs)(u.A,{direction:"column",align:"stretch",children:[(0,_.jsxs)(u.A,{direction:"row",justify:"between",wrap:"wrap",gap:"xs",style:{padding:e.paddingContentVertical,paddingLeft:e.paddingContentHorizontalSM,paddingRight:e.paddingContentHorizontalSM},children:[(0,_.jsx)(u.A,{direction:"column",align:"start",children:(0,_.jsx)(X.A,{menu:{items:[{key:"exportCSV",label:o("resourcePolicy.ExportCSV"),onClick:()=>{(()=>{if(!w||w.length===(null===V||void 0===V?void 0:V.length))return void l.error(o("resourcePolicy.NoDataToExport"));const e=y().without(y().map(z,(e=>y().toString(e.key))),"control"),n=y().map(w,(o=>y().pick(o,e.map((e=>e)))));(0,r.RM)(n,"user-resource-policies",{max_vfolder_count:e=>0===y().toNumber(e)?"-":e,max_quota_scope_size:e=>-1===e?"-":(0,a.wb)(e)})})()}}]},children:(0,_.jsx)(H.Ay,{type:"link",style:{padding:0},onClick:e=>e.preventDefault(),children:(0,_.jsxs)(J.A,{style:{color:e.colorLinkHover},children:[o("resourcePolicy.Tools"),(0,_.jsx)(U.A,{})]})})})}),(0,_.jsx)(u.A,{direction:"row",gap:"xs",wrap:"wrap",style:{flexShrink:1},children:(0,_.jsxs)(u.A,{gap:"xs",children:[(0,_.jsx)(H.Ay,{icon:(0,_.jsx)(E.A,{}),loading:i,onClick:()=>{c((()=>m()))}}),(0,_.jsx)(H.Ay,{type:"primary",icon:(0,_.jsx)(O.A,{}),onClick:()=>{v(!0)},children:o("button.Create")})]})})]}),(0,_.jsx)(G.A,{rowKey:"id",showSorterTooltip:!1,columns:y().filter(z,(e=>!y().includes(V,y().toString(null===e||void 0===e?void 0:e.key)))),dataSource:(0,a.tS)(w),scroll:{x:"max-content"},pagination:!1}),(0,_.jsx)(u.A,{justify:"end",style:{padding:e.paddingXXS},children:(0,_.jsx)(H.Ay,{type:"text",icon:(0,_.jsx)(T.A,{}),onClick:()=>{f()}})}),(0,_.jsx)(D.A,{open:x,onRequestClose:e=>{(null===e||void 0===e?void 0:e.selectedColumnKeys)&&B(y().difference(z.map((e=>y().toString(e.key))),null===e||void 0===e?void 0:e.selectedColumnKeys)),f()},columns:z,hiddenColumnKeys:V}),(0,_.jsx)(me,{existingPolicyNames:y().map(w,"name"),open:!!j||g,userResourcePolicyFrgmt:j||null,onRequestClose:e=>{e&&c((()=>m())),S(null),v(!1)}})]})};var ge=n(86289);const ve=(0,ge.withDefault)(ge.StringParam,"keypair"),xe=()=>{const{t:e}=(0,P.Bd)(),[o]=(0,ge.useQueryParam)("tab",ve),n=(0,t.f0)(),i=(0,t.CX)(),r=null===i||void 0===i?void 0:i.supports("configure-user-resource-policy");return(0,_.jsx)(M.A,{activeTabKey:o,onTabChange:e=>{n({pathname:"/resource-policy",search:`?tab=${e}`},{params:{tab:e}})},tabList:(0,a.LY)([{key:"keypair",label:e("resourcePolicy.Keypair")},r&&{key:"user",label:e("resourcePolicy.User")},{key:"project",label:e("resourcePolicy.Project")}]),styles:{body:{padding:0,paddingTop:1,overflow:"hidden"}},children:(0,_.jsxs)(p.Suspense,{fallback:(0,_.jsx)(l.A,{}),children:["keypair"===o&&(0,_.jsx)(Y,{}),"user"===o&&(0,_.jsx)(_e,{}),"project"===o&&(0,_.jsx)(se,{})]})})}}}]);
//# sourceMappingURL=2812.b732204a.chunk.js.map