"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[1822],{94777:(e,n,t)=>{t.d(n,{A:()=>E});var a=t(58452),s=t(90840),i=t(59571),c=t(3730),l=t(79151),o=t(34132),r=t(88961),d=t(29107),g=t(27484),m=t.n(g),u=t(1426),h=t(42906);const p=(0,d.rU)((e=>{let{css:n}=e;return{baiSettingItemCheckbox:n`
    .ant-checkbox {
      align-self: flex-start;
      margin-top: 0.2rem;
    }
  `}})),x=e=>{let{type:n,title:t,description:a,children:d,defaultValue:g,value:u,selectProps:x,onChange:y,disabled:j}=e;const{token:A}=i.A.useToken(),{styles:b}=p();return(0,h.jsxs)(s.A,{direction:"column",align:"start",gap:"xxs",children:[(0,h.jsxs)(s.A,{direction:"row",gap:"xxs",children:[(0,h.jsx)(c.A.Text,{strong:!0,style:{fontSize:A.fontSize},children:t}),!j&&void 0!==u&&null!==u&&g!==u&&(0,h.jsx)(l.A,{dot:!0,status:"warning"})]}),"custom"===n&&(0,h.jsxs)(h.Fragment,{children:[a,(0,h.jsx)("div",{style:{marginTop:A.marginXS},children:d})]}),"checkbox"===n&&(0,h.jsx)(o.A,{checked:u,onChange:y,disabled:j,className:b.baiSettingItemCheckbox,children:(0,h.jsx)(c.A.Text,{type:j?"secondary":void 0,children:a})}),"select"===n&&(0,h.jsxs)(h.Fragment,{children:[a,(0,h.jsx)(r.A,{value:u,popupMatchSelectWidth:!1,onChange:y,disabled:j,style:{marginTop:A.marginXS,...null===x||void 0===x?void 0:x.style},...m().omit(x,["style"])})]})]})};var y=t(80310),j=t(80707),A=t(67884),b=t(67933),k=t(86187),C=t(64181),v=t(79810),S=t(28134),I=t(4800),T=t(9976);const w=(0,d.rU)((e=>{let{css:n,token:t}=e;return{TabStyles:n`
    .ant-tabs-tab-active {
      font-weight: var(--token-fontWeightSuperStrong, 700);
    }
    .ant-typography-secondary {
      font-weight: normal !important;
    }
  `}})),f=e=>{let{title:n,count:t}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.A.Text,{children:n}),(0,h.jsx)(c.A.Text,{type:"secondary",children:` (${t})`})]})},R=e=>{let{group:n,hideEmpty:t}=e;const{token:a}=i.A.useToken();return(!t||0!==n.settingItems.length)&&(0,h.jsxs)(s.A,{direction:"column",align:"stretch",style:{marginBottom:a.marginMD},children:[(0,h.jsxs)(s.A,{direction:"column",align:"stretch",style:{zIndex:1,marginBottom:a.marginMD,background:a.colorBgContainer},children:[(0,h.jsx)(c.A.Title,{level:5,style:{marginTop:0},children:n.title}),(0,h.jsx)(b.A,{style:{marginTop:0,marginBottom:0}}),n.description&&(0,h.jsx)(c.A.Text,{type:"secondary",style:{marginTop:a.marginSM},children:n.description})]}),(0,h.jsx)(s.A,{direction:"column",align:"start",gap:"lg",children:n.settingItems.map(((e,n)=>(0,h.jsx)(x,{...e},e.title+n)))})]})},E=e=>{let{settingGroups:n,tabDirection:t="left",showChangedOptionFilter:c,showResetButton:l,showSearchBar:r}=e;const{t:d}=(0,T.Bd)(),{token:g}=i.A.useToken(),{styles:p}=w(),[x,b]=(0,u.useState)(""),[E,B]=(0,u.useState)(!1),[_,{toggle:D}]=(0,A.A)(!1),[M,F]=(0,u.useState)("all"),L=m().map(n,(e=>({...e,settingItems:m().filter(e.settingItems,(e=>(!E||(e=>null!==e.value&&void 0!==e.value&&!e.disabled&&e.value!==e.defaultValue)(e))&&(e=>e.title.toLowerCase().includes(x.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(x.toLowerCase()))(e)))})));return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(s.A,{direction:"column",gap:"md",align:"stretch",style:{padding:g.paddingContentHorizontal,maxWidth:g.screenLG},children:[(0,h.jsxs)(s.A,{justify:"start",gap:"xs",children:[!!r&&(0,h.jsx)(k.A,{prefix:(0,h.jsx)(y.A,{}),placeholder:d("settings.SearchPlaceholder"),onChange:e=>b(e.target.value),value:x}),!!c&&(0,h.jsx)(o.A,{onChange:e=>B(e.target.checked),style:{whiteSpace:"nowrap"},children:d("settings.ShowOnlyChanged")}),!!l&&(0,h.jsx)(C.Ay,{icon:(0,h.jsx)(j.A,{}),onClick:()=>D(),children:d("button.Reset")})]}),(0,h.jsx)(v.A,{activeKey:M,onChange:F,className:p.TabStyles,tabPosition:t?"left":"top",tabBarStyle:{minWidth:200},items:[{key:"all",label:(0,h.jsx)(f,{title:d("general.All"),count:m().sumBy(L,(e=>e.settingItems.length))}),children:(0,h.jsx)(s.A,{direction:"column",align:"stretch",gap:"xl",children:m().sumBy(L,(e=>e.settingItems.length))>0?m().map(L,(e=>(0,h.jsx)(R,{group:e,hideEmpty:!0},e.title))):(0,h.jsx)(S.A,{image:S.A.PRESENTED_IMAGE_SIMPLE,description:d("settings.NoChangesToDisplay")})})},...m().map(L,((e,n)=>({key:`index${n}`,label:(0,h.jsx)(f,{title:e.title,count:e.settingItems.length}),children:e.settingItems.length>0?(0,h.jsx)(R,{group:e,hideEmpty:!0}):(0,h.jsx)(S.A,{image:S.A.PRESENTED_IMAGE_SIMPLE,description:d("settings.NoChangesToDisplay")})})))]})]}),(0,h.jsx)(a.A,{open:_,title:d("dialog.ask.DoYouWantToResetChanges"),okText:d("button.Reset"),okButtonProps:{danger:!0},onOk:()=>{m().flatMap(n,(e=>e.settingItems)).forEach((e=>{!e.disabled&&(null===e||void 0===e?void 0:e.setValue)&&e.setValue(e.defaultValue)})),D()},cancelText:d("button.Cancel"),onCancel:()=>D(),children:(0,h.jsx)(I.A,{showIcon:!0,message:d("dialog.warning.CannotBeUndone"),type:"warning"})})]})}},41822:(e,n,t)=>{t.r(n),t.d(n,{default:()=>p});var a=t(32967),s=t(17353),i=t(94777),c=t(80707),l=t(64181),o=t(1426),r=t(9976),d=t(42906);const g=()=>{const[e,n]=(0,o.useState)(!1),[t,g]=(0,o.useState)(!1),{t:m}=(0,r.Bd)(),{upsertNotification:u}=(0,s.js)(),h=(0,a.CX)(),p=[{title:m("maintenance.Fix"),settingItems:[{type:"custom",title:m("maintenance.MatchDatabase"),description:m("maintenance.DescMatchDatabase"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{n(!0),u({message:m("maintenance.RecalculateUsage"),description:m("maintenance.Recalculating"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.recalculate_usage().finally((()=>n(!1))),onChange:{pending:m("maintenance.Recalculating"),resolved:m("maintenance.RecalculationFinished"),rejected:m("maintenance.RecalculationFailed")}}})},loading:e,children:m(e?"maintenance.Recalculating":"maintenance.RecalculateUsage")})}]},{title:m("maintenance.ImagesEnvironment"),settingItems:[{type:"custom",title:m("maintenance.RescanImageList"),description:m("maintenance.DescRescanImageList"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{g(!0),u({message:m("maintenance.RescanImages"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.rescan_images(),onChange:{pending:m("maintenance.RescanImageScanning"),resolved:e=>{const n=e;if(n.rescan_images.ok)return{backgroundTask:{status:"pending",taskId:n.rescan_images.task_id,promise:null,percent:0,onChange:{resolved:(e,n)=>(g(!1),m("maintenance.RescanImageFinished"))}},duration:0};throw new Error(m("maintenance.RescanFailed"))},rejected:(e,n)=>{const t=e;return g(!1),(null===t||void 0===t?void 0:t.message)||m("maintenance.RescanFailed")}}}})},loading:t,children:m(t?"maintenance.RescanImageScanning":"maintenance.RescanImages")})}]}];return(0,d.jsx)(i.A,{settingGroups:p,showSearchBar:!0})};var m=t(14287),u=t(86289);const h=(0,u.withDefault)(u.StringParam,"maintenance"),p=()=>{const{t:e}=(0,r.Bd)(),[n,t]=(0,u.useQueryParam)("tab",h);return(0,d.jsx)(m.A,{activeTabKey:"maintenance",onTabChange:e=>t(e),tabList:[{key:"maintenance",tab:e("webui.menu.Maintenance")}],styles:{body:{padding:0}},children:"maintenance"===n&&(0,d.jsx)(g,{})})}}}]);
//# sourceMappingURL=1822.1b5c6495.chunk.js.map