"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[896,502],{77758:function(n,e,t){t.d(e,{Z:function(){return l}});var i=t(1413),a=t(36459),o=t(65113),r=(t(4519),t(2556)),l=function(n){var e,t=Object.assign({},((0,a.Z)(n),n));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("style",{children:".ant-modal.bai-modal .ant-modal-content {\n  padding: var(--general-modal-content-padding, 0);\n}\n.ant-modal.bai-modal .ant-modal-body {\n  padding: var(--general-modal-body-padding, 0 24px);\n}\n\n.ant-modal.bai-modal .ant-modal-footer {\n  padding: var(--general-modal-footer-padding, 0 20px 24px 20px);\n}\n\n.ant-modal.bai-modal .ant-modal-header {\n  border-bottom: 1px solid rgb(221, 221, 221);\n  border-width: 100%;\n  justify-content: space-between;\n  display: flex;\n  align-items: center;\n}\n\n.ant-modal.bai-modal .ant-modal-content .ant-modal-header,\n.ant-modal.bai-modal .ant-modal-content > button.ant-modal-close {\n  padding: var(--general-modal-header-padding, 10px 20px);\n  height: var(--general-modal-header-height, 69px);\n}\n\n.ant-modal.bai-modal .ant-modal-content > button.ant-modal-close {\n  /* center */\n  top: 0;\n}\n"}),(0,r.jsx)(o.Z,(0,i.Z)({centered:null===(e=t.centered)||void 0===e||e,className:"bai-modal"},t))]})}},61502:function(n,e,t){t.r(e),t.d(e,{default:function(){return U},useShadowRoot:function(){return G},useWebComponentInfo:function(){return H}});var i=t(29439),a=t(74165),o=t(15861),r=t(24530),l=t(24717),d=t(61724);function u(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0,i=(0,r.Qc)(n),a=(0,l.Vn)(i,{Field:{enter:function(n){var i;if(null!==n&&void 0!==n&&null!==(i=n.directives)&&void 0!==i&&i.find((function(n){var i,a,o,r,l=n.name.value,d=null===(i=n.arguments)||void 0===i?void 0:i[0].name.value,u=null===(a=n.arguments)||void 0===a||null===(o=a[0].value)||void 0===o?void 0:o.value,c=null===(r=n.arguments)||void 0===r?void 0:r[0];if("since"===l&&"version"===d){if(t(u))return!0}else if("deprecatedSince"===l&&"version"===d){var s="StringValue"===(null===c||void 0===c?void 0:c.value.kind)?null===c||void 0===c?void 0:c.value.value:e[null===c||void 0===c?void 0:c.value.name.value];if(!t(s))return!0}else if("skipOnClient"===l&&"if"===d){if("BooleanValue"===(null===c||void 0===c?void 0:c.value.kind)&&c.value.value)return!0;if("Variable"===(null===c||void 0===c?void 0:c.value.kind)&&e[c.value.name.value])return!0}return!1})))return null},leave:function(n){var e;if(n.selectionSet&&"SelectionSet"===n.selectionSet.kind&&0===(null===(e=n.selectionSet.selections)||void 0===e?void 0:e.length))return null}},Directive:{leave:function(n){var e=n.name.value;if(["since","deprecatedSince","skipOnClient"].includes(e))return null}}}),o={};return(0,l.Vn)(a,{Variable:function(n){o[n.name.value]=(o[n.name.value]||0)+1}}),a=(0,l.Vn)(a,{VariableDefinition:{enter:function(n){if(o[n.variable.name.value]<=1)return null}}}),(0,d.S)(a)}var c=t(41011);c.RelayFeatureFlags.ENABLE_RELAY_RESOLVERS=!0;var s=function(){var n=(0,o.Z)((0,a.Z)().mark((function n(e,t){var i,o,r,l,d,c;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==globalThis.backendaiclient){n.next=3;break}return n.next=3,new Promise((function(n){document.addEventListener("backend-ai-connected",(function e(){document.removeEventListener("backend-ai-connected",e),n(void 0)}))}));case 3:return r=u(e.text||"",t,(function(n){var e;return!(null!==(e=globalThis.backendaiclient)&&void 0!==e&&e.isManagerVersionCompatibleWith(n))})),l={query:r,variables:t},d=null===(i=globalThis.backendaiclient)||void 0===i?void 0:i.newSignedRequest("POST","/admin/gql",l),n.next=8,null===(o=globalThis.backendaiclient)||void 0===o?void 0:o._wrapWithPromise(d,!1,null,1e4,0).catch((function(n){}));case 8:if(n.t0=n.sent,n.t0){n.next=11;break}n.t0={};case 11:return c=n.t0,n.abrupt("return",c);case 13:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();var v,m=new c.Environment({network:c.Network.create(s,void 0),store:new c.Store(new c.RecordSource)}),f=t(80382),p=t(27340),g=t(41239),h=t(47226),b=t(49883),x=t(66670),y=t(99517),k=t.n(y),w=(t(24989),t(79354)),j=t.n(w),Z=t(79748),S=t.n(Z),T=t(51714),C=t.n(T),E=t(63540),F=t.n(E),L=t(18272),_=t.n(L),P=t(9666),R=t.n(P),V=t(64447),q=t(13881),O=t(4519),K=t(81748),M=t(87112),N=t(16980),A=t(51843),I=t(12674),Q=t(55144),D=t(73181),z=t(2556);k().extend(R()),k().extend(j()),k().extend(S()),k().extend(C()),k().extend(_()),k().extend(F());var B=O.createContext(null),W=O.createContext(null),G=function(){return O.useContext(W)},H=function(){return O.useContext(B)},Y=new M.QueryClient({defaultOptions:{queries:{suspense:!0,refetchOnWindowFocus:!1,retry:!1}}});V.ZP.use(K.Db).use(q.Z).init({backend:{loadPath:"/resources/i18n/{{lng}}.json"},lng:(null===globalThis||void 0===globalThis||null===(v=globalThis.backendaioptions)||void 0===v?void 0:v.get("current_language"))||"en",fallbackLng:"en",interpolation:{escapeValue:!1},react:{transSupportBasicHtmlNodes:!0,transKeepBasicHtmlNodesFor:["br","strong","span","code","p"]}});var $=function(){var n=(0,I.s0)();return(0,O.useLayoutEffect)((function(){var e=function(e){var t=e.detail;n(t,{replace:!0})};return document.addEventListener("react-navigate",e),function(){document.removeEventListener("react-navigate",e)}}),[n]),null},U=function(n){var e=n.children,t=n.value,a=n.styles,o=n.shadowRoot,r=n.dispatchEvent,l=(0,O.useMemo)((function(){return(0,p.Df)()}),[]),d=function(){var n,e=(0,O.useState)(null===globalThis||void 0===globalThis||null===(n=globalThis.backendaioptions)||void 0===n?void 0:n.get("current_language")),t=(0,i.Z)(e,2),a=t[0],o=t[1],r=(0,K.$G)().i18n;return(0,O.useEffect)((function(){setTimeout((function(){return null===r||void 0===r?void 0:r.changeLanguage(a)}),0),k().locale(a)}),[]),(0,O.useEffect)((function(){var n=function(n){var e,t;o(null===n||void 0===n||null===(e=n.detail)||void 0===e?void 0:e.lang);var i=(null===n||void 0===n||null===(t=n.detail)||void 0===t?void 0:t.lang)||"en";null===r||void 0===r||r.changeLanguage(i),k().locale(i)};return window.addEventListener("langChanged",n),function(){return window.removeEventListener("langChanged",n)}}),[r]),[a]}(),u=(0,i.Z)(d,1)[0],c=(0,f.x)(),s=(0,O.useMemo)((function(){return{value:t,dispatchEvent:r,moveTo:function(n,e){r("moveTo",{path:n,params:e})}}}),[t,r]);return(0,z.jsx)(z.Fragment,{children:m&&(0,z.jsx)(N.RelayEnvironmentProvider,{environment:m,children:(0,z.jsxs)(O.StrictMode,{children:[(0,z.jsxs)("style",{children:[a,".anticon {\n  display: inline-block;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n/* fix: fixed column shadow display outside of a table wrapper */\n.ant-table-wrapper {\n  border-radius: 8px 8px 0 0;\n  overflow: hidden;\n}\n\n/* fix: the tooltip does not appear in the `<Form.Item tooltip={'something'}` when the popup container is a parent node of the trigger node. */\n.ant-form-item-label {\n  overflow: unset !important;\n}\n"]}),(0,z.jsx)(M.QueryClientProvider,{client:Y,children:(0,z.jsx)(W.Provider,{value:o,children:(0,z.jsx)(B.Provider,{value:s,children:(0,z.jsx)(g.ZP,{getPopupContainer:function(n){return(null===n||void 0===n?void 0:n.parentNode)||o},locale:"ko"===u?x.Z:b.Z,theme:c,children:(0,z.jsx)(h.Z,{children:(0,z.jsx)(p.V9,{container:o,cache:l,children:(0,z.jsx)(O.Suspense,{fallback:"",children:(0,z.jsx)(A.VK,{children:(0,z.jsxs)(Q.QueryParamProvider,{adapter:D.Q,options:{},children:[(0,z.jsx)($,{}),e]})})})})})})})})})]})})})}},14749:function(n,e,t){var i,a=t(1413),o=t(29439),r=t(44925),l=t(87760),d=t(50164),u=t(77758),c=t(99277),s=t(44036),v=t(57054),m=t(88464),f=t(39883),p=t(42272),g=t(28499),h=t(38818),b=(t(4519),t(81748)),x=t(87112),y=t(16980),k=t(2556),w=["userFrgmt","onRequestClose"];e.Z=function(n){var e=n.userFrgmt,j=void 0===e?null:e,Z=n.onRequestClose,S=(0,r.Z)(n,w),T=(0,b.$G)().t,C=s.Z.useToken().token,E=v.Z.useForm(),F=(0,o.Z)(E,1)[0],L=(0,y.useFragment)(void 0!==i?i:i=t(78067),j),_=(0,l.Dj)(),P=(0,x.useQuery)({queryKey:["initialize_totp",null===_||void 0===_?void 0:_.email,S.open],queryFn:function(){return(null===L||void 0===L?void 0:L.email)!==(null===_||void 0===_?void 0:_.email)||null!==L&&void 0!==L&&L.totp_activated||!S.open?null:_.initialize_totp()},suspense:!1,staleTime:0,cacheTime:0}),R=(0,d.Y)({mutationFn:function(n){return _.activate_totp(n.otp)}});return(0,k.jsx)(u.Z,(0,a.Z)((0,a.Z)({title:T("webui.menu.SetupTotp"),maskClosable:!1,confirmLoading:R.isLoading,onOk:function(){F.validateFields().then((function(n){R.mutate(n,{onSuccess:function(){m.ZP.success(T("totp.TotpSetupCompleted")),Z(!0)},onError:function(){m.ZP.error(T("totp.InvalidTotpCode"))}}),new Promise((function(n,e){})).then((function(){Z(!0)}))}))},onCancel:function(){Z()},style:{zIndex:1}},S),{},{children:P.isLoading?(0,k.jsx)(c.Z,{justify:"center",direction:"row",children:(0,k.jsx)(f.Z,{})}):P.data?(0,k.jsxs)(v.Z,{preserve:!1,form:F,validateTrigger:["onChange","onBlur"],children:[T("totp.TypeInAuthKey"),(0,k.jsx)(c.Z,{justify:"center",style:{margin:C.marginSM,gap:C.margin},children:(0,k.jsx)(p.Z,{value:P.data.totp_uri})}),T("totp.ScanQRToEnable"),(0,k.jsx)(c.Z,{justify:"center",style:{margin:C.marginSM,gap:C.margin},children:(0,k.jsx)(g.Z.Text,{copyable:!0,code:!0,children:P.data.totp_key})}),T("totp.TypeInAuthKey"),(0,k.jsx)(c.Z,{justify:"center",style:{margin:C.marginSM,gap:C.margin},children:(0,k.jsx)(v.Z.Item,{required:!0,name:"otp",children:(0,k.jsx)(h.Z,{maxLength:6,allowClear:!0,placeholder:"000000",style:{maxWidth:120}})})})]}):(0,k.jsx)(c.Z,{justify:"center",direction:"row",children:T("totp.TotpSetupNotAvailable")})}))}},78067:function(n,e,t){t.r(e);var i={argumentDefinitions:[{kind:"RootArgument",name:"isNotSupportTotp"}],kind:"Fragment",metadata:null,name:"TOTPActivateModalFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"totp_activated",storageKey:null}],type:"User",abstractKey:null,hash:"f5da6b3094f7d70bef9373d9c907955c"};e.default=i}}]);
//# sourceMappingURL=896.120e24f8.chunk.js.map