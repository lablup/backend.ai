"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[2329],{83557:(e,t,n)=>{n.d(t,{A:()=>O});var a=n(40005),s=n(234),i=n(8334),c=n(71509),l=n(17707),r=n(89881),o=n(11753),d=n(45045),g=n(43749),m=n.n(g),u=n(21481),h=n(66845);const p=(0,o.rU)((e=>{let{css:t}=e;return{baiSettingItemCheckbox:t`
    .ant-checkbox {
      align-self: flex-start;
      margin-top: 0.2rem;
    }
  `}})),x=e=>{let{"data-testid":t,type:n,title:a,description:o,children:g,defaultValue:u,value:x,selectProps:j,onChange:y,disabled:b}=e;const{token:f}=s.A.useToken(),{styles:v}=p();return(0,h.jsxs)(d.OO,{"data-testid":t,direction:"column",align:"start",gap:"xxs",children:[(0,h.jsxs)(d.OO,{direction:"row",gap:"xxs",children:[(0,h.jsx)(i.A.Text,{strong:!0,style:{fontSize:f.fontSize},children:a}),!b&&void 0!==x&&null!==x&&u!==x&&(0,h.jsx)(c.A,{dot:!0,status:"warning"})]}),"custom"===n&&(0,h.jsxs)(d.OO,{direction:"column",gap:"xs",align:"start",style:{width:"100%"},children:[o,g]}),"checkbox"===n&&(0,h.jsx)(l.A,{checked:x,onChange:y,disabled:b,className:v.baiSettingItemCheckbox,children:(0,h.jsx)(i.A.Text,{type:b?"secondary":void 0,children:o})}),"select"===n&&(0,h.jsxs)(h.Fragment,{children:[o,(0,h.jsx)(r.A,{value:x,popupMatchSelectWidth:!1,onChange:y,disabled:b,style:{marginTop:f.marginXS,...null===j||void 0===j?void 0:j.style},...m().omit(j,["style"])})]})]})};var j=n(83525),y=n(95056),b=n(60854),f=n(60402),v=n(73017),k=n(84910),A=n(14373),C=n(54575),S=n(51569);const w=(0,o.rU)((e=>{let{css:t}=e;return{TabStyles:t`
    .ant-tabs-tab-active {
      font-weight: var(--token-fontWeightSuperStrong, 700);
    }
    .ant-typography-secondary {
      font-weight: normal !important;
    }
  `}})),I=e=>{let{title:t,count:n}=e;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(i.A.Text,{children:t}),(0,h.jsx)(i.A.Text,{type:"secondary",children:` (${n})`})]})},T=e=>{let{group:t,hideEmpty:n=!0,...a}=e;const{token:c}=s.A.useToken();return(!n||0!==t.settingItems.length)&&(0,h.jsxs)(d.OO,{direction:"column",align:"stretch",style:{marginBottom:c.marginMD},...a,children:[(0,h.jsxs)(d.OO,{direction:"column",align:"stretch",style:{zIndex:1,marginBottom:c.marginMD,background:c.colorBgContainer},children:[(0,h.jsx)(d.OO,{align:"start",justify:"between",children:(0,h.jsxs)(d.OO,{gap:"sm",align:"start",children:[(0,h.jsx)(i.A.Title,{level:5,style:{marginTop:0},children:t.title}),t.titleExtra&&(0,h.jsx)("div",{children:t.titleExtra})]})}),(0,h.jsx)(f.A,{style:{marginTop:0,marginBottom:0}}),t.description&&(0,h.jsx)(i.A.Text,{type:"secondary",style:{marginTop:c.marginSM},children:t.description})]}),(0,h.jsxs)(d.OO,{direction:"column",align:"stretch",gap:"lg",children:[t.alert,t.settingItems.map(((e,t)=>(0,h.jsx)(x,{...e},e.title+t)))]})]})},O=e=>{const t=(0,a.c)(96),{settingGroups:n,tabDirection:s,showChangedOptionFilter:i,showResetButton:c,showSearchBar:r,primaryButton:o,extraButton:g}=e,p=void 0===s?"left":s,{t:x}=(0,S.Bd)(),{styles:f}=w(),[O,D]=(0,u.useState)(""),[M,F]=(0,u.useState)(!1),[L,P]=(0,b.A)(!1),{toggle:N}=P,[U,V]=(0,u.useState)("all");let z;t[0]!==O?(z=e=>e.title.toLowerCase().includes(O.toLowerCase())||"string"===typeof e.description&&e.description.toLowerCase().includes(O.toLowerCase()),t[0]=O,t[1]=z):z=t[1];const G=z,W=E;let K,X,$,Q,Y,Z,q,H,J,ee,te,ne,ae,se,ie,ce,le,re,oe,de,ge,me,ue,he;if(t[2]!==U||t[3]!==M||t[4]!==g||t[5]!==o||t[6]!==O||t[7]!==G||t[8]!==N||t[9]!==n||t[10]!==i||t[11]!==c||t[12]!==r||t[13]!==f.TabStyles||t[14]!==x||t[15]!==p){let e;t[28]!==M||t[29]!==G?(e=e=>({...e,settingItems:m().filter(e.settingItems,(e=>(!M||W(e))&&G(e)))}),t[28]=M,t[29]=G,t[30]=e):e=t[30];const a=m().map(n,e);let s,u,b,C,S;X=d.OO,$="column",Q="md",Y="stretch",t[31]!==O||t[32]!==r||t[33]!==x?(s=!!r&&(0,h.jsx)(v.A,{prefix:(0,h.jsx)(j.A,{}),placeholder:x("settings.SearchPlaceholder"),onChange:e=>D(e.target.value),value:O}),t[31]=O,t[32]=r,t[33]=x,t[34]=s):s=t[34],t[35]!==i||t[36]!==x?(u=!!i&&(0,h.jsx)(l.A,{onChange:e=>F(e.target.checked),style:{whiteSpace:"nowrap"},children:x("settings.ShowOnlyChanged")}),t[35]=i,t[36]=x,t[37]=u):u=t[37],t[38]!==N||t[39]!==c||t[40]!==x?(b=!!c&&(0,h.jsx)(d.Fv,{icon:(0,h.jsx)(y.A,{}),onClick:()=>N(),children:x("button.Reset")}),t[38]=N,t[39]=c,t[40]=x,t[41]=b):b=t[41],t[42]!==g||t[43]!==o||t[44]!==s||t[45]!==u||t[46]!==b?(Z=(0,h.jsxs)(d.OO,{justify:"start",gap:"xs",children:[s,u,g,b,o]}),t[42]=g,t[43]=o,t[44]=s,t[45]=u,t[46]=b,t[47]=Z):Z=t[47],K=k.A,q=U,H=V,J=f.TabStyles,ee=p?"left":"top",t[48]===Symbol.for("react.memo_cache_sentinel")?(te={minWidth:200},t[48]=te):te=t[48],t[49]!==x?(C=x("general.All"),t[49]=x,t[50]=C):C=t[50],t[51]!==N||t[52]!==x?(S=(e,t)=>({key:`index${t}`,label:(0,h.jsx)(I,{title:e.title,count:e.settingItems.length}),children:(0,h.jsx)(d.OO,{direction:"column",align:"stretch",gap:"xl",children:e.settingItems.length>0?(0,h.jsx)(T,{group:e,hideEmpty:!0,onReset:()=>{N()}}):(0,h.jsx)(A.A,{image:A.A.PRESENTED_IMAGE_SIMPLE,description:x("settings.NoChangesToDisplay")})})}),t[51]=N,t[52]=x,t[53]=S):S=t[53],ne=[{key:"all",label:(0,h.jsx)(I,{title:C,count:m().sumBy(a,_)}),children:(0,h.jsx)(d.OO,{direction:"column",align:"stretch",gap:"xl",children:m().sumBy(a,B)>0?m().map(a,(e=>(0,h.jsx)(T,{"data-testid":null===e||void 0===e?void 0:e["data-testid"],group:e,hideEmpty:!0,onReset:()=>{N()}},e.title))):(0,h.jsx)(A.A,{image:A.A.PRESENTED_IMAGE_SIMPLE,description:x("settings.NoChangesToDisplay")})})},...m().map(a,S)],t[2]=U,t[3]=M,t[4]=g,t[5]=o,t[6]=O,t[7]=G,t[8]=N,t[9]=n,t[10]=i,t[11]=c,t[12]=r,t[13]=f.TabStyles,t[14]=x,t[15]=p,t[16]=K,t[17]=X,t[18]=$,t[19]=Q,t[20]=Y,t[21]=Z,t[22]=q,t[23]=H,t[24]=J,t[25]=ee,t[26]=te,t[27]=ne}else K=t[16],X=t[17],$=t[18],Q=t[19],Y=t[20],Z=t[21],q=t[22],H=t[23],J=t[24],ee=t[25],te=t[26],ne=t[27];return t[54]!==K||t[55]!==q||t[56]!==H||t[57]!==J||t[58]!==ee||t[59]!==te||t[60]!==ne?(ae=(0,h.jsx)(K,{activeKey:q,onChange:H,className:J,tabPosition:ee,tabBarStyle:te,items:ne}),t[54]=K,t[55]=q,t[56]=H,t[57]=J,t[58]=ee,t[59]=te,t[60]=ne,t[61]=ae):ae=t[61],t[62]!==X||t[63]!==$||t[64]!==Q||t[65]!==Y||t[66]!==Z||t[67]!==ae?(se=(0,h.jsxs)(X,{direction:$,gap:Q,align:Y,children:[Z,ae]}),t[62]=X,t[63]=$,t[64]=Q,t[65]=Y,t[66]=Z,t[67]=ae,t[68]=se):se=t[68],t[69]!==x?(ie=x("dialog.ask.DoYouWantToResetChanges"),t[69]=x,t[70]=ie):ie=t[70],t[71]!==x?(ce=x("button.Reset"),t[71]=x,t[72]=ce):ce=t[72],t[73]===Symbol.for("react.memo_cache_sentinel")?(le={danger:!0},t[73]=le):le=t[73],t[74]!==N||t[75]!==n?(re=()=>{R(n),N()},t[74]=N,t[75]=n,t[76]=re):re=t[76],t[77]!==x?(oe=x("button.Cancel"),t[77]=x,t[78]=oe):oe=t[78],t[79]!==N?(de=()=>N(),t[79]=N,t[80]=de):de=t[80],t[81]!==x?(ge=x("dialog.warning.CannotBeUndone"),t[81]=x,t[82]=ge):ge=t[82],t[83]!==ge?(me=(0,h.jsx)(C.A,{showIcon:!0,message:ge,type:"warning"}),t[83]=ge,t[84]=me):me=t[84],t[85]!==L||t[86]!==ie||t[87]!==ce||t[88]!==re||t[89]!==oe||t[90]!==de||t[91]!==me?(ue=(0,h.jsx)(d.Ib,{open:L,title:ie,okText:ce,okButtonProps:le,onOk:re,cancelText:oe,onCancel:de,children:me}),t[85]=L,t[86]=ie,t[87]=ce,t[88]=re,t[89]=oe,t[90]=de,t[91]=me,t[92]=ue):ue=t[92],t[93]!==se||t[94]!==ue?(he=(0,h.jsxs)(h.Fragment,{children:[se,ue]}),t[93]=se,t[94]=ue,t[95]=he):he=t[95],he},R=e=>{m().flatMap(e,(e=>e.settingItems)).forEach((e=>{!e.disabled&&(null===e||void 0===e?void 0:e.setValue)&&e.setValue(e.defaultValue)}))};function E(e){return null!==e.value&&void 0!==e.value&&!e.disabled&&e.value!==e.defaultValue}function _(e){return e.settingItems.length}function B(e){return e.settingItems.length}},22329:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var a=n(43224),s=n(41633),i=n(83557),c=n(95056),l=n(93685),r=n(21481),o=n(51569),d=n(66845);const g=()=>{const[e,t]=(0,r.useState)(!1),[n,g]=(0,r.useState)(!1),{t:m}=(0,o.Bd)(),{upsertNotification:u}=(0,s.js)(),h=(0,a.CX)(),p=[{"data-testid":"maintenance-fix",title:m("maintenance.Fix"),settingItems:[{type:"custom",title:m("maintenance.MatchDatabase"),description:m("maintenance.DescMatchDatabase"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{t(!0),u({message:m("maintenance.RecalculateUsage"),description:m("maintenance.Recalculating"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.recalculate_usage().finally((()=>t(!1))),onChange:{pending:m("maintenance.Recalculating"),resolved:m("maintenance.RecalculationFinished"),rejected:m("maintenance.RecalculationFailed")}}})},loading:e,children:m(e?"maintenance.Recalculating":"maintenance.RecalculateUsage")})}]},{"data-testid":"maintenance-images",title:m("maintenance.ImagesEnvironment"),settingItems:[{type:"custom",title:m("maintenance.RescanImageList"),description:m("maintenance.DescRescanImageList"),children:(0,d.jsx)(l.Ay,{icon:(0,d.jsx)(c.A,{}),onClick:()=>{g(!0),u({message:m("maintenance.RescanImages"),open:!0,backgroundTask:{status:"pending",promise:h.maintenance.rescan_images(),onChange:{pending:m("maintenance.RescanImageScanning"),resolved:e=>{const t=e;if(t.rescan_images.ok)return{backgroundTask:{status:"pending",taskId:t.rescan_images.task_id,promise:null,percent:0,onChange:{resolved:(e,t)=>(g(!1),m("maintenance.RescanImageFinished"))}},duration:0};throw new Error(m("maintenance.RescanFailed"))},rejected:(e,t)=>{const n=e;return g(!1),(null===n||void 0===n?void 0:n.message)||m("maintenance.RescanFailed")}}}})},loading:n,children:m(n?"maintenance.RescanImageScanning":"maintenance.RescanImages")})}]}];return(0,d.jsx)(i.A,{settingGroups:p,showSearchBar:!0})};var m=n(78890),u=n(45045),h=n(75182),p=n(7927);const x=(0,p.withDefault)(p.StringParam,"maintenance"),j=()=>{const{t:e}=(0,o.Bd)(),[t,n]=(0,p.useQueryParam)("tab",x);return(0,d.jsx)(u.Zu,{activeTabKey:t,onTabChange:e=>n(e),tabList:[{key:"maintenance",tab:e("webui.menu.Maintenance")}],children:(0,d.jsx)(r.Suspense,{fallback:(0,d.jsx)(m.A,{active:!0}),children:"maintenance"===t&&(0,d.jsx)(h.A,{children:(0,d.jsx)(g,{})})})})}},95056:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(1139),s=n(21481);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"}}]},name:"redo",theme:"outlined"};var c=n(46361),l=function(e,t){return s.createElement(c.A,(0,a.A)({},e,{ref:t,icon:i}))};const r=s.forwardRef(l)}}]);
//# sourceMappingURL=2329.cf4c412d.chunk.js.map