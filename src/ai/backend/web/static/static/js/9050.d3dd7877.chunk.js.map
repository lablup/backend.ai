{"version":3,"file":"static/js/9050.d3dd7877.chunk.js","mappings":"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","sources":["components/LegacyFolderExplorer.tsx","components/__generated__/LegacyFolderExplorerVFolderNameTitleQuery.graphql.ts"],"sourcesContent":["import { formatToUUID } from '../helper';\nimport { useSuspendedBackendaiClient } from '../hooks';\nimport BAIModal, { BAIModalProps } from './BAIModal';\nimport Flex from './Flex';\nimport { LegacyFolderExplorerVFolderNameTitleQuery } from './__generated__/LegacyFolderExplorerVFolderNameTitleQuery.graphql';\nimport {\n  DeleteOutlined,\n  FileAddOutlined,\n  FolderAddOutlined,\n  UploadOutlined,\n} from '@ant-design/icons';\nimport {\n  Button,\n  Dropdown,\n  Grid,\n  Image,\n  Skeleton,\n  Tooltip,\n  Typography,\n  theme,\n} from 'antd';\nimport { createStyles } from 'antd-style';\nimport graphql from 'babel-plugin-relay/macro';\nimport { Suspense, useEffect, useRef, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useLazyLoadQuery } from 'react-relay';\n\nconst useStyles = createStyles(({ token, css }) => ({\n  baiModalHeader: css`\n    .ant-modal-title {\n      width: 100%;\n      margin-right: ${token.marginXXL}px;\n    }\n  `,\n}));\n\ninterface LegacyFolderExplorerProps extends BAIModalProps {\n  vfolderID: string;\n  onRequestClose: () => void;\n}\n\nconst LegacyFolderExplorer: React.FC<LegacyFolderExplorerProps> = ({\n  vfolderID,\n  onRequestClose,\n  ...modalProps\n}) => {\n  const { t } = useTranslation();\n  const { token } = theme.useToken();\n  const { styles } = useStyles();\n  const { lg } = Grid.useBreakpoint();\n  const [isWritable, setIsWritable] = useState<boolean>(false);\n  const [isSelected, setIsSelected] = useState<boolean>(false);\n  // TODO: Events are sent and received as normal,\n  // but the Lit Element is not rendered and the values inside are not available but ref is available.\n  const folderExplorerRef = useRef<HTMLDivElement>(null);\n  // ensure the client is connected\n  useSuspendedBackendaiClient();\n  useEffect(() => {\n    const handleConnected = (e: any) => {\n      setIsWritable(e.detail || false);\n    };\n\n    const handleColumnSelected = (e: any) => {\n      setIsSelected(e.detail || false);\n    };\n\n    document.addEventListener('folderExplorer:connected', handleConnected);\n    document.addEventListener(\n      'folderExplorer:columnSelected',\n      handleColumnSelected,\n    );\n    return () => {\n      document.removeEventListener('folderExplorer:connected', handleConnected);\n      document.removeEventListener(\n        'folderExplorer:columnSelected',\n        handleColumnSelected,\n      );\n    };\n  }, []);\n\n  return (\n    <BAIModal\n      className={styles.baiModalHeader}\n      centered\n      width={1200}\n      destroyOnClose\n      footer={null}\n      title={\n        <Flex justify=\"between\" gap={token.marginMD} style={{ width: '100%' }}>\n          <Flex gap={token.marginMD} style={{ flex: 1 }}>\n            <Suspense fallback={<Skeleton.Input active />}>\n              <VFolderNameTitle vfolderID={vfolderID} />\n            </Suspense>\n          </Flex>\n          <Flex justify=\"end\" gap={token.marginSM} style={{ flex: lg ? 2 : 1 }}>\n            <Button\n              danger\n              disabled={!isSelected || !isWritable}\n              icon={<DeleteOutlined />}\n              onClick={() => {\n                // @ts-ignore\n                folderExplorerRef.current?._openDeleteMultipleFileDialog();\n              }}\n            >\n              {lg && t('button.Delete')}\n            </Button>\n            <Button\n              disabled={!isWritable}\n              icon={<FolderAddOutlined />}\n              onClick={() => {\n                //@ts-ignore\n                folderExplorerRef.current?.openMkdirDialog();\n              }}\n            >\n              {lg && t('button.Create')}\n            </Button>\n            <Dropdown\n              disabled={!isWritable}\n              menu={{\n                items: [\n                  {\n                    key: 'upload files',\n                    label: t('data.explorer.UploadFiles'),\n                    icon: <FileAddOutlined />,\n                    onClick: () => {\n                      // @ts-ignore\n                      folderExplorerRef.current?.handleUpload('file');\n                    },\n                  },\n                  {\n                    key: 'upload folder',\n                    label: t('data.explorer.UploadFolder'),\n                    icon: <FolderAddOutlined />,\n                    onClick: () => {\n                      // @ts-ignore\n                      folderExplorerRef.current?.handleUpload('folder');\n                    },\n                  },\n                ],\n              }}\n            >\n              <Button icon={<UploadOutlined />}>{lg && 'Upload'}</Button>\n            </Dropdown>\n            <Button\n              icon={\n                <Image\n                  width=\"18px\"\n                  src=\"/resources/icons/filebrowser.svg\"\n                  alt=\"File Browser\"\n                  preview={false}\n                />\n              }\n              onClick={() =>\n                // @ts-ignore\n                folderExplorerRef.current?._executeFileBrowser()\n              }\n            >\n              {lg && t('data.explorer.ExecuteFileBrowser')}\n            </Button>\n            <Button\n              icon={\n                <Image\n                  width=\"18px\"\n                  src=\"/resources/icons/sftp.png\"\n                  alt=\"SSH / SFTP\"\n                  preview={false}\n                />\n              }\n              onClick={() => {\n                // @ts-ignore\n                folderExplorerRef.current?._executeSSHProxyAgent();\n              }}\n            >\n              {lg && t('data.explorer.RunSSH/SFTPserver')}\n            </Button>\n          </Flex>\n        </Flex>\n      }\n      onCancel={() => {\n        onRequestClose();\n      }}\n      {...modalProps}\n    >\n      {/* <script type=\"module\" src=\"./dist/components/backend-ai-folder-explorer.js\"></script> */}\n      {/* @ts-ignore */}\n      <backend-ai-folder-explorer\n        ref={folderExplorerRef}\n        active\n        vfolderID={vfolderID}\n      />\n    </BAIModal>\n  );\n};\n\nconst VFolderNameTitle: React.FC<{\n  vfolderID: string;\n}> = ({ vfolderID }) => {\n  const { token } = theme.useToken();\n  const { vfolder, vfolder_node } =\n    useLazyLoadQuery<LegacyFolderExplorerVFolderNameTitleQuery>(\n      graphql`\n        query LegacyFolderExplorerVFolderNameTitleQuery(\n          $vfolderID: String!\n          $vfolderUUID: String!\n        ) {\n          # TODO: version compatibility\n          vfolder(id: $vfolderID) @deprecatedSince(version: \"24.03.4\") {\n            id\n            name\n          }\n          vfolder_node(id: $vfolderUUID) @since(version: \"24.03.4\") {\n            id\n            name\n          }\n        }\n      `,\n      {\n        vfolderID,\n        vfolderUUID: btoa('VirtualFolderNode:' + formatToUUID(vfolderID)),\n      },\n      {\n        fetchPolicy: 'store-and-network',\n      },\n    );\n\n  const vfolderName = vfolder?.name || vfolder_node?.name || '';\n  return (\n    <Tooltip title={vfolderName}>\n      <Typography.Title\n        level={3}\n        style={{ marginTop: token.marginSM }}\n        ellipsis\n      >\n        {vfolderName}\n      </Typography.Title>\n    </Tooltip>\n  );\n};\n\nexport default LegacyFolderExplorer;\n","/**\n * @generated SignedSource<<4d882da5538a6b7559dcfacf028b5ac6>>\n * @lightSyntaxTransform\n * @nogrep\n */\n\n/* tslint:disable */\n/* eslint-disable */\n// @ts-nocheck\n\nimport { ConcreteRequest, Query } from 'relay-runtime';\nexport type LegacyFolderExplorerVFolderNameTitleQuery$variables = {\n  vfolderID: string;\n  vfolderUUID: string;\n};\nexport type LegacyFolderExplorerVFolderNameTitleQuery$data = {\n  readonly vfolder: {\n    readonly id: string | null | undefined;\n    readonly name: string | null | undefined;\n  } | null | undefined;\n  readonly vfolder_node: {\n    readonly id: string;\n    readonly name: string | null | undefined;\n  } | null | undefined;\n};\nexport type LegacyFolderExplorerVFolderNameTitleQuery = {\n  response: LegacyFolderExplorerVFolderNameTitleQuery$data;\n  variables: LegacyFolderExplorerVFolderNameTitleQuery$variables;\n};\n\nconst node: ConcreteRequest = (function(){\nvar v0 = [\n  {\n    \"defaultValue\": null,\n    \"kind\": \"LocalArgument\",\n    \"name\": \"vfolderID\"\n  },\n  {\n    \"defaultValue\": null,\n    \"kind\": \"LocalArgument\",\n    \"name\": \"vfolderUUID\"\n  }\n],\nv1 = [\n  {\n    \"alias\": null,\n    \"args\": null,\n    \"kind\": \"ScalarField\",\n    \"name\": \"id\",\n    \"storageKey\": null\n  },\n  {\n    \"alias\": null,\n    \"args\": null,\n    \"kind\": \"ScalarField\",\n    \"name\": \"name\",\n    \"storageKey\": null\n  }\n],\nv2 = [\n  {\n    \"alias\": null,\n    \"args\": [\n      {\n        \"kind\": \"Variable\",\n        \"name\": \"id\",\n        \"variableName\": \"vfolderID\"\n      }\n    ],\n    \"concreteType\": \"VirtualFolder\",\n    \"kind\": \"LinkedField\",\n    \"name\": \"vfolder\",\n    \"plural\": false,\n    \"selections\": (v1/*: any*/),\n    \"storageKey\": null\n  },\n  {\n    \"alias\": null,\n    \"args\": [\n      {\n        \"kind\": \"Variable\",\n        \"name\": \"id\",\n        \"variableName\": \"vfolderUUID\"\n      }\n    ],\n    \"concreteType\": \"VirtualFolderNode\",\n    \"kind\": \"LinkedField\",\n    \"name\": \"vfolder_node\",\n    \"plural\": false,\n    \"selections\": (v1/*: any*/),\n    \"storageKey\": null\n  }\n];\nreturn {\n  \"fragment\": {\n    \"argumentDefinitions\": (v0/*: any*/),\n    \"kind\": \"Fragment\",\n    \"metadata\": null,\n    \"name\": \"LegacyFolderExplorerVFolderNameTitleQuery\",\n    \"selections\": (v2/*: any*/),\n    \"type\": \"Queries\",\n    \"abstractKey\": null\n  },\n  \"kind\": \"Request\",\n  \"operation\": {\n    \"argumentDefinitions\": (v0/*: any*/),\n    \"kind\": \"Operation\",\n    \"name\": \"LegacyFolderExplorerVFolderNameTitleQuery\",\n    \"selections\": (v2/*: any*/)\n  },\n  \"params\": {\n    \"cacheID\": \"d068f3eaad8b8108353e61ba6cdf73e9\",\n    \"id\": null,\n    \"metadata\": {},\n    \"name\": \"LegacyFolderExplorerVFolderNameTitleQuery\",\n    \"operationKind\": \"query\",\n    \"text\": \"query LegacyFolderExplorerVFolderNameTitleQuery(\\n  $vfolderID: String!\\n  $vfolderUUID: String!\\n) {\\n  vfolder(id: $vfolderID) @deprecatedSince(version: \\\"24.03.4\\\") {\\n    id\\n    name\\n  }\\n  vfolder_node(id: $vfolderUUID) @since(version: \\\"24.03.4\\\") {\\n    id\\n    name\\n  }\\n}\\n\"\n  }\n};\n})();\n\n(node as any).hash = \"9c571e622253de1513d54bf011a863ef\";\n\nexport default node;\n"],"names":["useStyles","createStyles","_ref","token","css","baiModalHeader","marginXXL","VFolderNameTitle","_ref3","vfolderID","theme","useToken","vfolder","vfolder_node","useLazyLoadQuery","_LegacyFolderExplorerVFolderNameTitleQuery","require","vfolderUUID","btoa","formatToUUID","fetchPolicy","vfolderName","name","_jsx","Tooltip","title","children","Typography","Title","level","style","marginTop","marginSM","ellipsis","_ref2","onRequestClose","modalProps","t","useTranslation","styles","lg","Grid","useBreakpoint","isWritable","setIsWritable","useState","isSelected","setIsSelected","folderExplorerRef","useRef","useSuspendedBackendaiClient","useEffect","handleConnected","e","detail","handleColumnSelected","document","addEventListener","removeEventListener","BAIModal","className","centered","width","destroyOnClose","footer","_jsxs","Flex","justify","gap","marginMD","flex","Suspense","fallback","Skeleton","Input","active","Button","danger","disabled","icon","DeleteOutlined","onClick","_folderExplorerRef$cu","current","_openDeleteMultipleFileDialog","FolderAddOutlined","_folderExplorerRef$cu2","openMkdirDialog","Dropdown","menu","items","key","label","FileAddOutlined","_folderExplorerRef$cu3","handleUpload","_folderExplorerRef$cu4","UploadOutlined","Image","src","alt","preview","_folderExplorerRef$cu5","_executeFileBrowser","_folderExplorerRef$cu6","_executeSSHProxyAgent","onCancel","ref","node","v0","v1","v2","hash"],"sourceRoot":""}