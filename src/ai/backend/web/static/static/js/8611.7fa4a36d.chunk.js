"use strict";(self.webpackChunkbackend_ai_webui_react=self.webpackChunkbackend_ai_webui_react||[]).push([[8611],{18611:(t,e,o)=>{o.r(e),o.d(e,{default:()=>_});var n=o(81751),i=o(7885),a=o(38053),r=o(60916),l=o(96520),p=o(10161),s=o(27283),u=o(55202),c=o(90635),d=o(52426);const _=()=>{const{t:t}=(0,c.Bd)(),e=(0,u.useRef)(null),{value:o,dispatchEvent:_}=(0,r.useWebComponentInfo)();let k;try{k=JSON.parse(o||"")}catch(S){k={open:!1,totp_registration_token:"",api_endpoint:""}}const{api_endpoint:v,open:b,totp_registration_token:f}=k,g=(0,n.oM)({api_endpoint:v}),{data:h,isSuccess:m,isError:C,mutate:y}=(0,i.ET)({mutationFn:t=>{let{registration_token:e}=t;return g.initialize_totp_anon({registration_token:e})}});(0,u.useEffect)((()=>{b&&y({registration_token:f})}),[b,y,f]);const E=(0,i.ET)({mutationFn:t=>g.activate_totp_anon(t)});return(0,d.jsx)(a.A,{title:t("webui.menu.SetupTotp"),maskClosable:!1,confirmLoading:E.isPending,open:b,onCancel:()=>{_("cancel",null)},destroyOnClose:!0,onOk:()=>{var o;null===(o=e.current)||void 0===o||o.validateFields().then((e=>{E.mutate({otp:e.otp,registration_token:f},{onSuccess:()=>{s.Ay.success(t("totp.TotpSetupCompleted")),_("ok",null)},onError:()=>{s.Ay.error(t("totp.InvalidTotpCode"))}})})).catch((()=>{}))},loading:!m,children:!C&&null!==h&&void 0!==h&&h.totp_uri&&null!==h&&void 0!==h&&h.totp_key?(0,d.jsx)(p.R,{ref:e,totp_uri:null===h||void 0===h?void 0:h.totp_uri,totp_key:null===h||void 0===h?void 0:h.totp_key}):(0,d.jsx)(l.A,{children:t("totp.TotpSetupNotAvailable")})})}}}]);
//# sourceMappingURL=8611.7fa4a36d.chunk.js.map