Enable extended Ruff linter rules and apply codebase-wide fixes