Separate repository layer from image service