Apply try-with-resources pattern to prevent resource leak