Extract provisioning logic to SessionProvisioner