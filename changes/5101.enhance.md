Separate repository layer from scheduler