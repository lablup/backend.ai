Refactor `decrypt_payload()` as a middleware so that applied to `web_handler()` and `login_handler()`
