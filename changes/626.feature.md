Refactoring `decrypt_payload()` as a middleware so that applied to other request handlers
