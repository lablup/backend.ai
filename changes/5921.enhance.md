Introduce service, repository layer when handling agent status change event 
