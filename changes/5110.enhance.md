Separate repository layer from session service