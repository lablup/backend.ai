Kernel registry recovery logic has been refactored and separated from the Agent component for better modularity