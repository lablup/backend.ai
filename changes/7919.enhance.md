Centralize state change logic to Coordinator and fix kernel status transitions