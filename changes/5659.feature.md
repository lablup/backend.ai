Implement session wait logic in AgentRegistry for improved scheduling handling