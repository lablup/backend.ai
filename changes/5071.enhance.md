Separate repository layer from auth service