Migrate direct Database query from api/auth.py to follow directory pattern and safer validation.