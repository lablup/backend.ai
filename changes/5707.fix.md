Enhance endpoint creation logic to update existing records and handle circuits