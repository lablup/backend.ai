Refactor Redis message queue to follow ABC pattern