Refactor Message queue architecture by decoupling dispatcher components
